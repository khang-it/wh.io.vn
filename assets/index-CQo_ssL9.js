const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./MobileLayout-DYcg2ztq.js","./auth-hUBjOec7.js","./MobileLayout-kgKoArum.css","./DesktopLayout-BrAW6lFI.js","./DesktopLayout-DVaojfNY.css"])))=>i.map(i=>d[i]);
var cM=Object.defineProperty;var JS=e=>{throw TypeError(e)};var dM=(e,t,i)=>t in e?cM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var Pe=(e,t,i)=>dM(e,typeof t!="symbol"?t+"":t,i),Qv=(e,t,i)=>t.has(e)||JS("Cannot "+i);var g=(e,t,i)=>(Qv(e,t,"read from private field"),i?i.call(e):t.get(e)),F=(e,t,i)=>t.has(e)?JS("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),y=(e,t,i,s)=>(Qv(e,t,"write to private field"),s?s.call(e,i):t.set(e,i),i),x=(e,t,i)=>(Qv(e,t,"access private method"),i);var Ki=(e,t,i,s)=>({set _(n){y(e,t,n,i)},get _(){return g(e,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function i(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=i(n);fetch(n.href,o)}})();const Ax=!1;var Hf=Array.isArray,hM=Array.prototype.indexOf,yy=Array.from,Fx=Object.defineProperty,Cr=Object.getOwnPropertyDescriptor,Px=Object.getOwnPropertyDescriptors,uM=Object.prototype,gM=Array.prototype,Sy=Object.getPrototypeOf,ZS=Object.isExtensible;function td(e){return typeof e=="function"}const Fn=()=>{};function fM(e){return e()}function JC(e){for(var t=0;t<e.length;t++)e[t]()}function Tx(){var e,t,i=new Promise((s,n)=>{e=s,t=n});return{promise:i,resolve:e,reject:t}}function Dx(e,t){if(Array.isArray(e))return e;if(!(Symbol.iterator in e))return Array.from(e);const i=[];for(const s of e)if(i.push(s),i.length===t)break;return i}const Ui=2,wv=4,bv=8,Eo=16,kr=32,Hc=64,yv=128,kn=512,Fi=1024,ms=2048,Ao=4096,Ls=8192,Da=16384,Sv=32768,Ar=65536,e0=1<<17,Mx=1<<18,qh=1<<19,Ix=1<<20,Ju=32768,ZC=1<<21,Ry=1<<22,Ma=1<<23,bo=Symbol("$state"),kx=Symbol("legacy props"),pM=Symbol(""),hd=new class extends Error{constructor(){super(...arguments);Pe(this,"name","StaleReactionError");Pe(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Jv(){throw new Error("https://svelte.dev/e/invalid_default_snippet")}function Gf(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function mM(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function vM(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function CM(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function wM(e){throw new Error("https://svelte.dev/e/effect_orphan")}function bM(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function yM(e){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function SM(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function RM(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function xM(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function EM(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function AM(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Rv=1,xv=2,_x=4,FM=8,PM=16,TM=1,DM=2,Lx=4,MM=8,IM=16,kM=4,_M=1,LM=2,Ei=Symbol(),OM="http://www.w3.org/1999/xhtml",NM="http://www.w3.org/2000/svg",HM="@attach";function GM(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function BM(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let VM=!1;function Ox(e){return e===this.v}function Nx(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function Hx(e){return!Nx(e,this.v)}let Yh=!1,zM=!1;function WM(){Yh=!0}let Ze=null;function _h(e){Ze=e}function $M(e){return Gx().get(e)}function UM(e,t){return Gx().set(e,t),t}function ot(e,t=!1,i){Ze={p:Ze,i:!1,c:null,e:null,s:e,x:null,l:Yh&&!t?{s:null,u:null,$:[]}:null}}function rt(e){var t=Ze,i=t.e;if(i!==null){t.e=null;for(var s of i)sE(s)}return e!==void 0&&(t.x=e),t.i=!0,Ze=t.p,e??{}}function Bf(){return!Yh||Ze!==null&&Ze.l===null}function Gx(e){return Ze===null&&Gf(),Ze.c??(Ze.c=new Map(jM(Ze)||void 0))}function jM(e){let t=e.p;for(;t!==null;){const i=t.c;if(i!==null)return i;t=t.p}return null}let dl=[];function Bx(){var e=dl;dl=[],JC(e)}function Ua(e){if(dl.length===0&&!Lu){var t=dl;queueMicrotask(()=>{t===dl&&Bx()})}dl.push(e)}function KM(){for(;dl.length>0;)Bx()}function Vx(e){var t=Je;if(t===null)return Xe.f|=Ma,e;if((t.f&Sv)===0){if((t.f&yv)===0)throw e;t.b.error(e)}else Lh(e,t)}function Lh(e,t){for(;t!==null;){if((t.f&yv)!==0)try{t.b.error(e);return}catch(i){e=i}t=t.parent}throw e}const ip=new Set;let ht=null,_u=null,Wt=null,po=[],Ev=null,ew=!1,Lu=!1;var Id,kd,pl,ml,wg,_d,Ld,zi,tw,tl,zx,Wx;const Zm=class Zm{constructor(){F(this,zi);Pe(this,"committed",!1);Pe(this,"current",new Map);Pe(this,"previous",new Map);F(this,Id,new Set);F(this,kd,new Set);F(this,pl,0);F(this,ml,0);F(this,wg,null);F(this,_d,[]);F(this,Ld,[]);Pe(this,"skipped_effects",new Set);Pe(this,"is_fork",!1)}process(t){var s;po=[],_u=null,this.apply();var i={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const n of t)x(this,zi,tw).call(this,n,i);this.is_fork||x(this,zi,zx).call(this),g(this,ml)>0||this.is_fork?(x(this,zi,tl).call(this,i.effects),x(this,zi,tl).call(this,i.render_effects),x(this,zi,tl).call(this,i.block_effects)):(_u=this,ht=null,t0(i.render_effects),t0(i.effects),_u=null,(s=g(this,wg))==null||s.resolve()),Wt=null}capture(t,i){this.previous.has(t)||this.previous.set(t,i),(t.f&Ma)===0&&(this.current.set(t,t.v),Wt==null||Wt.set(t,t.v))}activate(){ht=this,this.apply()}deactivate(){ht=null,Wt=null}flush(){if(this.activate(),po.length>0){if($x(),ht!==null&&ht!==this)return}else g(this,pl)===0&&this.process([]);this.deactivate()}discard(){for(const t of g(this,kd))t(this);g(this,kd).clear()}increment(t){y(this,pl,g(this,pl)+1),t&&y(this,ml,g(this,ml)+1)}decrement(t){y(this,pl,g(this,pl)-1),t&&y(this,ml,g(this,ml)-1),this.revive()}revive(){for(const t of g(this,_d))Di(t,ms),Ec(t);for(const t of g(this,Ld))Di(t,Ao),Ec(t);y(this,_d,[]),y(this,Ld,[]),this.flush()}oncommit(t){g(this,Id).add(t)}ondiscard(t){g(this,kd).add(t)}settled(){return(g(this,wg)??y(this,wg,Tx())).promise}static ensure(){if(ht===null){const t=ht=new Zm;ip.add(ht),Lu||Zm.enqueue(()=>{ht===t&&t.flush()})}return ht}static enqueue(t){Ua(t)}apply(){}};Id=new WeakMap,kd=new WeakMap,pl=new WeakMap,ml=new WeakMap,wg=new WeakMap,_d=new WeakMap,Ld=new WeakMap,zi=new WeakSet,tw=function(t,i){var d;t.f^=Fi;for(var s=t.first;s!==null;){var n=s.f,o=(n&(kr|Hc))!==0,r=o&&(n&Fi)!==0,a=r||(n&Ls)!==0||this.skipped_effects.has(s);if((s.f&yv)!==0&&((d=s.b)!=null&&d.is_pending())&&(i={parent:i,effect:s,effects:[],render_effects:[],block_effects:[]}),!a&&s.fn!==null){o?s.f^=Fi:(n&wv)!==0?i.effects.push(s):Zh(s)&&((s.f&Eo)!==0&&i.block_effects.push(s),Nh(s));var l=s.first;if(l!==null){s=l;continue}}var c=s.parent;for(s=s.next;s===null&&c!==null;)c===i.effect&&(x(this,zi,tl).call(this,i.effects),x(this,zi,tl).call(this,i.render_effects),x(this,zi,tl).call(this,i.block_effects),i=i.parent),s=c.next,c=c.parent}},tl=function(t){for(const i of t)((i.f&ms)!==0?g(this,_d):g(this,Ld)).push(i),Di(i,Fi)},zx=function(){if(g(this,ml)===0){for(const t of g(this,Id))t();g(this,Id).clear()}g(this,pl)===0&&x(this,zi,Wx).call(this)},Wx=function(){var n;if(ip.size>1){this.previous.clear();var t=Wt,i=!0,s={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const o of ip){if(o===this){i=!1;continue}const r=[];for(const[l,c]of this.current){if(o.current.has(l))if(i&&c!==o.current.get(l))o.current.set(l,c);else continue;r.push(l)}if(r.length===0)continue;const a=[...o.current.keys()].filter(l=>!this.current.has(l));if(a.length>0){const l=new Set,c=new Map;for(const d of r)Ux(d,a,l,c);if(po.length>0){ht=o,o.apply();for(const d of po)x(n=o,zi,tw).call(n,d,s);po=[],o.deactivate()}}}ht=null,Wt=t}this.committed=!0,ip.delete(this)};let mr=Zm;function qM(e){var t=Lu;Lu=!0;try{for(var i;;){if(KM(),po.length===0&&(ht==null||ht.flush(),po.length===0))return Ev=null,i;$x()}}finally{Lu=t}}function $x(){var e=mc;ew=!0;try{var t=0;for(r0(!0);po.length>0;){var i=mr.ensure();if(t++>1e3){var s,n;YM()}i.process(po),Ia.clear()}}finally{ew=!1,r0(e),Ev=null}}function YM(){try{bM()}catch(e){Lh(e,Ev)}}let ln=null;function t0(e){var t=e.length;if(t!==0){for(var i=0;i<t;){var s=e[i++];if((s.f&(Da|Ls))===0&&Zh(s)&&(ln=new Set,Nh(s),s.deps===null&&s.first===null&&s.nodes_start===null&&(s.teardown===null&&s.ac===null?rE(s):s.fn=null),(ln==null?void 0:ln.size)>0)){Ia.clear();for(const n of ln){if((n.f&(Da|Ls))!==0)continue;const o=[n];let r=n.parent;for(;r!==null;)ln.has(r)&&(ln.delete(r),o.push(r)),r=r.parent;for(let a=o.length-1;a>=0;a--){const l=o[a];(l.f&(Da|Ls))===0&&Nh(l)}}ln.clear()}}ln=null}}function Ux(e,t,i,s){if(!i.has(e)&&(i.add(e),e.reactions!==null))for(const n of e.reactions){const o=n.f;(o&Ui)!==0?Ux(n,t,i,s):(o&(Ry|Eo))!==0&&(o&ms)===0&&jx(n,t,s)&&(Di(n,ms),Ec(n))}}function jx(e,t,i){const s=i.get(e);if(s!==void 0)return s;if(e.deps!==null)for(const n of e.deps){if(t.includes(n))return!0;if((n.f&Ui)!==0&&jx(n,t,i))return i.set(n,!0),!0}return i.set(e,!1),!1}function Ec(e){for(var t=Ev=e;t.parent!==null;){t=t.parent;var i=t.f;if(ew&&t===Je&&(i&Eo)!==0&&(i&Mx)===0)return;if((i&(Hc|kr))!==0){if((i&Fi)===0)return;t.f^=Fi}}po.push(t)}function XM(e){let t=0,i=Fr(0),s;return()=>{Av()&&(R(i),Jh(()=>(t===0&&(s=ie(()=>e(()=>Ou(i)))),t+=1,()=>{Ua(()=>{t-=1,t===0&&(s==null||s(),s=void 0,Ou(i))})})))}}var QM=Ar|qh|yv;function JM(e,t,i){new ZM(e,t,i)}var $s,Us,by,Un,vl,jn,js,as,Kn,Vo,Xr,Cl,Qr,wl,Jr,ev,vi,eI,tI,iw,Fp,Pp,sw;class ZM{constructor(t,i,s){F(this,vi);Pe(this,"parent");F(this,$s,!1);F(this,Us);F(this,by,null);F(this,Un);F(this,vl);F(this,jn);F(this,js,null);F(this,as,null);F(this,Kn,null);F(this,Vo,null);F(this,Xr,null);F(this,Cl,0);F(this,Qr,0);F(this,wl,!1);F(this,Jr,null);F(this,ev,XM(()=>(y(this,Jr,Fr(g(this,Cl))),()=>{y(this,Jr,null)})));y(this,Us,t),y(this,Un,i),y(this,vl,s),this.parent=Je.b,y(this,$s,!!g(this,Un).pending),y(this,jn,Gc(()=>{Je.b=this;{var n=x(this,vi,iw).call(this);try{y(this,js,Ms(()=>s(n)))}catch(o){this.error(o)}g(this,Qr)>0?x(this,vi,Pp).call(this):y(this,$s,!1)}return()=>{var o;(o=g(this,Xr))==null||o.remove()}},QM))}is_pending(){return g(this,$s)||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!g(this,Un).pending}update_pending_count(t){x(this,vi,sw).call(this,t),y(this,Cl,g(this,Cl)+t),g(this,Jr)&&Ac(g(this,Jr),g(this,Cl))}get_effect_pending(){return g(this,ev).call(this),R(g(this,Jr))}error(t){var i=g(this,Un).onerror;let s=g(this,Un).failed;if(g(this,wl)||!i&&!s)throw t;g(this,js)&&(mi(g(this,js)),y(this,js,null)),g(this,as)&&(mi(g(this,as)),y(this,as,null)),g(this,Kn)&&(mi(g(this,Kn)),y(this,Kn,null));var n=!1,o=!1;const r=()=>{if(n){BM();return}n=!0,o&&AM(),mr.ensure(),y(this,Cl,0),g(this,Kn)!==null&&vd(g(this,Kn),()=>{y(this,Kn,null)}),y(this,$s,this.has_pending_snippet()),y(this,js,x(this,vi,Fp).call(this,()=>(y(this,wl,!1),Ms(()=>g(this,vl).call(this,g(this,Us)))))),g(this,Qr)>0?x(this,vi,Pp).call(this):y(this,$s,!1)};var a=Xe;try{us(null),o=!0,i==null||i(t,r),o=!1}catch(l){Lh(l,g(this,jn)&&g(this,jn).parent)}finally{us(a)}s&&Ua(()=>{y(this,Kn,x(this,vi,Fp).call(this,()=>{mr.ensure(),y(this,wl,!0);try{return Ms(()=>{s(g(this,Us),()=>t,()=>r)})}catch(l){return Lh(l,g(this,jn).parent),null}finally{y(this,wl,!1)}}))})}}$s=new WeakMap,Us=new WeakMap,by=new WeakMap,Un=new WeakMap,vl=new WeakMap,jn=new WeakMap,js=new WeakMap,as=new WeakMap,Kn=new WeakMap,Vo=new WeakMap,Xr=new WeakMap,Cl=new WeakMap,Qr=new WeakMap,wl=new WeakMap,Jr=new WeakMap,ev=new WeakMap,vi=new WeakSet,eI=function(){try{y(this,js,Ms(()=>g(this,vl).call(this,g(this,Us))))}catch(t){this.error(t)}y(this,$s,!1)},tI=function(){const t=g(this,Un).pending;t&&(y(this,as,Ms(()=>t(g(this,Us)))),mr.enqueue(()=>{var i=x(this,vi,iw).call(this);y(this,js,x(this,vi,Fp).call(this,()=>(mr.ensure(),Ms(()=>g(this,vl).call(this,i))))),g(this,Qr)>0?x(this,vi,Pp).call(this):(vd(g(this,as),()=>{y(this,as,null)}),y(this,$s,!1))}))},iw=function(){var t=g(this,Us);return g(this,$s)&&(y(this,Xr,Pr()),g(this,Us).before(g(this,Xr)),t=g(this,Xr)),t},Fp=function(t){var i=Je,s=Xe,n=Ze;nn(g(this,jn)),us(g(this,jn)),_h(g(this,jn).ctx);try{return t()}catch(o){return Vx(o),null}finally{nn(i),us(s),_h(n)}},Pp=function(){const t=g(this,Un).pending;g(this,js)!==null&&(y(this,Vo,document.createDocumentFragment()),g(this,Vo).append(g(this,Xr)),cE(g(this,js),g(this,Vo))),g(this,as)===null&&y(this,as,Ms(()=>t(g(this,Us))))},sw=function(t){var i;if(!this.has_pending_snippet()){this.parent&&x(i=this.parent,vi,sw).call(i,t);return}y(this,Qr,g(this,Qr)+t),g(this,Qr)===0&&(y(this,$s,!1),g(this,as)&&vd(g(this,as),()=>{y(this,as,null)}),g(this,Vo)&&(g(this,Us).before(g(this,Vo)),y(this,Vo,null)))};function Kx(e,t,i,s){const n=Bf()?Vf:Aa;if(i.length===0&&e.length===0){s(t.map(n));return}var o=ht,r=Je,a=iI();function l(){Promise.all(i.map(c=>sI(c))).then(c=>{a();try{s([...t.map(n),...c])}catch(d){(r.f&Da)===0&&Lh(d,r)}o==null||o.deactivate(),wm()}).catch(c=>{Lh(c,r)})}e.length>0?Promise.all(e).then(()=>{a();try{return l()}finally{o==null||o.deactivate(),wm()}}):l()}function iI(){var e=Je,t=Xe,i=Ze,s=ht;return function(o=!0){nn(e),us(t),_h(i),o&&(s==null||s.activate())}}function wm(){nn(null),us(null),_h(null)}function Vf(e){var t=Ui|ms,i=Xe!==null&&(Xe.f&Ui)!==0?Xe:null;return Je!==null&&(Je.f|=qh),{ctx:Ze,deps:null,effects:null,equals:Ox,f:t,fn:e,reactions:null,rv:0,v:Ei,wv:0,parent:i??Je,ac:null}}function sI(e,t){let i=Je;i===null&&mM();var s=i.b,n=void 0,o=Fr(Ei),r=!Xe,a=new Map;return gI(()=>{var u;var l=Tx();n=l.promise;try{Promise.resolve(e()).then(l.resolve,l.reject).then(()=>{c===ht&&c.committed&&c.deactivate(),wm()})}catch(f){l.reject(f),wm()}var c=ht;if(r){var d=!s.is_pending();s.update_pending_count(1),c.increment(d),(u=a.get(c))==null||u.reject(hd),a.delete(c),a.set(c,l)}const h=(f,p=void 0)=>{if(c.activate(),p)p!==hd&&(o.f|=Ma,Ac(o,p));else{(o.f&Ma)!==0&&(o.f^=Ma),Ac(o,f);for(const[m,v]of a){if(a.delete(m),m===c)break;v.reject(hd)}}r&&(s.update_pending_count(-1),c.decrement(d))};l.promise.then(h,f=>h(null,f||"unknown"))}),Qh(()=>{for(const l of a.values())l.reject(hd)}),new Promise(l=>{function c(d){function h(){d===n?l(o):c(n)}d.then(h,h)}c(n)})}function al(e){const t=Vf(e);return dE(t),t}function Aa(e){const t=Vf(e);return t.equals=Hx,t}function qx(e){var t=e.effects;if(t!==null){e.effects=null;for(var i=0;i<t.length;i+=1)mi(t[i])}}function nI(e){for(var t=e.parent;t!==null;){if((t.f&Ui)===0)return t;t=t.parent}return null}function xy(e){var t,i=Je;nn(nI(e));try{e.f&=~Ju,qx(e),t=fE(e)}finally{nn(i)}return t}function Yx(e){var t=xy(e);if(e.equals(t)||(e.v=t,e.wv=uE()),!Bc)if(Wt!==null)Av()&&Wt.set(e,e.v);else{var i=(e.f&kn)===0?Ao:Fi;Di(e,i)}}let nw=new Set;const Ia=new Map;let Xx=!1;function Fr(e,t){var i={f:0,v:e,reactions:null,equals:Ox,rv:0,wv:0};return i}function Nr(e,t){const i=Fr(e);return dE(i),i}function re(e,t=!1,i=!0){var n;const s=Fr(e);return t||(s.equals=Hx),Yh&&i&&Ze!==null&&Ze.l!==null&&((n=Ze.l).s??(n.s=[])).push(s),s}function Ji(e,t){return G(e,ie(()=>R(e))),t}function G(e,t,i=!1){Xe!==null&&(!Co||(Xe.f&e0)!==0)&&Bf()&&(Xe.f&(Ui|Eo|Ry|e0))!==0&&!(Zi!=null&&Zi.includes(e))&&EM();let s=i?ud(t):t;return Ac(e,s)}function Ac(e,t){if(!e.equals(t)){var i=e.v;Bc?Ia.set(e,t):Ia.set(e,i),e.v=t;var s=mr.ensure();s.capture(e,i),(e.f&Ui)!==0&&((e.f&ms)!==0&&xy(e),Di(e,(e.f&kn)!==0?Fi:Ao)),e.wv=uE(),Qx(e,ms),Bf()&&Je!==null&&(Je.f&Fi)!==0&&(Je.f&(kr|Hc))===0&&(Ws===null?CI([e]):Ws.push(e)),!s.is_fork&&nw.size>0&&!Xx&&oI()}return t}function oI(){Xx=!1;const e=Array.from(nw);for(const t of e)(t.f&Fi)!==0&&Di(t,Ao),Zh(t)&&Nh(t);nw.clear()}function i0(e,t=1){var i=R(e),s=t===1?i++:i--;return G(e,i),s}function Ou(e){G(e,e.v+1)}function Qx(e,t){var i=e.reactions;if(i!==null)for(var s=Bf(),n=i.length,o=0;o<n;o++){var r=i[o],a=r.f;if(!(!s&&r===Je)){var l=(a&ms)===0;if(l&&Di(r,t),(a&Ui)!==0){var c=r;Wt==null||Wt.delete(c),(a&Ju)===0&&(a&kn&&(r.f|=Ju),Qx(c,Ao))}else l&&((a&Eo)!==0&&ln!==null&&ln.add(r),Ec(r))}}}function ud(e){if(typeof e!="object"||e===null||bo in e)return e;const t=Sy(e);if(t!==uM&&t!==gM)return e;var i=new Map,s=Hf(e),n=Nr(0),o=vc,r=a=>{if(vc===o)return a();var l=Xe,c=vc;us(null),l0(o);var d=a();return us(l),l0(c),d};return s&&i.set("length",Nr(e.length)),new Proxy(e,{defineProperty(a,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&RM();var d=i.get(l);return d===void 0?d=r(()=>{var h=Nr(c.value);return i.set(l,h),h}):G(d,c.value,!0),!0},deleteProperty(a,l){var c=i.get(l);if(c===void 0){if(l in a){const d=r(()=>Nr(Ei));i.set(l,d),Ou(n)}}else G(c,Ei),Ou(n);return!0},get(a,l,c){var f;if(l===bo)return e;var d=i.get(l),h=l in a;if(d===void 0&&(!h||(f=Cr(a,l))!=null&&f.writable)&&(d=r(()=>{var p=ud(h?a[l]:Ei),m=Nr(p);return m}),i.set(l,d)),d!==void 0){var u=R(d);return u===Ei?void 0:u}return Reflect.get(a,l,c)},getOwnPropertyDescriptor(a,l){var c=Reflect.getOwnPropertyDescriptor(a,l);if(c&&"value"in c){var d=i.get(l);d&&(c.value=R(d))}else if(c===void 0){var h=i.get(l),u=h==null?void 0:h.v;if(h!==void 0&&u!==Ei)return{enumerable:!0,configurable:!0,value:u,writable:!0}}return c},has(a,l){var u;if(l===bo)return!0;var c=i.get(l),d=c!==void 0&&c.v!==Ei||Reflect.has(a,l);if(c!==void 0||Je!==null&&(!d||(u=Cr(a,l))!=null&&u.writable)){c===void 0&&(c=r(()=>{var f=d?ud(a[l]):Ei,p=Nr(f);return p}),i.set(l,c));var h=R(c);if(h===Ei)return!1}return d},set(a,l,c,d){var S;var h=i.get(l),u=l in a;if(s&&l==="length")for(var f=c;f<h.v;f+=1){var p=i.get(f+"");p!==void 0?G(p,Ei):f in a&&(p=r(()=>Nr(Ei)),i.set(f+"",p))}if(h===void 0)(!u||(S=Cr(a,l))!=null&&S.writable)&&(h=r(()=>Nr(void 0)),G(h,ud(c)),i.set(l,h));else{u=h.v!==Ei;var m=r(()=>ud(c));G(h,m)}var v=Reflect.getOwnPropertyDescriptor(a,l);if(v!=null&&v.set&&v.set.call(d,c),!u){if(s&&typeof l=="string"){var C=i.get("length"),w=Number(l);Number.isInteger(w)&&w>=C.v&&G(C,w+1)}Ou(n)}return!0},ownKeys(a){R(n);var l=Reflect.ownKeys(a).filter(h=>{var u=i.get(h);return u===void 0||u.v!==Ei});for(var[c,d]of i)d.v!==Ei&&!(c in a)&&l.push(c);return l},setPrototypeOf(){xM()}})}function s0(e){try{if(e!==null&&typeof e=="object"&&bo in e)return e[bo]}catch{}return e}function rI(e,t){return Object.is(s0(e),s0(t))}var n0,Jx,Zx,eE;function aI(){if(n0===void 0){n0=window,Jx=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,i=Text.prototype;Zx=Cr(t,"firstChild").get,eE=Cr(t,"nextSibling").get,ZS(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),ZS(i)&&(i.__t=void 0)}}function Pr(e=""){return document.createTextNode(e)}function Oh(e){return Zx.call(e)}function zf(e){return eE.call(e)}function I(e,t){return Oh(e)}function ce(e,t=!1){{var i=Oh(e);return i instanceof Comment&&i.data===""?zf(i):i}}function L(e,t=1,i=!1){let s=e;for(;t--;)s=zf(s);return s}function lI(e){e.textContent=""}function tE(){return!1}function Ey(e,t){if(t){const i=document.body;e.autofocus=!0,Ua(()=>{document.activeElement===i&&e.focus()})}}let o0=!1;function cI(){o0||(o0=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const i of e.target.elements)(t=i.__on_r)==null||t.call(i)})},{capture:!0}))}function Xh(e){var t=Xe,i=Je;us(null),nn(null);try{return e()}finally{us(t),nn(i)}}function Ay(e,t,i,s=i){e.addEventListener(t,()=>Xh(i));const n=e.__on_r;n?e.__on_r=()=>{n(),s(!0)}:e.__on_r=()=>s(!0),cI()}function iE(e){Je===null&&(Xe===null&&wM(),CM()),Bc&&vM()}function dI(e,t){var i=t.last;i===null?t.last=t.first=e:(i.next=e,e.prev=i,t.last=e)}function Fo(e,t,i,s=!0){var n=Je;n!==null&&(n.f&Ls)!==0&&(e|=Ls);var o={ctx:Ze,deps:null,nodes_start:null,nodes_end:null,f:e|ms|kn,first:null,fn:t,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(i)try{Nh(o),o.f|=Sv}catch(l){throw mi(o),l}else t!==null&&Ec(o);if(s){var r=o;if(i&&r.deps===null&&r.teardown===null&&r.nodes_start===null&&r.first===r.last&&(r.f&qh)===0&&(r=r.first,(e&Eo)!==0&&(e&Ar)!==0&&r!==null&&(r.f|=Ar)),r!==null&&(r.parent=n,n!==null&&dI(r,n),Xe!==null&&(Xe.f&Ui)!==0&&(e&Hc)===0)){var a=Xe;(a.effects??(a.effects=[])).push(r)}}return o}function Av(){return Xe!==null&&!Co}function Qh(e){const t=Fo(bv,null,!1);return Di(t,Fi),t.teardown=e,t}function ow(e){iE();var t=Je.f,i=!Xe&&(t&kr)!==0&&(t&Sv)===0;if(i){var s=Ze;(s.e??(s.e=[])).push(e)}else return sE(e)}function sE(e){return Fo(wv|Ix,e,!1)}function hI(e){return iE(),Fo(bv|Ix,e,!0)}function uI(e){mr.ensure();const t=Fo(Hc|qh,e,!0);return(i={})=>new Promise(s=>{i.outro?vd(t,()=>{mi(t),s(void 0)}):(mi(t),s(void 0))})}function Wf(e){return Fo(wv,e,!1)}function Ti(e,t){var i=Ze,s={effect:null,ran:!1,deps:e};i.l.$.push(s),s.effect=Jh(()=>{e(),!s.ran&&(s.ran=!0,ie(t))})}function Po(){var e=Ze;Jh(()=>{for(var t of e.l.$){t.deps();var i=t.effect;(i.f&Fi)!==0&&Di(i,Ao),Zh(i)&&Nh(i),t.ran=!1}})}function gI(e){return Fo(Ry|qh,e,!0)}function Jh(e,t=0){return Fo(bv|t,e,!0)}function Me(e,t=[],i=[],s=[],n=!1){Kx(s,t,i,o=>{Fo(n?wv:bv,()=>e(...o.map(R)),!0)})}function Gc(e,t=0){var i=Fo(Eo|t,e,!0);return i}function Ms(e,t=!0){return Fo(kr|qh,e,!0,t)}function nE(e){var t=e.teardown;if(t!==null){const i=Bc,s=Xe;a0(!0),us(null);try{t.call(null)}finally{a0(i),us(s)}}}function oE(e,t=!1){var i=e.first;for(e.first=e.last=null;i!==null;){const n=i.ac;n!==null&&Xh(()=>{n.abort(hd)});var s=i.next;(i.f&Hc)!==0?i.parent=null:mi(i,t),i=s}}function fI(e){for(var t=e.first;t!==null;){var i=t.next;(t.f&kr)===0&&mi(t),t=i}}function mi(e,t=!0){var i=!1;(t||(e.f&Mx)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(pI(e.nodes_start,e.nodes_end),i=!0),oE(e,t&&!i),bm(e,0),Di(e,Da);var s=e.transitions;if(s!==null)for(const o of s)o.stop();nE(e);var n=e.parent;n!==null&&n.first!==null&&rE(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function pI(e,t){for(;e!==null;){var i=e===t?null:zf(e);e.remove(),e=i}}function rE(e){var t=e.parent,i=e.prev,s=e.next;i!==null&&(i.next=s),s!==null&&(s.prev=i),t!==null&&(t.first===e&&(t.first=s),t.last===e&&(t.last=i))}function vd(e,t,i=!0){var s=[];Fy(e,s,!0),aE(s,()=>{i&&mi(e),t&&t()})}function aE(e,t){var i=e.length;if(i>0){var s=()=>--i||t();for(var n of e)n.out(s)}else t()}function Fy(e,t,i){if((e.f&Ls)===0){if(e.f^=Ls,e.transitions!==null)for(const r of e.transitions)(r.is_global||i)&&t.push(r);for(var s=e.first;s!==null;){var n=s.next,o=(s.f&Ar)!==0||(s.f&kr)!==0&&(e.f&Eo)!==0;Fy(s,t,o?i:!1),s=n}}}function Py(e){lE(e,!0)}function lE(e,t){if((e.f&Ls)!==0){e.f^=Ls,(e.f&Fi)===0&&(Di(e,ms),Ec(e));for(var i=e.first;i!==null;){var s=i.next,n=(i.f&Ar)!==0||(i.f&kr)!==0;lE(i,n?t:!1),i=s}if(e.transitions!==null)for(const o of e.transitions)(o.is_global||t)&&o.in()}}function cE(e,t){for(var i=e.nodes_start,s=e.nodes_end;i!==null;){var n=i===s?null:zf(i);t.append(i),i=n}}let Kr=null;function mI(e){var t=Kr;try{if(Kr=new Set,ie(e),t!==null)for(var i of Kr)t.add(i);return Kr}finally{Kr=t}}function vI(e){for(var t of mI(e))Ac(t,t.v)}let mc=!1;function r0(e){mc=e}let Bc=!1;function a0(e){Bc=e}let Xe=null,Co=!1;function us(e){Xe=e}let Je=null;function nn(e){Je=e}let Zi=null;function dE(e){Xe!==null&&(Zi===null?Zi=[e]:Zi.push(e))}let Xi=null,bs=0,Ws=null;function CI(e){Ws=e}let hE=1,Zu=0,vc=Zu;function l0(e){vc=e}function uE(){return++hE}function Zh(e){var t=e.f;if((t&ms)!==0)return!0;if(t&Ui&&(e.f&=~Ju),(t&Ao)!==0){var i=e.deps;if(i!==null)for(var s=i.length,n=0;n<s;n++){var o=i[n];if(Zh(o)&&Yx(o),o.wv>e.wv)return!0}(t&kn)!==0&&Wt===null&&Di(e,Fi)}return!1}function gE(e,t,i=!0){var s=e.reactions;if(s!==null&&!(Zi!=null&&Zi.includes(e)))for(var n=0;n<s.length;n++){var o=s[n];(o.f&Ui)!==0?gE(o,t,!1):t===o&&(i?Di(o,ms):(o.f&Fi)!==0&&Di(o,Ao),Ec(o))}}function fE(e){var p;var t=Xi,i=bs,s=Ws,n=Xe,o=Zi,r=Ze,a=Co,l=vc,c=e.f;Xi=null,bs=0,Ws=null,Xe=(c&(kr|Hc))===0?e:null,Zi=null,_h(e.ctx),Co=!1,vc=++Zu,e.ac!==null&&(Xh(()=>{e.ac.abort(hd)}),e.ac=null);try{e.f|=ZC;var d=e.fn,h=d(),u=e.deps;if(Xi!==null){var f;if(bm(e,bs),u!==null&&bs>0)for(u.length=bs+Xi.length,f=0;f<Xi.length;f++)u[bs+f]=Xi[f];else e.deps=u=Xi;if(mc&&Av()&&(e.f&kn)!==0)for(f=bs;f<u.length;f++)((p=u[f]).reactions??(p.reactions=[])).push(e)}else u!==null&&bs<u.length&&(bm(e,bs),u.length=bs);if(Bf()&&Ws!==null&&!Co&&u!==null&&(e.f&(Ui|Ao|ms))===0)for(f=0;f<Ws.length;f++)gE(Ws[f],e);return n!==null&&n!==e&&(Zu++,Ws!==null&&(s===null?s=Ws:s.push(...Ws))),(e.f&Ma)!==0&&(e.f^=Ma),h}catch(m){return Vx(m)}finally{e.f^=ZC,Xi=t,bs=i,Ws=s,Xe=n,Zi=o,_h(r),Co=a,vc=l}}function wI(e,t){let i=t.reactions;if(i!==null){var s=hM.call(i,e);if(s!==-1){var n=i.length-1;n===0?i=t.reactions=null:(i[s]=i[n],i.pop())}}i===null&&(t.f&Ui)!==0&&(Xi===null||!Xi.includes(t))&&(Di(t,Ao),(t.f&kn)!==0&&(t.f^=kn,t.f&=~Ju),qx(t),bm(t,0))}function bm(e,t){var i=e.deps;if(i!==null)for(var s=t;s<i.length;s++)wI(e,i[s])}function Nh(e){var t=e.f;if((t&Da)===0){Di(e,Fi);var i=Je,s=mc;Je=e,mc=!0;try{(t&Eo)!==0?fI(e):oE(e),nE(e);var n=fE(e);e.teardown=typeof n=="function"?n:null,e.wv=hE;var o;Ax&&zM&&(e.f&ms)!==0&&e.deps}finally{mc=s,Je=i}}}async function Fc(){await Promise.resolve(),qM()}function R(e){var t=e.f,i=(t&Ui)!==0;if(Kr==null||Kr.add(e),Xe!==null&&!Co){var s=Je!==null&&(Je.f&Da)!==0;if(!s&&!(Zi!=null&&Zi.includes(e))){var n=Xe.deps;if((Xe.f&ZC)!==0)e.rv<Zu&&(e.rv=Zu,Xi===null&&n!==null&&n[bs]===e?bs++:Xi===null?Xi=[e]:Xi.includes(e)||Xi.push(e));else{(Xe.deps??(Xe.deps=[])).push(e);var o=e.reactions;o===null?e.reactions=[Xe]:o.includes(Xe)||o.push(Xe)}}}if(Bc){if(Ia.has(e))return Ia.get(e);if(i){var r=e,a=r.v;return((r.f&Fi)===0&&r.reactions!==null||mE(r))&&(a=xy(r)),Ia.set(r,a),a}}else if(i){if(r=e,Wt!=null&&Wt.has(r))return Wt.get(r);Zh(r)&&Yx(r),mc&&Av()&&(r.f&kn)===0&&pE(r)}else if(Wt!=null&&Wt.has(e))return Wt.get(e);if((e.f&Ma)!==0)throw e.v;return e.v}function pE(e){if(e.deps!==null){e.f^=kn;for(const t of e.deps)(t.reactions??(t.reactions=[])).push(e),(t.f&Ui)!==0&&(t.f&kn)===0&&pE(t)}}function mE(e){if(e.v===Ei)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(Ia.has(t)||(t.f&Ui)!==0&&mE(t))return!0;return!1}function ie(e){var t=Co;try{return Co=!0,e()}finally{Co=t}}const bI=-7169;function Di(e,t){e.f=e.f&bI|t}function Re(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(bo in e)rw(e);else if(!Array.isArray(e))for(let t in e){const i=e[t];typeof i=="object"&&i&&bo in i&&rw(i)}}}function rw(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let s in e)try{rw(e[s],t)}catch{}const i=Sy(e);if(i!==Object.prototype&&i!==Array.prototype&&i!==Map.prototype&&i!==Set.prototype&&i!==Date.prototype){const s=Px(i);for(let n in s){const o=s[n].get;if(o)try{o.call(e)}catch{}}}}}function yI(e){return e.endsWith("capture")&&e!=="gotpointercapture"&&e!=="lostpointercapture"}const SI=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function RI(e){return SI.includes(e)}const xI={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function EI(e){return e=e.toLowerCase(),xI[e]??e}const AI=["touchstart","touchmove"];function FI(e){return AI.includes(e)}const vE=new Set,aw=new Set;function CE(e,t,i,s={}){function n(o){if(s.capture||pu.call(t,o),!o.cancelBubble)return Xh(()=>i==null?void 0:i.call(this,o))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Ua(()=>{t.addEventListener(e,n,s)}):t.addEventListener(e,n,s),n}function Y(e,t,i,s,n){var o={capture:s,passive:n},r=CE(e,t,i,o);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Qh(()=>{t.removeEventListener(e,r,o)})}function Fv(e){for(var t=0;t<e.length;t++)vE.add(e[t]);for(var i of aw)i(e)}let c0=null;function pu(e){var v;var t=this,i=t.ownerDocument,s=e.type,n=((v=e.composedPath)==null?void 0:v.call(e))||[],o=n[0]||e.target;c0=e;var r=0,a=c0===e&&e.__root;if(a){var l=n.indexOf(a);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var c=n.indexOf(t);if(c===-1)return;l<=c&&(r=l)}if(o=n[r]||e.target,o!==t){Fx(e,"currentTarget",{configurable:!0,get(){return o||i}});var d=Xe,h=Je;us(null),nn(null);try{for(var u,f=[];o!==null;){var p=o.assignedSlot||o.parentNode||o.host||null;try{var m=o["__"+s];m!=null&&(!o.disabled||e.target===o)&&m.call(o,e)}catch(C){u?f.push(C):u=C}if(e.cancelBubble||p===t||p===null)break;o=p}if(u){for(let C of f)queueMicrotask(()=>{throw C});throw u}}finally{e.__root=t,delete e.currentTarget,us(d),nn(h)}}}function wE(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Hh(e,t){var i=Je;i.nodes_start===null&&(i.nodes_start=e,i.nodes_end=t)}function J(e,t){var i=(t&_M)!==0,s=(t&LM)!==0,n,o=!e.startsWith("<!>");return()=>{n===void 0&&(n=wE(o?e:"<!>"+e),i||(n=Oh(n)));var r=s||Jx?document.importNode(n,!0):n.cloneNode(!0);if(i){var a=Oh(r),l=r.lastChild;Hh(a,l)}else Hh(r,r);return r}}function PI(e,t,i="svg"){var s=!e.startsWith("<!>"),n=`<${i}>${s?e:"<!>"+e}</${i}>`,o;return()=>{if(!o){var r=wE(n),a=Oh(r);o=Oh(a)}var l=o.cloneNode(!0);return Hh(l,l),l}}function bE(e,t){return PI(e,t,"svg")}function yE(e=""){{var t=Pr(e+"");return Hh(t,t),t}}function xe(){var e=document.createDocumentFragment(),t=document.createComment(""),i=Pr();return e.append(t,i),Hh(t,i),e}function O(e,t){e!==null&&e.before(t)}let ym=!0;function sp(e){ym=e}function Be(e,t){var i=t==null?"":typeof t=="object"?t+"":t;i!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=i,e.nodeValue=i+"")}function TI(e,t){return DI(e,t)}const Xc=new Map;function DI(e,{target:t,anchor:i,props:s={},events:n,context:o,intro:r=!0}){aI();var a=new Set,l=h=>{for(var u=0;u<h.length;u++){var f=h[u];if(!a.has(f)){a.add(f);var p=FI(f);t.addEventListener(f,pu,{passive:p});var m=Xc.get(f);m===void 0?(document.addEventListener(f,pu,{passive:p}),Xc.set(f,1)):Xc.set(f,m+1)}}};l(yy(vE)),aw.add(l);var c=void 0,d=uI(()=>{var h=i??t.appendChild(Pr());return JM(h,{pending:()=>{}},u=>{if(o){ot({});var f=Ze;f.c=o}n&&(s.$$events=n),ym=r,c=e(u,s)||{},ym=!0,o&&rt()}),()=>{var p;for(var u of a){t.removeEventListener(u,pu);var f=Xc.get(u);--f===0?(document.removeEventListener(u,pu),Xc.delete(u)):Xc.set(u,f)}aw.delete(l),h!==i&&((p=h.parentNode)==null||p.removeChild(h))}});return MI.set(c,d),c}let MI=new WeakMap;var un,qn,ys,bg,yg,tv;class Ty{constructor(t,i=!0){Pe(this,"anchor");F(this,un,new Map);F(this,qn,new Map);F(this,ys,new Map);F(this,bg,!0);F(this,yg,()=>{var t=ht;if(g(this,un).has(t)){var i=g(this,un).get(t),s=g(this,qn).get(i);if(s)Py(s);else{var n=g(this,ys).get(i);n&&(g(this,qn).set(i,n.effect),g(this,ys).delete(i),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),s=n.effect)}for(const[o,r]of g(this,un)){if(g(this,un).delete(o),o===t)break;const a=g(this,ys).get(r);a&&(mi(a.effect),g(this,ys).delete(r))}for(const[o,r]of g(this,qn)){if(o===i)continue;const a=()=>{if(Array.from(g(this,un).values()).includes(o)){var c=document.createDocumentFragment();cE(r,c),c.append(Pr()),g(this,ys).set(o,{effect:r,fragment:c})}else mi(r);g(this,qn).delete(o)};g(this,bg)||!s?vd(r,a,!1):a()}}});F(this,tv,t=>{g(this,un).delete(t);const i=Array.from(g(this,un).values());for(const[s,n]of g(this,ys))i.includes(s)||(mi(n.effect),g(this,ys).delete(s))});this.anchor=t,y(this,bg,i)}ensure(t,i){var s=ht,n=tE();if(i&&!g(this,qn).has(t)&&!g(this,ys).has(t))if(n){var o=document.createDocumentFragment(),r=Pr();o.append(r),g(this,ys).set(t,{effect:Ms(()=>i(r)),fragment:o})}else g(this,qn).set(t,Ms(()=>i(this.anchor)));if(g(this,un).set(s,t),n){for(const[a,l]of g(this,qn))a===t?s.skipped_effects.delete(l):s.skipped_effects.add(l);for(const[a,l]of g(this,ys))a===t?s.skipped_effects.delete(l.effect):s.skipped_effects.add(l.effect);s.oncommit(g(this,yg)),s.ondiscard(g(this,tv))}else g(this,yg).call(this)}}un=new WeakMap,qn=new WeakMap,ys=new WeakMap,bg=new WeakMap,yg=new WeakMap,tv=new WeakMap;function ye(e,t,i=!1){var s=new Ty(e),n=i?Ar:0;function o(r,a){s.ensure(r,a)}Gc(()=>{var r=!1;t((a,l=!0)=>{r=!0,o(l,a)}),r||o(!1,null)},n)}function gs(e,t){return t}function II(e,t,i){for(var s=e.items,n=[],o=t.length,r=0;r<o;r++)Fy(t[r].e,n,!0);var a=o>0&&n.length===0&&i!==null;if(a){var l=i.parentNode;lI(l),l.append(i),s.clear(),zn(e,t[0].prev,t[o-1].next)}aE(n,()=>{for(var c=0;c<o;c++){var d=t[c];a||(s.delete(d.k),zn(e,d.prev,d.next)),mi(d.e,!a)}})}function Ai(e,t,i,s,n,o=null){var r=e,a={flags:t,items:new Map,first:null},l=(t&_x)!==0;if(l){var c=e;r=c.appendChild(Pr())}var d=null,h=!1,u=new Map,f=Aa(()=>{var C=i();return Hf(C)?C:C==null?[]:yy(C)}),p,m;function v(){kI(m,p,a,u,r,n,t,s,i),o!==null&&(p.length===0?d?Py(d):d=Ms(()=>o(r)):d!==null&&vd(d,()=>{d=null}))}Gc(()=>{m??(m=Je),p=R(f);var C=p.length;if(!(h&&C===0)){h=C===0;var w,S,b,E;if(tE()){var A=new Set,P=ht;for(S=0;S<C;S+=1){b=p[S],E=s(b,S);var T=a.items.get(E)??u.get(E);T?(t&(Rv|xv))!==0&&SE(T,b,S,t):(w=RE(null,a,null,null,b,E,S,n,t,i,!0),u.set(E,w)),A.add(E)}for(const[D,N]of a.items)A.has(D)||P.skipped_effects.add(N.e);P.oncommit(v)}else v();R(f)}})}function kI(e,t,i,s,n,o,r,a,l){var pe,Ee,Ce,le;var c=(r&FM)!==0,d=(r&(Rv|xv))!==0,h=t.length,u=i.items,f=i.first,p=f,m,v=null,C,w=[],S=[],b,E,A,P;if(c)for(P=0;P<h;P+=1)b=t[P],E=a(b,P),A=u.get(E),A!==void 0&&((pe=A.a)==null||pe.measure(),(C??(C=new Set)).add(A));for(P=0;P<h;P+=1){if(b=t[P],E=a(b,P),A=u.get(E),A===void 0){var T=s.get(E);if(T!==void 0){s.delete(E),u.set(E,T);var D=v?v.next:p;zn(i,v,T),zn(i,T,D),Zv(T,D,n),v=T}else{var N=p?p.e.nodes_start:n;v=RE(N,i,v,v===null?i.first:v.next,b,E,P,o,r,l)}u.set(E,v),w=[],S=[],p=v.next;continue}if(d&&SE(A,b,P,r),(A.e.f&Ls)!==0&&(Py(A.e),c&&((Ee=A.a)==null||Ee.unfix(),(C??(C=new Set)).delete(A))),A!==p){if(m!==void 0&&m.has(A)){if(w.length<S.length){var M=S[0],_;v=M.prev;var W=w[0],$=w[w.length-1];for(_=0;_<w.length;_+=1)Zv(w[_],M,n);for(_=0;_<S.length;_+=1)m.delete(S[_]);zn(i,W.prev,$.next),zn(i,v,W),zn(i,$,M),p=M,v=$,P-=1,w=[],S=[]}else m.delete(A),Zv(A,p,n),zn(i,A.prev,A.next),zn(i,A,v===null?i.first:v.next),zn(i,v,A),v=A;continue}for(w=[],S=[];p!==null&&p.k!==E;)(p.e.f&Ls)===0&&(m??(m=new Set)).add(p),S.push(p),p=p.next;if(p===null)continue;A=p}w.push(A),v=A,p=A.next}if(p!==null||m!==void 0){for(var B=m===void 0?[]:yy(m);p!==null;)(p.e.f&Ls)===0&&B.push(p),p=p.next;var q=B.length;if(q>0){var X=(r&_x)!==0&&h===0?n:null;if(c){for(P=0;P<q;P+=1)(Ce=B[P].a)==null||Ce.measure();for(P=0;P<q;P+=1)(le=B[P].a)==null||le.fix()}II(i,B,X)}}c&&Ua(()=>{var ee;if(C!==void 0)for(A of C)(ee=A.a)==null||ee.apply()}),e.first=i.first&&i.first.e,e.last=v&&v.e;for(var U of s.values())mi(U.e);s.clear()}function SE(e,t,i,s){(s&Rv)!==0&&Ac(e.v,t),(s&xv)!==0?Ac(e.i,i):e.i=i}function RE(e,t,i,s,n,o,r,a,l,c,d){var h=(l&Rv)!==0,u=(l&PM)===0,f=h?u?re(n,!1,!1):Fr(n):n,p=(l&xv)===0?r:Fr(r),m={i:p,v:f,k:o,a:null,e:null,prev:i,next:s};try{if(e===null){var v=document.createDocumentFragment();v.append(e=Pr())}return m.e=Ms(()=>a(e,f,p,c),VM),m.e.prev=i&&i.e,m.e.next=s&&s.e,i===null?d||(t.first=m):(i.next=m,i.e.next=m.e),s!==null&&(s.prev=m,s.e.prev=m.e),m}finally{}}function Zv(e,t,i){for(var s=e.next?e.next.e.nodes_start:i,n=t?t.e.nodes_start:i,o=e.e.nodes_start;o!==null&&o!==s;){var r=zf(o);n.before(o),o=r}}function zn(e,t,i){t===null?e.first=i:(t.next=i,t.e.next=i&&i.e),i!==null&&(i.prev=t,i.e.prev=t&&t.e)}function We(e,t,i,s,n){var a;var o=(a=t.$$slots)==null?void 0:a[i],r=!1;o===!0&&(o=t[i==="default"?"children":i],r=!0),o===void 0||o(e,r?()=>s:s)}function _I(e,t,i){var s=new Ty(e);Gc(()=>{var n=t()??null;s.ensure(n,n&&(o=>i(o,n)))},Ar)}function LI(e,t,i,s,n,o){var r=null,a=e,l=new Ty(a,!1);Gc(()=>{const c=t()||null;var d=NM;if(c===null){l.ensure(null,null),sp(!0);return}return l.ensure(c,h=>{if(c){if(r=document.createElementNS(d,c),Hh(r,r),s){var u=r.appendChild(Pr());s(r,u)}Je.nodes_end=r,h.before(r)}}),sp(!0),()=>{c&&sp(!1)}},Ar),Qh(()=>{sp(!0)})}function OI(e,t){var i=void 0,s;Gc(()=>{i!==(i=t())&&(s&&(mi(s),s=null),i&&(s=Ms(()=>{Wf(()=>i(e))})))})}function xE(e){var t,i,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(i=xE(e[t]))&&(s&&(s+=" "),s+=i)}else for(i in e)e[i]&&(s&&(s+=" "),s+=i);return s}function NI(){for(var e,t,i=0,s="",n=arguments.length;i<n;i++)(e=arguments[i])&&(t=xE(e))&&(s&&(s+=" "),s+=t);return s}function HI(e){return typeof e=="object"?NI(e):e??""}const d0=[...` 	
\r\fÂ \v\uFEFF`];function GI(e,t,i){var s=e==null?"":""+e;if(t&&(s=s?s+" "+t:t),i){for(var n in i)if(i[n])s=s?s+" "+n:n;else if(s.length)for(var o=n.length,r=0;(r=s.indexOf(n,r))>=0;){var a=r+o;(r===0||d0.includes(s[r-1]))&&(a===s.length||d0.includes(s[a]))?s=(r===0?"":s.substring(0,r))+s.substring(a+1):r=a}}return s===""?null:s}function h0(e,t=!1){var i=t?" !important;":";",s="";for(var n in e){var o=e[n];o!=null&&o!==""&&(s+=" "+n+": "+o+i)}return s}function eC(e){return e[0]!=="-"||e[1]!=="-"?e.toLowerCase():e}function BI(e,t){if(t){var i="",s,n;if(Array.isArray(t)?(s=t[0],n=t[1]):s=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,r=0,a=!1,l=[];s&&l.push(...Object.keys(s).map(eC)),n&&l.push(...Object.keys(n).map(eC));var c=0,d=-1;const m=e.length;for(var h=0;h<m;h++){var u=e[h];if(a?u==="/"&&e[h-1]==="*"&&(a=!1):o?o===u&&(o=!1):u==="/"&&e[h+1]==="*"?a=!0:u==='"'||u==="'"?o=u:u==="("?r++:u===")"&&r--,!a&&o===!1&&r===0){if(u===":"&&d===-1)d=h;else if(u===";"||h===m-1){if(d!==-1){var f=eC(e.substring(c,d).trim());if(!l.includes(f)){u!==";"&&h++;var p=e.substring(c,h).trim();i+=" "+p+";"}}c=h+1,d=-1}}}}return s&&(i+=h0(s)),n&&(i+=h0(n,!0)),i=i.trim(),i===""?null:i}return e==null?null:String(e)}function $i(e,t,i,s,n,o){var r=e.__className;if(r!==i||r===void 0){var a=GI(i,s,o);a==null?e.removeAttribute("class"):t?e.className=a:e.setAttribute("class",a),e.__className=i}else if(o&&n!==o)for(var l in o){var c=!!o[l];(n==null||c!==!!n[l])&&e.classList.toggle(l,c)}return o}function tC(e,t={},i,s){for(var n in i){var o=i[n];t[n]!==o&&(i[n]==null?e.style.removeProperty(n):e.style.setProperty(n,o,s))}}function ja(e,t,i,s){var n=e.__style;if(n!==t){var o=BI(t,s);o==null?e.removeAttribute("style"):e.style.cssText=o,e.__style=t}else s&&(Array.isArray(s)?(tC(e,i==null?void 0:i[0],s[0]),tC(e,i==null?void 0:i[1],s[1],"important")):tC(e,i,s));return s}function Sm(e,t,i=!1){if(e.multiple){if(t==null)return;if(!Hf(t))return GM();for(var s of e.options)s.selected=t.includes(Nu(s));return}for(s of e.options){var n=Nu(s);if(rI(n,t)){s.selected=!0;return}}(!i||t!==void 0)&&(e.selectedIndex=-1)}function EE(e){var t=new MutationObserver(()=>{Sm(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Qh(()=>{t.disconnect()})}function VI(e,t,i=t){var s=new WeakSet,n=!0;Ay(e,"change",o=>{var r=o?"[selected]":":checked",a;if(e.multiple)a=[].map.call(e.querySelectorAll(r),Nu);else{var l=e.querySelector(r)??e.querySelector("option:not([disabled])");a=l&&Nu(l)}i(a),ht!==null&&s.add(ht)}),Wf(()=>{var o=t();if(e===document.activeElement){var r=_u??ht;if(s.has(r))return}if(Sm(e,o,n),n&&o===void 0){var a=e.querySelector(":checked");a!==null&&(o=Nu(a),i(o))}e.__value=o,n=!1}),EE(e)}function Nu(e){return"__value"in e?e.__value:e.value}const nu=Symbol("class"),ou=Symbol("style"),AE=Symbol("is custom element"),FE=Symbol("is html");function f9(e,t){var i=Dy(e);i.value===(i.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function zI(e,t){t?e.hasAttribute("selected")||e.setAttribute("selected",""):e.removeAttribute("selected")}function fi(e,t,i,s){var n=Dy(e);n[t]!==(n[t]=i)&&(t==="loading"&&(e[pM]=i),i==null?e.removeAttribute(t):typeof i!="string"&&PE(e).includes(t)?e[t]=i:e.setAttribute(t,i))}function WI(e,t,i,s,n=!1,o=!1){var r=Dy(e),a=r[AE],l=!r[FE],c=t||{},d=e.tagName==="OPTION";for(var h in t)h in i||(i[h]=null);i.class?i.class=HI(i.class):i[nu]&&(i.class=null),i[ou]&&(i.style??(i.style=null));var u=PE(e);for(const S in i){let b=i[S];if(d&&S==="value"&&b==null){e.value=e.__value="",c[S]=b;continue}if(S==="class"){var f=e.namespaceURI==="http://www.w3.org/1999/xhtml";$i(e,f,b,s,t==null?void 0:t[nu],i[nu]),c[S]=b,c[nu]=i[nu];continue}if(S==="style"){ja(e,b,t==null?void 0:t[ou],i[ou]),c[S]=b,c[ou]=i[ou];continue}var p=c[S];if(!(b===p&&!(b===void 0&&e.hasAttribute(S)))){c[S]=b;var m=S[0]+S[1];if(m!=="$$")if(m==="on"){const E={},A="$$"+S;let P=S.slice(2);var v=RI(P);if(yI(P)&&(P=P.slice(0,-7),E.capture=!0),!v&&p){if(b!=null)continue;e.removeEventListener(P,c[A],E),c[A]=null}if(b!=null)if(v)e[`__${P}`]=b,Fv([P]);else{let T=function(D){c[S].call(this,D)};c[A]=CE(P,e,T,E)}else v&&(e[`__${P}`]=void 0)}else if(S==="style")fi(e,S,b);else if(S==="autofocus")Ey(e,!!b);else if(!a&&(S==="__value"||S==="value"&&b!=null))e.value=e.__value=b;else if(S==="selected"&&d)zI(e,b);else{var C=S;l||(C=EI(C));var w=C==="defaultValue"||C==="defaultChecked";if(b==null&&!a&&!w)if(r[S]=null,C==="value"||C==="checked"){let E=e;const A=t===void 0;if(C==="value"){let P=E.defaultValue;E.removeAttribute(C),E.defaultValue=P,E.value=E.__value=A?P:null}else{let P=E.defaultChecked;E.removeAttribute(C),E.defaultChecked=P,E.checked=A?P:!1}}else e.removeAttribute(S);else w||u.includes(C)&&(a||typeof b!="string")?(e[C]=b,C in r&&(r[C]=Ei)):typeof b!="function"&&fi(e,C,b)}}}return c}function lw(e,t,i=[],s=[],n=[],o,r=!1,a=!1){Kx(n,i,s,l=>{var c=void 0,d={},h=e.nodeName==="SELECT",u=!1;if(Gc(()=>{var p=t(...l.map(R)),m=WI(e,c,p,o,r,a);u&&h&&"value"in p&&Sm(e,p.value);for(let C of Object.getOwnPropertySymbols(d))p[C]||mi(d[C]);for(let C of Object.getOwnPropertySymbols(p)){var v=p[C];C.description===HM&&(!c||v!==c[C])&&(d[C]&&mi(d[C]),d[C]=Ms(()=>OI(e,()=>v))),m[C]=v}c=m}),h){var f=e;Wf(()=>{Sm(f,c.value,!0),EE(f)})}u=!0})}function Dy(e){return e.__attributes??(e.__attributes={[AE]:e.nodeName.includes("-"),[FE]:e.namespaceURI===OM})}var u0=new Map;function PE(e){var t=e.getAttribute("is")||e.nodeName,i=u0.get(t);if(i)return i;u0.set(t,i=[]);for(var s,n=e,o=Element.prototype;o!==n;){s=Px(n);for(var r in s)s[r].set&&i.push(r);n=Sy(n)}return i}const $I=()=>performance.now(),ur={tick:e=>requestAnimationFrame(e),now:()=>$I(),tasks:new Set};function TE(){const e=ur.now();ur.tasks.forEach(t=>{t.c(e)||(ur.tasks.delete(t),t.f())}),ur.tasks.size!==0&&ur.tick(TE)}function UI(e){let t;return ur.tasks.size===0&&ur.tick(TE),{promise:new Promise(i=>{ur.tasks.add(t={c:e,f:i})}),abort(){ur.tasks.delete(t)}}}function np(e,t){Xh(()=>{e.dispatchEvent(new CustomEvent(t))})}function jI(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const t=e.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(i=>i[0].toUpperCase()+i.slice(1)).join("")}function g0(e){const t={},i=e.split(";");for(const s of i){const[n,o]=s.split(":");if(!n||o===void 0)break;const r=jI(n.trim());t[r]=o.trim()}return t}const KI=e=>e;function DE(e,t,i,s){var n=(e&kM)!==0,o="both",r,a=t.inert,l=t.style.overflow,c,d;function h(){return Xh(()=>r??(r=i()(t,(s==null?void 0:s())??{},{direction:o})))}var u={is_global:n,in(){t.inert=a,np(t,"introstart"),c=cw(t,h(),d,1,()=>{np(t,"introend"),c==null||c.abort(),c=r=void 0,t.style.overflow=l})},out(v){t.inert=!0,np(t,"outrostart"),d=cw(t,h(),c,0,()=>{np(t,"outroend"),v==null||v()})},stop:()=>{c==null||c.abort(),d==null||d.abort()}},f=Je;if((f.transitions??(f.transitions=[])).push(u),ym){var p=n;if(!p){for(var m=f.parent;m&&(m.f&Ar)!==0;)for(;(m=m.parent)&&(m.f&Eo)===0;);p=!m||(m.f&Sv)!==0}p&&Wf(()=>{ie(()=>u.in())})}}function cw(e,t,i,s,n){var o=s===1;if(td(t)){var r,a=!1;return Ua(()=>{if(!a){var v=t({direction:o?"in":"out"});r=cw(e,v,i,s,n)}}),{abort:()=>{a=!0,r==null||r.abort()},deactivate:()=>r.deactivate(),reset:()=>r.reset(),t:()=>r.t()}}if(i==null||i.deactivate(),!(t!=null&&t.duration))return n(),{abort:Fn,deactivate:Fn,reset:Fn,t:()=>s};const{delay:l=0,css:c,tick:d,easing:h=KI}=t;var u=[];if(o&&i===void 0&&(d&&d(0,1),c)){var f=g0(c(0,1));u.push(f,f)}var p=()=>1-s,m=e.animate(u,{duration:l,fill:"forwards"});return m.onfinish=()=>{m.cancel();var v=(i==null?void 0:i.t())??1-s;i==null||i.abort();var C=s-v,w=t.duration*Math.abs(C),S=[];if(w>0){var b=!1;if(c)for(var E=Math.ceil(w/16.666666666666668),A=0;A<=E;A+=1){var P=v+C*h(A/E),T=g0(c(P,1-P));S.push(T),b||(b=T.overflow==="hidden")}b&&(e.style.overflow="hidden"),p=()=>{var D=m.currentTime;return v+C*h(D/w)},d&&UI(()=>{if(m.playState!=="running")return!1;var D=p();return d(D,1-D),!0})}m=e.animate(S,{duration:w,fill:"forwards"}),m.onfinish=()=>{p=()=>s,d==null||d(s,1-s),n()}},{abort:()=>{m&&(m.cancel(),m.effect=null,m.onfinish=Fn)},deactivate:()=>{n=Fn},reset:()=>{s===0&&(d==null||d(1,0))},t:()=>p()}}function eg(e,t,i=t){var s=new WeakSet;Ay(e,"input",async n=>{var o=n?e.defaultValue:e.value;if(o=iC(e)?sC(o):o,i(o),ht!==null&&s.add(ht),await Fc(),o!==(o=t())){var r=e.selectionStart,a=e.selectionEnd,l=e.value.length;if(e.value=o??"",a!==null){var c=e.value.length;r===a&&a===l&&c>l?(e.selectionStart=c,e.selectionEnd=c):(e.selectionStart=r,e.selectionEnd=Math.min(a,c))}}}),ie(t)==null&&e.value&&(i(iC(e)?sC(e.value):e.value),ht!==null&&s.add(ht)),Jh(()=>{var n=t();if(e===document.activeElement){var o=_u??ht;if(s.has(o))return}iC(e)&&n===sC(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function op(e,t,i=t){Ay(e,"change",s=>{var n=s?e.defaultChecked:e.checked;i(n)}),ie(t)==null&&i(e.checked),Jh(()=>{var s=t();e.checked=!!s})}function iC(e){var t=e.type;return t==="number"||t==="range"}function sC(e){return e===""?null:+e}function Vr(e,t,i){var s=Cr(e,t);s&&s.set&&(e[t]=i,Qh(()=>{e[t]=null}))}function f0(e,t){return e===t||(e==null?void 0:e[bo])===t}function ji(e={},t,i,s){return Wf(()=>{var n,o;return Jh(()=>{n=o,o=[],ie(()=>{e!==i(...o)&&(t(e,...o),n&&f0(i(...n),e)&&t(null,...n))})}),()=>{Ua(()=>{o&&f0(i(...o),e)&&t(null,...o)})}}),e}function qI(e){return function(...t){var i=t[0];i.target===this&&(e==null||e.apply(this,t))}}function Gh(e){return function(...t){var i=t[0];return i.stopPropagation(),e==null?void 0:e.apply(this,t)}}function YI(e){return function(...t){var i=t[0];return i.preventDefault(),e==null?void 0:e.apply(this,t)}}function lt(e=!1){const t=Ze,i=t.l.u;if(!i)return;let s=()=>Re(t.s);if(e){let n=0,o={};const r=Vf(()=>{let a=!1;const l=t.s;for(const c in l)l[c]!==o[c]&&(o[c]=l[c],a=!0);return a&&n++,n});s=()=>R(r)}i.b.length&&hI(()=>{p0(t,s),JC(i.b)}),ow(()=>{const n=ie(()=>i.m.map(fM));return()=>{for(const o of n)typeof o=="function"&&o()}}),i.a.length&&ow(()=>{p0(t,s),JC(i.a)})}function p0(e,t){if(e.l.s)for(const i of e.l.s)R(i);t()}function ME(e){var t=Fr(0);return function(){return arguments.length===1?(G(t,R(t)+1),arguments[0]):(R(t),e())}}function Pv(e,t){var o;var i=(o=e.$$events)==null?void 0:o[t.type],s=Hf(i)?i.slice():i==null?[]:[i];for(var n of s)n.call(this,t)}function IE(e,t,i){if(e==null)return t(void 0),Fn;const s=ie(()=>e.subscribe(t,i));return s.unsubscribe?()=>s.unsubscribe():s}const Qc=[];function ri(e,t=Fn){let i=null;const s=new Set;function n(a){if(Nx(e,a)&&(e=a,i)){const l=!Qc.length;for(const c of s)c[1](),Qc.push(c,e);if(l){for(let c=0;c<Qc.length;c+=2)Qc[c][0](Qc[c+1]);Qc.length=0}}}function o(a){n(a(e))}function r(a,l=Fn){const c=[a,l];return s.add(c),s.size===1&&(i=t(n,o)||Fn),a(e),()=>{s.delete(c),s.size===0&&i&&(i(),i=null)}}return{set:n,update:o,subscribe:r}}function si(e){let t;return IE(e,i=>t=i)(),t}let rp=!1,dw=Symbol();function mt(e,t,i){const s=i[t]??(i[t]={store:null,source:re(void 0),unsubscribe:Fn});if(s.store!==e&&!(dw in i))if(s.unsubscribe(),s.store=e??null,e==null)s.source.v=void 0,s.unsubscribe=Fn;else{var n=!0;s.unsubscribe=IE(e,o=>{n?s.source.v=o:G(s.source,o)}),n=!1}return e&&dw in i?si(e):R(s.source)}function $r(e,t){return e.set(t),t}function Ln(){const e={};function t(){Qh(()=>{for(var i in e)e[i].unsubscribe();Fx(e,dw,{enumerable:!1,value:!0})})}return[e,t]}function XI(e){var t=rp;try{return rp=!1,[e(),rp]}finally{rp=t}}function m0(e,t=1){const i=e();return e(i+t),i}const QI={get(e,t){if(!e.exclude.includes(t))return R(e.version),t in e.special?e.special[t]():e.props[t]},set(e,t,i){if(!(t in e.special)){var s=Je;try{nn(e.parent_effect),e.special[t]=ge({get[t](){return e.props[t]}},t,Lx)}finally{nn(s)}}return e.special[t](i),i0(e.version),!0},getOwnPropertyDescriptor(e,t){if(!e.exclude.includes(t)&&t in e.props)return{enumerable:!0,configurable:!0,value:e.props[t]}},deleteProperty(e,t){return e.exclude.includes(t)||(e.exclude.push(t),i0(e.version)),!0},has(e,t){return e.exclude.includes(t)?!1:t in e.props},ownKeys(e){return Reflect.ownKeys(e.props).filter(t=>!e.exclude.includes(t))}};function et(e,t){return new Proxy({props:e,exclude:t,special:{},version:Fr(0),parent_effect:Je},QI)}const JI={get(e,t){let i=e.props.length;for(;i--;){let s=e.props[i];if(td(s)&&(s=s()),typeof s=="object"&&s!==null&&t in s)return s[t]}},set(e,t,i){let s=e.props.length;for(;s--;){let n=e.props[s];td(n)&&(n=n());const o=Cr(n,t);if(o&&o.set)return o.set(i),!0}return!1},getOwnPropertyDescriptor(e,t){let i=e.props.length;for(;i--;){let s=e.props[i];if(td(s)&&(s=s()),typeof s=="object"&&s!==null&&t in s){const n=Cr(s,t);return n&&!n.configurable&&(n.configurable=!0),n}}},has(e,t){if(t===bo||t===kx)return!1;for(let i of e.props)if(td(i)&&(i=i()),i!=null&&t in i)return!0;return!1},ownKeys(e){const t=[];for(let i of e.props)if(td(i)&&(i=i()),!!i){for(const s in i)t.includes(s)||t.push(s);for(const s of Object.getOwnPropertySymbols(i))t.includes(s)||t.push(s)}return t}};function bt(...e){return new Proxy({props:e},JI)}function ge(e,t,i,s){var S;var n=!Yh||(i&DM)!==0,o=(i&MM)!==0,r=(i&IM)!==0,a=s,l=!0,c=()=>(l&&(l=!1,a=r?ie(s):s),a),d;if(o){var h=bo in e||kx in e;d=((S=Cr(e,t))==null?void 0:S.set)??(h&&t in e?b=>e[t]=b:void 0)}var u,f=!1;o?[u,f]=XI(()=>e[t]):u=e[t],u===void 0&&s!==void 0&&(u=c(),d&&(n&&SM(),d(u)));var p;if(n?p=()=>{var b=e[t];return b===void 0?c():(l=!0,b)}:p=()=>{var b=e[t];return b!==void 0&&(a=void 0),b===void 0?a:b},n&&(i&Lx)===0)return p;if(d){var m=e.$$legacy;return(function(b,E){return arguments.length>0?((!n||!E||m||f)&&d(E?p():b),b):p()})}var v=!1,C=((i&TM)!==0?Vf:Aa)(()=>(v=!1,p()));o&&R(C);var w=Je;return(function(b,E){if(arguments.length>0){const A=E?R(C):n&&o?ud(b):b;return G(C,A),v=!0,a!==void 0&&(a=A),b}return Bc&&v||(w.f&Da)!==0?C.v:R(C)})}function Ci(e){Ze===null&&Gf(),Yh&&Ze.l!==null?_E(Ze).m.push(e):ow(()=>{const t=ie(e);if(typeof t=="function")return t})}function _r(e){Ze===null&&Gf(),Ci(()=>()=>ie(e))}function ZI(e,t,{bubbles:i=!1,cancelable:s=!1}={}){return new CustomEvent(e,{detail:t,bubbles:i,cancelable:s})}function kE(){const e=Ze;return e===null&&Gf(),(t,i,s)=>{var o;const n=(o=e.s.$$events)==null?void 0:o[t];if(n){const r=Hf(n)?n.slice():[n],a=ZI(t,i,s);for(const l of r)l.call(e.x,a);return!a.defaultPrevented}return!0}}function My(e){Ze===null&&Gf(),Ze.l===null&&yM(),_E(Ze).a.push(e)}function _E(e){var t=e.l;return t.u??(t.u={a:[],b:[],m:[]})}const ek="5";var Sx;typeof window<"u"&&((Sx=window.__svelte??(window.__svelte={})).v??(Sx.v=new Set)).add(ek);WM();const Fa=ri(null),Pn=ri(""),nC=ri(!0),tk="App2KSecureDB",_a="authStore",La="cryptoKeys",Iy="refreshToken_encrypted",ky="aes-key",Cc="__app2k_aes_key_b64",Pa="__app2k_refresh_token_b64";let el=null;function v0(e){const t=new Uint8Array(e);let i="";for(let s=0;s<t.length;s++)i+=String.fromCharCode(t[s]);return btoa(i)}function oC(e){const t=atob(e),i=t.length,s=new Uint8Array(i);for(let n=0;n<i;n++)s[n]=t.charCodeAt(n);return s.buffer}function $f(){return new Promise((e,t)=>{const i=indexedDB.open(tk,3);i.onupgradeneeded=()=>{const s=i.result;s.objectStoreNames.contains(_a)||s.createObjectStore(_a),s.objectStoreNames.contains(La)||s.createObjectStore(La)},i.onsuccess=()=>e(i.result),i.onerror=()=>t(i.error),i.onblocked=()=>{console.warn("IndexedDB blocked"),t(new Error("Database blocked"))}})}async function ik(e){try{const i=(await $f()).transaction(La,"readwrite");i.objectStore(La).put(e,ky);try{const s=v0(e);localStorage.setItem(Cc,s)}catch(s){console.warn("Backup key to localStorage failed:",s)}return new Promise((s,n)=>{i.oncomplete=()=>s(),i.onerror=()=>{console.warn("saveExportedKey tx error:",i.error),n(i.error)}})}catch(t){console.warn("saveExportedKey fallback -> store in localStorage only",t);try{const i=v0(e);localStorage.setItem(Cc,i);return}catch{throw t}}}async function sk(){try{const i=(await $f()).transaction(La,"readonly").objectStore(La).get(ky);return await new Promise(s=>{i.onsuccess=()=>{const n=i.result;if(n instanceof ArrayBuffer)s(n);else if(n&&n.buffer instanceof ArrayBuffer)s(n.buffer);else{const o=localStorage.getItem(Cc);if(o)try{s(oC(o))}catch(r){console.warn("Failed to parse key from localStorage backup:",r),s(null)}else s(null)}},i.onerror=()=>{const n=localStorage.getItem(Cc);if(n)try{s(oC(n))}catch(o){console.warn("Failed to parse key from localStorage backup:",o),s(null)}else s(null)}})}catch(e){console.warn("loadExportedKey indexdb open failed, try localStorage:",e);const t=localStorage.getItem(Cc);if(t)try{return oC(t)}catch{return null}return null}}async function LE(){if(el)return el;const e=await sk();if(e)try{return el=await crypto.subtle.importKey("raw",e,{name:"AES-GCM"},!0,["encrypt","decrypt"]),el}catch(i){console.warn("importKey failed, will regenerate key:",i)}el=await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);const t=await crypto.subtle.exportKey("raw",el);return await ik(t),el}async function nk(e){const t=await LE(),i=crypto.getRandomValues(new Uint8Array(12)),s=new TextEncoder().encode(String(e));return{cipher:await crypto.subtle.encrypt({name:"AES-GCM",iv:i},t,s),iv:i.buffer}}async function ok(e,t){const i=await LE(),s=e instanceof ArrayBuffer?new Uint8Array(e):e instanceof Uint8Array?e:e&&e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer):null,n=t instanceof ArrayBuffer?new Uint8Array(t):t instanceof Uint8Array?t:t&&t.buffer instanceof ArrayBuffer?new Uint8Array(t.buffer):null;if(!s||!n)throw new Error("Invalid cipher or iv format");const o=await crypto.subtle.decrypt({name:"AES-GCM",iv:n},i,s);return new TextDecoder().decode(o)}async function _y(e){if(!e)return!1;const t=await nk(e);try{const s=(await $f()).transaction(_a,"readwrite");s.objectStore(_a).put({cipher:t.cipher,iv:t.iv},Iy);try{localStorage.setItem(Pa,btoa(String(e)))}catch(o){console.warn("Could not backup token to localStorage:",o)}return await new Promise((o,r)=>{s.oncomplete=()=>o(!0),s.onerror=()=>r(s.error)})}catch(i){console.warn("saveRefreshToken indexeddb failed, fallback to localStorage",i);try{return localStorage.setItem(Pa,btoa(String(e))),!0}catch(s){throw s}}}async function OE(){try{const i=(await $f()).transaction(_a,"readonly").objectStore(_a).get(Iy);return await new Promise(s=>{i.onsuccess=async()=>{const n=i.result;if(!n){const a=localStorage.getItem(Pa);if(a)try{s(atob(a))}catch{s(null)}else s(null);return}const{cipher:o,iv:r}=n;try{const a=await ok(o,r);s(a)}catch(a){console.warn("Token decrypt failed â clearing storage",a),await Ly();const l=localStorage.getItem(Pa);if(l)try{s(atob(l))}catch{s(null)}else s(null)}},i.onerror=()=>{const n=localStorage.getItem(Pa);if(n)try{s(atob(n))}catch{s(null)}else s(null)}})}catch(e){console.warn("getRefreshToken fallback localStorage:",e);const t=localStorage.getItem(Pa);if(t)try{return atob(t)}catch{return null}return null}}async function Ly(){try{const e=await $f(),t=e.transaction(_a,"readwrite");t.objectStore(_a).delete(Iy);const i=e.transaction(La,"readwrite");return i.objectStore(La).delete(ky),localStorage.removeItem(Cc),localStorage.removeItem(Pa),await Promise.all([new Promise(s=>{t.oncomplete=s,t.onerror=s}),new Promise(s=>{i.oncomplete=s,i.onerror=s})])}catch(e){console.warn("clearRefreshToken fallback:",e);try{localStorage.removeItem(Cc),localStorage.removeItem(Pa)}catch{}return}}/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 * ---
 * 
 * The MIT License (MIT) (for portions derived from Feather)
 * 
 * Copyright (c) 2013-2023 Cole Bemis
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const rk={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var ak=bE("<svg><!><!></svg>");function Nt(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]),s=et(i,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);ot(t,!1);let n=ge(t,"name",8,void 0),o=ge(t,"color",8,"currentColor"),r=ge(t,"size",8,24),a=ge(t,"strokeWidth",8,2),l=ge(t,"absoluteStrokeWidth",8,!1),c=ge(t,"iconNode",24,()=>[]);const d=(...p)=>p.filter((m,v,C)=>!!m&&C.indexOf(m)===v).join(" ");lt();var h=ak();lw(h,(p,m)=>({...rk,...s,width:r(),height:r(),stroke:o(),"stroke-width":p,class:m}),[()=>(Re(l()),Re(a()),Re(r()),ie(()=>l()?Number(a())*24/Number(r()):a())),()=>(Re(n()),Re(i),ie(()=>d("lucide-icon","lucide",n()?`lucide-${n()}`:"",i.class)))]);var u=I(h);Ai(u,1,c,gs,(p,m)=>{var v=al(()=>Dx(R(m),2));let C=()=>R(v)[0],w=()=>R(v)[1];var S=xe(),b=ce(S);LI(b,C,!0,(E,A)=>{lw(E,()=>({...w()}))}),O(p,S)});var f=L(u);We(f,t,"default",{}),O(e,h),rt()}function NE(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"m12 19-7-7 7-7"}],["path",{d:"M19 12H5"}]];Nt(e,bt({name:"arrow-left"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function lk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M16 2v2"}],["path",{d:"M7 22v-2a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2"}],["path",{d:"M8 2v2"}],["circle",{cx:"12",cy:"11",r:"3"}],["rect",{x:"3",y:"4",width:"18",height:"18",rx:"2"}]];Nt(e,bt({name:"contact"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function ck(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["circle",{cx:"12",cy:"12",r:"1"}],["circle",{cx:"12",cy:"5",r:"1"}],["circle",{cx:"12",cy:"19",r:"1"}]];Nt(e,bt({name:"ellipsis-vertical"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function dk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["circle",{cx:"12",cy:"12",r:"1"}],["circle",{cx:"19",cy:"12",r:"1"}],["circle",{cx:"5",cy:"12",r:"1"}]];Nt(e,bt({name:"ellipsis"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function hk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"m15 15 6 6"}],["path",{d:"m15 9 6-6"}],["path",{d:"M21 16v5h-5"}],["path",{d:"M21 8V3h-5"}],["path",{d:"M3 16v5h5"}],["path",{d:"m3 21 6-6"}],["path",{d:"M3 8V3h5"}],["path",{d:"M9 9 3 3"}]];Nt(e,bt({name:"expand"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function uk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}],["circle",{cx:"9",cy:"9",r:"2"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"}]];Nt(e,bt({name:"image"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function gk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3"}]];Nt(e,bt({name:"maximize"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function fk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719"}],["path",{d:"M8 12h.01"}],["path",{d:"M12 12h.01"}],["path",{d:"M16 12h.01"}]];Nt(e,bt({name:"message-circle-more"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function pk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719"}]];Nt(e,bt({name:"message-circle"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function mk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z"}],["path",{d:"M7 11h10"}],["path",{d:"M7 15h6"}],["path",{d:"M7 7h8"}]];Nt(e,bt({name:"message-square-text"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function vk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3"}]];Nt(e,bt({name:"minimize"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function HE(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}],["path",{d:"M9 3v18"}],["path",{d:"m16 15-3-3 3-3"}]];Nt(e,bt({name:"panel-left-close"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function GE(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}],["path",{d:"M9 3v18"}],["path",{d:"m14 9 3 3-3 3"}]];Nt(e,bt({name:"panel-left-open"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function Ck(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551"}]];Nt(e,bt({name:"paperclip"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function wk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}],["path",{d:"M21 3v5h-5"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}],["path",{d:"M8 16H3v5"}]];Nt(e,bt({name:"refresh-cw"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function Oy(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"m21 21-4.34-4.34"}],["circle",{cx:"11",cy:"11",r:"8"}]];Nt(e,bt({name:"search"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function bk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]];Nt(e,bt({name:"send"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function yk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915"}],["circle",{cx:"12",cy:"12",r:"3"}]];Nt(e,bt({name:"settings"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function Sk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"m15 15 6 6m-6-6v4.8m0-4.8h4.8"}],["path",{d:"M9 19.8V15m0 0H4.2M9 15l-6 6"}],["path",{d:"M15 4.2V9m0 0h4.8M15 9l6-6"}],["path",{d:"M9 4.2V9m0 0H4.2M9 9 3 3"}]];Nt(e,bt({name:"shrink"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function Rk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9"}]];Nt(e,bt({name:"smile"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function xk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}],["circle",{cx:"9",cy:"7",r:"4"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11"}]];Nt(e,bt({name:"user-plus"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function Ek(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}],["circle",{cx:"9",cy:"7",r:"4"}]];Nt(e,bt({name:"users"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}function BE(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]];Nt(e,bt({name:"x"},()=>i,{get iconNode(){return s},children:(n,o)=>{var r=xe(),a=ce(r);We(a,t,"default",{}),O(n,r)},$$slots:{default:!0}}))}var Ak=J("<img/>");function ap(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]),s=et(i,["name"]);let n=ge(t,"name",8,"icon");var o=Ak();lw(o,()=>({src:`./assets/${n()}.svg`,loading:"lazy",...s})),O(e,o)}const Fk="modulepreload",Pk=function(e,t){return new URL(e,t).href},C0={},hl=function(t,i,s){let n=Promise.resolve();if(i&&i.length>0){let r=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};const a=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));n=r(i.map(d=>{if(d=Pk(d,s),d in C0)return;C0[d]=!0;const h=d.endsWith(".css"),u=h?'[rel="stylesheet"]':"";if(!!s)for(let m=a.length-1;m>=0;m--){const v=a[m];if(v.href===d&&(!h||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${u}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":Fk,h||(p.as="script"),p.crossOrigin="",p.href=d,c&&p.setAttribute("nonce",c),document.head.appendChild(p),h)return new Promise((m,v)=>{p.addEventListener("load",m),p.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(r){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=r,window.dispatchEvent(a),!a.defaultPrevented)throw r}return n.then(r=>{for(const a of r||[])a.status==="rejected"&&o(a.reason);return t().catch(o)})},Hu=ri("desktop"),w0=()=>{window.innerWidth<640?Hu.set("mobile"):window.innerWidth>=640&&window.innerWidth<1024?Hu.set("tablet"):Hu.set("desktop")};typeof window<"u"&&(w0(),window.addEventListener("resize",w0));var Tk=J('<div class="loading-overlay svelte-14fu6kf"><div class="loading-box svelte-14fu6kf"><div class="spinner svelte-14fu6kf"></div> <p class="loading-message svelte-14fu6kf"> </p></div></div>');function VE(e,t){let i=ge(t,"message",8,"Loading...");var s=Tk(),n=I(s),o=L(I(n),2),r=I(o);Me(()=>Be(r,i())),O(e,s)}function Dk(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]),s=et(i,[]);ot(t,!1);const n=()=>mt(Hu,"$screen",o),[o,r]=Ln();let a=re(null),l="";async function c(){const p=si(Hu);if(p!==l)if(l=p,p==="mobile"){const m=await hl(()=>import("./MobileLayout-DYcg2ztq.js"),__vite__mapDeps([0,1,2]),import.meta.url);G(a,m.default)}else if(p==="tablet"){const m=await hl(()=>import("./DesktopLayout-BrAW6lFI.js").then(v=>v.D),__vite__mapDeps([3,1,4]),import.meta.url);G(a,m.default)}else{const m=await hl(()=>import("./DesktopLayout-BrAW6lFI.js").then(v=>v.D),__vite__mapDeps([3,1,4]),import.meta.url);G(a,m.default)}}Ci(async()=>{await c()}),Ti(()=>n(),()=>{n()&&c()}),Po(),lt();var d=xe(),h=ce(d);{var u=p=>{var m=xe(),v=ce(m);_I(v,()=>R(a),(C,w)=>{w(C,bt(()=>s))}),O(p,m)},f=p=>{VE(p,{message:"Äang táº£i..."})};ye(h,p=>{R(a)?p(u):p(f,!1)})}O(e,d),rt(),r()}class Tv{constructor({baseURL:t="",withCredentials:i=!1,defaultHeaders:s={"Content-Type":"application/json"},defaultResponseType:n="json"}={}){this.baseURL="https://render-server-ezuf.onrender.com",this.withCredentials=i,this.defaultHeaders=s,this.defaultResponseType=n,this._isRefreshing=!1,this._refreshQueue=[],this.latestAccessToken=null}setAccessToken(t){typeof t=="string"?(Pn.set(t),this.latestAccessToken=t):(Pn.set(""),this.latestAccessToken=null)}_enqueueRefresh(t,i){this._refreshQueue.push({resolve:t,reject:i})}_resolveRefreshQueue(t){this._refreshQueue.forEach(i=>i.resolve(t)),this._refreshQueue=[]}_rejectRefreshQueue(t){this._refreshQueue.forEach(i=>i.reject(t)),this._refreshQueue=[]}async _refreshAccessToken(){if(this._isRefreshing)return new Promise((t,i)=>{this._enqueueRefresh(t,i)});this._isRefreshing=!0;try{const t=await OE();if(!t)throw new Error("Refresh token not found");const i=await fetch(`${this.baseURL}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(!i.ok)throw new Error(`Refresh failed: HTTP ${i.status}`);const s=await i.json();if(!(s!=null&&s.accessToken))throw new Error("Refresh response missing accessToken");return this.setAccessToken(s.accessToken),s.refreshToken&&await _y(s.refreshToken),this._resolveRefreshQueue(s.accessToken),s.accessToken}catch(t){try{await Ly()}catch(i){console.warn("clearRefreshToken failed:",i)}this.setAccessToken("");try{Fa.set(null)}catch{}throw this._rejectRefreshQueue(t),t}finally{this._isRefreshing=!1}}async request(t,{method:i="GET",data:s=null,params:n=null,headers:o={},responseType:r=this.defaultResponseType,withCredentials:a=this.withCredentials,retry:l=!0}={}){const c=`${this.baseURL}${t}${n?"?"+new URLSearchParams(n):""}`,d=this.latestAccessToken??si(Pn)??"",h={...s instanceof FormData?{}:this.defaultHeaders,...d?{Authorization:`Bearer ${d}`}:{},...o},u={method:i,credentials:a?"include":"same-origin",headers:h};s&&(u.body=s instanceof FormData?s:JSON.stringify(s));let f;try{f=await fetch(c,u)}catch(p){throw p}if(f.status===401&&l)try{const p=await this._refreshAccessToken(),m={...s instanceof FormData?{}:this.defaultHeaders,...o||{},...p?{Authorization:`Bearer ${p}`}:{}},v={method:i,credentials:a?"include":"same-origin",headers:m};s&&(v.body=s instanceof FormData?s:JSON.stringify(s));const C=await fetch(c,v);if(!C.ok)throw new Error(`HTTP ${C.status}: ${C.statusText}`);return this._parseResponseByType(C,r)}catch(p){throw p}if(!f.ok)throw new Error(`HTTP ${f.status}: ${f.statusText}`);return this._parseResponseByType(f,r)}_parseResponseByType(t,i){switch(i){case"json":return t.json();case"text":return t.text();case"blob":return t.blob();case"arrayBuffer":return t.arrayBuffer();case"formData":return t.formData();default:return t}}get(t,i={}){return this.request(t,{...i,method:"GET"})}post(t,i,s={}){return this.request(t,{...s,method:"POST",data:i})}put(t,i,s={}){return this.request(t,{...s,method:"PUT",data:i})}delete(t,i={}){return this.request(t,{...i,method:"DELETE"})}}const zE=new Tv;async function Mk(e){const t=new FormData;return t.append("image",e,"capture.jpg"),zE.post("/capture",t)}async function b0(e,t=!1){const i=new FormData;return i.append("chunk",e,t?"final.webm":"chunk.webm"),i.append("stop",t.toString()),zE.post("/stream-input",i)}const Ny=new Tv,Tp=ri("ð Connecting..."),ka=ri([]),gr=ri(null),hw=ri(""),Hy=ri([]),Tn=ri(null),dn=ri(null);Fa.subscribe(e=>{e?(gr.set(e.id),hw.set(e.name)):(gr.set(null),hw.set(""))});const Ik="wss://render-server-ezuf.onrender.com";let qe=null,uw=null,gw=!1;function WE(){if(console.log("connectWebSocket....",qe==null?void 0:qe.readyState,WebSocket.CLOSED),qe&&qe.readyState!==WebSocket.CLOSED)return console.log("âï¸ WS already connected or connecting"),qe;const e=si(Pn);if(!e){console.log("No access token â DO NOT CONNECT WS yet.");return}gw=!1,qe=new WebSocket(Ik),qe.onopen=()=>{qe.send(JSON.stringify({type:"auth",token:e})),Tp.set("ð¢ Connected")},qe.onmessage=async i=>{try{const s=JSON.parse(i.data);if(s.type==="auth_error"){console.warn("Token expired â refreshing...",new Date().toISOString());try{const o=(await Ny.post("/auth/refresh",{},{withCredentials:!0})).accessToken;Pn.set(o),t({type:"auth",token:o})}catch(n){console.error("Lá»i Refresh token failed:",n),qe.close()}return}if(s.type==="recent_contacts"){Hy.set([...s.conversations]);return}if(s.type==="welcome"){console.log("welcome",s);return}if(s.type==="chat"){const n=(s==null?void 0:s.payload)??{};if(!kk(n))return;ka.update(o=>y0(o,[n]));return}if(s.type==="messages"){if(s.rows.length===0)return;ka.update(n=>y0(n,s.rows,{prepend:!0}));return}if(s.type==="reaction_update"){const{messageId:n,reactions:o}=s;ka.update(r=>r.map(a=>a.id===n?{...a,reactions:o}:a));return}}catch{console.warn("â ï¸ Invalid WS message:",i.data)}},qe.onclose=()=>{const i=si(Pn);if(gw||!i){console.log("ð WS closed manually or token missing â NO reconnect"),Tp.set("âª WS closed");return}console.log("ð´ WS disconnected â retry in 2s..."),Tp.set("ð´ Disconnected â retrying..."),clearTimeout(uw),uw=setTimeout(WE,2e3)};function t(i){if(qe)if(qe.readyState===WebSocket.OPEN)qe.send(JSON.stringify(i));else{const s=()=>{qe.send(JSON.stringify(i)),qe.removeEventListener("open",s)};qe.addEventListener("open",s)}}return qe}function kk(e){const t=si(Tn);return t?e.conversationId===t:!1}function ul(e){if(!qe||qe.readyState!==WebSocket.OPEN){console.warn("â ï¸ WS not ready");return}qe.send(JSON.stringify(e))}const _k=e=>(qe==null?void 0:qe.readyState)===WebSocket.OPEN&&qe.send(e),Lk=()=>(qe==null?void 0:qe.readyState)===WebSocket.OPEN&&qe.send("stop");function fw(){qe&&(console.log("ð Closing WS manually..."),gw=!0,clearTimeout(uw),qe.close(),qe=null)}function tg(e,t={}){!qe||qe.readyState!==WebSocket.OPEN||qe.send(JSON.stringify({type:"load_messages",conversationId:e,firstMsg:t.firstMsg??null}))}function y0(e,t,{prepend:i=!1}={}){const s=new Map;e.forEach(o=>s.set(o.id,o)),t.forEach(o=>s.set(o.id,o));const n=Array.from(s.values());return i?n.sort((o,r)=>new Date(o.created_at)-new Date(r.created_at)):n}async function Ok(e){if(!e)throw new Error("File is required");const t=new FormData;t.append("file",e);try{return await Ny.post("/api/upload",t,{withCredentials:!0,responseType:"json"})}catch(i){throw console.error("â uploadFile failed:",i),i}}async function Nk(e){const t=new FormData;e.forEach(i=>t.append("images",i));try{return await Ny.post("/api/upload/images",t,{withCredentials:!0,responseType:"json"})}catch(i){throw console.error("â uploadFile failedss:",i),i}}const Hk=new Audio("/sounds/shutter.mp3"),Gk=new Audio("/sounds/recording.mp3"),Bk=new Audio("/sounds/stop-recording.mp3");function Gy(e){e.currentTime=0,e.play().catch(t=>console.warn("KhÃ´ng phÃ¡t ÄÆ°á»£c Ã¢m thanh:",t))}function Vk(){Gy(Hk)}function zk(){Gy(Gk)}function Wk(){Gy(Bk)}var $k=J(`<div class="absolute bottom-14 left-1/2 -translate-x-1/2 bg-white text-gray-800
               rounded-lg shadow-lg w-48 py-2 z-50"><button class="w-full px-4 py-2 text-left hover:bg-gray-100 flex items-center gap-2"> </button> <button class="w-full px-4 py-2 text-left hover:bg-gray-100 flex items-center gap-2 disabled:opacity-50">ð Start Stream</button> <button class="w-full px-4 py-2 text-left hover:bg-gray-100 flex items-center gap-2 disabled:opacity-50">â¹ Stop Stream</button></div>`),Uk=J(`<div class="relative flex flex-col h-full bg-black overflow-hidden"><video autoplay playsinline="" class="w-full h-full object-contain"></video> <div class="fixed bottom-0 left-0 w-full px-6 py-4 bg-black/50 backdrop-blur-sm
         shadow-lg flex flex-wrap items-center justify-center gap-3 border-t z-50"><button class="px-4 py-2 rounded-full bg-green-500 text-white font-medium
           shadow hover:bg-green-600 transition flex items-center gap-2">ð¸ <span>Capture</span></button> <button class="px-4 py-2 rounded-full bg-blue-500 text-white font-medium
           shadow hover:bg-blue-600 transition flex items-center gap-2 disabled:opacity-50">ð¥ <span>Start</span></button> <button class="px-4 py-2 rounded-full bg-red-500 text-white font-medium
           shadow hover:bg-red-600 transition flex items-center gap-2 disabled:opacity-50">â¹ <span>Stop</span></button> <div class="relative"><button class="w-12 h-12 flex items-center justify-center rounded-full bg-gray-700 text-white
             shadow-md hover:bg-gray-800 transition">â®</button> <!></div></div> <button class="absolute top-2 left-2 bg-white text-black rounded-full p-2 shadow-md block md:hidden"><!></button></div>`,2);function jk(e,t){ot(t,!1);let i=re("environment"),s=re(!1),n=re(),o,r,a=[],l=re(!1),c=ge(t,"onClose",8);Ci(async()=>{await h()}),_r(()=>{f(),console.log("Camera component destroyed, camera stopped.",new Date().toLocaleTimeString())});async function d(){const U=/iPhone|iPad|iPod/i.test(navigator.userAgent);try{U?o=await navigator.mediaDevices.getUserMedia({video:{facingMode:{exact:"environment"}},audio:!1}):o=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1})}catch(pe){console.warn("â ï¸ KhÃ´ng láº¥y ÄÆ°á»£c camera sau hoáº·c lá»i khÃ¡c, fallback vá» camera máº·c Äá»nh",pe),o=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1})}Ji(n,R(n).srcObject=o)}async function h(){try{zk(),o&&o.getTracks().forEach(U=>U.stop()),o=await navigator.mediaDevices.getUserMedia({video:{facingMode:R(i)},audio:!1}),R(n)&&Ji(n,R(n).srcObject=o)}catch(U){console.warn("â ï¸ KhÃ´ng má» ÄÆ°á»£c camera",U)}}function u(){G(i,R(i)==="user"?"environment":"user"),h(),b()}function f(){o&&(o.getTracks().forEach(U=>U.stop()),o=null),R(n)&&Ji(n,R(n).srcObject=null)}async function p(){Vk();const U=document.createElement("canvas");U.width=R(n).videoWidth,U.height=R(n).videoHeight,U.getContext("2d").drawImage(R(n),0,0);const Ee=await new Promise(Ce=>U.toBlob(Ce,"image/jpeg"));Mk(Ee)}async function m(){a=[],r=new MediaRecorder(o,{mimeType:"video/webm"});let U=[],pe=0;const Ee=2;r.ondataavailable=async Ce=>{if(Ce.data.size>0&&(a.push(Ce.data),U.push(Ce.data),pe+=Ce.data.size,pe/(1024*1024)>=Ee)){const le=new Blob(U,{type:"video/webm"});console.log("Chunk size:",le,new Date().toLocaleTimeString()),await b0(le,!1),U=[],pe=0}},r.onstop=async()=>{const Ce=new Blob(a,{type:"video/webm"});await b0(Ce,!0)},r.start(2e3),G(l,!0)}function v(){Wk(),r&&r.stop(),G(l,!1)}function C(){r=new MediaRecorder(o,{mimeType:"video/webm"}),r.ondataavailable=U=>{U.data.size>0&&U.data.arrayBuffer().then(pe=>{_k(pe)})},r.onstop=()=>{Lk()},r.start(1e3),G(l,!0)}function w(){r&&R(l)&&r.stop(),fw(),G(l,!1)}function S(){G(s,!R(s))}function b(){G(s,!1)}var E={initCamera1:d,stopCamera:f,capture:p,startRecording:m,stopRecording:v,startWebSocketStream:C,stopWebSocketStream:w};lt();var A=Uk(),P=I(A);ji(P,U=>G(n,U),()=>R(n));var T=L(P,2),D=I(T),N=L(D,2),M=L(N,2),_=L(M,2),W=I(_),$=L(W,2);{var B=U=>{var pe=$k(),Ee=I(pe),Ce=I(Ee),le=L(Ee,2),ee=L(le,2);Me(()=>{Be(Ce,`ð· Chuyá»n Camera (${R(i)==="user"?"TrÆ°á»c":"Sau"})`),le.disabled=R(l),ee.disabled=!R(l)}),Y("click",Ee,u),Y("click",le,()=>{C(),b()}),Y("click",ee,()=>{w(),b()}),O(U,pe)};ye($,U=>{R(s)&&U(B)})}var q=L(T,2),X=I(q);return NE(X,{size:"20"}),Me(()=>{N.disabled=R(l),M.disabled=!R(l)}),Y("loadedmetadata",P,()=>R(n).play()),Y("click",D,p),Y("click",N,m),Y("click",M,v),Y("click",W,S),Y("click",q,function(...U){var pe;(pe=c())==null||pe.apply(this,U)}),O(e,A),Vr(t,"initCamera1",d),Vr(t,"stopCamera",f),Vr(t,"capture",p),Vr(t,"startRecording",m),Vr(t,"stopRecording",v),Vr(t,"startWebSocketStream",C),Vr(t,"stopWebSocketStream",w),rt(E)}var Kk=J('<button class="p-2 rounded hover:bg-gray-100 transition" title="Äáº·t láº¡i vá» trÃ­" aria-label="Reset position"><!></button>'),qk=J('<div class="fixed inset-0 z-40 bg-white/10 backdrop-blur-sm transition-opacity"></div> <div class="fixed inset-0 z-50 flex items-center justify-center pointer-events-none"><div class="bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden relative pointer-events-auto transition-transform transition-all duration-300"><div class="flex items-center justify-between px-6 py-4 border-b bg-gradient-to-r from-gray-50 to-white cursor-move select-none"><h2 class="text-xl font-semibold text-gray-800"> </h2> <div class="flex gap-3 items-center"><!> <button class="p-2 rounded hover:bg-gray-100 transition" title="Chuyá»n cháº¿ Äá» fullscreen" aria-label="Toggle fullscreen"><!></button> <button class="p-2 rounded hover:bg-gray-100 transition" aria-label="Maximize or minimize modal"><!></button> <button class="p-2 rounded hover:bg-gray-100 transition" title="ÄÃ³ng" aria-label="Close modal"><!></button></div></div> <div class="px-6 py-4 overflow-y-auto h-[calc(100%-130px)]"><!></div> <div class="flex justify-end gap-2 px-6 py-2 border-t bg-gray-50"><button class="px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-300 rounded-lg hover:bg-gray-100">Cancel</button> <button class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700">OK</button></div></div></div>',1);function Yk(e,t){ot(t,!1);let i=ge(t,"open",12,!1),s=ge(t,"title",8,"Untitle"),n=ge(t,"onClose",8,()=>{i(!1)}),o=ge(t,"onConfirm",8,()=>{}),r=ge(t,"width",8,"80vw"),a=ge(t,"height",8,"auto"),l=ge(t,"closeOnOutsideClick",8,!0),c=re(),d=0,h=0,u=!1,f,p,m=re(!1),v=re(!1);function C(_){if(!R(c)||R(m))return;u=!0,f=_.clientX,p=_.clientY;const W=window.getComputedStyle(R(c)),$=new DOMMatrixReadOnly(W.transform);d=$.m41,h=$.m42,window.addEventListener("mousemove",w),window.addEventListener("mouseup",S)}function w(_){if(!u)return;const W=_.clientX-f,$=_.clientY-p;Ji(c,R(c).style.transform=`translate(${d+W}px, ${h+$}px)`)}function S(){if(u=!1,window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",S),R(c)){const _=window.getComputedStyle(R(c)),W=new DOMMatrixReadOnly(_.transform);G(v,!(W.m41===0&&W.m42===0))}}function b(){R(c)&&(Ji(c,R(c).style.transform="translate(0px, 0px)"),G(v,!1))}function E(){G(m,!R(m)),b()}function A(){var _,W,$;R(c)&&(R(m)?($=document.exitFullscreen)==null||$.call(document):(W=(_=R(c)).requestFullscreen)==null||W.call(_),G(m,!R(m)))}function P(){G(m,!!document.fullscreenElement)}Ci(()=>{document.addEventListener("fullscreenchange",P)}),_r(()=>{document.removeEventListener("fullscreenchange",P)});function T(){l()&&n()()}lt();var D=xe(),N=ce(D);{var M=_=>{var W=qk(),$=ce(W),B=L($,2),q=I(B),X=I(q),U=I(X),pe=I(U),Ee=L(U,2),Ce=I(Ee);{var le=Le=>{var it=Kk(),Cs=I(it);wk(Cs,{class:"w-5 h-5 text-gray-600 hover:text-blue-600"}),Y("click",it,b),O(Le,it)};ye(Ce,Le=>{R(v)&&Le(le)})}var ee=L(Ce,2),ve=I(ee);{var Oe=Le=>{Sk(Le,{class:"w-5 h-5 text-gray-600 hover:text-blue-600"})},Z=Le=>{hk(Le,{class:"w-5 h-5 text-gray-600 hover:text-blue-600"})};ye(ve,Le=>{R(m)?Le(Oe):Le(Z,!1)})}var we=L(ee,2),Ne=I(we);{var Se=Le=>{vk(Le,{class:"w-5 h-5 text-gray-600 hover:text-blue-600"})},tt=Le=>{gk(Le,{class:"w-5 h-5 text-gray-600 hover:text-blue-600"})};ye(Ne,Le=>{R(m)?Le(Se):Le(tt,!1)})}var Mt=L(we,2),St=I(Mt);BE(St,{class:"w-6 h-6 text-gray-600 hover:text-red-600"});var qt=L(X,2),Ht=I(qt);We(Ht,t,"default",{});var wi=L(qt,2),Ie=I(wi),Rt=L(Ie,2);ji(q,Le=>G(c,Le),()=>R(c)),Me(()=>{ja(q,`width: ${(R(m)?"100vw":r())??""}; height: ${(R(m)?"100vh":a())??""}; max-height: 90vh; transform: translate(0px, 0px);`),Be(pe,s()),fi(we,"title",R(m)?"Thu nhá» cá»­a sá»":"PhÃ³ng to cá»­a sá»")}),Y("click",$,T),Y("click",ee,E),Y("click",we,A),Y("click",Mt,function(...Le){var it;(it=n())==null||it.apply(this,Le)}),Y("mousedown",X,C),Y("click",Ie,function(...Le){var it;(it=n())==null||it.apply(this,Le)}),Y("click",Rt,function(...Le){var it;(it=o())==null||it.apply(this,Le)}),Y("click",q,Gh(function(Le){Pv.call(this,t,Le)})),O(_,W)};ye(N,_=>{i()&&_(M)})}O(e,D),rt()}var Xk=J("<button><span> </span> </button>"),Qk=J('<section class="bg-white p-6 rounded-xl shadow space-y-4"><h2 class="text-lg font-medium text-gray-800">Account Info</h2> <div><label class="block text-sm text-gray-600">Full Name</label> <input type="text" placeholder="Your name" class="mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:ring focus:ring-blue-200"/></div> <div><label class="block text-sm text-gray-600">Email</label> <input type="email" placeholder="your@email.com" class="mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:ring focus:ring-blue-200"/></div> <button class="mt-4 px-4 py-2 rounded-lg bg-blue-600 text-white shadow hover:bg-blue-700">Save Account</button></section>'),Jk=J('<section class="bg-white p-6 rounded-xl shadow space-y-4"><h2 class="text-lg font-medium text-gray-800">Security</h2> <div><label class="block text-sm text-gray-600">Change Password</label> <input type="password" placeholder="New password" class="mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:ring focus:ring-blue-200"/></div> <button class="mt-4 px-4 py-2 rounded-lg bg-blue-600 text-white shadow hover:bg-blue-700">Update Password</button></section>'),Zk=J('<section class="bg-white p-6 rounded-xl shadow space-y-4"><h2 class="text-lg font-medium text-gray-800">Notifications</h2> <label class="flex items-center gap-3"><input type="checkbox" class="rounded text-blue-600"/> Email alerts</label> <label class="flex items-center gap-3"><input type="checkbox" class="rounded text-blue-600"/> Push notifications</label></section>'),e_=J('<section class="bg-white p-6 rounded-xl shadow space-y-4"><h2 class="text-lg font-medium text-gray-800">System Settings</h2> <label class="block text-sm text-gray-600">Language</label> <select class="mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:ring focus:ring-blue-200"><option>English</option><option>Vietnamese</option><option>Japanese</option></select></section>'),t_=J(`<div class="min-h-screen flex bg-gray-100"><aside class="w-64 bg-white shadow-lg flex flex-col"><div class="p-6 font-bold text-xl text-blue-600 border-b">â¡ Settings</div> <nav class="flex-1 p-4 space-y-2"></nav></aside> <main class="flex-1 p-8 space-y-6"><div class="flex justify-between items-center"><h1 class="text-2xl font-semibold text-gray-800 capitalize"> </h1> <input type="text" placeholder="Search settings..." class="w-64 px-4 py-2 rounded-lg border border-gray-300 shadow-sm
               focus:border-blue-500 focus:ring focus:ring-blue-200"/></div> <!></main></div>`);function i_(e){let t=re("account"),i=re("");const s=[{id:"account",label:"Account",icon:"ð¤"},{id:"security",label:"Security",icon:"ð"},{id:"notifications",label:"Notifications",icon:"ð"},{id:"system",label:"System",icon:"âï¸"}];function n(C){G(t,C)}function o(){alert("Changes saved!")}var r=t_(),a=I(r),l=L(I(a),2);Ai(l,5,()=>s,gs,(C,w)=>{var S=Xk(),b=I(S),E=I(b),A=L(b);Me(()=>{$i(S,1,`w-full flex items-center gap-3 px-4 py-2 rounded-lg transition
                 ${R(t)===R(w).id?"bg-blue-100 text-blue-700 font-medium":"hover:bg-gray-100 text-gray-700"}`),Be(E,R(w).icon),Be(A,` ${R(w).label??""}`)}),Y("click",S,()=>n(R(w).id)),O(C,S)});var c=L(a,2),d=I(c),h=I(d),u=I(h),f=L(h,2),p=L(d,2);{var m=C=>{var w=Qk(),S=L(I(w),6);Y("click",S,o),O(C,w)},v=C=>{var w=xe(),S=ce(w);{var b=A=>{var P=Jk();O(A,P)},E=A=>{var P=xe(),T=ce(P);{var D=M=>{var _=Zk();O(M,_)},N=M=>{var _=xe(),W=ce(_);{var $=B=>{var q=e_();O(B,q)};ye(W,B=>{R(t)==="system"&&B($)},!0)}O(M,_)};ye(T,M=>{R(t)==="notifications"?M(D):M(N,!1)},!0)}O(A,P)};ye(S,A=>{R(t)==="security"?A(b):A(E,!1)},!0)}O(C,w)};ye(p,C=>{R(t)==="account"?C(m):C(v,!1)})}Me(()=>Be(u,`${R(t)??""} settings`)),eg(f,()=>R(i),C=>G(i,C)),O(e,r)}function s_(){const{subscribe:e,update:t}=ri({});function i(n,o){t(r=>(r[n]=o,r))}function s(n){t(o=>(delete o[n],o))}return{subscribe:e,register:i,unregister:s}}const pw=s_();function rC(e,t){ot(t,!1);let i=ge(t,"combo",8);const s=kE();function n(o){s("pressed",{detail:o})}Ci(()=>{pw.register(i(),n)}),_r(()=>{pw.unregister(i())}),lt(),rt()}var n_=J('<div class="text-center text-gray-500">Loading...</div>'),o_=J('<div class="text-center text-red-500">No users found.</div>'),r_=J('<tr class="hover:bg-gray-100"><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700"></td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-blue-600"> </td></tr>'),a_=J('<div class="overflow-x-auto bg-white rounded-lg shadow"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">#</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Name</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Email</th></tr></thead><tbody class="divide-y divide-gray-200"></tbody></table></div>'),l_=J('<div class="max-w-3xl mx-auto p-4"><h1 class="text-2xl font-bold mb-4 text-center">User List</h1> <!></div>');function c_(e,t){ot(t,!1);let i=re([]),s=re(!1);async function n(){G(s,!1);try{const d=await(await fetch("https://render-server-ezuf.onrender.com/users")).json();d.success?G(i,d.users):console.error("API error34:",d.error)}catch(c){console.error("Fetch error12:",c)}finally{G(s,!0)}}Ci(()=>{n()}),lt();var o=l_(),r=L(I(o),2);{var a=c=>{var d=n_();O(c,d)},l=c=>{var d=xe(),h=ce(d);{var u=p=>{var m=o_();O(p,m)},f=p=>{var m=a_(),v=I(m),C=L(I(v));Ai(C,5,()=>R(i),gs,(w,S,b)=>{var E=r_(),A=I(E);A.textContent=b+1;var P=L(A),T=I(P),D=L(P),N=I(D);Me(()=>{Be(T,R(S).name),Be(N,R(S).email)}),O(w,E)}),O(p,m)};ye(h,p=>{R(i).length===0?p(u):p(f,!1)},!0)}O(c,d)};ye(r,c=>{R(s)?c(l,!1):c(a)})}O(e,o),rt()}var mw=function(e,t){return mw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,s){i.__proto__=s}||function(i,s){for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(i[n]=s[n])},mw(e,t)};function eu(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");mw(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}function d_(e,t,i,s){function n(o){return o instanceof i?o:new i(function(r){r(o)})}return new(i||(i=Promise))(function(o,r){function a(d){try{c(s.next(d))}catch(h){r(h)}}function l(d){try{c(s.throw(d))}catch(h){r(h)}}function c(d){d.done?o(d.value):n(d.value).then(a,l)}c((s=s.apply(e,t||[])).next())})}function $E(e,t){var i={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},s,n,o,r=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return r.next=a(0),r.throw=a(1),r.return=a(2),typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function a(c){return function(d){return l([c,d])}}function l(c){if(s)throw new TypeError("Generator is already executing.");for(;r&&(r=0,c[0]&&(i=0)),i;)try{if(s=1,n&&(o=c[0]&2?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(o=i.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){i=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(c[0]===6&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(d){c=[6,d],n=0}finally{s=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function ig(e){var t=typeof Symbol=="function"&&Symbol.iterator,i=t&&e[t],s=0;if(i)return i.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Bh(e,t){var i=typeof Symbol=="function"&&e[Symbol.iterator];if(!i)return e;var s=i.call(e),n,o=[],r;try{for(;(t===void 0||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o}function sg(e,t,i){if(i||arguments.length===2)for(var s=0,n=t.length,o;s<n;s++)(o||!(s in t))&&(o||(o=Array.prototype.slice.call(t,0,s)),o[s]=t[s]);return e.concat(o||Array.prototype.slice.call(t))}function Cd(e){return this instanceof Cd?(this.v=e,this):new Cd(e)}function h_(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=i.apply(e,t||[]),n,o=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",r),n[Symbol.asyncIterator]=function(){return this},n;function r(f){return function(p){return Promise.resolve(p).then(f,h)}}function a(f,p){s[f]&&(n[f]=function(m){return new Promise(function(v,C){o.push([f,m,v,C])>1||l(f,m)})},p&&(n[f]=p(n[f])))}function l(f,p){try{c(s[f](p))}catch(m){u(o[0][3],m)}}function c(f){f.value instanceof Cd?Promise.resolve(f.value.v).then(d,h):u(o[0][2],f)}function d(f){l("next",f)}function h(f){l("throw",f)}function u(f,p){f(p),o.shift(),o.length&&l(o[0][0],o[0][1])}}function u_(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],i;return t?t.call(e):(e=typeof ig=="function"?ig(e):e[Symbol.iterator](),i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i);function s(o){i[o]=e[o]&&function(r){return new Promise(function(a,l){r=e[o](r),n(a,l,r.done,r.value)})}}function n(o,r,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},r)}}function Tt(e){return typeof e=="function"}function g_(e){var t=function(s){Error.call(s),s.stack=new Error().stack},i=e(t);return i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,i}var aC=g_(function(e){return function(i){e(this),this.message=i?i.length+` errors occurred during unsubscription:
`+i.map(function(s,n){return n+1+") "+s.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=i}});function vw(e,t){if(e){var i=e.indexOf(t);0<=i&&e.splice(i,1)}}var Dv=(function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,i,s,n,o;if(!this.closed){this.closed=!0;var r=this._parentage;if(r)if(this._parentage=null,Array.isArray(r))try{for(var a=ig(r),l=a.next();!l.done;l=a.next()){var c=l.value;c.remove(this)}}catch(m){t={error:m}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}else r.remove(this);var d=this.initialTeardown;if(Tt(d))try{d()}catch(m){o=m instanceof aC?m.errors:[m]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var u=ig(h),f=u.next();!f.done;f=u.next()){var p=f.value;try{S0(p)}catch(m){o=o??[],m instanceof aC?o=sg(sg([],Bh(o)),Bh(m.errors)):o.push(m)}}}catch(m){s={error:m}}finally{try{f&&!f.done&&(n=u.return)&&n.call(u)}finally{if(s)throw s.error}}}if(o)throw new aC(o)}},e.prototype.add=function(t){var i;if(t&&t!==this)if(this.closed)S0(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(i=this._finalizers)!==null&&i!==void 0?i:[]).push(t)}},e.prototype._hasParent=function(t){var i=this._parentage;return i===t||Array.isArray(i)&&i.includes(t)},e.prototype._addParent=function(t){var i=this._parentage;this._parentage=Array.isArray(i)?(i.push(t),i):i?[i,t]:t},e.prototype._removeParent=function(t){var i=this._parentage;i===t?this._parentage=null:Array.isArray(i)&&vw(i,t)},e.prototype.remove=function(t){var i=this._finalizers;i&&vw(i,t),t instanceof e&&t._removeParent(this)},e.EMPTY=(function(){var t=new e;return t.closed=!0,t})(),e})();Dv.EMPTY;function UE(e){return e instanceof Dv||e&&"closed"in e&&Tt(e.remove)&&Tt(e.add)&&Tt(e.unsubscribe)}function S0(e){Tt(e)?e():e.unsubscribe()}var f_={Promise:void 0},p_={setTimeout:function(e,t){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];return setTimeout.apply(void 0,sg([e,t],Bh(i)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function jE(e){p_.setTimeout(function(){throw e})}function R0(){}function m_(e){e()}var By=(function(e){eu(t,e);function t(i){var s=e.call(this)||this;return s.isStopped=!1,i?(s.destination=i,UE(i)&&i.add(s)):s.destination=w_,s}return t.create=function(i,s,n){return new Cw(i,s,n)},t.prototype.next=function(i){this.isStopped||this._next(i)},t.prototype.error=function(i){this.isStopped||(this.isStopped=!0,this._error(i))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(i){this.destination.next(i)},t.prototype._error=function(i){try{this.destination.error(i)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t})(Dv),v_=(function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var i=this.partialObserver;if(i.next)try{i.next(t)}catch(s){lp(s)}},e.prototype.error=function(t){var i=this.partialObserver;if(i.error)try{i.error(t)}catch(s){lp(s)}else lp(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(i){lp(i)}},e})(),Cw=(function(e){eu(t,e);function t(i,s,n){var o=e.call(this)||this,r;return Tt(i)||!i?r={next:i??void 0,error:s??void 0,complete:n??void 0}:r=i,o.destination=new v_(r),o}return t})(By);function lp(e){jE(e)}function C_(e){throw e}var w_={closed:!0,next:R0,error:C_,complete:R0},Vy=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function KE(e){return e}function b_(e){return e.length===0?KE:e.length===1?e[0]:function(i){return e.reduce(function(s,n){return n(s)},i)}}var Vc=(function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var i=new e;return i.source=this,i.operator=t,i},e.prototype.subscribe=function(t,i,s){var n=this,o=S_(t)?t:new Cw(t,i,s);return m_(function(){var r=n,a=r.operator,l=r.source;o.add(a?a.call(o,l):l?n._subscribe(o):n._trySubscribe(o))}),o},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(i){t.error(i)}},e.prototype.forEach=function(t,i){var s=this;return i=x0(i),new i(function(n,o){var r=new Cw({next:function(a){try{t(a)}catch(l){o(l),r.unsubscribe()}},error:o,complete:n});s.subscribe(r)})},e.prototype._subscribe=function(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)},e.prototype[Vy]=function(){return this},e.prototype.pipe=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return b_(t)(this)},e.prototype.toPromise=function(t){var i=this;return t=x0(t),new t(function(s,n){var o;i.subscribe(function(r){return o=r},function(r){return n(r)},function(){return s(o)})})},e.create=function(t){return new e(t)},e})();function x0(e){var t;return(t=e??f_.Promise)!==null&&t!==void 0?t:Promise}function y_(e){return e&&Tt(e.next)&&Tt(e.error)&&Tt(e.complete)}function S_(e){return e&&e instanceof By||y_(e)&&UE(e)}function R_(e){return Tt(e==null?void 0:e.lift)}function Uf(e){return function(t){if(R_(t))return t.lift(function(i){try{return e(i,this)}catch(s){this.error(s)}});throw new TypeError("Unable to lift unknown Observable type")}}function Vh(e,t,i,s,n){return new x_(e,t,i,s,n)}var x_=(function(e){eu(t,e);function t(i,s,n,o,r,a){var l=e.call(this,i)||this;return l.onFinalize=r,l.shouldUnsubscribe=a,l._next=s?function(c){try{s(c)}catch(d){i.error(d)}}:e.prototype._next,l._error=o?function(c){try{o(c)}catch(d){i.error(d)}finally{this.unsubscribe()}}:e.prototype._error,l._complete=n?function(){try{n()}catch(c){i.error(c)}finally{this.unsubscribe()}}:e.prototype._complete,l}return t.prototype.unsubscribe=function(){var i;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var s=this.closed;e.prototype.unsubscribe.call(this),!s&&((i=this.onFinalize)===null||i===void 0||i.call(this))}},t})(By),E_={now:function(){return Date.now()}},A_=(function(e){eu(t,e);function t(i,s){return e.call(this)||this}return t.prototype.schedule=function(i,s){return this},t})(Dv),E0={setInterval:function(e,t){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];return setInterval.apply(void 0,sg([e,t],Bh(i)))},clearInterval:function(e){return clearInterval(e)},delegate:void 0},F_=(function(e){eu(t,e);function t(i,s){var n=e.call(this,i,s)||this;return n.scheduler=i,n.work=s,n.pending=!1,n}return t.prototype.schedule=function(i,s){var n;if(s===void 0&&(s=0),this.closed)return this;this.state=i;var o=this.id,r=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(r,o,s)),this.pending=!0,this.delay=s,this.id=(n=this.id)!==null&&n!==void 0?n:this.requestAsyncId(r,this.id,s),this},t.prototype.requestAsyncId=function(i,s,n){return n===void 0&&(n=0),E0.setInterval(i.flush.bind(i,this),n)},t.prototype.recycleAsyncId=function(i,s,n){if(n===void 0&&(n=0),n!=null&&this.delay===n&&this.pending===!1)return s;s!=null&&E0.clearInterval(s)},t.prototype.execute=function(i,s){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(i,s);if(n)return n;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(i,s){var n=!1,o;try{this.work(i)}catch(r){n=!0,o=r||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),o},t.prototype.unsubscribe=function(){if(!this.closed){var i=this,s=i.id,n=i.scheduler,o=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,vw(o,this),s!=null&&(this.id=this.recycleAsyncId(n,s,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t})(A_),A0=(function(){function e(t,i){i===void 0&&(i=e.now),this.schedulerActionCtor=t,this.now=i}return e.prototype.schedule=function(t,i,s){return i===void 0&&(i=0),new this.schedulerActionCtor(this,t).schedule(s,i)},e.now=E_.now,e})(),P_=(function(e){eu(t,e);function t(i,s){s===void 0&&(s=A0.now);var n=e.call(this,i,s)||this;return n.actions=[],n._active=!1,n}return t.prototype.flush=function(i){var s=this.actions;if(this._active){s.push(i);return}var n;this._active=!0;do if(n=i.execute(i.state,i.delay))break;while(i=s.shift());if(this._active=!1,n){for(;i=s.shift();)i.unsubscribe();throw n}},t})(A0),T_=new P_(F_),qE=(function(e){return e&&typeof e.length=="number"&&typeof e!="function"});function D_(e){return Tt(e==null?void 0:e.then)}function M_(e){return Tt(e[Vy])}function I_(e){return Symbol.asyncIterator&&Tt(e==null?void 0:e[Symbol.asyncIterator])}function k_(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function __(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var L_=__();function O_(e){return Tt(e==null?void 0:e[L_])}function N_(e){return h_(this,arguments,function(){var i,s,n,o;return $E(this,function(r){switch(r.label){case 0:i=e.getReader(),r.label=1;case 1:r.trys.push([1,,9,10]),r.label=2;case 2:return[4,Cd(i.read())];case 3:return s=r.sent(),n=s.value,o=s.done,o?[4,Cd(void 0)]:[3,5];case 4:return[2,r.sent()];case 5:return[4,Cd(n)];case 6:return[4,r.sent()];case 7:return r.sent(),[3,2];case 8:return[3,10];case 9:return i.releaseLock(),[7];case 10:return[2]}})})}function H_(e){return Tt(e==null?void 0:e.getReader)}function zy(e){if(e instanceof Vc)return e;if(e!=null){if(M_(e))return G_(e);if(qE(e))return B_(e);if(D_(e))return V_(e);if(I_(e))return YE(e);if(O_(e))return z_(e);if(H_(e))return W_(e)}throw k_(e)}function G_(e){return new Vc(function(t){var i=e[Vy]();if(Tt(i.subscribe))return i.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function B_(e){return new Vc(function(t){for(var i=0;i<e.length&&!t.closed;i++)t.next(e[i]);t.complete()})}function V_(e){return new Vc(function(t){e.then(function(i){t.closed||(t.next(i),t.complete())},function(i){return t.error(i)}).then(null,jE)})}function z_(e){return new Vc(function(t){var i,s;try{for(var n=ig(e),o=n.next();!o.done;o=n.next()){var r=o.value;if(t.next(r),t.closed)return}}catch(a){i={error:a}}finally{try{o&&!o.done&&(s=n.return)&&s.call(n)}finally{if(i)throw i.error}}t.complete()})}function YE(e){return new Vc(function(t){$_(e,t).catch(function(i){return t.error(i)})})}function W_(e){return YE(N_(e))}function $_(e,t){var i,s,n,o;return d_(this,void 0,void 0,function(){var r,a;return $E(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),i=u_(e),l.label=1;case 1:return[4,i.next()];case 2:if(s=l.sent(),!!s.done)return[3,4];if(r=s.value,t.next(r),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),n={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),s&&!s.done&&(o=i.return)?[4,o.call(i)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(n)throw n.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function Wy(e,t){return Uf(function(i,s){var n=0;i.subscribe(Vh(s,function(o){s.next(e.call(t,o,n++))}))})}var U_=Array.isArray;function j_(e,t){return U_(t)?e.apply(void 0,sg([],Bh(t))):e(t)}function K_(e){return Wy(function(t){return j_(e,t)})}function q_(e,t,i,s,n,o,r,a){var l=[],c=0,d=0,h=!1,u=function(){h&&!l.length&&!c&&t.complete()},f=function(m){return c<s?p(m):l.push(m)},p=function(m){c++;var v=!1;zy(i(m,d++)).subscribe(Vh(t,function(C){t.next(C)},function(){v=!0},void 0,function(){if(v)try{c--;for(var C=function(){var w=l.shift();r||p(w)};l.length&&c<s;)C();u()}catch(w){t.error(w)}}))};return e.subscribe(Vh(t,f,function(){h=!0,u()})),function(){}}function XE(e,t,i){return i===void 0&&(i=1/0),Tt(t)?XE(function(s,n){return Wy(function(o,r){return t(s,o,n,r)})(zy(e(s,n)))},i):(typeof t=="number"&&(i=t),Uf(function(s,n){return q_(s,n,e,i)}))}var Y_=["addListener","removeListener"],X_=["addEventListener","removeEventListener"],Q_=["on","off"];function ww(e,t,i,s){if(Tt(i)&&(s=i,i=void 0),s)return ww(e,t,i).pipe(K_(s));var n=Bh(e1(e)?X_.map(function(a){return function(l){return e[a](t,l,i)}}):J_(e)?Y_.map(F0(e,t)):Z_(e)?Q_.map(F0(e,t)):[],2),o=n[0],r=n[1];if(!o&&qE(e))return XE(function(a){return ww(a,t,i)})(zy(e));if(!o)throw new TypeError("Invalid event target");return new Vc(function(a){var l=function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return a.next(1<c.length?c:c[0])};return o(l),function(){return r(l)}})}function F0(e,t){return function(i){return function(s){return e[i](t,s)}}}function J_(e){return Tt(e.addListener)&&Tt(e.removeListener)}function Z_(e){return Tt(e.on)&&Tt(e.off)}function e1(e){return Tt(e.addEventListener)&&Tt(e.removeEventListener)}function t1(e,t){return Uf(function(i,s){var n=0;i.subscribe(Vh(s,function(o){return e.call(t,o,n++)&&s.next(o)}))})}function i1(e,t){return t===void 0&&(t=T_),Uf(function(i,s){var n=null,o=null,r=null,a=function(){if(n){n.unsubscribe(),n=null;var c=o;o=null,s.next(c)}};function l(){var c=r+e,d=t.now();if(d<c){n=this.schedule(void 0,c-d),s.add(n);return}a()}i.subscribe(Vh(s,function(c){o=c,r=t.now(),n||(n=t.schedule(l,e),s.add(n))},function(){a(),s.complete()},void 0,function(){o=n=null}))})}function s1(e,t){return t===void 0&&(t=KE),e=e??n1,Uf(function(i,s){var n,o=!0;i.subscribe(Vh(s,function(r){var a=t(r);(o||!e(n,a))&&(o=!1,n=a,s.next(r))}))})}function n1(e,t){return e===t}const o1=e=>e;function QE(e){const t=e-1;return t*t*t+1}function P0(e){const t=typeof e=="string"&&e.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[e,"px"]}function r1(e,{delay:t=0,duration:i=400,easing:s=o1}={}){const n=+getComputedStyle(e).opacity;return{delay:t,duration:i,easing:s,css:o=>`opacity: ${o*n}`}}function a1(e,{delay:t=0,duration:i=400,easing:s=QE,x:n=0,y:o=0,opacity:r=0}={}){const a=getComputedStyle(e),l=+a.opacity,c=a.transform==="none"?"":a.transform,d=l*(1-r),[h,u]=P0(n),[f,p]=P0(o);return{delay:t,duration:i,easing:s,css:(m,v)=>`
			transform: ${c} translate(${(1-m)*h}${u}, ${(1-m)*f}${p});
			opacity: ${l-d*v}`}}function l1(e,{delay:t=0,duration:i=400,easing:s=QE,start:n=0,opacity:o=0}={}){const r=getComputedStyle(e),a=+r.opacity,l=r.transform==="none"?"":r.transform,c=1-n,d=a*(1-o);return{delay:t,duration:i,easing:s,css:(h,u)=>`
			transform: ${l} scale(${1-c*u});
			opacity: ${a-d*u}
		`}}function c1(e,t){return{delay:(t==null?void 0:t.delay)||0,duration:(t==null?void 0:t.duration)||300,css:(i,s)=>{const n=r1(e,t).css(i,s),o=l1(e,t).css(i,s);return`${n}; ${o}`}}}var d1=J('<li class="px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 cursor-pointer"> </li>'),h1=J('<ul class="mt-4 max-h-60 overflow-y-auto divide-y divide-gray-100 dark:divide-gray-700"></ul>'),u1=J('<div class="mt-4 text-center text-gray-400">KhÃ´ng cÃ³ káº¿t quáº£.</div>'),g1=J('<div class="fixed inset-0 bg-black/40 z-40"></div> <div class="fixed top-[20%] left-1/2 -translate-x-1/2 z-50 bg-white dark:bg-zinc-900 w-full max-w-md rounded-xl shadow-xl p-4"><input type="text" placeholder="Search..." class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring"/> <!></div>',1);function f1(e,t){ot(t,!1);let i=re(!1),s=re(),n=re([]),o;function r(){G(i,!0),G(n,[]),setTimeout(()=>{var u;return(u=R(s))==null?void 0:u.focus()},0)}function a(){G(i,!1),o==null||o.unsubscribe()}async function l(u){console.log("ð Gá»i server vá»i query:",u);try{const p=await(await fetch("https://jsonplaceholder.typicode.com/posts")).json();console.log("â Káº¿t quáº£ tá»« server:",p),G(n,p.filter(m=>m.title.toLowerCase().includes(u.toLowerCase())).slice(0,10))}catch(f){console.error("â Lá»i gá»i API:",f),G(n,[])}}Ci(()=>{const u=m=>{(m.metaKey||m.ctrlKey)&&m.key==="k"&&(m.preventDefault(),r()),m.key==="Escape"&&a()};window.addEventListener("keydown",u);const f=()=>{R(s)&&(o=ww(R(s),"input").pipe(Wy(m=>m.target.value.trim()),t1(m=>m.length>0),i1(500),s1()).subscribe(m=>{l(m)}))},p=setInterval(()=>{R(i)&&R(s)&&(f(),clearInterval(p))},100);return()=>{window.removeEventListener("keydown",u),o==null||o.unsubscribe()}}),lt();var c=xe(),d=ce(c);{var h=u=>{var f=g1(),p=ce(f),m=L(p,2),v=I(m);ji(v,b=>G(s,b),()=>R(s));var C=L(v,2);{var w=b=>{var E=h1();Ai(E,5,()=>R(n),gs,(A,P)=>{var T=d1(),D=I(T);Me(()=>Be(D,R(P).title)),O(A,T)}),O(b,E)},S=b=>{var E=u1();O(b,E)};ye(C,b=>{R(n).length>0?b(w):b(S,!1)})}Y("click",p,a),DE(3,m,()=>c1,()=>({duration:300})),Y("click",m,Gh(()=>{})),O(u,f)};ye(d,u=>{R(i)&&u(h)})}O(e,c),rt()}function cp(e){if(!(e!=null&&e.endsWith("px")))return;const t=parseFloat(e.slice(0,e.length-2));return isNaN(t)?void 0:t}const JE=e=>e?"height":"width",bw=e=>window.getComputedStyle(e),yw=e=>e.getBoundingClientRect(),p1=(e,t=!0)=>{if(e.getPropertyValue("box-sizing")==="border-box")return;const i=cp(e.getPropertyValue("border-left-width"));if(i===void 0){console.error("Splitpanes Error: Fail to parse container `border-left-width`.");return}const s=cp(e.getPropertyValue("border-top-width"));if(s===void 0){console.error("Splitpanes Error: Fail to parse container `border-top-width`.");return}const n={left:i,top:s};if(t){const o=cp(e.getPropertyValue("border-right-width"));if(o===void 0){console.error("Splitpanes Error: Fail to parse container `border-right-width`.");return}const r=cp(e.getPropertyValue("border-bottom-width"));if(r===void 0){console.error("Splitpanes Error: Fail to parse container `border-bottom-width`.");return}const a=n;a.right=o,a.bottom=r}return n};function m1(e,t){t||(t=bw(e));const i=yw(e),s=p1(t,!0)||{left:0,top:0,right:0,bottom:0};return{width:i.width-s.left-s.right,height:i.height-s.top-s.bottom,left:i.left+s.left,top:i.top+s.top}}const T0=(e,t)=>({left:e.left-t.left,top:e.top-t.top});function D0(e){const t=e,i=e,{clientX:s,clientY:n}="ontouchstart"in window&&i.touches?i.touches[0]:t;return{left:s,top:n}}function M0(e,t,i,s){let n=0;for(let o=t;o<i;o++)n+=s(e[o],o);return n}function dp(e,t,i,s){for(let n=t;n<i;n++)s(e[n],n)}const ZE={},I0=(()=>{let e=!1;try{const t=Object.defineProperty({},"passive",{get(){return e={passive:!0},!0}});window.addEventListener("testpassive",t,t),window.remove("testpassive",t,t)}catch{}return e})();var v1=J("<div><!> <!></div>");function C1(e,t){ot(t,!1);const i=()=>mt(M,"$veryFirstPaneKey",s),[s,n]=Ln();let o=ge(t,"id",8,void 0),r=ge(t,"horizontal",8,!1),a=ge(t,"pushOtherPanes",8,!0),l=ge(t,"dblClickSplitter",8,!0),c=ge(t,"rtl",8,"auto"),d=ge(t,"firstSplitter",8,!1),h=ge(t,"style",8,null),u=ge(t,"theme",8,"default-theme"),f=ge(t,"class",8,"");const p=kE();let m=re(),v=!1,C=!1,w=re(!1),S=re(!1),b=re(!1),E=-1,A=-1,P,T=new Array;const D=ri(r()),N=ri(d()),M=ri(void 0);let _,W;UM(ZE,{showFirstSplitter:N,veryFirstPaneKey:M,isHorizontal:D,ssrRegisterPaneSize:void 0,onPaneInit:Q=>(i()===void 0&&$r(M,Q),{undefinedPaneInitSize:0}),clientOnly:{onPaneAdd:B,onPaneRemove:q}});function B(Q){let k=-1;Q.element.parentNode&&Array.from(Q.element.parentNode.children).some(K=>(K.className.includes("splitpanes__pane")&&k++,K===Q.element)),k===0&&$r(M,Q.key),T.splice(k,0,Q);for(let K=0;K<T.length;K++)T[K].index=K;v&&it().then(()=>{Q.isReady=!0,p("pane-add",{index:k,panes:tt()})});const z=(K,me=!0)=>he=>{(me||Q.index>0)&&K(he,Q)};return{onSplitterDown:z(Oe,!1),onSplitterClick:z(Ne,!1),onSplitterDblClick:z(Se),onPaneClick:z(X),reportGivenSizeChange:z(U)}}async function q(Q){const k=T.findIndex(z=>z.key===Q);if(k>=0){const z=T.splice(k,1)[0];for(let K=0;K<T.length;K++)T[K].index=K;k===0&&$r(M,T.length>0?T[0].key:void 0),v&&(await it(),p("pane-remove",{removed:z,panes:tt()}))}}function X(Q,k){p("pane-click",k)}function U(Q,k){k.setSz(Q),it()}Ci(()=>{_e(),Cs();for(let Q=0;Q<T.length;Q++)T[Q].isReady=!0;v=!0,p("ready"),setTimeout(()=>{G(w,!0)},0)}),_r(()=>{v&&Ce(),v=!1}),My(()=>{_e()});function pe(Q){if(c()==="auto")try{return(Q??bw(R(m))).direction==="rtl"}catch{}return c()===!0}function Ee(){document.body.style.cursor=D?"col-resize":"row-resize",document.addEventListener("mousemove",Z,I0),document.addEventListener("mouseup",we),"ontouchstart"in window&&(document.addEventListener("touchmove",Z,I0),document.addEventListener("touchend",we))}function Ce(){document.body.style.cursor="",document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",we),"ontouchstart"in window&&(document.removeEventListener("touchmove",Z),document.removeEventListener("touchend",we))}const le=Q=>Q.nodeType===Node.ELEMENT_NODE&&Q.classList.contains("splitpanes__splitter");function ee(Q,k,z){let K=Q[r()?"top":"left"];return z&&!r()&&(K=k-K),K}const ve=()=>JE(r());function Oe(Q,k){G(S,!0),E=k.index,k.setSplitterActive(!0);let K=k.element;for(;K&&(K=K.previousSibling,!(K&&le(K))););if(K===null){console.error("Splitpane Error: Active splitter wasn't found!");return}_=K;const me=D0(Q),he=yw(_);W=ee(T0(me,he),he[ve()],pe()),Ee()}function Z(Q){if(R(S)){G(b,!0);const k=D0(Q),z=bw(R(m)),K=m1(R(m),z),me=K[ve()],he=pe(z),te=T0(k,K),ue=ee(te,me,he);St(ue,me),p("resize",tt())}}function we(){R(b)&&p("resized",tt()),G(S,!1),T[E].setSplitterActive(!1),setTimeout(()=>{G(b,!1),Ce()},100)}function Ne(Q,k){if("ontouchstart"in window){const z=k.index;l()&&(A===z?(P&&clearTimeout(P),P=null,Se(Q,k),A=-1):(A=z,P=setTimeout(()=>{A=-1},500)))}R(b)||p("splitter-click",k)}function Se(Q,k){if(l()){const z=k.index;let K=0;for(let te=0;te<T.length;te++){const ue=T[te];te!==z&&(K+=ue.min())}const me=Math.min(Math.max(0,100-K),k.max()),he=K+me;if(he>=100)for(let te=0;te<T.length;te++){const ue=T[te];ue!==k?ue.setSz(ue.min()):ue.setSz(100-K)}else{let te=100-he;k.setSz(me);const ue=De=>{const Ke=De.min(),ai=De.max(),Vt=Math.min(Math.max(0,te),ai-Ke);De.setSz(Ke+Vt),te-=Vt};for(let De=z-1;De>=0;De--)ue(T[De]);for(let De=z+1;De<T.length;De++)ue(T[De]);te!==0&&console.warn("Splitpanes: there is a left spare size after computation of splitter double click, which means there are issues on the size constains of the panes.")}p("pane-maximize",k),p("resized",tt())}G(S,!1)}const tt=()=>T.map(Q=>({min:Q.min(),max:Q.max(),size:Q.sz(),snap:Q.snap()}));function Mt(Q,k){const z=ai=>yw(ai)[ve()],K=z(_);let me=0,he=_.previousSibling;for(;he;)le(he)&&(me+=z(he)),he=he.previousSibling;let te=0,ue=_.nextSibling;for(;ue;)le(ue)&&(te+=z(ue)),ue=ue.nextSibling;const De=me+W,Ke=me+K+te;return(Q-De)/(k-Ke)*100}function St(Q,k){let z=E-1,K=T[z],me=E,he=T[me],te={prevPanesSize:wi(z),nextPanesSize:Ie(me),prevReachedMinPanes:0,nextReachedMinPanes:0};const ue=0+(a()?0:te.prevPanesSize),De=100-(a()?0:te.nextPanesSize),Ke=Math.max(Math.min(Mt(Q,k),De),ue),ai=te.prevPanesSize+K.min()+K.snap(),Vt=100-(te.nextPanesSize+he.min()+he.snap());let nt=Ke,Hs=!1;Ke<=ai?Ke>te.prevPanesSize+K.min()&&(nt=Math.max(K.min()+te.prevPanesSize,100-(he.max()+te.nextPanesSize)),Hs=!0):Ke>=Vt&&Ke<100-te.nextPanesSize-he.min()&&(nt=Math.min(100-(he.min()+te.nextPanesSize),K.max()+te.prevPanesSize),Hs=!0);const Yc=K.max()<100&&nt>=K.max()+te.prevPanesSize,Xv=he.max()<100&&nt<=100-(he.max()+te.nextPanesSize);if(Yc||Xv)Yc?(K.setSz(K.max()),he.setSz(Math.max(100-K.max()-te.prevPanesSize-te.nextPanesSize,0))):(K.setSz(Math.max(100-he.max()-te.prevPanesSize-te.nextPanesSize,0)),he.setSz(he.max()));else{if(a()&&!Hs){const Mo=qt(te,nt);if(!Mo)return;({sums:te,paneBeforeIndex:z,paneAfterIndex:me}=Mo),K=T[z],he=T[me]}typeof z=="number"&&K.setSz(Math.min(Math.max(nt-te.prevPanesSize-te.prevReachedMinPanes,K.min()),K.max())),typeof me=="number"&&he.setSz(Math.min(Math.max(100-nt-te.nextPanesSize-te.nextReachedMinPanes,he.min()),he.max()))}}function qt(Q,k){var he,te;const z=E-1;let K=z,me=z+1;if(k<Q.prevPanesSize+T[K].min()){if(K=(he=Rt(z))==null?void 0:he.index,Q.prevReachedMinPanes=0,K===void 0)return Q.prevPanesSize=0,T[0].setSz(T[0].min()),dp(T,1,z+1,ue=>{ue.setSz(ue.min()),Q.prevReachedMinPanes+=ue.min()}),T[me].setSz(100-Q.prevReachedMinPanes-T[0].min()-Q.prevPanesSize-Q.nextPanesSize),null;K<z&&dp(T,K+1,z+1,ue=>{ue.setSz(ue.min()),Q.prevReachedMinPanes+=ue.min()}),Q.prevPanesSize=wi(K)}if(k>100-Q.nextPanesSize-T[me].min())if(me=(te=Le(z))==null?void 0:te.index,K===void 0&&console.log("Yep undefined paneAfterIndex"),Q.nextReachedMinPanes=0,me===void 0){Q.nextPanesSize=0;const ue=T.length;return T[ue-1].setSz(T[ue-1].min()),dp(T,z+1,ue-1,De=>{De.setSz(De.min()),Q.nextReachedMinPanes+=De.min()}),T[K].setSz(100-Q.prevPanesSize-Q.nextReachedMinPanes-T[ue-1].min()-Q.nextPanesSize),null}else me>z+1&&dp(T,z+1,me,ue=>{ue.setSz(ue.min()),Q.nextReachedMinPanes+=ue.min()}),Q.nextPanesSize=Ie(me);return{sums:Q,paneBeforeIndex:K,paneAfterIndex:me}}const Ht=Q=>Q.sz(),wi=Q=>M0(T,0,Q,Ht),Ie=Q=>M0(T,Q+1,T.length,Ht),Rt=Q=>[...T].reverse().find(k=>k.index<Q&&k.sz()>k.min()),Le=Q=>T.find(k=>k.index>Q+1&&k.sz()>k.min());async function it(){C=!0,await Fc(),C&&(Cs(),C=!1)}function Cs(){Nn(),v&&p("resized",tt())}function Nn(){if(T.length===0)return;const Q=T.length;let k=100,z=0,K=0,me=0;const he=[],te=[];for(let Vt=0;Vt<Q;Vt++){const nt=T[Vt],Hs=nt.sz();nt.givenSize===null?nt.isReady?(me+=Hs,Hs>=nt.max()&&he.push(nt),Hs<=nt.min()&&te.push(nt)):K+=1:(k-=Hs,z++,he.push(nt),te.push(nt))}const ue=Q-z,De=ue-K;let Ke,ai;if(De>0?(Ke=me/De,Ke>.1&&k>.1?(me+=K*Ke,ai=k/me):(Ke=0,ai=1)):(Ke=k/ue,ai=1),k+me>.1){k=100;for(let Vt=0;Vt<Q;Vt++){const nt=T[Vt];if(typeof nt.givenSize!="number"){const Hs=nt.isReady?nt.sz():Ke,Yc=Math.max(Math.min(Hs*ai,nt.max()),nt.min());nt.setSz(Yc)}k-=nt.sz()}Math.abs(k)>.1&&(k=oe(k,he,te))}isFinite(k)?Math.abs(k)>.1&&console.warn("Splitpanes: Could not resize panes correctly due to their constraints."):console.warn("Splitpanes: Internal error, sizes might be NaN as a result.")}function oe(Q,k,z){const me=T.length-(Q>0?k.length:z.length);if(me<=0)return Q;const he=Q/me;if(T.length===1)T[0].setSz(100),Q=0;else for(let te=0;te<T.length;te++){const ue=T[te],De=ue.sz();if(Q>0&&!k.includes(ue)){const Ke=Math.max(Math.min(De+he,ue.max()),ue.min()),ai=Ke-De;Q-=ai,ue.setSz(Ke)}else if(!z.includes(ue)){const Ke=Math.max(Math.min(De+he,ue.max()),ue.min()),ai=Ke-De;Q-=ai,ue.setSz(Ke)}}return Q}function _e(){var K;if(!R(m))return;const{children:Q}=R(m);let k=0,z=!1;for(let me=0;me<Q.length;me++){const he=Q.item(me),te=he.classList.contains("splitpanes__pane"),ue=he.classList.contains("splitpanes__splitter");if(!te&&!ue){(K=he.parentNode)==null||K.removeChild(he),console.warn("Splitpanes: Only <Pane> elements are allowed at the root of <Splitpanes>. One of your DOM nodes was removed.");return}else te&&(!z&&T[k].element!==he&&(z=!0),k++)}if(z){const me=[];for(let he=0;he<Q.length;he++){const te=Q.item(he);if(te==null?void 0:te.classList.contains("splitpanes__pane")){const De=T.find(Ke=>Ke.element===te);De?(De.index=me.length,me.push(De)):console.warn("Splitpanes: Internal error - found a <Pane> elements which isn't tracked.")}}T=me,$r(M,T.length>0?T[0].key:void 0)}}Ti(()=>Re(r()),()=>{$r(D,r())}),Ti(()=>Re(d()),()=>{$r(N,d())}),Po(),lt();var st=v1();let Bt;var Hn=I(st);ye(Hn,Q=>{});var Gn=L(Hn,2);We(Gn,t,"default",{}),ji(st,Q=>G(m,Q),()=>R(m)),Me(()=>{fi(st,"id",o()),Bt=$i(st,1,`splitpanes ${u()||""} ${f()||""}`,null,Bt,{"splitpanes--horizontal":r(),"splitpanes--vertical":!r(),"splitpanes--dragging":R(S)||R(b),"splitpanes--freeze":!R(w)}),ja(st,h())}),O(e,st),rt(),n()}const w1=(e,t)=>i=>{const s=e();s!==null&&s[t](i)},b1=e=>w1.bind(null,e);var y1=J("<div></div>"),S1=J("<!>   <div><!></div>",1);function R1(e,t){ot(t,!1);const i=()=>mt(u,"$isHorizontal",o),s=()=>mt(p,"$veryFirstPaneKey",o),n=()=>mt(f,"$showFirstSplitter",o),[o,r]=Ln(),a=re(),l=re(),{ssrRegisterPaneSize:c,onPaneInit:d,clientOnly:h,isHorizontal:u,showFirstSplitter:f,veryFirstPaneKey:p}=$M(ZE);let m=ge(t,"size",12,null),v=ge(t,"minSize",8,0),C=ge(t,"maxSize",8,100),w=ge(t,"snapSize",8,0),S=ge(t,"class",8,"");const b={},{undefinedPaneInitSize:E}=d(b);let A=re(),P=re(m()??E),T=re(!1),D;const N=b1(()=>D),M=B=>{D&&B!=R(P)&&(N==null||N("reportGivenSizeChange")(B))};Ci(()=>{const B={index:0,key:b,element:R(A),givenSize:m(),sz:()=>R(P),setSz:q=>{G(P,q),typeof m()=="number"&&m()!==R(P)&&m(R(P))},min:()=>v(),max:()=>C(),snap:()=>w(),setSplitterActive:q=>{G(T,q)},isReady:!1};D=h==null?void 0:h.onPaneAdd(B)}),_r(()=>{h==null||h.onPaneRemove(b)}),Ti(()=>Re(m()),()=>{typeof m()=="number"&&M(m())}),Ti(()=>i(),()=>{G(a,JE(i()))}),Ti(()=>(R(a),R(P)),()=>{G(l,`${R(a)}: ${R(P)}%;`)}),Po(),lt();var _=xe(),W=ce(_);{var $=B=>{var q=S1(),X=ce(q);{var U=le=>{var ee=y1(),ve=al(()=>N==null?void 0:N("onSplitterDown")),Oe=al(()=>N==null?void 0:N("onSplitterDown")),Z=al(()=>N==null?void 0:N("onSplitterClick")),we=al(()=>N==null?void 0:N("onSplitterDblClick"));Me(()=>$i(ee,1,`splitpanes__splitter ${R(T)?"splitpanes__splitter__active":""}`)),Y("mousedown",ee,function(...Ne){var Se;(Se=R(ve))==null||Se.apply(this,Ne)}),Y("touchstart",ee,function(...Ne){var Se;(Se=R(Oe))==null||Se.apply(this,Ne)}),Y("click",ee,function(...Ne){var Se;(Se=R(Z))==null||Se.apply(this,Ne)}),Y("dblclick",ee,function(...Ne){var Se;(Se=R(we))==null||Se.apply(this,Ne)}),O(le,ee)};ye(X,le=>{(s()!==b||n())&&le(U)})}var pe=L(X,2),Ee=al(()=>N==null?void 0:N("onPaneClick")),Ce=I(pe);We(Ce,t,"default",{}),ji(pe,le=>G(A,le),()=>R(A)),Me(()=>{$i(pe,1,`splitpanes__pane ${S()||""}`),ja(pe,R(l))}),Y("click",pe,function(...le){var ee;(ee=R(Ee))==null||ee.apply(this,le)}),O(B,q)};ye(W,B=>{B($)})}O(e,_),rt(),r()}function lC(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]),s=et(i,["key","horizontal","defaultSizes","prefix"]);ot(t,!1);let n=ge(t,"key",8,""),o=ge(t,"horizontal",8,!1),r=ge(t,"defaultSizes",24,()=>[]),a=ge(t,"prefix",8,"layout__"),l=re([]),c=`${a()}${n()}`;Ci(()=>{const h=localStorage.getItem(c);if(h)try{G(l,JSON.parse(h))}catch{G(l,r())}else G(l,r())});const d=h=>{const u=h.detail,f=Array.isArray(u)&&(u==null?void 0:u.map(p=>({...p,size:Number.isFinite(p.size)?Math.round(p.size):p.size,snapSize:Math.round(p.size/2)})));localStorage.setItem(c,JSON.stringify(f))};lt(),C1(e,bt({get horizontal(){return o()}},()=>s,{$$events:{resize:d},children:(h,u)=>{var f=xe(),p=ce(f);We(p,t,"default",{get paneSizes(){return R(l)}}),O(h,f)},$$slots:{default:!0}})),rt()}function Io(e,t){const i=et(t,["children","$$slots","$$events","$$legacy"]),s=et(i,["index","paneSizes"]);ot(t,!1);let n=ge(t,"index",8,0),o=ge(t,"paneSizes",24,()=>[]);lt(),R1(e,bt(()=>o()[n()],()=>s,{children:(r,a)=>{var l=xe(),c=ce(l);We(c,t,"default",{}),O(r,l)},$$slots:{default:!0}})),rt()}const Rm={vi:{today:"HÃ´m nay",yesterday:"HÃ´m qua",weekdays:{0:"CN",1:"T2",2:"T3",3:"T4",4:"T5",5:"T6",6:"T7"}},en:{today:"Today",yesterday:"Yesterday"}};function Ta(e){return String(e).padStart(2,"0")}function k0(e,t="vi"){if(!e)return"";const i=new Date(e);if(isNaN(i.getTime()))return"";const s=new Date,n=Rm[t]??Rm.vi,o=i.getFullYear()===s.getFullYear(),r=p=>`${p.getFullYear()}-${Ta(p.getMonth()+1)}-${Ta(p.getDate())}`,a=r(s),l=r(new Date(s.getFullYear(),s.getMonth(),s.getDate()-1)),c=r(i),d=Ta(i.getDate()),h=Ta(i.getMonth()+1),u=i.getFullYear(),f=t==="vi"?n.weekdays[i.getDay()]:i.toLocaleDateString(t,{weekday:"short"});return c===a?`${n.today}, ${d}/${h}`:c===l?`${n.yesterday}, ${f}, ${d}/${h}`:o?`${f}, ${d}/${h}`:`${f}, ${d}/${h}/${u}`}function _0(e,t="vi"){if(!e)return"";const i=new Date(e);if(isNaN(i.getTime()))return"";const s=new Date,n=Rm[t]??Rm.vi,o=u=>`${u.getFullYear()}-${Ta(u.getMonth()+1)}-${Ta(u.getDate())}`,r=o(s),a=o(new Date(s.getFullYear(),s.getMonth(),s.getDate()-1)),l=o(i),c=Ta(i.getHours()),d=Ta(i.getMinutes()),h=`${c}:${d}`;return l===r?h:l===a?`${n.yesterday}, ${h}`:h}function xm(e,t){if(!e||!t)return!0;const i=new Date(e),s=new Date(t);return isNaN(i.getTime())||isNaN(s.getTime())?!0:i.getFullYear()!==s.getFullYear()||i.getMonth()!==s.getMonth()||i.getDate()!==s.getDate()}var x1=J('<div class="flex items-center justify-center my-3"><span class="px-3 py-[2px] text-xs rounded-full bg-gray-200 text-gray-600"> </span></div>');function eA(e,t){ot(t,!1);let i=ge(t,"time",8),s=ge(t,"locale",8,"vi");lt();var n=x1(),o=I(n),r=I(o);Me(a=>Be(r,a),[()=>(Re(k0),Re(i()),Re(s()),ie(()=>k0(i(),s())))]),O(e,n),rt()}var E1=J('<button class="btn nav left svelte-4w3r7p">â¹</button>'),A1=J('<button class="btn nav right svelte-4w3r7p">âº</button>'),F1=J("<img/>"),P1=J('<div class="overlay svelte-4w3r7p"><div class="viewer svelte-4w3r7p"><img draggable="false"/> <button class="btn close svelte-4w3r7p">â</button> <!> <!> <div class="toolbox svelte-4w3r7p"><button class="svelte-4w3r7p">ð¤ Share</button> <button class="svelte-4w3r7p">â¬ï¸ Download</button> <button class="svelte-4w3r7p">ð Open</button></div> <div class="meta svelte-4w3r7p"><strong>ð· ThÃ´ng tin</strong> <br/> <br/> <!></div> <div class="counter svelte-4w3r7p"> </div> <div class="thumb-wrap svelte-4w3r7p"></div></div></div>');function T1(e,t){ot(t,!1);let i=ge(t,"images",24,()=>[]),s=ge(t,"index",12,0),n=ge(t,"onClose",8,()=>{}),o=re(1),r=re(0),a=re(0),l=!1,c,d,h=0,u=1,f=0;const p=130;let m=0,v=0,C=re({width:0,height:0,size:null});function w(oe){const _e=new Image;_e.onload=()=>{Ji(C,R(C).width=_e.width),Ji(C,R(C).height=_e.height)},_e.src=oe,fetch(oe,{method:"HEAD"}).then(st=>{const Bt=st.headers.get("content-length");Bt&&Ji(C,R(C).size=S(parseInt(Bt)))}).catch(()=>{})}function S(oe){const _e=["B","KB","MB","GB"],st=Math.floor(Math.log(oe)/Math.log(1024));return`${(oe/Math.pow(1024,st)).toFixed(1)} ${_e[st]}`}let b=re("zoom-in"),E=re();function A(){if(!R(E))return;const oe=R(E).querySelector(`.thumb-${s()}`);oe&&oe.scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})}function P(){s()<i().length-1&&(D("left"),m0(s),Ee())}function T(){s()>0&&(D("right"),m0(s,-1),Ee())}function D(oe){G(b,oe==="left"?"slide-left":"slide-right"),setTimeout(()=>G(b,""),250)}function N(oe){G(o,R(o)+oe.deltaY*-.002),G(o,Math.min(Math.max(R(o),1),4))}function M(oe){R(o)<2?G(o,2):R(o)<4?G(o,4):Ee();const _e=oe.target.getBoundingClientRect();G(r,(_e.width/2-(oe.clientX-_e.left))*(R(o)-1)),G(a,(_e.height/2-(oe.clientY-_e.top))*(R(o)-1))}function _(oe){const _e=oe.touches?oe.touches[0]:oe;R(o)===1&&(m=performance.now(),v=_e.clientY),l=!0,c=_e.clientX-R(r),d=_e.clientY-R(a)}function W(oe){if(!l)return;const _e=oe.touches?oe.touches[0]:oe;if(G(r,_e.clientX-c),G(a,_e.clientY-d),R(o)===1){const st=performance.now(),Bt=st-m,Hn=_e.clientY-v;Bt>0&&Math.abs(Hn/Bt*1e3)>p&&(G(b,"swipe-close"),setTimeout(n(),150)),m=st,v=_e.clientY}}function $(){l=!1}function B(oe){const _e=oe.touches?oe.touches[0]:oe;h=_e.clientX,_e.clientY}function q(oe){const st=(oe.changedTouches?oe.changedTouches[0]:oe).clientX-h;R(o)===1&&Math.abs(st)>60&&(st<0?P():T())}function X(oe){oe.touches.length<2||(f=pe(oe.touches),u=R(o))}function U(oe){if(oe.touches.length<2)return;const _e=pe(oe.touches);G(o,Math.min(Math.max(u*(_e/f),1),4))}function pe(oe){return Math.hypot(oe[0].clientX-oe[1].clientX,oe[0].clientY-oe[1].clientY)}function Ee(){G(o,1),G(r,G(a,0))}function Ce(){navigator.share?navigator.share({url:i()[s()]}):window.open(i()[s()],"_blank")}function le(){const oe=document.createElement("a");oe.href=i()[s()],oe.download=`photo-${s()+1}`,oe.click()}Ti(()=>(Re(i()),Re(s())),()=>{w(i()[s()])}),Ti(()=>{},()=>{A()}),Po(),lt();var ee=P1(),ve=I(ee),Oe=I(ve),Z=L(Oe,2),we=L(Z,2);{var Ne=oe=>{var _e=E1();Y("click",_e,T),O(oe,_e)};ye(we,oe=>{s()>0&&oe(Ne)})}var Se=L(we,2);{var tt=oe=>{var _e=A1();Y("click",_e,P),O(oe,_e)};ye(Se,oe=>{Re(s()),Re(i()),ie(()=>s()<i().length-1)&&oe(tt)})}var Mt=L(Se,2),St=I(Mt),qt=L(St,2),Ht=L(qt,2),wi=L(Mt,2),Ie=L(I(wi),3),Rt=L(Ie,3);{var Le=oe=>{var _e=yE();Me(()=>Be(_e,`Size: ${R(C),ie(()=>R(C).size)??""}`)),O(oe,_e)};ye(Rt,oe=>{R(C),ie(()=>R(C).size)&&oe(Le)})}var it=L(wi,2),Cs=I(it),Nn=L(it,2);Ai(Nn,5,i,gs,(oe,_e,st)=>{var Bt=F1();Me(()=>{fi(Bt,"src",R(_e)),$i(Bt,1,`thumb thumb-${st} ${s()===st?"active":""}`,"svelte-4w3r7p")}),Y("click",Bt,()=>{s(st),Ee()}),O(oe,Bt)}),ji(Nn,oe=>G(E,oe),()=>R(E)),Me(()=>{fi(Oe,"src",(Re(i()),Re(s()),ie(()=>i()[s()]))),$i(Oe,1,`main-img ${R(b)??""}`,"svelte-4w3r7p"),ja(Oe,`transform: translate(${R(r)??""}px, ${R(a)??""}px) scale(${R(o)??""});`),Be(Ie,` Resolution: ${R(C),ie(()=>R(C).width)??""}Ã${R(C),ie(()=>R(C).height)??""} `),Be(Cs,`${s()+1} / ${Re(i()),ie(()=>i().length)??""}`)}),Y("dblclick",Oe,M),Y("click",Z,()=>n()()),Y("click",St,Ce),Y("click",qt,le),Y("click",Ht,()=>window.open(i()[s()],"_blank")),Y("click",ve,Gh(function(oe){Pv.call(this,t,oe)})),Y("wheel",ve,N),Y("mousedown",ve,_),Y("mousemove",ve,W),Y("mouseup",ve,$),Y("mouseleave",ve,$),Y("touchstart",ve,oe=>{B(oe),X(oe)}),Y("touchmove",ve,oe=>U(oe)),Y("touchend",ve,q),Y("click",ee,()=>n()()),O(e,ee),rt()}function D1(e){return--e*e*e*e*e+1}var M1=J('<div class="absolute bottom-8 pointer-events-none z-50"><span class="text-4xl drop-shadow-xl"> </span></div>'),I1=J('<button class="text-2xl hover:scale-150 transition-transform duration-200 active:scale-190"> </button>'),k1=J("<div></div>"),_1=J(`<div class="relative inline-block"><!> <button class="text-[12px] bg-gray-200 dark:bg-gray-600
           px-1.5 py-0.5 rounded-full
           hover:scale-110 transition">ð</button> <!></div>`);function L1(e,t){ot(t,!1);let i=ge(t,"fromMe",8,!1),s=ge(t,"messageId",8),n=ge(t,"reactions",24,()=>["ð","â¤ï¸","ð","ð®","ð¢","ð¡"]),o=ge(t,"effect",8,"fly-one"),r=ge(t,"onSelect",8,()=>{}),a=re(!1),l=re(!1),c=re([]);function d(P){if(o()!=="simple"){if(o()==="fly-one"&&u(P),o()==="fly-multi"){const T=6+Math.floor(Math.random()*4);for(let D=0;D<T;D++)setTimeout(()=>u(P),D*70)}if(o()==="center-rise"&&u(P,{x:h(),y:160}),o()==="spread"&&[-40,-20,0,20,40].forEach((T,D)=>{setTimeout(()=>u(P,{x:T,y:140}),D*60)}),o()==="burst")for(let T=0;T<8;T++)u(P,{x:i()?-(10+Math.random()*40):10+Math.random()*40,y:120+Math.random()*80,scale:.7+Math.random()*.6})}}function h(){return i()?-40:0}function u(P,T={}){const D=Date.now()+Math.random();G(c,[...R(c),{id:D,emoji:P,x:T.x??f(),y:T.y??p(),scale:T.scale??m()}])}function f(){return i()?-(10+Math.random()*40):10+Math.random()*40}function p(){return 130+Math.random()*50}function m(){return .8+Math.random()*.5}function v(P){G(c,R(c).filter(T=>T.id!==P))}function C(P){r()({messageId:s(),reaction:P}),d(P),G(a,!1)}lt();var w=_1(),S=I(w);Ai(S,1,()=>R(c),P=>P.id,(P,T)=>{var D=M1(),N=I(D),M=I(N);Me(()=>{ja(D,`
    ${i()?"right: 24px;":"left: 24px;"}
    transform: translateX(${R(T),ie(()=>R(T).x)??""}px) scale(${R(T),ie(()=>R(T).scale)??""});
    opacity: 0.95;
  `),Be(M,(R(T),ie(()=>R(T).emoji)))}),Y("introend",D,()=>v(R(T).id)),DE(3,D,()=>a1,()=>({y:-R(T).y,duration:900,easing:D1})),O(P,D)});var b=L(S,2);b.__click=P=>{P.stopPropagation(),G(a,!R(a))};var E=L(b,2);{var A=P=>{var T=k1();let D;Ai(T,5,n,gs,(N,M)=>{var _=I1();_.__click=()=>C(R(M));var W=I(_);Me(()=>Be(W,R(M))),O(N,_)}),Me(()=>D=$i(T,1,`absolute bottom-full translate-y-1
        ${i()?"right-0 origin-bottom-right":"left-0 origin-bottom-left"}
        flex gap-2 bg-white dark:bg-gray-700
        border border-gray-300 dark:border-gray-600
        rounded-full px-3 py-2 shadow-xl z-50
        scale-0 transition-transform duration-150`,null,D,{"scale-100":R(a)||R(l)})),Y("mouseenter",T,()=>G(a,!0)),Y("mouseleave",T,()=>G(a,!1)),O(P,T)};ye(E,P=>{(R(l)||R(a))&&P(A)})}Y("mouseenter",w,()=>G(l,!0)),Y("mouseleave",w,()=>{G(l,!1),G(a,!1)}),O(e,w),rt()}Fv(["click"]);var Gu={};Gu.d=(e,t)=>{for(var i in t)Gu.o(t,i)&&!Gu.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})};Gu.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Ge=globalThis.pdfjsLib={};Gu.d(Ge,{AbortException:()=>Wc,AnnotationEditorLayer:()=>Ib,AnnotationEditorParamsType:()=>He,AnnotationEditorType:()=>ze,AnnotationEditorUIManager:()=>Tc,AnnotationLayer:()=>kO,AnnotationMode:()=>qr,ColorPicker:()=>Pm,DOMSVGFactory:()=>tS,DrawLayer:()=>Ob,FeatureTest:()=>es,GlobalWorkerOptions:()=>fr,ImageKind:()=>Dp,InvalidPDFException:()=>iA,MissingPDFException:()=>zc,OPS:()=>hn,OutputScale:()=>Aw,PDFDataRangeTransport:()=>JA,PDFDateString:()=>qy,PDFWorker:()=>bd,PasswordResponses:()=>G1,PermissionFlag:()=>H1,PixelsPerInch:()=>Oa,RenderingCancelledException:()=>jy,TextLayer:()=>ng,UnexpectedResponseException:()=>_v,Util:()=>Ae,VerbosityLevel:()=>Mv,XfaLayer:()=>eF,build:()=>gO,createValidAbsoluteUrl:()=>W1,fetchData:()=>Ov,getDocument:()=>nO,getFilenameFromUrl:()=>J1,getPdfFilenameFromUrl:()=>Z1,getXfaPageViewport:()=>eL,isDataScheme:()=>Nv,isPdfFile:()=>Ky,noContextMenu:()=>on,normalizeUnicode:()=>Y1,setLayerDimensions:()=>Pc,shadow:()=>Qe,version:()=>uO});const Wi=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),tA=[1,0,0,1,0,0],Sw=[.001,0,0,.001,0,0],O1=1e7,cC=1.35,Ds={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},qr={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},N1="pdfjs_internal_editor_",ze={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},He={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},H1={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Li={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Dp={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Jt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},ru={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Mv={ERRORS:0,WARNINGS:1,INFOS:5},hn={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},G1={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Iv=Mv.WARNINGS;function B1(e){Number.isInteger(e)&&(Iv=e)}function V1(){return Iv}function kv(e){Iv>=Mv.INFOS&&console.log(`Info: ${e}`)}function Ue(e){Iv>=Mv.WARNINGS&&console.log(`Warning: ${e}`)}function Et(e){throw new Error(e)}function ni(e,t){e||Et(t)}function z1(e){switch(e==null?void 0:e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function W1(e,t=null,i=null){if(!e)return null;try{if(i&&typeof e=="string"){if(i.addDefaultProtocol&&e.startsWith("www.")){const n=e.match(/\./g);(n==null?void 0:n.length)>=2&&(e=`http://${e}`)}if(i.tryConvertEncoding)try{e=q1(e)}catch{}}const s=t?new URL(e,t):new URL(e);if(z1(s))return s}catch{}return null}function Qe(e,t,i,s=!1){return Object.defineProperty(e,t,{value:i,enumerable:!s,configurable:!0,writable:!1}),i}const Ka=(function(){function t(i,s){this.message=i,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class Rw extends Ka{constructor(t,i){super(t,"PasswordException"),this.code=i}}class xw extends Ka{constructor(t,i){super(t,"UnknownErrorException"),this.details=i}}class iA extends Ka{constructor(t){super(t,"InvalidPDFException")}}class zc extends Ka{constructor(t){super(t,"MissingPDFException")}}class _v extends Ka{constructor(t,i){super(t,"UnexpectedResponseException"),this.status=i}}class $1 extends Ka{constructor(t){super(t,"FormatError")}}class Wc extends Ka{constructor(t){super(t,"AbortException")}}function sA(e){(typeof e!="object"||(e==null?void 0:e.length)===void 0)&&Et("Invalid argument for bytesToString");const t=e.length,i=8192;if(t<i)return String.fromCharCode.apply(null,e);const s=[];for(let n=0;n<t;n+=i){const o=Math.min(n+i,t),r=e.subarray(n,o);s.push(String.fromCharCode.apply(null,r))}return s.join("")}function Lv(e){typeof e!="string"&&Et("Invalid argument for stringToBytes");const t=e.length,i=new Uint8Array(t);for(let s=0;s<t;++s)i[s]=e.charCodeAt(s)&255;return i}function U1(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,e&255)}function $y(e){const t=Object.create(null);for(const[i,s]of e)t[i]=s;return t}function j1(){const e=new Uint8Array(4);return e[0]=1,new Uint32Array(e.buffer,0,1)[0]===1}function K1(){try{return new Function(""),!0}catch{return!1}}class es{static get isLittleEndian(){return Qe(this,"isLittleEndian",j1())}static get isEvalSupported(){return Qe(this,"isEvalSupported",K1())}static get isOffscreenCanvasSupported(){return Qe(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Qe(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):Qe(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var t,i;return Qe(this,"isCSSRoundSupported",(i=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:i.call(t,"width: round(1.5px, 1px)"))}}const dC=Array.from(Array(256).keys(),e=>e.toString(16).padStart(2,"0"));var xr,Mp,Ew;class Ae{static makeHexColor(t,i,s){return`#${dC[t]}${dC[i]}${dC[s]}`}static scaleMinMax(t,i){let s;t[0]?(t[0]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[0],i[2]*=t[0],t[3]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[3],i[3]*=t[3]):(s=i[0],i[0]=i[1],i[1]=s,s=i[2],i[2]=i[3],i[3]=s,t[1]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[1],i[3]*=t[1],t[2]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[2],i[2]*=t[2]),i[0]+=t[4],i[1]+=t[5],i[2]+=t[4],i[3]+=t[5]}static transform(t,i){return[t[0]*i[0]+t[2]*i[1],t[1]*i[0]+t[3]*i[1],t[0]*i[2]+t[2]*i[3],t[1]*i[2]+t[3]*i[3],t[0]*i[4]+t[2]*i[5]+t[4],t[1]*i[4]+t[3]*i[5]+t[5]]}static applyTransform(t,i){const s=t[0]*i[0]+t[1]*i[2]+i[4],n=t[0]*i[1]+t[1]*i[3]+i[5];return[s,n]}static applyInverseTransform(t,i){const s=i[0]*i[3]-i[1]*i[2],n=(t[0]*i[3]-t[1]*i[2]+i[2]*i[5]-i[4]*i[3])/s,o=(-t[0]*i[1]+t[1]*i[0]+i[4]*i[1]-i[5]*i[0])/s;return[n,o]}static getAxialAlignedBoundingBox(t,i){const s=this.applyTransform(t,i),n=this.applyTransform(t.slice(2,4),i),o=this.applyTransform([t[0],t[3]],i),r=this.applyTransform([t[2],t[1]],i);return[Math.min(s[0],n[0],o[0],r[0]),Math.min(s[1],n[1],o[1],r[1]),Math.max(s[0],n[0],o[0],r[0]),Math.max(s[1],n[1],o[1],r[1])]}static inverseTransform(t){const i=t[0]*t[3]-t[1]*t[2];return[t[3]/i,-t[1]/i,-t[2]/i,t[0]/i,(t[2]*t[5]-t[4]*t[3])/i,(t[4]*t[1]-t[5]*t[0])/i]}static singularValueDecompose2dScale(t){const i=[t[0],t[2],t[1],t[3]],s=t[0]*i[0]+t[1]*i[2],n=t[0]*i[1]+t[1]*i[3],o=t[2]*i[0]+t[3]*i[2],r=t[2]*i[1]+t[3]*i[3],a=(s+r)/2,l=Math.sqrt((s+r)**2-4*(s*r-o*n))/2,c=a+l||1,d=a-l||1;return[Math.sqrt(c),Math.sqrt(d)]}static normalizeRect(t){const i=t.slice(0);return t[0]>t[2]&&(i[0]=t[2],i[2]=t[0]),t[1]>t[3]&&(i[1]=t[3],i[3]=t[1]),i}static intersect(t,i){const s=Math.max(Math.min(t[0],t[2]),Math.min(i[0],i[2])),n=Math.min(Math.max(t[0],t[2]),Math.max(i[0],i[2]));if(s>n)return null;const o=Math.max(Math.min(t[1],t[3]),Math.min(i[1],i[3])),r=Math.min(Math.max(t[1],t[3]),Math.max(i[1],i[3]));return o>r?null:[s,o,n,r]}static bezierBoundingBox(t,i,s,n,o,r,a,l,c){return c?(c[0]=Math.min(c[0],t,a),c[1]=Math.min(c[1],i,l),c[2]=Math.max(c[2],t,a),c[3]=Math.max(c[3],i,l)):c=[Math.min(t,a),Math.min(i,l),Math.max(t,a),Math.max(i,l)],x(this,xr,Ew).call(this,t,s,o,a,i,n,r,l,3*(-t+3*(s-o)+a),6*(t-2*s+o),3*(s-t),c),x(this,xr,Ew).call(this,t,s,o,a,i,n,r,l,3*(-i+3*(n-r)+l),6*(i-2*n+r),3*(n-i),c),c}}xr=new WeakSet,Mp=function(t,i,s,n,o,r,a,l,c,d){if(c<=0||c>=1)return;const h=1-c,u=c*c,f=u*c,p=h*(h*(h*t+3*c*i)+3*u*s)+f*n,m=h*(h*(h*o+3*c*r)+3*u*a)+f*l;d[0]=Math.min(d[0],p),d[1]=Math.min(d[1],m),d[2]=Math.max(d[2],p),d[3]=Math.max(d[3],m)},Ew=function(t,i,s,n,o,r,a,l,c,d,h,u){if(Math.abs(c)<1e-12){Math.abs(d)>=1e-12&&x(this,xr,Mp).call(this,t,i,s,n,o,r,a,l,-h/d,u);return}const f=d**2-4*h*c;if(f<0)return;const p=Math.sqrt(f),m=2*c;x(this,xr,Mp).call(this,t,i,s,n,o,r,a,l,(-d+p)/m,u),x(this,xr,Mp).call(this,t,i,s,n,o,r,a,l,(-d-p)/m,u)},F(Ae,xr);function q1(e){return decodeURIComponent(escape(e))}let hC=null,L0=null;function Y1(e){return hC||(hC=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,L0=new Map([["ï¬","Å¿t"]])),e.replaceAll(hC,(t,i,s)=>i?i.normalize("NFKC"):L0.get(s))}function X1(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const e=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(e);else for(let t=0;t<32;t++)e[t]=Math.floor(Math.random()*255);return sA(e)}const Uy="pdfjs_internal_id_",ko={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};function Q1(e){return Uint8Array.prototype.toBase64?e.toBase64():btoa(sA(e))}const Oo="http://www.w3.org/2000/svg",ll=class ll{};Pe(ll,"CSS",96),Pe(ll,"PDF",72),Pe(ll,"PDF_TO_CSS_UNITS",ll.CSS/ll.PDF);let Oa=ll;async function Ov(e,t="text"){if(mu(e,document.baseURI)){const i=await fetch(e);if(!i.ok)throw new Error(i.statusText);switch(t){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise((i,s)=>{const n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType=t,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(t){case"arraybuffer":case"blob":case"json":i(n.response);return}i(n.responseText);return}s(new Error(n.statusText))}},n.send(null)})}class jf{constructor({viewBox:t,scale:i,rotation:s,offsetX:n=0,offsetY:o=0,dontFlip:r=!1}){this.viewBox=t,this.scale=i,this.rotation=s,this.offsetX=n,this.offsetY=o;const a=(t[2]+t[0])/2,l=(t[3]+t[1])/2;let c,d,h,u;switch(s%=360,s<0&&(s+=360),s){case 180:c=-1,d=0,h=0,u=1;break;case 90:c=0,d=1,h=1,u=0;break;case 270:c=0,d=-1,h=-1,u=0;break;case 0:c=1,d=0,h=0,u=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}r&&(h=-h,u=-u);let f,p,m,v;c===0?(f=Math.abs(l-t[1])*i+n,p=Math.abs(a-t[0])*i+o,m=(t[3]-t[1])*i,v=(t[2]-t[0])*i):(f=Math.abs(a-t[0])*i+n,p=Math.abs(l-t[1])*i+o,m=(t[2]-t[0])*i,v=(t[3]-t[1])*i),this.transform=[c*i,d*i,h*i,u*i,f-c*i*a-h*i*l,p-d*i*a-u*i*l],this.width=m,this.height=v}get rawDims(){const{viewBox:t}=this;return Qe(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:i=this.rotation,offsetX:s=this.offsetX,offsetY:n=this.offsetY,dontFlip:o=!1}={}){return new jf({viewBox:this.viewBox.slice(),scale:t,rotation:i,offsetX:s,offsetY:n,dontFlip:o})}convertToViewportPoint(t,i){return Ae.applyTransform([t,i],this.transform)}convertToViewportRectangle(t){const i=Ae.applyTransform([t[0],t[1]],this.transform),s=Ae.applyTransform([t[2],t[3]],this.transform);return[i[0],i[1],s[0],s[1]]}convertToPdfPoint(t,i){return Ae.applyInverseTransform([t,i],this.transform)}}class jy extends Ka{constructor(t,i=0){super(t,"RenderingCancelledException"),this.extraDelay=i}}function Nv(e){const t=e.length;let i=0;for(;i<t&&e[i].trim()==="";)i++;return e.substring(i,i+5).toLowerCase()==="data:"}function Ky(e){return typeof e=="string"&&/\.pdf$/i.test(e)}function J1(e){return[e]=e.split(/[#?]/,1),e.substring(e.lastIndexOf("/")+1)}function Z1(e,t="document.pdf"){if(typeof e!="string")return t;if(Nv(e))return Ue('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,n=i.exec(e);let o=s.exec(n[1])||s.exec(n[2])||s.exec(n[3]);if(o&&(o=o[0],o.includes("%")))try{o=s.exec(decodeURIComponent(o))[0]}catch{}return o||t}class O0{constructor(){Pe(this,"started",Object.create(null));Pe(this,"times",[])}time(t){t in this.started&&Ue(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Ue(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let i=0;for(const{name:s}of this.times)i=Math.max(s.length,i);for(const{name:s,start:n,end:o}of this.times)t.push(`${s.padEnd(i)} ${o-n}ms
`);return t.join("")}}function mu(e,t){try{const{protocol:i}=t?new URL(e,t):new URL(e);return i==="http:"||i==="https:"}catch{return!1}}function on(e){e.preventDefault()}function N0(e){console.log("Deprecated API usage: "+e)}var Sg;class qy{static toDateObject(t){if(!t||typeof t!="string")return null;g(this,Sg)||y(this,Sg,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const i=g(this,Sg).exec(t);if(!i)return null;const s=parseInt(i[1],10);let n=parseInt(i[2],10);n=n>=1&&n<=12?n-1:0;let o=parseInt(i[3],10);o=o>=1&&o<=31?o:1;let r=parseInt(i[4],10);r=r>=0&&r<=23?r:0;let a=parseInt(i[5],10);a=a>=0&&a<=59?a:0;let l=parseInt(i[6],10);l=l>=0&&l<=59?l:0;const c=i[7]||"Z";let d=parseInt(i[8],10);d=d>=0&&d<=23?d:0;let h=parseInt(i[9],10)||0;return h=h>=0&&h<=59?h:0,c==="-"?(r+=d,a+=h):c==="+"&&(r-=d,a-=h),new Date(Date.UTC(s,n,o,r,a,l))}}Sg=new WeakMap,F(qy,Sg);function eL(e,{scale:t=1,rotation:i=0}){const{width:s,height:n}=e.attributes.style,o=[0,0,parseInt(s),parseInt(n)];return new jf({viewBox:o,scale:t,rotation:i})}function Yy(e){if(e.startsWith("#")){const t=parseInt(e.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return e.startsWith("rgb(")?e.slice(4,-1).split(",").map(t=>parseInt(t)):e.startsWith("rgba(")?e.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Ue(`Not a valid color format: "${e}"`),[0,0,0])}function tL(e){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const i of e.keys()){t.style.color=i;const s=window.getComputedStyle(t).color;e.set(i,Yy(s))}t.remove()}function Lt(e){const{a:t,b:i,c:s,d:n,e:o,f:r}=e.getTransform();return[t,i,s,n,o,r]}function _o(e){const{a:t,b:i,c:s,d:n,e:o,f:r}=e.getTransform().invertSelf();return[t,i,s,n,o,r]}function Pc(e,t,i=!1,s=!0){if(t instanceof jf){const{pageWidth:n,pageHeight:o}=t.rawDims,{style:r}=e,a=es.isCSSRoundSupported,l=`var(--scale-factor) * ${n}px`,c=`var(--scale-factor) * ${o}px`,d=a?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,h=a?`round(down, ${c}, var(--scale-round-y, 1px))`:`calc(${c})`;!i||t.rotation%180===0?(r.width=d,r.height=h):(r.width=h,r.height=d)}s&&e.setAttribute("data-main-rotation",t.rotation)}class Aw{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Zr,bl,gn,yl,Rg,xg,iv,nA,is,oA,rA,Ip,aA,Pw;const Ho=class Ho{constructor(t){F(this,is);F(this,Zr,null);F(this,bl,null);F(this,gn);F(this,yl,null);F(this,Rg,null);y(this,gn,t),g(Ho,xg)||y(Ho,xg,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const t=y(this,Zr,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const i=g(this,gn)._uiManager._signal;t.addEventListener("contextmenu",on,{signal:i}),t.addEventListener("pointerdown",x(Ho,iv,nA),{signal:i});const s=y(this,yl,document.createElement("div"));s.className="buttons",t.append(s);const n=g(this,gn).toolbarPosition;if(n){const{style:o}=t,r=g(this,gn)._uiManager.direction==="ltr"?1-n[0]:n[0];o.insetInlineEnd=`${100*r}%`,o.top=`calc(${100*n[1]}% + var(--editor-toolbar-vert-offset))`}return x(this,is,aA).call(this),t}get div(){return g(this,Zr)}hide(){var t;g(this,Zr).classList.add("hidden"),(t=g(this,bl))==null||t.hideDropdown()}show(){var t;g(this,Zr).classList.remove("hidden"),(t=g(this,Rg))==null||t.shown()}async addAltText(t){const i=await t.render();x(this,is,Ip).call(this,i),g(this,yl).prepend(i,g(this,is,Pw)),y(this,Rg,t)}addColorPicker(t){y(this,bl,t);const i=t.renderButton();x(this,is,Ip).call(this,i),g(this,yl).prepend(i,g(this,is,Pw))}remove(){var t;g(this,Zr).remove(),(t=g(this,bl))==null||t.destroy(),y(this,bl,null)}};Zr=new WeakMap,bl=new WeakMap,gn=new WeakMap,yl=new WeakMap,Rg=new WeakMap,xg=new WeakMap,iv=new WeakSet,nA=function(t){t.stopPropagation()},is=new WeakSet,oA=function(t){g(this,gn)._focusEventsAllowed=!1,t.preventDefault(),t.stopPropagation()},rA=function(t){g(this,gn)._focusEventsAllowed=!0,t.preventDefault(),t.stopPropagation()},Ip=function(t){const i=g(this,gn)._uiManager._signal;t.addEventListener("focusin",x(this,is,oA).bind(this),{capture:!0,signal:i}),t.addEventListener("focusout",x(this,is,rA).bind(this),{capture:!0,signal:i}),t.addEventListener("contextmenu",on,{signal:i})},aA=function(){const{editorType:t,_uiManager:i}=g(this,gn),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",g(Ho,xg)[t]),x(this,is,Ip).call(this,s),s.addEventListener("click",n=>{i.delete()},{signal:i._signal}),g(this,yl).append(s)},Pw=function(){const t=document.createElement("div");return t.className="divider",t},F(Ho,iv),F(Ho,xg,null);let Fw=Ho;var Eg,Sl,Rl,Wa,lA,cA,dA;class iL{constructor(t){F(this,Wa);F(this,Eg,null);F(this,Sl,null);F(this,Rl);y(this,Rl,t)}show(t,i,s){const[n,o]=x(this,Wa,cA).call(this,i,s),{style:r}=g(this,Sl)||y(this,Sl,x(this,Wa,lA).call(this));t.append(g(this,Sl)),r.insetInlineEnd=`${100*n}%`,r.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){g(this,Sl).remove()}}Eg=new WeakMap,Sl=new WeakMap,Rl=new WeakMap,Wa=new WeakSet,lA=function(){const t=y(this,Sl,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",on,{signal:g(this,Rl)._signal});const i=y(this,Eg,document.createElement("div"));return i.className="buttons",t.append(i),x(this,Wa,dA).call(this),t},cA=function(t,i){let s=0,n=0;for(const o of t){const r=o.y+o.height;if(r<s)continue;const a=o.x+(i?o.width:0);if(r>s){n=a,s=r;continue}i?a>n&&(n=a):a<n&&(n=a)}return[i?1-n:n,s]},dA=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const i=document.createElement("span");t.append(i),i.className="visuallyHidden",i.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=g(this,Rl)._signal;t.addEventListener("contextmenu",on,{signal:s}),t.addEventListener("click",()=>{g(this,Rl).highlightSelection("floating_button")},{signal:s}),g(this,Eg).append(t)};function Em(e,t,i){for(const s of i)t.addEventListener(s,e[s].bind(e))}function sL(e){return Math.round(Math.min(255,Math.max(1,255*e))).toString(16).padStart(2,"0")}var sv;class nL{constructor(){F(this,sv,0)}get id(){return`${N1}${Ki(this,sv)._++}`}}sv=new WeakMap;var Od,Ag,Ni,Nd,kp;const YS=class YS{constructor(){F(this,Nd);F(this,Od,X1());F(this,Ag,0);F(this,Ni,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),n=new Image;n.src=t;const o=n.decode().then(()=>(s.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return Qe(this,"_isSVGFittingCanvas",o)}async getFromFile(t){const{lastModified:i,name:s,size:n,type:o}=t;return x(this,Nd,kp).call(this,`${i}_${s}_${n}_${o}`,t)}async getFromUrl(t){return x(this,Nd,kp).call(this,t,t)}async getFromBlob(t,i){const s=await i;return x(this,Nd,kp).call(this,t,s)}async getFromId(t){g(this,Ni)||y(this,Ni,new Map);const i=g(this,Ni).get(t);if(!i)return null;if(i.bitmap)return i.refCounter+=1,i;if(i.file)return this.getFromFile(i.file);if(i.blobPromise){const{blobPromise:s}=i;return delete i.blobPromise,this.getFromBlob(i.id,s)}return this.getFromUrl(i.url)}getFromCanvas(t,i){g(this,Ni)||y(this,Ni,new Map);let s=g(this,Ni).get(t);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const n=new OffscreenCanvas(i.width,i.height);return n.getContext("2d").drawImage(i,0,0),s={bitmap:n.transferToImageBitmap(),id:`image_${g(this,Od)}_${Ki(this,Ag)._++}`,refCounter:1,isSvg:!1},g(this,Ni).set(t,s),g(this,Ni).set(s.id,s),s}getSvgUrl(t){const i=g(this,Ni).get(t);return i!=null&&i.isSvg?i.svgUrl:null}deleteId(t){var n;g(this,Ni)||y(this,Ni,new Map);const i=g(this,Ni).get(t);if(!i||(i.refCounter-=1,i.refCounter!==0))return;const{bitmap:s}=i;if(!i.url&&!i.file){const o=new OffscreenCanvas(s.width,s.height);o.getContext("bitmaprenderer").transferFromImageBitmap(s),i.blobPromise=o.convertToBlob()}(n=s.close)==null||n.call(s),i.bitmap=null}isValidId(t){return t.startsWith(`image_${g(this,Od)}_`)}};Od=new WeakMap,Ag=new WeakMap,Ni=new WeakMap,Nd=new WeakSet,kp=async function(t,i){g(this,Ni)||y(this,Ni,new Map);let s=g(this,Ni).get(t);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${g(this,Od)}_${Ki(this,Ag)._++}`,refCounter:0,isSvg:!1});let n;if(typeof i=="string"?(s.url=i,n=await Ov(i,"blob")):i instanceof File?n=s.file=i:i instanceof Blob&&(n=i),n.type==="image/svg+xml"){const o=YS._isSVGFittingCanvas,r=new FileReader,a=new Image,l=new Promise((c,d)=>{a.onload=()=>{s.bitmap=a,s.isSvg=!0,c()},r.onload=async()=>{const h=s.svgUrl=r.result;a.src=await o?`${h}#svgView(preserveAspectRatio(none))`:h},a.onerror=r.onerror=d});r.readAsDataURL(n),await l}else s.bitmap=await createImageBitmap(n);s.refCounter=1}catch(n){console.error(n),s=null}return g(this,Ni).set(t,s),s&&g(this,Ni).set(s.id,s),s};let Tw=YS;var ci,ea,Fg,di;class oL{constructor(t=128){F(this,ci,[]);F(this,ea,!1);F(this,Fg);F(this,di,-1);y(this,Fg,t)}add({cmd:t,undo:i,post:s,mustExec:n,type:o=NaN,overwriteIfSameType:r=!1,keepUndo:a=!1}){if(n&&t(),g(this,ea))return;const l={cmd:t,undo:i,post:s,type:o};if(g(this,di)===-1){g(this,ci).length>0&&(g(this,ci).length=0),y(this,di,0),g(this,ci).push(l);return}if(r&&g(this,ci)[g(this,di)].type===o){a&&(l.undo=g(this,ci)[g(this,di)].undo),g(this,ci)[g(this,di)]=l;return}const c=g(this,di)+1;c===g(this,Fg)?g(this,ci).splice(0,1):(y(this,di,c),c<g(this,ci).length&&g(this,ci).splice(c)),g(this,ci).push(l)}undo(){if(g(this,di)===-1)return;y(this,ea,!0);const{undo:t,post:i}=g(this,ci)[g(this,di)];t(),i==null||i(),y(this,ea,!1),y(this,di,g(this,di)-1)}redo(){if(g(this,di)<g(this,ci).length-1){y(this,di,g(this,di)+1),y(this,ea,!0);const{cmd:t,post:i}=g(this,ci)[g(this,di)];t(),i==null||i(),y(this,ea,!1)}}hasSomethingToUndo(){return g(this,di)!==-1}hasSomethingToRedo(){return g(this,di)<g(this,ci).length-1}destroy(){y(this,ci,null)}}ci=new WeakMap,ea=new WeakMap,Fg=new WeakMap,di=new WeakMap;var nv,hA;class Kf{constructor(t){F(this,nv);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:i}=es.platform;for(const[s,n,o={}]of t)for(const r of s){const a=r.startsWith("mac+");i&&a?(this.callbacks.set(r.slice(4),{callback:n,options:o}),this.allKeys.add(r.split("+").at(-1))):!i&&!a&&(this.callbacks.set(r,{callback:n,options:o}),this.allKeys.add(r.split("+").at(-1)))}}exec(t,i){if(!this.allKeys.has(i.key))return;const s=this.callbacks.get(x(this,nv,hA).call(this,i));if(!s)return;const{callback:n,options:{bubbles:o=!1,args:r=[],checker:a=null}}=s;a&&!a(t,i)||(n.bind(t,...r,i)(),o||(i.stopPropagation(),i.preventDefault()))}}nv=new WeakSet,hA=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const i=this.buffer.join("+");return this.buffer.length=0,i};const ov=class ov{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return tL(t),Qe(this,"_colors",t)}convert(t){const i=Yy(t);if(!window.matchMedia("(forced-colors: active)").matches)return i;for(const[s,n]of this._colors)if(n.every((o,r)=>o===i[r]))return ov._colorsMapping.get(s);return i}getHexCode(t){const i=this._colors.get(t);return i?Ae.makeHexColor(...i):t}};Pe(ov,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Dw=ov;var Hd,Ss,ei,Si,Gd,zo,Bd,fn,ta,Vd,xl,Yn,pn,El,Pg,Tg,zd,Dg,Xn,ia,Wd,sa,Qn,rv,na,Mg,oa,Al,Ig,kg,hi,gt,Wo,Fl,_g,Lg,ra,Jn,$o,Og,Ks,fe,_p,Mw,uA,gA,Lp,fA,pA,mA,Iw,vA,kw,_w,CA,qi,zr,wA,bA,Lw,yA,vu,Ow;const md=class md{constructor(t,i,s,n,o,r,a,l,c,d,h){F(this,fe);F(this,Hd,new AbortController);F(this,Ss,null);F(this,ei,new Map);F(this,Si,new Map);F(this,Gd,null);F(this,zo,null);F(this,Bd,null);F(this,fn,new oL);F(this,ta,null);F(this,Vd,0);F(this,xl,new Set);F(this,Yn,null);F(this,pn,null);F(this,El,new Set);F(this,Pg,!1);F(this,Tg,!1);F(this,zd,!1);F(this,Dg,null);F(this,Xn,null);F(this,ia,null);F(this,Wd,null);F(this,sa,!1);F(this,Qn,null);F(this,rv,new nL);F(this,na,!1);F(this,Mg,!1);F(this,oa,null);F(this,Al,null);F(this,Ig,null);F(this,kg,null);F(this,hi,ze.NONE);F(this,gt,new Set);F(this,Wo,null);F(this,Fl,null);F(this,_g,null);F(this,Lg,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});F(this,ra,[0,0]);F(this,Jn,null);F(this,$o,null);F(this,Og,null);F(this,Ks,null);const u=this._signal=g(this,Hd).signal;y(this,$o,t),y(this,Og,i),y(this,Gd,s),this._eventBus=n,n._on("editingaction",this.onEditingAction.bind(this),{signal:u}),n._on("pagechanging",this.onPageChanging.bind(this),{signal:u}),n._on("scalechanging",this.onScaleChanging.bind(this),{signal:u}),n._on("rotationchanging",this.onRotationChanging.bind(this),{signal:u}),n._on("setpreference",this.onSetPreference.bind(this),{signal:u}),n._on("switchannotationeditorparams",f=>this.updateParams(f.type,f.value),{signal:u}),x(this,fe,fA).call(this),x(this,fe,CA).call(this),x(this,fe,Iw).call(this),y(this,zo,o.annotationStorage),y(this,Dg,o.filterFactory),y(this,Fl,r),y(this,Wd,a||null),y(this,Pg,l),y(this,Tg,c),y(this,zd,d),y(this,kg,h||null),this.viewParameters={realScale:Oa.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const t=md.prototype,i=r=>g(r,$o).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&r.hasSomethingToControl(),s=(r,{target:a})=>{if(a instanceof HTMLInputElement){const{type:l}=a;return l!=="text"&&l!=="number"}return!0},n=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return Qe(this,"_keyboardManager",new Kf([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(r,{target:a})=>!(a instanceof HTMLButtonElement)&&g(r,$o).contains(a)&&!r.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(r,{target:a})=>!(a instanceof HTMLButtonElement)&&g(r,$o).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:i}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:i}]]))}destroy(){var t,i,s,n;(t=g(this,Ks))==null||t.resolve(),y(this,Ks,null),(i=g(this,Hd))==null||i.abort(),y(this,Hd,null),this._signal=null;for(const o of g(this,Si).values())o.destroy();g(this,Si).clear(),g(this,ei).clear(),g(this,El).clear(),y(this,Ss,null),g(this,gt).clear(),g(this,fn).destroy(),(s=g(this,Gd))==null||s.destroy(),(n=g(this,Qn))==null||n.hide(),y(this,Qn,null),g(this,Xn)&&(clearTimeout(g(this,Xn)),y(this,Xn,null)),g(this,Jn)&&(clearTimeout(g(this,Jn)),y(this,Jn,null))}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return g(this,kg)}get useNewAltTextFlow(){return g(this,Tg)}get useNewAltTextWhenAddingImage(){return g(this,zd)}get hcmFilter(){return Qe(this,"hcmFilter",g(this,Fl)?g(this,Dg).addHCMFilter(g(this,Fl).foreground,g(this,Fl).background):"none")}get direction(){return Qe(this,"direction",getComputedStyle(g(this,$o)).direction)}get highlightColors(){return Qe(this,"highlightColors",g(this,Wd)?new Map(g(this,Wd).split(",").map(t=>t.split("=").map(i=>i.trim()))):null)}get highlightColorNames(){return Qe(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setMainHighlightColorPicker(t){y(this,Ig,t)}editAltText(t,i=!1){var s;(s=g(this,Gd))==null||s.editAltText(this,t,i)}switchToMode(t,i){this._eventBus.on("annotationeditormodechanged",i,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,i){this._eventBus.dispatch("setpreference",{source:this,name:t,value:i})}onSetPreference({name:t,value:i}){switch(t){case"enableNewAltTextWhenAddingImage":y(this,zd,i);break}}onPageChanging({pageNumber:t}){y(this,Vd,t-1)}focusMainContainer(){g(this,$o).focus()}findParent(t,i){for(const s of g(this,Si).values()){const{x:n,y:o,width:r,height:a}=s.div.getBoundingClientRect();if(t>=n&&t<=n+r&&i>=o&&i<=o+a)return s}return null}disableUserSelect(t=!1){g(this,Og).classList.toggle("noUserSelect",t)}addShouldRescale(t){g(this,El).add(t)}removeShouldRescale(t){g(this,El).delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Oa.PDF_TO_CSS_UNITS;for(const i of g(this,El))i.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:s,anchorOffset:n,focusNode:o,focusOffset:r}=i,a=i.toString(),c=x(this,fe,_p).call(this,i).closest(".textLayer"),d=this.getSelectionBoxes(c);if(!d)return;i.empty();const h=x(this,fe,Mw).call(this,c),u=g(this,hi)===ze.NONE,f=()=>{h==null||h.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:d,anchorNode:s,anchorOffset:n,focusNode:o,focusOffset:r,text:a}),u&&this.showAllEditors("highlight",!0,!0)};if(u){this.switchToMode(ze.HIGHLIGHT,f);return}f()}addToAnnotationStorage(t){!t.isEmpty()&&g(this,zo)&&!g(this,zo).has(t.id)&&g(this,zo).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,g(this,sa)&&(y(this,sa,!1),x(this,fe,Lp).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const i of g(this,gt))if(i.div.contains(t)){y(this,Al,[i,t]),i._focusEventsAllowed=!1;break}}focus(){if(!g(this,Al))return;const[t,i]=g(this,Al);y(this,Al,null),i.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),i.focus()}addEditListeners(){x(this,fe,Iw).call(this),x(this,fe,kw).call(this)}removeEditListeners(){x(this,fe,vA).call(this),x(this,fe,_w).call(this)}dragOver(t){for(const{type:i}of t.dataTransfer.items)for(const s of g(this,pn))if(s.isHandlingMimeForPasting(i)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const i of t.dataTransfer.items)for(const s of g(this,pn))if(s.isHandlingMimeForPasting(i.type)){s.paste(i,this.currentLayer),t.preventDefault();return}}copy(t){var s;if(t.preventDefault(),(s=g(this,Ss))==null||s.commitOrRemove(),!this.hasSelection)return;const i=[];for(const n of g(this,gt)){const o=n.serialize(!0);o&&i.push(o)}i.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(i))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:i}=t;for(const o of i.items)for(const r of g(this,pn))if(r.isHandlingMimeForPasting(o.type)){r.paste(o,this.currentLayer);return}let s=i.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(o){Ue(`paste: "${o.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const n=this.currentLayer;try{const o=[];for(const l of s){const c=await n.deserialize(l);if(!c)return;o.push(c)}const r=()=>{for(const l of o)x(this,fe,Lw).call(this,l);x(this,fe,Ow).call(this,o)},a=()=>{for(const l of o)l.remove()};this.addCommands({cmd:r,undo:a,mustExec:!0})}catch(o){Ue(`paste: "${o.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),g(this,hi)!==ze.NONE&&!this.isEditorHandlingKeyboard&&md._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,g(this,sa)&&(y(this,sa,!1),x(this,fe,Lp).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(x(this,fe,pA).call(this),x(this,fe,kw).call(this),x(this,fe,qi).call(this,{isEditing:g(this,hi)!==ze.NONE,isEmpty:x(this,fe,vu).call(this),hasSomethingToUndo:g(this,fn).hasSomethingToUndo(),hasSomethingToRedo:g(this,fn).hasSomethingToRedo(),hasSelectedEditor:!1})):(x(this,fe,mA).call(this),x(this,fe,_w).call(this),x(this,fe,qi).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!g(this,pn)){y(this,pn,t);for(const i of g(this,pn))x(this,fe,zr).call(this,i.defaultPropertiesToUpdate)}}getId(){return g(this,rv).id}get currentLayer(){return g(this,Si).get(g(this,Vd))}getLayer(t){return g(this,Si).get(t)}get currentPageIndex(){return g(this,Vd)}addLayer(t){g(this,Si).set(t.pageIndex,t),g(this,na)?t.enable():t.disable()}removeLayer(t){g(this,Si).delete(t.pageIndex)}async updateMode(t,i=null,s=!1){if(g(this,hi)!==t&&!(g(this,Ks)&&(await g(this,Ks).promise,!g(this,Ks)))){if(y(this,Ks,Promise.withResolvers()),y(this,hi,t),t===ze.NONE){this.setEditingState(!1),x(this,fe,bA).call(this),g(this,Ks).resolve();return}this.setEditingState(!0),await x(this,fe,wA).call(this),this.unselectAll();for(const n of g(this,Si).values())n.updateMode(t);if(!i){s&&this.addNewEditorFromKeyboard(),g(this,Ks).resolve();return}for(const n of g(this,ei).values())n.annotationElementId===i?(this.setSelected(n),n.enterInEditMode()):n.unselect();g(this,Ks).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==g(this,hi)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,i){var s;if(g(this,pn)){switch(t){case He.CREATE:this.currentLayer.addNewEditor();return;case He.HIGHLIGHT_DEFAULT_COLOR:(s=g(this,Ig))==null||s.updateColor(i);break;case He.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(g(this,_g)||y(this,_g,new Map)).set(t,i),this.showAllEditors("highlight",i);break}for(const n of g(this,gt))n.updateParams(t,i);for(const n of g(this,pn))n.updateDefaultParams(t,i)}}showAllEditors(t,i,s=!1){var o;for(const r of g(this,ei).values())r.editorType===t&&r.show(i);(((o=g(this,_g))==null?void 0:o.get(He.HIGHLIGHT_SHOW_ALL))??!0)!==i&&x(this,fe,zr).call(this,[[He.HIGHLIGHT_SHOW_ALL,i]])}enableWaiting(t=!1){if(g(this,Mg)!==t){y(this,Mg,t);for(const i of g(this,Si).values())t?i.disableClick():i.enableClick(),i.div.classList.toggle("waiting",t)}}getEditors(t){const i=[];for(const s of g(this,ei).values())s.pageIndex===t&&i.push(s);return i}getEditor(t){return g(this,ei).get(t)}addEditor(t){g(this,ei).set(t.id,t)}removeEditor(t){var i;t.div.contains(document.activeElement)&&(g(this,Xn)&&clearTimeout(g(this,Xn)),y(this,Xn,setTimeout(()=>{this.focusMainContainer(),y(this,Xn,null)},0))),g(this,ei).delete(t.id),this.unselect(t),(!t.annotationElementId||!g(this,xl).has(t.annotationElementId))&&((i=g(this,zo))==null||i.remove(t.id))}addDeletedAnnotationElement(t){g(this,xl).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return g(this,xl).has(t)}removeDeletedAnnotationElement(t){g(this,xl).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){g(this,Ss)!==t&&(y(this,Ss,t),t&&x(this,fe,zr).call(this,t.propertiesToUpdate))}updateUI(t){g(this,fe,yA)===t&&x(this,fe,zr).call(this,t.propertiesToUpdate)}toggleSelected(t){if(g(this,gt).has(t)){g(this,gt).delete(t),t.unselect(),x(this,fe,qi).call(this,{hasSelectedEditor:this.hasSelection});return}g(this,gt).add(t),t.select(),x(this,fe,zr).call(this,t.propertiesToUpdate),x(this,fe,qi).call(this,{hasSelectedEditor:!0})}setSelected(t){for(const i of g(this,gt))i!==t&&i.unselect();g(this,gt).clear(),g(this,gt).add(t),t.select(),x(this,fe,zr).call(this,t.propertiesToUpdate),x(this,fe,qi).call(this,{hasSelectedEditor:!0})}isSelected(t){return g(this,gt).has(t)}get firstSelectedEditor(){return g(this,gt).values().next().value}unselect(t){t.unselect(),g(this,gt).delete(t),x(this,fe,qi).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return g(this,gt).size!==0}get isEnterHandled(){return g(this,gt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){g(this,fn).undo(),x(this,fe,qi).call(this,{hasSomethingToUndo:g(this,fn).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:x(this,fe,vu).call(this)})}redo(){g(this,fn).redo(),x(this,fe,qi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:g(this,fn).hasSomethingToRedo(),isEmpty:x(this,fe,vu).call(this)})}addCommands(t){g(this,fn).add(t),x(this,fe,qi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:x(this,fe,vu).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const t=[...g(this,gt)],i=()=>{for(const n of t)n.remove()},s=()=>{for(const n of t)x(this,fe,Lw).call(this,n)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){var t;(t=g(this,Ss))==null||t.commitOrRemove()}hasSomethingToControl(){return g(this,Ss)||this.hasSelection}selectAll(){for(const t of g(this,gt))t.commit();x(this,fe,Ow).call(this,g(this,ei).values())}unselectAll(){if(!(g(this,Ss)&&(g(this,Ss).commitOrRemove(),g(this,hi)!==ze.NONE))&&this.hasSelection){for(const t of g(this,gt))t.unselect();g(this,gt).clear(),x(this,fe,qi).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,i,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;g(this,ra)[0]+=t,g(this,ra)[1]+=i;const[n,o]=g(this,ra),r=[...g(this,gt)],a=1e3;g(this,Jn)&&clearTimeout(g(this,Jn)),y(this,Jn,setTimeout(()=>{y(this,Jn,null),g(this,ra)[0]=g(this,ra)[1]=0,this.addCommands({cmd:()=>{for(const l of r)g(this,ei).has(l.id)&&l.translateInPage(n,o)},undo:()=>{for(const l of r)g(this,ei).has(l.id)&&l.translateInPage(-n,-o)},mustExec:!1})},a));for(const l of r)l.translateInPage(t,i)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),y(this,Yn,new Map);for(const t of g(this,gt))g(this,Yn).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!g(this,Yn))return!1;this.disableUserSelect(!1);const t=g(this,Yn);y(this,Yn,null);let i=!1;for(const[{x:n,y:o,pageIndex:r},a]of t)a.newX=n,a.newY=o,a.newPageIndex=r,i||(i=n!==a.savedX||o!==a.savedY||r!==a.savedPageIndex);if(!i)return!1;const s=(n,o,r,a)=>{if(g(this,ei).has(n.id)){const l=g(this,Si).get(a);l?n._setParentAndPosition(l,o,r):(n.pageIndex=a,n.x=o,n.y=r)}};return this.addCommands({cmd:()=>{for(const[n,{newX:o,newY:r,newPageIndex:a}]of t)s(n,o,r,a)},undo:()=>{for(const[n,{savedX:o,savedY:r,savedPageIndex:a}]of t)s(n,o,r,a)},mustExec:!0}),!0}dragSelectedEditors(t,i){if(g(this,Yn))for(const s of g(this,Yn).keys())s.drag(t,i)}rebuild(t){if(t.parent===null){const i=this.getLayer(t.pageIndex);i?(i.changeParent(t),i.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||g(this,gt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return g(this,Ss)===t}getActive(){return g(this,Ss)}getMode(){return g(this,hi)}get imageManager(){return Qe(this,"imageManager",new Tw)}getSelectionBoxes(t){if(!t)return null;const i=document.getSelection();for(let c=0,d=i.rangeCount;c<d;c++)if(!t.contains(i.getRangeAt(c).commonAncestorContainer))return null;const{x:s,y:n,width:o,height:r}=t.getBoundingClientRect();let a;switch(t.getAttribute("data-main-rotation")){case"90":a=(c,d,h,u)=>({x:(d-n)/r,y:1-(c+h-s)/o,width:u/r,height:h/o});break;case"180":a=(c,d,h,u)=>({x:1-(c+h-s)/o,y:1-(d+u-n)/r,width:h/o,height:u/r});break;case"270":a=(c,d,h,u)=>({x:1-(d+u-n)/r,y:(c-s)/o,width:u/r,height:h/o});break;default:a=(c,d,h,u)=>({x:(c-s)/o,y:(d-n)/r,width:h/o,height:u/r});break}const l=[];for(let c=0,d=i.rangeCount;c<d;c++){const h=i.getRangeAt(c);if(!h.collapsed)for(const{x:u,y:f,width:p,height:m}of h.getClientRects())p===0||m===0||l.push(a(u,f,p,m))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:t,id:i}){(g(this,Bd)||y(this,Bd,new Map)).set(t,i)}removeChangedExistingAnnotation({annotationElementId:t}){var i;(i=g(this,Bd))==null||i.delete(t)}renderAnnotationElement(t){var n;const i=(n=g(this,Bd))==null?void 0:n.get(t.data.id);if(!i)return;const s=g(this,zo).getRawValue(i);s&&(g(this,hi)===ze.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}};Hd=new WeakMap,Ss=new WeakMap,ei=new WeakMap,Si=new WeakMap,Gd=new WeakMap,zo=new WeakMap,Bd=new WeakMap,fn=new WeakMap,ta=new WeakMap,Vd=new WeakMap,xl=new WeakMap,Yn=new WeakMap,pn=new WeakMap,El=new WeakMap,Pg=new WeakMap,Tg=new WeakMap,zd=new WeakMap,Dg=new WeakMap,Xn=new WeakMap,ia=new WeakMap,Wd=new WeakMap,sa=new WeakMap,Qn=new WeakMap,rv=new WeakMap,na=new WeakMap,Mg=new WeakMap,oa=new WeakMap,Al=new WeakMap,Ig=new WeakMap,kg=new WeakMap,hi=new WeakMap,gt=new WeakMap,Wo=new WeakMap,Fl=new WeakMap,_g=new WeakMap,Lg=new WeakMap,ra=new WeakMap,Jn=new WeakMap,$o=new WeakMap,Og=new WeakMap,Ks=new WeakMap,fe=new WeakSet,_p=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},Mw=function(t){const{currentLayer:i}=this;if(i.hasTextLayer(t))return i;for(const s of g(this,Si).values())if(s.hasTextLayer(t))return s;return null},uA=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=x(this,fe,_p).call(this,t).closest(".textLayer"),n=this.getSelectionBoxes(s);n&&(g(this,Qn)||y(this,Qn,new iL(this)),g(this,Qn).show(s,n,this.direction==="ltr"))},gA=function(){var o,r,a;const t=document.getSelection();if(!t||t.isCollapsed){g(this,Wo)&&((o=g(this,Qn))==null||o.hide(),y(this,Wo,null),x(this,fe,qi).call(this,{hasSelectedText:!1}));return}const{anchorNode:i}=t;if(i===g(this,Wo))return;const n=x(this,fe,_p).call(this,t).closest(".textLayer");if(!n){g(this,Wo)&&((r=g(this,Qn))==null||r.hide(),y(this,Wo,null),x(this,fe,qi).call(this,{hasSelectedText:!1}));return}if((a=g(this,Qn))==null||a.hide(),y(this,Wo,i),x(this,fe,qi).call(this,{hasSelectedText:!0}),!(g(this,hi)!==ze.HIGHLIGHT&&g(this,hi)!==ze.NONE)&&(g(this,hi)===ze.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),y(this,sa,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=g(this,hi)===ze.HIGHLIGHT?x(this,fe,Mw).call(this,n):null;l==null||l.toggleDrawing();const c=new AbortController,d=this.combinedSignal(c),h=u=>{u.type==="pointerup"&&u.button!==0||(c.abort(),l==null||l.toggleDrawing(!0),u.type==="pointerup"&&x(this,fe,Lp).call(this,"main_toolbar"))};window.addEventListener("pointerup",h,{signal:d}),window.addEventListener("blur",h,{signal:d})}},Lp=function(t=""){g(this,hi)===ze.HIGHLIGHT?this.highlightSelection(t):g(this,Pg)&&x(this,fe,uA).call(this)},fA=function(){document.addEventListener("selectionchange",x(this,fe,gA).bind(this),{signal:this._signal})},pA=function(){if(g(this,ia))return;y(this,ia,new AbortController);const t=this.combinedSignal(g(this,ia));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},mA=function(){var t;(t=g(this,ia))==null||t.abort(),y(this,ia,null)},Iw=function(){if(g(this,oa))return;y(this,oa,new AbortController);const t=this.combinedSignal(g(this,oa));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},vA=function(){var t;(t=g(this,oa))==null||t.abort(),y(this,oa,null)},kw=function(){if(g(this,ta))return;y(this,ta,new AbortController);const t=this.combinedSignal(g(this,ta));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},_w=function(){var t;(t=g(this,ta))==null||t.abort(),y(this,ta,null)},CA=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},qi=function(t){Object.entries(t).some(([s,n])=>g(this,Lg)[s]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(g(this,Lg),t)}),g(this,hi)===ze.HIGHLIGHT&&t.hasSelectedEditor===!1&&x(this,fe,zr).call(this,[[He.HIGHLIGHT_FREE,!0]]))},zr=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},wA=async function(){if(!g(this,na)){y(this,na,!0);const t=[];for(const i of g(this,Si).values())t.push(i.enable());await Promise.all(t);for(const i of g(this,ei).values())i.enable()}},bA=function(){if(this.unselectAll(),g(this,na)){y(this,na,!1);for(const t of g(this,Si).values())t.disable();for(const t of g(this,ei).values())t.disable()}},Lw=function(t){const i=g(this,Si).get(t.pageIndex);i?i.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},yA=function(){let t=null;for(t of g(this,gt));return t},vu=function(){if(g(this,ei).size===0)return!0;if(g(this,ei).size===1)for(const t of g(this,ei).values())return t.isEmpty();return!1},Ow=function(t){for(const i of g(this,gt))i.unselect();g(this,gt).clear();for(const i of t)i.isEmpty()||(g(this,gt).add(i),i.select());x(this,fe,qi).call(this,{hasSelectedEditor:this.hasSelection})},Pe(md,"TRANSLATE_SMALL",1),Pe(md,"TRANSLATE_BIG",10);let Tc=md;var ui,Zn,mn,$d,eo,Rs,Ud,to,ls,Uo,Pl,io,aa,Mn,Cu,Op;const Yi=class Yi{constructor(t){F(this,Mn);F(this,ui,null);F(this,Zn,!1);F(this,mn,null);F(this,$d,null);F(this,eo,null);F(this,Rs,null);F(this,Ud,!1);F(this,to,null);F(this,ls,null);F(this,Uo,null);F(this,Pl,null);F(this,io,!1);y(this,ls,t),y(this,io,t._uiManager.useNewAltTextFlow),g(Yi,aa)||y(Yi,aa,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){Yi._l10n??(Yi._l10n=t)}async render(){const t=y(this,mn,document.createElement("button"));t.className="altText",t.tabIndex="0";const i=y(this,$d,document.createElement("span"));t.append(i),g(this,io)?(t.classList.add("new"),t.setAttribute("data-l10n-id",g(Yi,aa).missing),i.setAttribute("data-l10n-id",g(Yi,aa)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=g(this,ls)._uiManager._signal;t.addEventListener("contextmenu",on,{signal:s}),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const n=o=>{o.preventDefault(),g(this,ls)._uiManager.editAltText(g(this,ls)),g(this,io)&&g(this,ls)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:g(this,Mn,Cu)}})};return t.addEventListener("click",n,{capture:!0,signal:s}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(y(this,Ud,!0),n(o))},{signal:s}),await x(this,Mn,Op).call(this),t}finish(){g(this,mn)&&(g(this,mn).focus({focusVisible:g(this,Ud)}),y(this,Ud,!1))}isEmpty(){return g(this,io)?g(this,ui)===null:!g(this,ui)&&!g(this,Zn)}hasData(){return g(this,io)?g(this,ui)!==null||!!g(this,Uo):this.isEmpty()}get guessedText(){return g(this,Uo)}async setGuessedText(t){g(this,ui)===null&&(y(this,Uo,t),y(this,Pl,await Yi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),x(this,Mn,Op).call(this))}toggleAltTextBadge(t=!1){var i;if(!g(this,io)||g(this,ui)){(i=g(this,to))==null||i.remove(),y(this,to,null);return}if(!g(this,to)){const s=y(this,to,document.createElement("div"));s.className="noAltTextBadge",g(this,ls).div.append(s)}g(this,to).classList.toggle("hidden",!t)}serialize(t){let i=g(this,ui);return!t&&g(this,Uo)===i&&(i=g(this,Pl)),{altText:i,decorative:g(this,Zn),guessedText:g(this,Uo),textWithDisclaimer:g(this,Pl)}}get data(){return{altText:g(this,ui),decorative:g(this,Zn)}}set data({altText:t,decorative:i,guessedText:s,textWithDisclaimer:n,cancel:o=!1}){s&&(y(this,Uo,s),y(this,Pl,n)),!(g(this,ui)===t&&g(this,Zn)===i)&&(o||(y(this,ui,t),y(this,Zn,i)),x(this,Mn,Op).call(this))}toggle(t=!1){g(this,mn)&&(!t&&g(this,Rs)&&(clearTimeout(g(this,Rs)),y(this,Rs,null)),g(this,mn).disabled=!t)}shown(){g(this,ls)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:g(this,Mn,Cu)}})}destroy(){var t,i;(t=g(this,mn))==null||t.remove(),y(this,mn,null),y(this,$d,null),y(this,eo,null),(i=g(this,to))==null||i.remove(),y(this,to,null)}};ui=new WeakMap,Zn=new WeakMap,mn=new WeakMap,$d=new WeakMap,eo=new WeakMap,Rs=new WeakMap,Ud=new WeakMap,to=new WeakMap,ls=new WeakMap,Uo=new WeakMap,Pl=new WeakMap,io=new WeakMap,aa=new WeakMap,Mn=new WeakSet,Cu=function(){return g(this,ui)&&"added"||g(this,ui)===null&&this.guessedText&&"review"||"missing"},Op=async function(){var n,o,r;const t=g(this,mn);if(!t)return;if(g(this,io)){if(t.classList.toggle("done",!!g(this,ui)),t.setAttribute("data-l10n-id",g(Yi,aa)[g(this,Mn,Cu)]),(n=g(this,$d))==null||n.setAttribute("data-l10n-id",g(Yi,aa)[`${g(this,Mn,Cu)}-label`]),!g(this,ui)){(o=g(this,eo))==null||o.remove();return}}else{if(!g(this,ui)&&!g(this,Zn)){t.classList.remove("done"),(r=g(this,eo))==null||r.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let i=g(this,eo);if(!i){y(this,eo,i=document.createElement("span")),i.className="tooltip",i.setAttribute("role","tooltip"),i.id=`alt-text-tooltip-${g(this,ls).id}`;const a=100,l=g(this,ls)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(g(this,Rs)),y(this,Rs,null)},{once:!0}),t.addEventListener("mouseenter",()=>{y(this,Rs,setTimeout(()=>{y(this,Rs,null),g(this,eo).classList.add("show"),g(this,ls)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:l}),t.addEventListener("mouseleave",()=>{var c;g(this,Rs)&&(clearTimeout(g(this,Rs)),y(this,Rs,null)),(c=g(this,eo))==null||c.classList.remove("show")},{signal:l})}g(this,Zn)?i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(i.removeAttribute("data-l10n-id"),i.textContent=g(this,ui)),i.parentNode||t.append(i);const s=g(this,ls).getImageForAltText();s==null||s.setAttribute("aria-describedby",i.id)},F(Yi,aa,null),Pe(Yi,"_l10n",null);let Am=Yi;var Tl,vn,kt,jd,Dl,Ri,Ml,la,Ng,Il,ca,Hg,kl,jo,so,Kd,qd,qs,Gg,av,$e,Nw,Bg,Hw,Gw,SA,RA,Bw,Vw,zw,xA,Ww,EA,AA,FA,$w,wu;const dt=class dt{constructor(t){F(this,$e);F(this,Tl,null);F(this,vn,null);F(this,kt,null);F(this,jd,!1);F(this,Dl,!1);F(this,Ri,null);F(this,Ml,null);F(this,la,null);F(this,Ng,"");F(this,Il,!1);F(this,ca,null);F(this,Hg,!1);F(this,kl,!1);F(this,jo,!1);F(this,so,null);F(this,Kd,0);F(this,qd,0);F(this,qs,null);Pe(this,"_editToolbar",null);Pe(this,"_initialOptions",Object.create(null));Pe(this,"_initialData",null);Pe(this,"_isVisible",!0);Pe(this,"_uiManager",null);Pe(this,"_focusEventsAllowed",!0);F(this,Gg,!1);F(this,av,dt._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:i,rawDims:{pageWidth:s,pageHeight:n,pageX:o,pageY:r}}=this.parent.viewport;this.rotation=i,this.pageRotation=(360+i-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,n],this.pageTranslation=[o,r];const[a,l]=this.parentDimensions;this.x=t.x/a,this.y=t.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=dt.prototype._resizeWithKeyboard,i=Tc.TRANSLATE_SMALL,s=Tc.TRANSLATE_BIG;return Qe(this,"_resizerKeyboardManager",new Kf([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-i,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[i,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-i]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,i]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],dt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return Qe(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const i=new rL({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});i.annotationElementId=t.annotationElementId,i.deleted=!0,i._uiManager.addToAnnotationStorage(i)}static initialize(t,i){if(dt._l10n??(dt._l10n=t),dt._l10nResizer||(dt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),dt._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);dt._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,i){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,i){Et("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return g(this,Gg)}set _isDraggable(t){var i;y(this,Gg,t),(i=this.div)==null||i.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,i]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*i/(t*2),this.y+=this.width*t/(i*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*i/(t*2),this.y-=this.width*t/(i*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=g(this,av)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):x(this,$e,wu).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(g(this,Il)?y(this,Il,!1):this.parent.setSelected(this))}focusout(t){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const i=t.relatedTarget;i!=null&&i.closest(`#${this.id}`)||(t.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,i,s,n){const[o,r]=this.parentDimensions;[s,n]=this.screenToPageTranslation(s,n),this.x=(t+s)/o,this.y=(i+n)/r,this.fixAndSetPosition()}translate(t,i){x(this,$e,Nw).call(this,this.parentDimensions,t,i)}translateInPage(t,i){g(this,ca)||y(this,ca,[this.x,this.y]),x(this,$e,Nw).call(this,this.pageDimensions,t,i),this.div.scrollIntoView({block:"nearest"})}drag(t,i){g(this,ca)||y(this,ca,[this.x,this.y]);const[s,n]=this.parentDimensions;if(this.x+=t/s,this.y+=i/n,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:c,y:d}=this.div.getBoundingClientRect();this.parent.findNewParent(this,c,d)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:r}=this;const[a,l]=this.getBaseTranslation();o+=a,r+=l,this.div.style.left=`${(100*o).toFixed(2)}%`,this.div.style.top=`${(100*r).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!g(this,ca)&&(g(this,ca)[0]!==this.x||g(this,ca)[1]!==this.y)}getBaseTranslation(){const[t,i]=this.parentDimensions,{_borderLineWidth:s}=dt,n=s/t,o=s/i;switch(this.rotation){case 90:return[-n,o];case 180:return[n,o];case 270:return[n,-o];default:return[-n,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const[i,s]=this.pageDimensions;let{x:n,y:o,width:r,height:a}=this;if(r*=i,a*=s,n*=i,o*=s,this._mustFixPosition)switch(t){case 0:n=Math.max(0,Math.min(i-r,n)),o=Math.max(0,Math.min(s-a,o));break;case 90:n=Math.max(0,Math.min(i-a,n)),o=Math.min(s,Math.max(r,o));break;case 180:n=Math.min(i,Math.max(r,n)),o=Math.min(s,Math.max(a,o));break;case 270:n=Math.min(i,Math.max(a,n)),o=Math.max(0,Math.min(s-r,o));break}this.x=n/=i,this.y=o/=s;const[l,c]=this.getBaseTranslation();n+=l,o+=c;const{style:d}=this.div;d.left=`${(100*n).toFixed(2)}%`,d.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,i){var s;return x(s=dt,Bg,Hw).call(s,t,i,this.parentRotation)}pageTranslationToScreen(t,i){var s;return x(s=dt,Bg,Hw).call(s,t,i,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[i,s]}=this;return[i*t,s*t]}setDims(t,i){const[s,n]=this.parentDimensions;this.div.style.width=`${(100*t/s).toFixed(2)}%`,g(this,Dl)||(this.div.style.height=`${(100*i/n).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:i,width:s}=t,n=s.endsWith("%"),o=!g(this,Dl)&&i.endsWith("%");if(n&&o)return;const[r,a]=this.parentDimensions;n||(t.width=`${(100*parseFloat(s)/r).toFixed(2)}%`),!g(this,Dl)&&!o&&(t.height=`${(100*parseFloat(i)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var t;(t=g(this,kt))==null||t.finish()}async addEditToolbar(){return this._editToolbar||g(this,kl)?this._editToolbar:(this._editToolbar=new Fw(this),this.div.append(this._editToolbar.render()),g(this,kt)&&await this._editToolbar.addAltText(g(this,kt)),this._editToolbar)}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=g(this,kt))==null||t.destroy())}addContainer(t){var s;const i=(s=this._editToolbar)==null?void 0:s.div;i?i.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){g(this,kt)||(Am.initialize(dt._l10n),y(this,kt,new Am(this)),g(this,Tl)&&(g(this,kt).data=g(this,Tl),y(this,Tl,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=g(this,kt))==null?void 0:t.data}set altTextData(t){g(this,kt)&&(g(this,kt).data=t)}get guessedAltText(){var t;return(t=g(this,kt))==null?void 0:t.guessedText}async setGuessedAltText(t){var i;await((i=g(this,kt))==null?void 0:i.setGuessedText(t))}serializeAltText(t){var i;return(i=g(this,kt))==null?void 0:i.serialize(t)}hasAltText(){return!!g(this,kt)&&!g(this,kt).isEmpty()}hasAltTextData(){var t;return((t=g(this,kt))==null?void 0:t.hasData())??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=g(this,jd)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),x(this,$e,Ww).call(this);const[t,i]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*i/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/i).toFixed(2)}%`);const[s,n]=this.getInitialTranslation();return this.translate(s,n),Em(this,this.div,["pointerdown"]),this.div}pointerdown(t){const{isMac:i}=es.platform;if(t.button!==0||t.ctrlKey&&i){t.preventDefault();return}if(y(this,Il,!0),this._isDraggable){x(this,$e,xA).call(this,t);return}x(this,$e,zw).call(this,t)}get isSelected(){return this._uiManager.isSelected(this)}moveInDOM(){g(this,so)&&clearTimeout(g(this,so)),y(this,so,setTimeout(()=>{var t;y(this,so,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,i,s){t.changeParent(this),this.x=i,this.y=s,this.fixAndSetPosition()}getRect(t,i,s=this.rotation){const n=this.parentScale,[o,r]=this.pageDimensions,[a,l]=this.pageTranslation,c=t/n,d=i/n,h=this.x*o,u=this.y*r,f=this.width*o,p=this.height*r;switch(s){case 0:return[h+c+a,r-u-d-p+l,h+c+f+a,r-u-d+l];case 90:return[h+d+a,r-u+c+l,h+d+p+a,r-u+c+f+l];case 180:return[h-c-f+a,r-u+d+l,h-c+a,r-u+d+p+l];case 270:return[h-d-p+a,r-u-c-f+l,h-d+a,r-u-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,i){const[s,n,o,r]=t,a=o-s,l=r-n;switch(this.rotation){case 0:return[s,i-r,a,l];case 90:return[s,i-n,l,a];case 180:return[o,i-n,a,l];case 270:return[o,i-r,l,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){y(this,kl,!0)}disableEditMode(){y(this,kl,!1)}isInEditMode(){return g(this,kl)}shouldGetKeyboardEvents(){return g(this,jo)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){x(this,$e,Ww).call(this)}rotate(t){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,i=null){Et("An editor must be serializable")}static async deserialize(t,i,s){const n=new this.prototype.constructor({parent:i,id:i.getNextId(),uiManager:s});n.rotation=t.rotation,y(n,Tl,t.accessibilityData);const[o,r]=n.pageDimensions,[a,l,c,d]=n.getRectInCurrentCoords(t.rect,r);return n.x=a/o,n.y=l/r,n.width=c/o,n.height=d/r,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t;if((t=g(this,la))==null||t.abort(),y(this,la,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),g(this,so)&&(clearTimeout(g(this,so)),y(this,so,null)),x(this,$e,wu).call(this),this.removeEditToolbar(),g(this,qs)){for(const i of g(this,qs).values())clearTimeout(i);y(this,qs,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(x(this,$e,SA).call(this),g(this,Ri).classList.remove("hidden"),Em(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),y(this,Ml,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const i=g(this,Ri).children;if(!g(this,vn)){y(this,vn,Array.from(i));const r=x(this,$e,EA).bind(this),a=x(this,$e,AA).bind(this),l=this._uiManager._signal;for(const c of g(this,vn)){const d=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",r,{signal:l}),c.addEventListener("blur",a,{signal:l}),c.addEventListener("focus",x(this,$e,FA).bind(this,d),{signal:l}),c.setAttribute("data-l10n-id",dt._l10nResizer[d])}}const s=g(this,vn)[0];let n=0;for(const r of i){if(r===s)break;n++}const o=(360-this.rotation+this.parentRotation)%360/90*(g(this,vn).length/4);if(o!==n){if(o<n)for(let a=0;a<n-o;a++)g(this,Ri).append(g(this,Ri).firstChild);else if(o>n)for(let a=0;a<o-n;a++)g(this,Ri).firstChild.before(g(this,Ri).lastChild);let r=0;for(const a of i){const c=g(this,vn)[r++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",dt._l10nResizer[c])}}x(this,$e,$w).call(this,0),y(this,jo,!0),g(this,Ri).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,i){g(this,jo)&&x(this,$e,Vw).call(this,g(this,Ng),{movementX:t,movementY:i})}_stopResizingWithKeyboard(){x(this,$e,wu).call(this),this.div.focus()}select(){var t,i,s;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var n,o;(n=this.div)!=null&&n.classList.contains("selectedEditor")&&((o=this._editToolbar)==null||o.show())});return}(i=this._editToolbar)==null||i.show(),(s=g(this,kt))==null||s.toggleAltTextBadge(!1)}unselect(){var t,i,s,n,o;(t=g(this,Ri))==null||t.classList.add("hidden"),(i=this.div)==null||i.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(n=this._editToolbar)==null||n.hide(),(o=g(this,kt))==null||o.toggleAltTextBadge(!0)}updateParams(t,i){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return g(this,Hg)}set isEditing(t){y(this,Hg,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,i){y(this,Dl,!0);const s=t/i,{style:n}=this.div;n.aspectRatio=s,n.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,i=!1){if(i){g(this,qs)||y(this,qs,new Map);const{action:s}=t;let n=g(this,qs).get(s);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(t),g(this,qs).delete(s),g(this,qs).size===0&&y(this,qs,null)},dt._telemetryTimeout),g(this,qs).set(s,n);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),y(this,jd,!1)}disable(){this.div&&(this.div.tabIndex=-1),y(this,jd,!0)}renderAnnotationElement(t){let i=t.container.querySelector(".annotationContent");if(!i)i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),t.container.prepend(i);else if(i.nodeName==="CANVAS"){const s=i;i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),s.before(i)}return i}resetAnnotationElement(t){const{firstChild:i}=t.container;(i==null?void 0:i.nodeName)==="DIV"&&i.classList.contains("annotationContent")&&i.remove()}};Tl=new WeakMap,vn=new WeakMap,kt=new WeakMap,jd=new WeakMap,Dl=new WeakMap,Ri=new WeakMap,Ml=new WeakMap,la=new WeakMap,Ng=new WeakMap,Il=new WeakMap,ca=new WeakMap,Hg=new WeakMap,kl=new WeakMap,jo=new WeakMap,so=new WeakMap,Kd=new WeakMap,qd=new WeakMap,qs=new WeakMap,Gg=new WeakMap,av=new WeakMap,$e=new WeakSet,Nw=function([t,i],s,n){[s,n]=this.screenToPageTranslation(s,n),this.x+=s/t,this.y+=n/i,this.fixAndSetPosition()},Bg=new WeakSet,Hw=function(t,i,s){switch(s){case 90:return[i,-t];case 180:return[-t,-i];case 270:return[-i,t];default:return[t,i]}},Gw=function(t){switch(t){case 90:{const[i,s]=this.pageDimensions;return[0,-i/s,s/i,0]}case 180:return[-1,0,0,-1];case 270:{const[i,s]=this.pageDimensions;return[0,i/s,-s/i,0]}default:return[1,0,0,1]}},SA=function(){if(g(this,Ri))return;y(this,Ri,document.createElement("div")),g(this,Ri).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],i=this._uiManager._signal;for(const s of t){const n=document.createElement("div");g(this,Ri).append(n),n.classList.add("resizer",s),n.setAttribute("data-resizer-name",s),n.addEventListener("pointerdown",x(this,$e,RA).bind(this,s),{signal:i}),n.addEventListener("contextmenu",on,{signal:i}),n.tabIndex=-1}this.div.prepend(g(this,Ri))},RA=function(t,i){var p;i.preventDefault();const{isMac:s}=es.platform;if(i.button!==0||i.ctrlKey&&s)return;(p=g(this,kt))==null||p.toggle(!1);const n=this._isDraggable;this._isDraggable=!1;const o=new AbortController,r=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",x(this,$e,Vw).bind(this,t),{passive:!0,capture:!0,signal:r}),window.addEventListener("contextmenu",on,{signal:r});const a=this.x,l=this.y,c=this.width,d=this.height,h=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(i.target).cursor;const f=()=>{var m;o.abort(),this.parent.togglePointerEvents(!0),(m=g(this,kt))==null||m.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=h,this.div.style.cursor=u,x(this,$e,Bw).call(this,a,l,c,d)};window.addEventListener("pointerup",f,{signal:r}),window.addEventListener("blur",f,{signal:r})},Bw=function(t,i,s,n){const o=this.x,r=this.y,a=this.width,l=this.height;o===t&&r===i&&a===s&&l===n||this.addCommands({cmd:()=>{this.width=a,this.height=l,this.x=o,this.y=r;const[c,d]=this.parentDimensions;this.setDims(c*a,d*l),this.fixAndSetPosition()},undo:()=>{this.width=s,this.height=n,this.x=t,this.y=i;const[c,d]=this.parentDimensions;this.setDims(c*s,d*n),this.fixAndSetPosition()},mustExec:!0})},Vw=function(t,i){const[s,n]=this.parentDimensions,o=this.x,r=this.y,a=this.width,l=this.height,c=dt.MIN_SIZE/s,d=dt.MIN_SIZE/n,h=X=>Math.round(X*1e4)/1e4,u=x(this,$e,Gw).call(this,this.rotation),f=(X,U)=>[u[0]*X+u[2]*U,u[1]*X+u[3]*U],p=x(this,$e,Gw).call(this,360-this.rotation),m=(X,U)=>[p[0]*X+p[2]*U,p[1]*X+p[3]*U];let v,C,w=!1,S=!1;switch(t){case"topLeft":w=!0,v=(X,U)=>[0,0],C=(X,U)=>[X,U];break;case"topMiddle":v=(X,U)=>[X/2,0],C=(X,U)=>[X/2,U];break;case"topRight":w=!0,v=(X,U)=>[X,0],C=(X,U)=>[0,U];break;case"middleRight":S=!0,v=(X,U)=>[X,U/2],C=(X,U)=>[0,U/2];break;case"bottomRight":w=!0,v=(X,U)=>[X,U],C=(X,U)=>[0,0];break;case"bottomMiddle":v=(X,U)=>[X/2,U],C=(X,U)=>[X/2,0];break;case"bottomLeft":w=!0,v=(X,U)=>[0,U],C=(X,U)=>[X,0];break;case"middleLeft":S=!0,v=(X,U)=>[0,U/2],C=(X,U)=>[X,U/2];break}const b=v(a,l),E=C(a,l);let A=f(...E);const P=h(o+A[0]),T=h(r+A[1]);let D=1,N=1,[M,_]=this.screenToPageTranslation(i.movementX,i.movementY);if([M,_]=m(M/s,_/n),w){const X=Math.hypot(a,l);D=N=Math.max(Math.min(Math.hypot(E[0]-b[0]-M,E[1]-b[1]-_)/X,1/a,1/l),c/a,d/l)}else S?D=Math.max(c,Math.min(1,Math.abs(E[0]-b[0]-M)))/a:N=Math.max(d,Math.min(1,Math.abs(E[1]-b[1]-_)))/l;const W=h(a*D),$=h(l*N);A=f(...C(W,$));const B=P-A[0],q=T-A[1];this.width=W,this.height=$,this.x=B,this.y=q,this.setDims(s*W,n*$),this.fixAndSetPosition()},zw=function(t){const{isMac:i}=es.platform;t.ctrlKey&&!i||t.shiftKey||t.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)},xA=function(t){const{isSelected:i}=this;this._uiManager.setUpDragSession();const s=new AbortController,n=this._uiManager.combinedSignal(s);if(i){this.div.classList.add("moving"),y(this,Kd,t.clientX),y(this,qd,t.clientY);const r=a=>{const{clientX:l,clientY:c}=a,[d,h]=this.screenToPageTranslation(l-g(this,Kd),c-g(this,qd));y(this,Kd,l),y(this,qd,c),this._uiManager.dragSelectedEditors(d,h)};window.addEventListener("pointermove",r,{passive:!0,capture:!0,signal:n})}const o=()=>{s.abort(),i&&this.div.classList.remove("moving"),y(this,Il,!1),this._uiManager.endDragSession()||x(this,$e,zw).call(this,t)};window.addEventListener("pointerup",o,{signal:n}),window.addEventListener("blur",o,{signal:n})},Ww=function(){if(g(this,la)||!this.div)return;y(this,la,new AbortController);const t=this._uiManager.combinedSignal(g(this,la));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},EA=function(t){dt._resizerKeyboardManager.exec(this,t)},AA=function(t){var i;g(this,jo)&&((i=t.relatedTarget)==null?void 0:i.parentNode)!==g(this,Ri)&&x(this,$e,wu).call(this)},FA=function(t){y(this,Ng,g(this,jo)?t:"")},$w=function(t){if(g(this,vn))for(const i of g(this,vn))i.tabIndex=t},wu=function(){if(y(this,jo,!1),x(this,$e,$w).call(this,-1),g(this,Ml)){const{savedX:t,savedY:i,savedWidth:s,savedHeight:n}=g(this,Ml);x(this,$e,Bw).call(this,t,i,s,n),y(this,Ml,null)}},F(dt,Bg),Pe(dt,"_l10n",null),Pe(dt,"_l10nResizer",null),Pe(dt,"_borderLineWidth",-1),Pe(dt,"_colorManager",new Dw),Pe(dt,"_zIndex",1),Pe(dt,"_telemetryTimeout",1e3);let pt=dt;class rL extends pt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const H0=3285377520,Gs=4294901760,Bn=65535;class PA{constructor(t){this.h1=t?t&4294967295:H0,this.h2=t?t&4294967295:H0}update(t){let i,s;if(typeof t=="string"){i=new Uint8Array(t.length*2),s=0;for(let m=0,v=t.length;m<v;m++){const C=t.charCodeAt(m);C<=255?i[s++]=C:(i[s++]=C>>>8,i[s++]=C&255)}}else if(ArrayBuffer.isView(t))i=t.slice(),s=i.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=s>>2,o=s-n*4,r=new Uint32Array(i.buffer,0,n);let a=0,l=0,c=this.h1,d=this.h2;const h=3432918353,u=461845907,f=h&Bn,p=u&Bn;for(let m=0;m<n;m++)m&1?(a=r[m],a=a*h&Gs|a*f&Bn,a=a<<15|a>>>17,a=a*u&Gs|a*p&Bn,c^=a,c=c<<13|c>>>19,c=c*5+3864292196):(l=r[m],l=l*h&Gs|l*f&Bn,l=l<<15|l>>>17,l=l*u&Gs|l*p&Bn,d^=l,d=d<<13|d>>>19,d=d*5+3864292196);switch(a=0,o){case 3:a^=i[n*4+2]<<16;case 2:a^=i[n*4+1]<<8;case 1:a^=i[n*4],a=a*h&Gs|a*f&Bn,a=a<<15|a>>>17,a=a*u&Gs|a*p&Bn,n&1?c^=a:d^=a}this.h1=c,this.h2=d}hexdigest(){let t=this.h1,i=this.h2;return t^=i>>>1,t=t*3981806797&Gs|t*36045&Bn,i=i*4283543511&Gs|((i<<16|t>>>16)*2950163797&Gs)>>>16,t^=i>>>1,t=t*444984403&Gs|t*60499&Bn,i=i*3301882366&Gs|((i<<16|t>>>16)*3120437893&Gs)>>>16,t^=i>>>1,(t>>>0).toString(16).padStart(8,"0")+(i>>>0).toString(16).padStart(8,"0")}}const Uw=Object.freeze({map:null,hash:"",transfer:void 0});var _l,Ll,gi,lv,TA;class Xy{constructor(){F(this,lv);F(this,_l,!1);F(this,Ll,null);F(this,gi,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,i){const s=g(this,gi).get(t);return s===void 0?i:Object.assign(i,s)}getRawValue(t){return g(this,gi).get(t)}remove(t){if(g(this,gi).delete(t),g(this,gi).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const i of g(this,gi).values())if(i instanceof pt)return;this.onAnnotationEditor(null)}}setValue(t,i){const s=g(this,gi).get(t);let n=!1;if(s!==void 0)for(const[o,r]of Object.entries(i))s[o]!==r&&(n=!0,s[o]=r);else n=!0,g(this,gi).set(t,i);n&&x(this,lv,TA).call(this),i instanceof pt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type)}has(t){return g(this,gi).has(t)}getAll(){return g(this,gi).size>0?$y(g(this,gi)):null}setAll(t){for(const[i,s]of Object.entries(t))this.setValue(i,s)}get size(){return g(this,gi).size}resetModified(){g(this,_l)&&(y(this,_l,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new DA(this)}get serializable(){if(g(this,gi).size===0)return Uw;const t=new Map,i=new PA,s=[],n=Object.create(null);let o=!1;for(const[r,a]of g(this,gi)){const l=a instanceof pt?a.serialize(!1,n):a;l&&(t.set(r,l),i.update(`${r}:${JSON.stringify(l)}`),o||(o=!!l.bitmap))}if(o)for(const r of t.values())r.bitmap&&s.push(r.bitmap);return t.size>0?{map:t,hash:i.hexdigest(),transfer:s}:Uw}get editorStats(){let t=null;const i=new Map;for(const s of g(this,gi).values()){if(!(s instanceof pt))continue;const n=s.telemetryFinalData;if(!n)continue;const{type:o}=n;i.has(o)||i.set(o,Object.getPrototypeOf(s).constructor),t||(t=Object.create(null));const r=t[o]||(t[o]=new Map);for(const[a,l]of Object.entries(n)){if(a==="type")continue;let c=r.get(a);c||(c=new Map,r.set(a,c));const d=c.get(l)??0;c.set(l,d+1)}}for(const[s,n]of i)t[s]=n.computeTelemetryFinalData(t[s]);return t}resetModifiedIds(){y(this,Ll,null)}get modifiedIds(){if(g(this,Ll))return g(this,Ll);const t=[];for(const i of g(this,gi).values())!(i instanceof pt)||!i.annotationElementId||!i.serialize()||t.push(i.annotationElementId);return y(this,Ll,{ids:new Set(t),hash:t.join(",")})}}_l=new WeakMap,Ll=new WeakMap,gi=new WeakMap,lv=new WeakSet,TA=function(){g(this,_l)||(y(this,_l,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Vg;class DA extends Xy{constructor(i){super();F(this,Vg);const{map:s,hash:n,transfer:o}=i.serializable,r=structuredClone(s,o?{transfer:o}:null);y(this,Vg,{map:r,hash:n,transfer:o})}get print(){Et("Should not call PrintAnnotationStorage.print")}get serializable(){return g(this,Vg)}get modifiedIds(){return Qe(this,"modifiedIds",{ids:new Set,hash:""})}}Vg=new WeakMap;var Yd;class aL{constructor({ownerDocument:t=globalThis.document,styleElement:i=null}){F(this,Yd,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const i=this.styleElement.sheet;i.insertRule(t,i.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),g(this,Yd).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:i}){if(!(!t||g(this,Yd).has(t.loadedName))){if(ni(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:n,style:o}=t,r=new FontFace(s,n,o);this.addNativeFontFace(r);try{await r.load(),g(this,Yd).add(s),i==null||i(t)}catch{Ue(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(r)}return}Et("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(n){throw Ue(`Failed to load font '${s.family}': '${n}'.`),t.disableFontFace=!0,n}}return}const i=t.createFontFaceRule();if(i){if(this.insertRule(i),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const n=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,n)})}}get isFontLoadingAPISupported(){var i;const t=!!((i=this._document)!=null&&i.fonts);return Qe(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(Wi||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),Qe(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function i(){for(ni(!n.done,"completeRequest() cannot be called twice."),n.done=!0;s.length>0&&s[0].done;){const o=s.shift();setTimeout(o.callback,0)}}const{loadingRequests:s}=this,n={done:!1,complete:i,callback:t};return s.push(n),n}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Qe(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,i){function s(b,E){return b.charCodeAt(E)<<24|b.charCodeAt(E+1)<<16|b.charCodeAt(E+2)<<8|b.charCodeAt(E+3)&255}function n(b,E,A,P){const T=b.substring(0,E),D=b.substring(E+A);return T+P+D}let o,r;const a=this._document.createElement("canvas");a.width=1,a.height=1;const l=a.getContext("2d");let c=0;function d(b,E){if(++c>30){Ue("Load test font never loaded."),E();return}if(l.font="30px "+b,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){E();return}setTimeout(d.bind(null,b,E))}const h=`lt${Date.now()}${this.loadTestFontId++}`;let u=this._loadTestFont;u=n(u,976,h.length,h);const p=16,m=1482184792;let v=s(u,p);for(o=0,r=h.length-3;o<r;o+=4)v=v-m+s(h,o)|0;o<h.length&&(v=v-m+s(h+"XXX",o)|0),u=n(u,p,4,U1(v));const C=`url(data:font/opentype;base64,${btoa(u)});`,w=`@font-face {font-family:"${h}";src:${C}}`;this.insertRule(w);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const b of[t.loadedName,h]){const E=this._document.createElement("span");E.textContent="Hi",E.style.fontFamily=b,S.append(E)}this._document.body.append(S),d(h,()=>{S.remove(),i.complete()})}}Yd=new WeakMap;class lL{constructor(t,{disableFontFace:i=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(const n in t)this[n]=t[n];this.disableFontFace=i===!0,this._inspectFont=s}createNativeFontFace(){var i;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(i=this._inspectFont)==null||i.call(this,this),t}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${Q1(this.data)});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${t}}`}return(s=this._inspectFont)==null||s.call(this,this,t),i}getPathGenerator(t,i){if(this.compiledGlyphs[i]!==void 0)return this.compiledGlyphs[i];let s;try{s=t.get(this.loadedName+"_path_"+i)}catch(o){Ue(`getPathGenerator - ignoring character: "${o}".`)}if(!Array.isArray(s)||s.length===0)return this.compiledGlyphs[i]=function(o,r){};const n=[];for(let o=0,r=s.length;o<r;)switch(s[o++]){case ko.BEZIER_CURVE_TO:{const[a,l,c,d,h,u]=s.slice(o,o+6);n.push(f=>f.bezierCurveTo(a,l,c,d,h,u)),o+=6}break;case ko.MOVE_TO:{const[a,l]=s.slice(o,o+2);n.push(c=>c.moveTo(a,l)),o+=2}break;case ko.LINE_TO:{const[a,l]=s.slice(o,o+2);n.push(c=>c.lineTo(a,l)),o+=2}break;case ko.QUADRATIC_CURVE_TO:{const[a,l,c,d]=s.slice(o,o+4);n.push(h=>h.quadraticCurveTo(a,l,c,d)),o+=4}break;case ko.RESTORE:n.push(a=>a.restore());break;case ko.SAVE:n.push(a=>a.save());break;case ko.SCALE:ni(n.length===2,"Scale command is only valid at the third position.");break;case ko.TRANSFORM:{const[a,l,c,d,h,u]=s.slice(o,o+6);n.push(f=>f.transform(a,l,c,d,h,u)),o+=6}break;case ko.TRANSLATE:{const[a,l]=s.slice(o,o+2);n.push(c=>c.translate(a,l)),o+=2}break}return this.compiledGlyphs[i]=function(r,a){n[0](r),n[1](r),r.scale(a,-a);for(let l=2,c=n.length;l<c;l++)n[l](r)}}}var zg;class MA{constructor({enableHWA:t=!1}){F(this,zg,!1);y(this,zg,t)}create(t,i){if(t<=0||i<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,i);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!g(this,zg)})}}reset(t,i,s){if(!t.canvas)throw new Error("Canvas is not specified");if(i<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=i,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,i){Et("Abstract method `_createCanvas` called.")}}zg=new WeakMap;class cL extends MA{constructor({ownerDocument:t=globalThis.document,enableHWA:i=!1}){super({enableHWA:i}),this._document=t}_createCanvas(t,i){const s=this._document.createElement("canvas");return s.width=t,s.height=i,s}}class IA{constructor({baseUrl:t=null,isCompressed:i=!0}){this.baseUrl=t,this.isCompressed=i}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const i=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(i).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})}async _fetch(t){Et("Abstract method `_fetch` called.")}}class kA extends IA{async _fetch(t){const i=await Ov(t,this.isCompressed?"arraybuffer":"text");return i instanceof ArrayBuffer?new Uint8Array(i):Lv(i)}}class _A{addFilter(t){return"none"}addHCMFilter(t,i){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,i,s,n,o){return"none"}destroy(t=!1){}}var Ol,Nl,no,Ko,Hi,cv,Hl,be,Oi,id,sd,Np,nd,LA,jw,od,bu,yu,Kw,Su;class dL extends _A{constructor({docId:i,ownerDocument:s=globalThis.document}){super();F(this,be);F(this,Ol);F(this,Nl);F(this,no);F(this,Ko);F(this,Hi);F(this,cv);F(this,Hl,0);y(this,Ko,i),y(this,Hi,s)}addFilter(i){if(!i)return"none";let s=g(this,be,Oi).get(i);if(s)return s;const[n,o,r]=x(this,be,Np).call(this,i),a=i.length===1?n:`${n}${o}${r}`;if(s=g(this,be,Oi).get(a),s)return g(this,be,Oi).set(i,s),s;const l=`g_${g(this,Ko)}_transfer_map_${Ki(this,Hl)._++}`,c=x(this,be,nd).call(this,l);g(this,be,Oi).set(i,c),g(this,be,Oi).set(a,c);const d=x(this,be,od).call(this,l);return x(this,be,yu).call(this,n,o,r,d),c}addHCMFilter(i,s){var p;const n=`${i}-${s}`,o="base";let r=g(this,be,id).get(o);if((r==null?void 0:r.key)===n||(r?((p=r.filter)==null||p.remove(),r.key=n,r.url="none",r.filter=null):(r={key:n,url:"none",filter:null},g(this,be,id).set(o,r)),!i||!s))return r.url;const a=x(this,be,Su).call(this,i);i=Ae.makeHexColor(...a);const l=x(this,be,Su).call(this,s);if(s=Ae.makeHexColor(...l),g(this,be,sd).style.color="",i==="#000000"&&s==="#ffffff"||i===s)return r.url;const c=new Array(256);for(let m=0;m<=255;m++){const v=m/255;c[m]=v<=.03928?v/12.92:((v+.055)/1.055)**2.4}const d=c.join(","),h=`g_${g(this,Ko)}_hcm_filter`,u=r.filter=x(this,be,od).call(this,h);x(this,be,yu).call(this,d,d,d,u),x(this,be,jw).call(this,u);const f=(m,v)=>{const C=a[m]/255,w=l[m]/255,S=new Array(v+1);for(let b=0;b<=v;b++)S[b]=C+b/v*(w-C);return S.join(",")};return x(this,be,yu).call(this,f(0,5),f(1,5),f(2,5),u),r.url=x(this,be,nd).call(this,h),r.url}addAlphaFilter(i){let s=g(this,be,Oi).get(i);if(s)return s;const[n]=x(this,be,Np).call(this,[i]),o=`alpha_${n}`;if(s=g(this,be,Oi).get(o),s)return g(this,be,Oi).set(i,s),s;const r=`g_${g(this,Ko)}_alpha_map_${Ki(this,Hl)._++}`,a=x(this,be,nd).call(this,r);g(this,be,Oi).set(i,a),g(this,be,Oi).set(o,a);const l=x(this,be,od).call(this,r);return x(this,be,Kw).call(this,n,l),a}addLuminosityFilter(i){let s=g(this,be,Oi).get(i||"luminosity");if(s)return s;let n,o;if(i?([n]=x(this,be,Np).call(this,[i]),o=`luminosity_${n}`):o="luminosity",s=g(this,be,Oi).get(o),s)return g(this,be,Oi).set(i,s),s;const r=`g_${g(this,Ko)}_luminosity_map_${Ki(this,Hl)._++}`,a=x(this,be,nd).call(this,r);g(this,be,Oi).set(i,a),g(this,be,Oi).set(o,a);const l=x(this,be,od).call(this,r);return x(this,be,LA).call(this,l),i&&x(this,be,Kw).call(this,n,l),a}addHighlightHCMFilter(i,s,n,o,r){var w;const a=`${s}-${n}-${o}-${r}`;let l=g(this,be,id).get(i);if((l==null?void 0:l.key)===a||(l?((w=l.filter)==null||w.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},g(this,be,id).set(i,l)),!s||!n))return l.url;const[c,d]=[s,n].map(x(this,be,Su).bind(this));let h=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),u=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[f,p]=[o,r].map(x(this,be,Su).bind(this));u<h&&([h,u,f,p]=[u,h,p,f]),g(this,be,sd).style.color="";const m=(S,b,E)=>{const A=new Array(256),P=(u-h)/E,T=S/255,D=(b-S)/(255*E);let N=0;for(let M=0;M<=E;M++){const _=Math.round(h+M*P),W=T+M*D;for(let $=N;$<=_;$++)A[$]=W;N=_+1}for(let M=N;M<256;M++)A[M]=A[N-1];return A.join(",")},v=`g_${g(this,Ko)}_hcm_${i}_filter`,C=l.filter=x(this,be,od).call(this,v);return x(this,be,jw).call(this,C),x(this,be,yu).call(this,m(f[0],p[0],5),m(f[1],p[1],5),m(f[2],p[2],5),C),l.url=x(this,be,nd).call(this,v),l.url}destroy(i=!1){i&&g(this,be,id).size!==0||(g(this,no)&&(g(this,no).parentNode.parentNode.remove(),y(this,no,null)),g(this,Nl)&&(g(this,Nl).clear(),y(this,Nl,null)),y(this,Hl,0))}}Ol=new WeakMap,Nl=new WeakMap,no=new WeakMap,Ko=new WeakMap,Hi=new WeakMap,cv=new WeakMap,Hl=new WeakMap,be=new WeakSet,Oi=function(){return g(this,Nl)||y(this,Nl,new Map)},id=function(){return g(this,cv)||y(this,cv,new Map)},sd=function(){if(!g(this,no)){const i=g(this,Hi).createElement("div"),{style:s}=i;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const n=g(this,Hi).createElementNS(Oo,"svg");n.setAttribute("width",0),n.setAttribute("height",0),y(this,no,g(this,Hi).createElementNS(Oo,"defs")),i.append(n),n.append(g(this,no)),g(this,Hi).body.append(i)}return g(this,no)},Np=function(i){if(i.length===1){const c=i[0],d=new Array(256);for(let u=0;u<256;u++)d[u]=c[u]/255;const h=d.join(",");return[h,h,h]}const[s,n,o]=i,r=new Array(256),a=new Array(256),l=new Array(256);for(let c=0;c<256;c++)r[c]=s[c]/255,a[c]=n[c]/255,l[c]=o[c]/255;return[r.join(","),a.join(","),l.join(",")]},nd=function(i){if(g(this,Ol)===void 0){y(this,Ol,"");const s=g(this,Hi).URL;s!==g(this,Hi).baseURI&&(Nv(s)?Ue('#createUrl: ignore "data:"-URL for performance reasons.'):y(this,Ol,s.split("#",1)[0]))}return`url(${g(this,Ol)}#${i})`},LA=function(i){const s=g(this,Hi).createElementNS(Oo,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),i.append(s)},jw=function(i){const s=g(this,Hi).createElementNS(Oo,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),i.append(s)},od=function(i){const s=g(this,Hi).createElementNS(Oo,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",i),g(this,be,sd).append(s),s},bu=function(i,s,n){const o=g(this,Hi).createElementNS(Oo,s);o.setAttribute("type","discrete"),o.setAttribute("tableValues",n),i.append(o)},yu=function(i,s,n,o){const r=g(this,Hi).createElementNS(Oo,"feComponentTransfer");o.append(r),x(this,be,bu).call(this,r,"feFuncR",i),x(this,be,bu).call(this,r,"feFuncG",s),x(this,be,bu).call(this,r,"feFuncB",n)},Kw=function(i,s){const n=g(this,Hi).createElementNS(Oo,"feComponentTransfer");s.append(n),x(this,be,bu).call(this,n,"feFuncA",i)},Su=function(i){return g(this,be,sd).style.color=i,Yy(getComputedStyle(g(this,be,sd)).getPropertyValue("color"))};class OA{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load font data at: ${i}`)})}async _fetch(t){Et("Abstract method `_fetch` called.")}}class NA extends OA{async _fetch(t){const i=await Ov(t,"arraybuffer");return new Uint8Array(i)}}if(Wi){var qw=Promise.withResolvers(),Bu=null;(async()=>{const t=await hl(()=>import("./__vite-browser-external-BIHI7g3E.js"),[],import.meta.url),i=await hl(()=>import("./__vite-browser-external-BIHI7g3E.js"),[],import.meta.url),s=await hl(()=>import("./__vite-browser-external-BIHI7g3E.js"),[],import.meta.url),n=await hl(()=>import("./__vite-browser-external-BIHI7g3E.js"),[],import.meta.url);let o,r;return new Map(Object.entries({fs:t,http:i,https:s,url:n,canvas:o,path2d:r}))})().then(t=>{Bu=t,qw.resolve()},t=>{Ue(`loadPackages: ${t}`),Bu=new Map,qw.resolve()})}class Na{static get promise(){return qw.promise}static get(t){return Bu==null?void 0:Bu.get(t)}}async function HA(e){const i=await Na.get("fs").promises.readFile(e);return new Uint8Array(i)}class hL extends _A{}class uL extends MA{_createCanvas(t,i){return Na.get("canvas").createCanvas(t,i)}}class gL extends IA{async _fetch(t){return HA(t)}}class fL extends OA{async _fetch(t){return HA(t)}}const Qi={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Yw(e,t){if(!t)return;const i=t[2]-t[0],s=t[3]-t[1],n=new Path2D;n.rect(t[0],t[1],i,s),e.clip(n)}class Qy{getPattern(){Et("Abstract method `getPattern` called.")}}class pL extends Qy{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let i;this._type==="axial"?i=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(i=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)i.addColorStop(s[0],s[1]);return i}getPattern(t,i,s,n){let o;if(n===Qi.STROKE||n===Qi.FILL){const r=i.current.getClippedPathBoundingBox(n,Lt(t))||[0,0,0,0],a=Math.ceil(r[2]-r[0])||1,l=Math.ceil(r[3]-r[1])||1,c=i.cachedCanvases.getCanvas("pattern",a,l),d=c.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-r[0],-r[1]),s=Ae.transform(s,[1,0,0,1,r[0],r[1]]),d.transform(...i.baseTransform),this.matrix&&d.transform(...this.matrix),Yw(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),o=t.createPattern(c.canvas,"no-repeat");const h=new DOMMatrix(s);o.setTransform(h)}else Yw(t,this._bbox),o=this._createGradient(t);return o}}function uC(e,t,i,s,n,o,r,a){const l=t.coords,c=t.colors,d=e.data,h=e.width*4;let u;l[i+1]>l[s+1]&&(u=i,i=s,s=u,u=o,o=r,r=u),l[s+1]>l[n+1]&&(u=s,s=n,n=u,u=r,r=a,a=u),l[i+1]>l[s+1]&&(u=i,i=s,s=u,u=o,o=r,r=u);const f=(l[i]+t.offsetX)*t.scaleX,p=(l[i+1]+t.offsetY)*t.scaleY,m=(l[s]+t.offsetX)*t.scaleX,v=(l[s+1]+t.offsetY)*t.scaleY,C=(l[n]+t.offsetX)*t.scaleX,w=(l[n+1]+t.offsetY)*t.scaleY;if(p>=w)return;const S=c[o],b=c[o+1],E=c[o+2],A=c[r],P=c[r+1],T=c[r+2],D=c[a],N=c[a+1],M=c[a+2],_=Math.round(p),W=Math.round(w);let $,B,q,X,U,pe,Ee,Ce;for(let le=_;le<=W;le++){if(le<v){const we=le<p?0:(p-le)/(p-v);$=f-(f-m)*we,B=S-(S-A)*we,q=b-(b-P)*we,X=E-(E-T)*we}else{let we;le>w?we=1:v===w?we=0:we=(v-le)/(v-w),$=m-(m-C)*we,B=A-(A-D)*we,q=P-(P-N)*we,X=T-(T-M)*we}let ee;le<p?ee=0:le>w?ee=1:ee=(p-le)/(p-w),U=f-(f-C)*ee,pe=S-(S-D)*ee,Ee=b-(b-N)*ee,Ce=E-(E-M)*ee;const ve=Math.round(Math.min($,U)),Oe=Math.round(Math.max($,U));let Z=h*le+ve*4;for(let we=ve;we<=Oe;we++)ee=($-we)/($-U),ee<0?ee=0:ee>1&&(ee=1),d[Z++]=B-(B-pe)*ee|0,d[Z++]=q-(q-Ee)*ee|0,d[Z++]=X-(X-Ce)*ee|0,d[Z++]=255}}function mL(e,t,i){const s=t.coords,n=t.colors;let o,r;switch(t.type){case"lattice":const a=t.verticesPerRow,l=Math.floor(s.length/a)-1,c=a-1;for(o=0;o<l;o++){let d=o*a;for(let h=0;h<c;h++,d++)uC(e,i,s[d],s[d+1],s[d+a],n[d],n[d+1],n[d+a]),uC(e,i,s[d+a+1],s[d+1],s[d+a],n[d+a+1],n[d+1],n[d+a])}break;case"triangles":for(o=0,r=s.length;o<r;o+=3)uC(e,i,s[o],s[o+1],s[o+2],n[o],n[o+1],n[o+2]);break;default:throw new Error("illegal figure")}}class vL extends Qy{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,i,s){const a=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-a,d=Math.ceil(this._bounds[3])-l,h=Math.min(Math.ceil(Math.abs(c*t[0]*1.1)),3e3),u=Math.min(Math.ceil(Math.abs(d*t[1]*1.1)),3e3),f=c/h,p=d/u,m={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-l,scaleX:1/f,scaleY:1/p},v=h+4,C=u+4,w=s.getCanvas("mesh",v,C),S=w.context,b=S.createImageData(h,u);if(i){const A=b.data;for(let P=0,T=A.length;P<T;P+=4)A[P]=i[0],A[P+1]=i[1],A[P+2]=i[2],A[P+3]=255}for(const A of this._figures)mL(b,A,m);return S.putImageData(b,2,2),{canvas:w.canvas,offsetX:a-2*f,offsetY:l-2*p,scaleX:f,scaleY:p}}getPattern(t,i,s,n){Yw(t,this._bbox);let o;if(n===Qi.SHADING)o=Ae.singularValueDecompose2dScale(Lt(t));else if(o=Ae.singularValueDecompose2dScale(i.baseTransform),this.matrix){const a=Ae.singularValueDecompose2dScale(this.matrix);o=[o[0]*a[0],o[1]*a[1]]}const r=this._createMeshCanvas(o,n===Qi.SHADING?null:this._background,i.cachedCanvases);return n!==Qi.SHADING&&(t.setTransform(...i.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(r.offsetX,r.offsetY),t.scale(r.scaleX,r.scaleY),t.createPattern(r.canvas,"no-repeat")}}class CL extends Qy{getPattern(){return"hotpink"}}function wL(e){switch(e[0]){case"RadialAxial":return new pL(e);case"Mesh":return new vL(e);case"Dummy":return new CL}throw new Error(`Unknown IR type: ${e[0]}`)}const G0={COLORED:1,UNCOLORED:2},dv=class dv{constructor(t,i,s,n,o){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=i,this.ctx=s,this.canvasGraphicsFactory=n,this.baseTransform=o}createPatternCanvas(t){const{bbox:i,operatorList:s,paintType:n,tilingType:o,color:r,canvasGraphicsFactory:a}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),kv("TilingType: "+o);const d=i[0],h=i[1],u=i[2],f=i[3],p=u-d,m=f-h,v=Ae.singularValueDecompose2dScale(this.matrix),C=Ae.singularValueDecompose2dScale(this.baseTransform),w=v[0]*C[0],S=v[1]*C[1];let b=p,E=m,A=!1,P=!1;const T=Math.ceil(l*w),D=Math.ceil(c*S),N=Math.ceil(p*w),M=Math.ceil(m*S);T>=N?b=l:A=!0,D>=M?E=c:P=!0;const _=this.getSizeAndScale(b,this.ctx.canvas.width,w),W=this.getSizeAndScale(E,this.ctx.canvas.height,S),$=t.cachedCanvases.getCanvas("pattern",_.size,W.size),B=$.context,q=a.createCanvasGraphics(B);if(q.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(q,n,r),B.translate(-_.scale*d,-W.scale*h),q.transform(_.scale,0,0,W.scale,0,0),B.save(),this.clipBbox(q,d,h,u,f),q.baseTransform=Lt(q.ctx),q.executeOperatorList(s),q.endDrawing(),B.restore(),A||P){const X=$.canvas;A&&(b=l),P&&(E=c);const U=this.getSizeAndScale(b,this.ctx.canvas.width,w),pe=this.getSizeAndScale(E,this.ctx.canvas.height,S),Ee=U.size,Ce=pe.size,le=t.cachedCanvases.getCanvas("pattern-workaround",Ee,Ce),ee=le.context,ve=A?Math.floor(p/l):0,Oe=P?Math.floor(m/c):0;for(let Z=0;Z<=ve;Z++)for(let we=0;we<=Oe;we++)ee.drawImage(X,Ee*Z,Ce*we,Ee,Ce,0,0,Ee,Ce);return{canvas:le.canvas,scaleX:U.scale,scaleY:pe.scale,offsetX:d,offsetY:h}}return{canvas:$.canvas,scaleX:_.scale,scaleY:W.scale,offsetX:d,offsetY:h}}getSizeAndScale(t,i,s){const n=Math.max(dv.MAX_PATTERN_SIZE,i);let o=Math.ceil(t*s);return o>=n?o=n:s=o/t,{scale:s,size:o}}clipBbox(t,i,s,n,o){const r=n-i,a=o-s;t.ctx.rect(i,s,r,a),t.current.updateRectMinMax(Lt(t.ctx),[i,s,n,o]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,i,s){const n=t.ctx,o=t.current;switch(i){case G0.COLORED:const r=this.ctx;n.fillStyle=r.fillStyle,n.strokeStyle=r.strokeStyle,o.fillColor=r.fillStyle,o.strokeColor=r.strokeStyle;break;case G0.UNCOLORED:const a=Ae.makeHexColor(s[0],s[1],s[2]);n.fillStyle=a,n.strokeStyle=a,o.fillColor=a,o.strokeColor=a;break;default:throw new $1(`Unsupported paint type: ${i}`)}}getPattern(t,i,s,n){let o=s;n!==Qi.SHADING&&(o=Ae.transform(o,i.baseTransform),this.matrix&&(o=Ae.transform(o,this.matrix)));const r=this.createPatternCanvas(i);let a=new DOMMatrix(o);a=a.translate(r.offsetX,r.offsetY),a=a.scale(1/r.scaleX,1/r.scaleY);const l=t.createPattern(r.canvas,"repeat");return l.setTransform(a),l}};Pe(dv,"MAX_PATTERN_SIZE",3e3);let Xw=dv;function bL({src:e,srcPos:t=0,dest:i,width:s,height:n,nonBlackColor:o=4294967295,inverseDecode:r=!1}){const a=es.isLittleEndian?4278190080:255,[l,c]=r?[o,a]:[a,o],d=s>>3,h=s&7,u=e.length;i=new Uint32Array(i.buffer);let f=0;for(let p=0;p<n;p++){for(const v=t+d;t<v;t++){const C=t<u?e[t]:255;i[f++]=C&128?c:l,i[f++]=C&64?c:l,i[f++]=C&32?c:l,i[f++]=C&16?c:l,i[f++]=C&8?c:l,i[f++]=C&4?c:l,i[f++]=C&2?c:l,i[f++]=C&1?c:l}if(h===0)continue;const m=t<u?e[t++]:255;for(let v=0;v<h;v++)i[f++]=m&1<<7-v?c:l}return{srcPos:t,destPos:f}}const B0=16,V0=100,yL=15,z0=10,W0=1e3,hs=16;function SL(e,t){if(e._removeMirroring)throw new Error("Context is already forwarding operations.");e.__originalSave=e.save,e.__originalRestore=e.restore,e.__originalRotate=e.rotate,e.__originalScale=e.scale,e.__originalTranslate=e.translate,e.__originalTransform=e.transform,e.__originalSetTransform=e.setTransform,e.__originalResetTransform=e.resetTransform,e.__originalClip=e.clip,e.__originalMoveTo=e.moveTo,e.__originalLineTo=e.lineTo,e.__originalBezierCurveTo=e.bezierCurveTo,e.__originalRect=e.rect,e.__originalClosePath=e.closePath,e.__originalBeginPath=e.beginPath,e._removeMirroring=()=>{e.save=e.__originalSave,e.restore=e.__originalRestore,e.rotate=e.__originalRotate,e.scale=e.__originalScale,e.translate=e.__originalTranslate,e.transform=e.__originalTransform,e.setTransform=e.__originalSetTransform,e.resetTransform=e.__originalResetTransform,e.clip=e.__originalClip,e.moveTo=e.__originalMoveTo,e.lineTo=e.__originalLineTo,e.bezierCurveTo=e.__originalBezierCurveTo,e.rect=e.__originalRect,e.closePath=e.__originalClosePath,e.beginPath=e.__originalBeginPath,delete e._removeMirroring},e.save=function(){t.save(),this.__originalSave()},e.restore=function(){t.restore(),this.__originalRestore()},e.translate=function(s,n){t.translate(s,n),this.__originalTranslate(s,n)},e.scale=function(s,n){t.scale(s,n),this.__originalScale(s,n)},e.transform=function(s,n,o,r,a,l){t.transform(s,n,o,r,a,l),this.__originalTransform(s,n,o,r,a,l)},e.setTransform=function(s,n,o,r,a,l){t.setTransform(s,n,o,r,a,l),this.__originalSetTransform(s,n,o,r,a,l)},e.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},e.rotate=function(s){t.rotate(s),this.__originalRotate(s)},e.clip=function(s){t.clip(s),this.__originalClip(s)},e.moveTo=function(i,s){t.moveTo(i,s),this.__originalMoveTo(i,s)},e.lineTo=function(i,s){t.lineTo(i,s),this.__originalLineTo(i,s)},e.bezierCurveTo=function(i,s,n,o,r,a){t.bezierCurveTo(i,s,n,o,r,a),this.__originalBezierCurveTo(i,s,n,o,r,a)},e.rect=function(i,s,n,o){t.rect(i,s,n,o),this.__originalRect(i,s,n,o)},e.closePath=function(){t.closePath(),this.__originalClosePath()},e.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class RL{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,i,s){let n;return this.cache[t]!==void 0?(n=this.cache[t],this.canvasFactory.reset(n,i,s)):(n=this.canvasFactory.create(i,s),this.cache[t]=n),n}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const i=this.cache[t];this.canvasFactory.destroy(i),delete this.cache[t]}}}function hp(e,t,i,s,n,o,r,a,l,c){const[d,h,u,f,p,m]=Lt(e);if(h===0&&u===0){const w=r*d+p,S=Math.round(w),b=a*f+m,E=Math.round(b),A=(r+l)*d+p,P=Math.abs(Math.round(A)-S)||1,T=(a+c)*f+m,D=Math.abs(Math.round(T)-E)||1;return e.setTransform(Math.sign(d),0,0,Math.sign(f),S,E),e.drawImage(t,i,s,n,o,0,0,P,D),e.setTransform(d,h,u,f,p,m),[P,D]}if(d===0&&f===0){const w=a*u+p,S=Math.round(w),b=r*h+m,E=Math.round(b),A=(a+c)*u+p,P=Math.abs(Math.round(A)-S)||1,T=(r+l)*h+m,D=Math.abs(Math.round(T)-E)||1;return e.setTransform(0,Math.sign(h),Math.sign(u),0,S,E),e.drawImage(t,i,s,n,o,0,0,D,P),e.setTransform(d,h,u,f,p,m),[D,P]}e.drawImage(t,i,s,n,o,r,a,l,c);const v=Math.hypot(d,h),C=Math.hypot(u,f);return[v*l,C*c]}function xL(e){const{width:t,height:i}=e;if(t>W0||i>W0)return null;const s=1e3,n=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),o=t+1;let r=new Uint8Array(o*(i+1)),a,l,c;const d=t+7&-8;let h=new Uint8Array(d*i),u=0;for(const C of e.data){let w=128;for(;w>0;)h[u++]=C&w?0:255,w>>=1}let f=0;for(u=0,h[u]!==0&&(r[0]=1,++f),l=1;l<t;l++)h[u]!==h[u+1]&&(r[l]=h[u]?2:1,++f),u++;for(h[u]!==0&&(r[l]=2,++f),a=1;a<i;a++){u=a*d,c=a*o,h[u-d]!==h[u]&&(r[c]=h[u]?1:8,++f);let C=(h[u]?4:0)+(h[u-d]?8:0);for(l=1;l<t;l++)C=(C>>2)+(h[u+1]?4:0)+(h[u-d+1]?8:0),n[C]&&(r[c+l]=n[C],++f),u++;if(h[u-d]!==h[u]&&(r[c+l]=h[u]?2:4,++f),f>s)return null}for(u=d*(i-1),c=a*o,h[u]!==0&&(r[c]=8,++f),l=1;l<t;l++)h[u]!==h[u+1]&&(r[c+l]=h[u]?4:8,++f),u++;if(h[u]!==0&&(r[c+l]=4,++f),f>s)return null;const p=new Int32Array([0,o,-1,0,-o,0,0,0,1]),m=new Path2D;for(a=0;f&&a<=i;a++){let C=a*o;const w=C+t;for(;C<w&&!r[C];)C++;if(C===w)continue;m.moveTo(C%o,a);const S=C;let b=r[C];do{const E=p[b];do C+=E;while(!r[C]);const A=r[C];A!==5&&A!==10?(b=A,r[C]=0):(b=A&51*b>>4,r[C]&=b>>2|b<<2),m.lineTo(C%o,C/o|0),r[C]||--f}while(S!==C);--a}return h=null,r=null,function(C){C.save(),C.scale(1/t,-1/i),C.translate(0,-i),C.fill(m),C.beginPath(),C.restore()}}class $0{constructor(t,i){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=tA,this.textMatrixScale=1,this.fontMatrix=Sw,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Li.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,i])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,i){this.x=t,this.y=i}updatePathMinMax(t,i,s){[i,s]=Ae.applyTransform([i,s],t),this.minX=Math.min(this.minX,i),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,i),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(t,i){const s=Ae.applyTransform(i,t),n=Ae.applyTransform(i.slice(2),t),o=Ae.applyTransform([i[0],i[3]],t),r=Ae.applyTransform([i[2],i[1]],t);this.minX=Math.min(this.minX,s[0],n[0],o[0],r[0]),this.minY=Math.min(this.minY,s[1],n[1],o[1],r[1]),this.maxX=Math.max(this.maxX,s[0],n[0],o[0],r[0]),this.maxY=Math.max(this.maxY,s[1],n[1],o[1],r[1])}updateScalingPathMinMax(t,i){Ae.scaleMinMax(t,i),this.minX=Math.min(this.minX,i[0]),this.minY=Math.min(this.minY,i[1]),this.maxX=Math.max(this.maxX,i[2]),this.maxY=Math.max(this.maxY,i[3])}updateCurvePathMinMax(t,i,s,n,o,r,a,l,c,d){const h=Ae.bezierBoundingBox(i,s,n,o,r,a,l,c,d);d||this.updateRectMinMax(t,h)}getPathBoundingBox(t=Qi.FILL,i=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(t===Qi.STROKE){i||Et("Stroke bounding box must include transform.");const n=Ae.singularValueDecompose2dScale(i),o=n[0]*this.lineWidth/2,r=n[1]*this.lineWidth/2;s[0]-=o,s[1]-=r,s[2]+=o,s[3]+=r}return s}updateClipFromPath(){const t=Ae.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=Qi.FILL,i=null){return Ae.intersect(this.clipBox,this.getPathBoundingBox(t,i))}}function U0(e,t){if(typeof ImageData<"u"&&t instanceof ImageData){e.putImageData(t,0,0);return}const i=t.height,s=t.width,n=i%hs,o=(i-n)/hs,r=n===0?o:o+1,a=e.createImageData(s,hs);let l=0,c;const d=t.data,h=a.data;let u,f,p,m;if(t.kind===Dp.GRAYSCALE_1BPP){const v=d.byteLength,C=new Uint32Array(h.buffer,0,h.byteLength>>2),w=C.length,S=s+7>>3,b=4294967295,E=es.isLittleEndian?4278190080:255;for(u=0;u<r;u++){for(p=u<o?hs:n,c=0,f=0;f<p;f++){const A=v-l;let P=0;const T=A>S?s:A*8-7,D=T&-8;let N=0,M=0;for(;P<D;P+=8)M=d[l++],C[c++]=M&128?b:E,C[c++]=M&64?b:E,C[c++]=M&32?b:E,C[c++]=M&16?b:E,C[c++]=M&8?b:E,C[c++]=M&4?b:E,C[c++]=M&2?b:E,C[c++]=M&1?b:E;for(;P<T;P++)N===0&&(M=d[l++],N=128),C[c++]=M&N?b:E,N>>=1}for(;c<w;)C[c++]=0;e.putImageData(a,0,u*hs)}}else if(t.kind===Dp.RGBA_32BPP){for(f=0,m=s*hs*4,u=0;u<o;u++)h.set(d.subarray(l,l+m)),l+=m,e.putImageData(a,0,f),f+=hs;u<r&&(m=s*n*4,h.set(d.subarray(l,l+m)),e.putImageData(a,0,f))}else if(t.kind===Dp.RGB_24BPP)for(p=hs,m=s*p,u=0;u<r;u++){for(u>=o&&(p=n,m=s*p),c=0,f=m;f--;)h[c++]=d[l++],h[c++]=d[l++],h[c++]=d[l++],h[c++]=255;e.putImageData(a,0,u*hs)}else throw new Error(`bad image kind: ${t.kind}`)}function j0(e,t){if(t.bitmap){e.drawImage(t.bitmap,0,0);return}const i=t.height,s=t.width,n=i%hs,o=(i-n)/hs,r=n===0?o:o+1,a=e.createImageData(s,hs);let l=0;const c=t.data,d=a.data;for(let h=0;h<r;h++){const u=h<o?hs:n;({srcPos:l}=bL({src:c,srcPos:l,dest:d,width:s,height:u,nonBlackColor:0})),e.putImageData(a,0,h*hs)}}function au(e,t){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of i)e[s]!==void 0&&(t[s]=e[s]);e.setLineDash!==void 0&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function up(e){if(e.strokeStyle=e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",e.setLineDash!==void 0&&(e.setLineDash([]),e.lineDashOffset=0),!Wi){const{filter:t}=e;t!=="none"&&t!==""&&(e.filter="none")}}function K0(e,t){if(t)return!0;const i=Ae.singularValueDecompose2dScale(e);i[0]=Math.fround(i[0]),i[1]=Math.fround(i[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*Oa.PDF_TO_CSS_UNITS);return i[0]<=s&&i[1]<=s}const EL=["butt","round","square"],AL=["miter","round","bevel"],FL={},q0={};var $a,Qw,Jw;const XS=class XS{constructor(t,i,s,n,o,{optionalContentConfig:r,markedContentStack:a=null},l,c){F(this,$a);this.ctx=t,this.current=new $0(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=s,this.canvasFactory=n,this.filterFactory=o,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=r,this.cachedCanvases=new RL(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,i=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):i}beginDrawing({transform:t,viewport:i,transparency:s=!1,background:n=null}){const o=this.ctx.canvas.width,r=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,o,r),this.ctx.fillStyle=a,s){const l=this.cachedCanvases.getCanvas("transparent",o,r);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Lt(this.compositeCtx))}this.ctx.save(),up(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=Lt(this.ctx)}executeOperatorList(t,i,s,n){const o=t.argsArray,r=t.fnArray;let a=i||0;const l=o.length;if(l===a)return a;const c=l-a>z0&&typeof s=="function",d=c?Date.now()+yL:0;let h=0;const u=this.commonObjs,f=this.objs;let p;for(;;){if(n!==void 0&&a===n.nextBreakPoint)return n.breakIt(a,s),a;if(p=r[a],p!==hn.dependency)this[p].apply(this,o[a]);else for(const m of o[a]){const v=m.startsWith("g_")?u:f;if(!v.has(m))return v.get(m,s),a}if(a++,a===l)return a;if(c&&++h>z0){if(Date.now()>d)return s(),a;h=0}}}endDrawing(){x(this,$a,Qw).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const i of t.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);t.clear()}this._cachedBitmapsMap.clear(),x(this,$a,Jw).call(this)}_scaleImage(t,i){const s=t.width??t.displayWidth,n=t.height??t.displayHeight;let o=Math.max(Math.hypot(i[0],i[1]),1),r=Math.max(Math.hypot(i[2],i[3]),1),a=s,l=n,c="prescale1",d,h;for(;o>2&&a>1||r>2&&l>1;){let u=a,f=l;o>2&&a>1&&(u=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),o/=a/u),r>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,r/=l/f),d=this.cachedCanvases.getCanvas(c,u,f),h=d.context,h.clearRect(0,0,u,f),h.drawImage(t,0,0,a,l,0,0,u,f),t=d.canvas,a=u,l=f,c=c==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:a,paintHeight:l}}_createMaskCanvas(t){const i=this.ctx,{width:s,height:n}=t,o=this.current.fillColor,r=this.current.patternFill,a=Lt(i);let l,c,d,h;if((t.bitmap||t.data)&&t.count>1){const T=t.bitmap||t.data.buffer;c=JSON.stringify(r?a:[a.slice(0,4),o]),l=this._cachedBitmapsMap.get(T),l||(l=new Map,this._cachedBitmapsMap.set(T,l));const D=l.get(c);if(D&&!r){const N=Math.round(Math.min(a[0],a[2])+a[4]),M=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:D,offsetX:N,offsetY:M}}d=D}d||(h=this.cachedCanvases.getCanvas("maskCanvas",s,n),j0(h.context,t));let u=Ae.transform(a,[1/s,0,0,-1/n,0,0]);u=Ae.transform(u,[1,0,0,1,0,-n]);const[f,p,m,v]=Ae.getAxialAlignedBoundingBox([0,0,s,n],u),C=Math.round(m-f)||1,w=Math.round(v-p)||1,S=this.cachedCanvases.getCanvas("fillCanvas",C,w),b=S.context,E=f,A=p;b.translate(-E,-A),b.transform(...u),d||(d=this._scaleImage(h.canvas,_o(b)),d=d.img,l&&r&&l.set(c,d)),b.imageSmoothingEnabled=K0(Lt(b),t.interpolate),hp(b,d,0,0,d.width,d.height,0,0,s,n),b.globalCompositeOperation="source-in";const P=Ae.transform(_o(b),[1,0,0,1,-E,-A]);return b.fillStyle=r?o.getPattern(i,this,P,Qi.FILL):o,b.fillRect(0,0,s,n),l&&!r&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,S.canvas)),{canvas:S.canvas,offsetX:Math.round(E),offsetY:Math.round(A)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=EL[t]}setLineJoin(t){this.ctx.lineJoin=AL[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,i){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=i)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[i,s]of t)switch(i){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,i=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,n=this.cachedCanvases.getCanvas(s,t,i);this.suspendedCtx=this.ctx,this.ctx=n.context;const o=this.ctx;o.setTransform(...Lt(this.suspendedCtx)),au(this.suspendedCtx,o),SL(o,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),au(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,i,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,i,s,n){const o=n[0],r=n[1],a=n[2]-o,l=n[3]-r;a===0||l===0||(this.genericComposeSMask(i.context,s,a,l,i.subtype,i.backdrop,i.transferMap,o,r,i.offsetX,i.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,i,s,n,o,r,a,l,c,d,h){let u=t.canvas,f=l-d,p=c-h;if(r){const v=Ae.makeHexColor(...r);if(f<0||p<0||f+s>u.width||p+n>u.height){const C=this.cachedCanvases.getCanvas("maskExtension",s,n),w=C.context;w.drawImage(u,-f,-p),w.globalCompositeOperation="destination-atop",w.fillStyle=v,w.fillRect(0,0,s,n),w.globalCompositeOperation="source-over",u=C.canvas,f=p=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const C=new Path2D;C.rect(f,p,s,n),t.clip(C),t.globalCompositeOperation="destination-atop",t.fillStyle=v,t.fillRect(f,p,s,n),t.restore()}}i.save(),i.globalAlpha=1,i.setTransform(1,0,0,1,0,0),o==="Alpha"&&a?i.filter=this.filterFactory.addAlphaFilter(a):o==="Luminosity"&&(i.filter=this.filterFactory.addLuminosityFilter(a));const m=new Path2D;m.rect(l,c,s,n),i.clip(m),i.globalCompositeOperation="destination-in",i.drawImage(u,f,p,s,n,l,c,s,n),i.restore()}save(){this.inSMaskMode?(au(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),au(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,i,s,n,o,r){this.ctx.transform(t,i,s,n,o,r),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,i,s){const n=this.ctx,o=this.current;let r=o.x,a=o.y,l,c;const d=Lt(n),h=d[0]===0&&d[3]===0||d[1]===0&&d[2]===0,u=h?s.slice(0):null;for(let f=0,p=0,m=t.length;f<m;f++)switch(t[f]|0){case hn.rectangle:r=i[p++],a=i[p++];const v=i[p++],C=i[p++],w=r+v,S=a+C;n.moveTo(r,a),v===0||C===0?n.lineTo(w,S):(n.lineTo(w,a),n.lineTo(w,S),n.lineTo(r,S)),h||o.updateRectMinMax(d,[r,a,w,S]),n.closePath();break;case hn.moveTo:r=i[p++],a=i[p++],n.moveTo(r,a),h||o.updatePathMinMax(d,r,a);break;case hn.lineTo:r=i[p++],a=i[p++],n.lineTo(r,a),h||o.updatePathMinMax(d,r,a);break;case hn.curveTo:l=r,c=a,r=i[p+4],a=i[p+5],n.bezierCurveTo(i[p],i[p+1],i[p+2],i[p+3],r,a),o.updateCurvePathMinMax(d,l,c,i[p],i[p+1],i[p+2],i[p+3],r,a,u),p+=6;break;case hn.curveTo2:l=r,c=a,n.bezierCurveTo(r,a,i[p],i[p+1],i[p+2],i[p+3]),o.updateCurvePathMinMax(d,l,c,r,a,i[p],i[p+1],i[p+2],i[p+3],u),r=i[p+2],a=i[p+3],p+=4;break;case hn.curveTo3:l=r,c=a,r=i[p+2],a=i[p+3],n.bezierCurveTo(i[p],i[p+1],r,a,r,a),o.updateCurvePathMinMax(d,l,c,i[p],i[p+1],r,a,r,a,u),p+=4;break;case hn.closePath:n.closePath();break}h&&o.updateScalingPathMinMax(d,u),o.setCurrentPoint(r,a)}closePath(){this.ctx.closePath()}stroke(t=!0){const i=this.ctx,s=this.current.strokeColor;i.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(i.save(),i.strokeStyle=s.getPattern(i,this,_o(i),Qi.STROKE),this.rescaleAndStroke(!1),i.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),i.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const i=this.ctx,s=this.current.fillColor,n=this.current.patternFill;let o=!1;n&&(i.save(),i.fillStyle=s.getPattern(i,this,_o(i),Qi.FILL),o=!0);const r=this.current.getClippedPathBoundingBox();this.contentVisible&&r!==null&&(this.pendingEOFill?(i.fill("evenodd"),this.pendingEOFill=!1):i.fill()),o&&i.restore(),t&&this.consumePath(r)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=FL}eoClip(){this.pendingClip=q0}beginText(){this.current.textMatrix=tA,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,i=this.ctx;if(t===void 0){i.beginPath();return}i.save(),i.beginPath();for(const s of t)i.setTransform(...s.transform),i.translate(s.x,s.y),s.addToPath(i,s.fontSize);i.restore(),i.clip(),i.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,i){var d;const s=this.commonObjs.get(t),n=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(n.fontMatrix=s.fontMatrix||Sw,(n.fontMatrix[0]===0||n.fontMatrix[3]===0)&&Ue("Invalid font matrix for font "+t),i<0?(i=-i,n.fontDirection=-1):n.fontDirection=1,this.current.font=s,this.current.fontSize=i,s.isType3Font)return;const o=s.loadedName||"sans-serif",r=((d=s.systemFontInfo)==null?void 0:d.css)||`"${o}", ${s.fallbackName}`;let a="normal";s.black?a="900":s.bold&&(a="bold");const l=s.italic?"italic":"normal";let c=i;i<B0?c=B0:i>V0&&(c=V0),this.current.fontSizeScale=i/c,this.ctx.font=`${l} ${a} ${c}px ${r}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,i){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,i){this.setLeading(-i),this.moveText(t,i)}setTextMatrix(t,i,s,n,o,r){this.current.textMatrix=[t,i,s,n,o,r],this.current.textMatrixScale=Math.hypot(t,i),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,i,s,n){const o=this.ctx,r=this.current,a=r.font,l=r.textRenderingMode,c=r.fontSize/r.fontSizeScale,d=l&Li.FILL_STROKE_MASK,h=!!(l&Li.ADD_TO_PATH_FLAG),u=r.patternFill&&!a.missingFile;let f;(a.disableFontFace||h||u)&&(f=a.getPathGenerator(this.commonObjs,t)),a.disableFontFace||u?(o.save(),o.translate(i,s),o.beginPath(),f(o,c),n&&o.setTransform(...n),(d===Li.FILL||d===Li.FILL_STROKE)&&o.fill(),(d===Li.STROKE||d===Li.FILL_STROKE)&&o.stroke(),o.restore()):((d===Li.FILL||d===Li.FILL_STROKE)&&o.fillText(t,i,s),(d===Li.STROKE||d===Li.FILL_STROKE)&&o.strokeText(t,i,s)),h&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Lt(o),x:i,y:s,fontSize:c,addToPath:f})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const i=t.getImageData(0,0,10,10).data;let s=!1;for(let n=3;n<i.length;n+=4)if(i[n]>0&&i[n]<255){s=!0;break}return Qe(this,"isFontSubpixelAAEnabled",s)}showText(t){const i=this.current,s=i.font;if(s.isType3Font)return this.showType3Text(t);const n=i.fontSize;if(n===0)return;const o=this.ctx,r=i.fontSizeScale,a=i.charSpacing,l=i.wordSpacing,c=i.fontDirection,d=i.textHScale*c,h=t.length,u=s.vertical,f=u?1:-1,p=s.defaultVMetrics,m=n*i.fontMatrix[0],v=i.textRenderingMode===Li.FILL&&!s.disableFontFace&&!i.patternFill;o.save(),o.transform(...i.textMatrix),o.translate(i.x,i.y+i.textRise),c>0?o.scale(d,-1):o.scale(d,1);let C;if(i.patternFill){o.save();const A=i.fillColor.getPattern(o,this,_o(o),Qi.FILL);C=Lt(o),o.restore(),o.fillStyle=A}let w=i.lineWidth;const S=i.textMatrixScale;if(S===0||w===0){const A=i.textRenderingMode&Li.FILL_STROKE_MASK;(A===Li.STROKE||A===Li.FILL_STROKE)&&(w=this.getSinglePixelWidth())}else w/=S;if(r!==1&&(o.scale(r,r),w/=r),o.lineWidth=w,s.isInvalidPDFjsFont){const A=[];let P=0;for(const T of t)A.push(T.unicode),P+=T.width;o.fillText(A.join(""),0,0),i.x+=P*m*d,o.restore(),this.compose();return}let b=0,E;for(E=0;E<h;++E){const A=t[E];if(typeof A=="number"){b+=f*A*n/1e3;continue}let P=!1;const T=(A.isSpace?l:0)+a,D=A.fontChar,N=A.accent;let M,_,W=A.width;if(u){const B=A.vmetric||p,q=-(A.vmetric?B[1]:W*.5)*m,X=B[2]*m;W=B?-B[0]:W,M=q/r,_=(b+X)/r}else M=b/r,_=0;if(s.remeasure&&W>0){const B=o.measureText(D).width*1e3/n*r;if(W<B&&this.isFontSubpixelAAEnabled){const q=W/B;P=!0,o.save(),o.scale(q,1),M/=q}else W!==B&&(M+=(W-B)/2e3*n/r)}if(this.contentVisible&&(A.isInFont||s.missingFile)){if(v&&!N)o.fillText(D,M,_);else if(this.paintChar(D,M,_,C),N){const B=M+n*N.offset.x/r,q=_-n*N.offset.y/r;this.paintChar(N.fontChar,B,q,C)}}const $=u?W*m-T*c:W*m+T*c;b+=$,P&&o.restore()}u?i.y-=b:i.x+=b*d,o.restore(),this.compose()}showType3Text(t){const i=this.ctx,s=this.current,n=s.font,o=s.fontSize,r=s.fontDirection,a=n.vertical?1:-1,l=s.charSpacing,c=s.wordSpacing,d=s.textHScale*r,h=s.fontMatrix||Sw,u=t.length,f=s.textRenderingMode===Li.INVISIBLE;let p,m,v,C;if(!(f||o===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),i.transform(...s.textMatrix),i.translate(s.x,s.y),i.scale(d,r),p=0;p<u;++p){if(m=t[p],typeof m=="number"){C=a*m*o/1e3,this.ctx.translate(C,0),s.x+=C*d;continue}const w=(m.isSpace?c:0)+l,S=n.charProcOperatorList[m.operatorListId];if(!S){Ue(`Type3 character "${m.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=m,this.save(),i.scale(o,o),i.transform(...h),this.executeOperatorList(S),this.restore()),v=Ae.applyTransform([m.width,0],h)[0]*o+w,i.translate(v,0),s.x+=v*d}i.restore(),this.processingType3=null}}setCharWidth(t,i){}setCharWidthAndBounds(t,i,s,n,o,r){this.ctx.rect(s,n,o-s,r-n),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let i;if(t[0]==="TilingPattern"){const s=t[1],n=this.baseTransform||Lt(this.ctx),o={createCanvasGraphics:r=>new XS(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};i=new Xw(t,s,this.ctx,o,n)}else i=this._getPattern(t[1],t[2]);return i}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,i,s){this.ctx.strokeStyle=this.current.strokeColor=Ae.makeHexColor(t,i,s)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(t,i,s){this.ctx.fillStyle=this.current.fillColor=Ae.makeHexColor(t,i,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,i=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=wL(this.getObject(t)),this.cachedPatterns.set(t,s)),i&&(s.matrix=i),s}shadingFill(t){if(!this.contentVisible)return;const i=this.ctx;this.save();const s=this._getPattern(t);i.fillStyle=s.getPattern(i,this,_o(i),Qi.SHADING);const n=_o(i);if(n){const{width:o,height:r}=i.canvas,[a,l,c,d]=Ae.getAxialAlignedBoundingBox([0,0,o,r],n);this.ctx.fillRect(a,l,c-a,d-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Et("Should not call beginInlineImage")}beginImageData(){Et("Should not call beginImageData")}paintFormXObjectBegin(t,i){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Lt(this.ctx),i)){const s=i[2]-i[0],n=i[3]-i[1];this.ctx.rect(i[0],i[1],s,n),this.current.updateRectMinMax(Lt(this.ctx),i),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;t.isolated||kv("TODO: Support non-isolated groups."),t.knockout&&Ue("Knockout groups not supported.");const s=Lt(i);if(t.matrix&&i.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let n=Ae.getAxialAlignedBoundingBox(t.bbox,Lt(i));const o=[0,0,i.canvas.width,i.canvas.height];n=Ae.intersect(n,o)||[0,0,0,0];const r=Math.floor(n[0]),a=Math.floor(n[1]),l=Math.max(Math.ceil(n[2])-r,1),c=Math.max(Math.ceil(n[3])-a,1);this.current.startNewPathAndClipBox([0,0,l,c]);let d="groupAt"+this.groupLevel;t.smask&&(d+="_smask_"+this.smaskCounter++%2);const h=this.cachedCanvases.getCanvas(d,l,c),u=h.context;u.translate(-r,-a),u.transform(...s),t.smask?this.smaskStack.push({canvas:h.canvas,context:u,offsetX:r,offsetY:a,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(i.setTransform(1,0,0,1,0,0),i.translate(r,a),i.save()),au(i,u),this.ctx=u,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const n=Lt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...n);const o=Ae.getAxialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],n);this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(t,i,s,n,o){if(x(this,$a,Qw).call(this),up(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const r=i[2]-i[0],a=i[3]-i[1];if(o&&this.annotationCanvasMap){s=s.slice(),s[4]-=i[0],s[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=r,i[3]=a;const[l,c]=Ae.singularValueDecompose2dScale(Lt(this.ctx)),{viewportScale:d}=this,h=Math.ceil(r*this.outputScaleX*d),u=Math.ceil(a*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(h,u);const{canvas:f,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(t,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,a*c),up(this.ctx)}else up(this.ctx),this.endPath(),this.ctx.rect(i[0],i[1],r,a),this.ctx.clip(),this.ctx.beginPath()}this.current=new $0(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...n)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),x(this,$a,Jw).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const i=t.count;t=this.getObject(t.data,t),t.count=i;const s=this.ctx,n=this.processingType3;if(n&&(n.compiled===void 0&&(n.compiled=xL(t)),n.compiled)){n.compiled(s);return}const o=this._createMaskCanvas(t),r=o.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(r,o.offsetX,o.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(t,i,s=0,n=0,o,r){if(!this.contentVisible)return;t=this.getObject(t.data,t);const a=this.ctx;a.save();const l=Lt(a);a.transform(i,s,n,o,0,0);const c=this._createMaskCanvas(t);a.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let d=0,h=r.length;d<h;d+=2){const u=Ae.transform(l,[i,s,n,o,r[d],r[d+1]]),[f,p]=Ae.applyTransform([0,0],u);a.drawImage(c.canvas,f,p)}a.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const i=this.ctx,s=this.current.fillColor,n=this.current.patternFill;for(const o of t){const{data:r,width:a,height:l,transform:c}=o,d=this.cachedCanvases.getCanvas("maskCanvas",a,l),h=d.context;h.save();const u=this.getObject(r,o);j0(h,u),h.globalCompositeOperation="source-in",h.fillStyle=n?s.getPattern(h,this,_o(i),Qi.FILL):s,h.fillRect(0,0,a,l),h.restore(),i.save(),i.transform(...c),i.scale(1,-1),hp(i,d.canvas,0,0,a,l,0,-1,1,1),i.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const i=this.getObject(t);if(!i){Ue("Dependent image isn't ready yet");return}this.paintInlineImageXObject(i)}paintImageXObjectRepeat(t,i,s,n){if(!this.contentVisible)return;const o=this.getObject(t);if(!o){Ue("Dependent image isn't ready yet");return}const r=o.width,a=o.height,l=[];for(let c=0,d=n.length;c<d;c+=2)l.push({transform:[i,0,0,s,n[c],n[c+1]],x:0,y:0,w:r,h:a});this.paintInlineImageXObjectGroup(o,l)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:i,width:s,height:n}=t,o=this.cachedCanvases.getCanvas("inlineImage",s,n),r=o.context;return r.filter=this.current.transferMaps,r.drawImage(i,0,0),r.filter="none",o.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const i=t.width,s=t.height,n=this.ctx;if(this.save(),!Wi){const{filter:a}=n;a!=="none"&&a!==""&&(n.filter="none")}n.scale(1/i,-1/s);let o;if(t.bitmap)o=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)o=t;else{const l=this.cachedCanvases.getCanvas("inlineImage",i,s).context;U0(l,t),o=this.applyTransferMapsToCanvas(l)}const r=this._scaleImage(o,_o(n));n.imageSmoothingEnabled=K0(Lt(n),t.interpolate),hp(n,r.img,0,0,r.paintWidth,r.paintHeight,0,-s,i,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,i){if(!this.contentVisible)return;const s=this.ctx;let n;if(t.bitmap)n=t.bitmap;else{const o=t.width,r=t.height,l=this.cachedCanvases.getCanvas("inlineImage",o,r).context;U0(l,t),n=this.applyTransferMapsToCanvas(l)}for(const o of i)s.save(),s.transform(...o.transform),s.scale(1,-1),hp(s,n,o.x,o.y,o.w,o.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,i){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,i){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const s=this.ctx;this.pendingClip&&(i||(this.pendingClip===q0?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Lt(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const i=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),n=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,n)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:i,b:s,c:n,d:o}=this.ctx.getTransform();let r,a;if(s===0&&n===0){const l=Math.abs(i),c=Math.abs(o);if(l===c)if(t===0)r=a=1/l;else{const d=l*t;r=a=d<1?1/d:1}else if(t===0)r=1/l,a=1/c;else{const d=l*t,h=c*t;r=d<1?1/d:1,a=h<1?1/h:1}}else{const l=Math.abs(i*o-s*n),c=Math.hypot(i,s),d=Math.hypot(n,o);if(t===0)r=d/l,a=c/l;else{const h=t*l;r=d>h?d/h:1,a=c>h?c/h:1}}this._cachedScaleForStroking[0]=r,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:i}=this,{lineWidth:s}=this.current,[n,o]=this.getScaleForStroking();if(i.lineWidth=s||1,n===1&&o===1){i.stroke();return}const r=i.getLineDash();if(t&&i.save(),i.scale(n,o),r.length>0){const a=Math.max(n,o);i.setLineDash(r.map(l=>l/a)),i.lineDashOffset/=a}i.stroke(),t&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};$a=new WeakSet,Qw=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Jw=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const i=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}};let wd=XS;for(const e in hn)wd.prototype[e]!==void 0&&(wd.prototype[hn[e]]=wd.prototype[e]);var Wg,$g;class fr{static get workerPort(){return g(this,Wg)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");y(this,Wg,t)}static get workerSrc(){return g(this,$g)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");y(this,$g,t)}}Wg=new WeakMap,$g=new WeakMap,F(fr,Wg,null),F(fr,$g,"");const gp={DATA:1,ERROR:2},Yt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function ws(e){switch(e instanceof Error||typeof e=="object"&&e!==null||Et('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),e.name){case"AbortException":return new Wc(e.message);case"MissingPDFException":return new zc(e.message);case"PasswordException":return new Rw(e.message,e.code);case"UnexpectedResponseException":return new _v(e.message,e.status);case"UnknownErrorException":return new xw(e.message,e.details);default:return new xw(e.message,e.toString())}}var Xd,sn,GA,BA,VA,Hp;class Ru{constructor(t,i,s){F(this,sn);F(this,Xd,new AbortController);this.sourceName=t,this.targetName=i,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",x(this,sn,GA).bind(this),{signal:g(this,Xd).signal})}on(t,i){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=i}send(t,i,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:i},s)}sendWithPromise(t,i,s){const n=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[n]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:n,data:i},s)}catch(r){o.reject(r)}return o.promise}sendWithStream(t,i,s,n){const o=this.streamId++,r=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const d=Promise.withResolvers();return this.streamControllers[o]={controller:c,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:r,targetName:a,action:t,streamId:o,data:i,desiredSize:c.desiredSize},n),d.promise},pull:c=>{const d=Promise.withResolvers();return this.streamControllers[o].pullCall=d,l.postMessage({sourceName:r,targetName:a,stream:Yt.PULL,streamId:o,desiredSize:c.desiredSize}),d.promise},cancel:c=>{ni(c instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[o].cancelCall=d,this.streamControllers[o].isClosed=!0,l.postMessage({sourceName:r,targetName:a,stream:Yt.CANCEL,streamId:o,reason:ws(c)}),d.promise}},s)}destroy(){var t;(t=g(this,Xd))==null||t.abort(),y(this,Xd,null)}}Xd=new WeakMap,sn=new WeakSet,GA=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){x(this,sn,VA).call(this,t);return}if(t.callback){const s=t.callbackId,n=this.callbackCapabilities[s];if(!n)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===gp.DATA)n.resolve(t.data);else if(t.callback===gp.ERROR)n.reject(ws(t.reason));else throw new Error("Unexpected callback case");return}const i=this.actionHandler[t.action];if(!i)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,n=t.sourceName,o=this.comObj;new Promise(function(r){r(i(t.data))}).then(function(r){o.postMessage({sourceName:s,targetName:n,callback:gp.DATA,callbackId:t.callbackId,data:r})},function(r){o.postMessage({sourceName:s,targetName:n,callback:gp.ERROR,callbackId:t.callbackId,reason:ws(r)})});return}if(t.streamId){x(this,sn,BA).call(this,t);return}i(t.data)},BA=function(t){const i=t.streamId,s=this.sourceName,n=t.sourceName,o=this.comObj,r=this,a=this.actionHandler[t.action],l={enqueue(c,d=1,h){if(this.isCancelled)return;const u=this.desiredSize;this.desiredSize-=d,u>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:s,targetName:n,stream:Yt.ENQUEUE,streamId:i,chunk:c},h)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:n,stream:Yt.CLOSE,streamId:i}),delete r.streamSinks[i])},error(c){ni(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:n,stream:Yt.ERROR,streamId:i,reason:ws(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[i]=l,new Promise(function(c){c(a(t.data,l))}).then(function(){o.postMessage({sourceName:s,targetName:n,stream:Yt.START_COMPLETE,streamId:i,success:!0})},function(c){o.postMessage({sourceName:s,targetName:n,stream:Yt.START_COMPLETE,streamId:i,reason:ws(c)})})},VA=function(t){const i=t.streamId,s=this.sourceName,n=t.sourceName,o=this.comObj,r=this.streamControllers[i],a=this.streamSinks[i];switch(t.stream){case Yt.START_COMPLETE:t.success?r.startCall.resolve():r.startCall.reject(ws(t.reason));break;case Yt.PULL_COMPLETE:t.success?r.pullCall.resolve():r.pullCall.reject(ws(t.reason));break;case Yt.PULL:if(!a){o.postMessage({sourceName:s,targetName:n,stream:Yt.PULL_COMPLETE,streamId:i,success:!0});break}a.desiredSize<=0&&t.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=t.desiredSize,new Promise(function(l){var c;l((c=a.onPull)==null?void 0:c.call(a))}).then(function(){o.postMessage({sourceName:s,targetName:n,stream:Yt.PULL_COMPLETE,streamId:i,success:!0})},function(l){o.postMessage({sourceName:s,targetName:n,stream:Yt.PULL_COMPLETE,streamId:i,reason:ws(l)})});break;case Yt.ENQUEUE:if(ni(r,"enqueue should have stream controller"),r.isClosed)break;r.controller.enqueue(t.chunk);break;case Yt.CLOSE:if(ni(r,"close should have stream controller"),r.isClosed)break;r.isClosed=!0,r.controller.close(),x(this,sn,Hp).call(this,r,i);break;case Yt.ERROR:ni(r,"error should have stream controller"),r.controller.error(ws(t.reason)),x(this,sn,Hp).call(this,r,i);break;case Yt.CANCEL_COMPLETE:t.success?r.cancelCall.resolve():r.cancelCall.reject(ws(t.reason)),x(this,sn,Hp).call(this,r,i);break;case Yt.CANCEL:if(!a)break;new Promise(function(l){var c;l((c=a.onCancel)==null?void 0:c.call(a,ws(t.reason)))}).then(function(){o.postMessage({sourceName:s,targetName:n,stream:Yt.CANCEL_COMPLETE,streamId:i,success:!0})},function(l){o.postMessage({sourceName:s,targetName:n,stream:Yt.CANCEL_COMPLETE,streamId:i,reason:ws(l)})}),a.sinkCapability.reject(ws(t.reason)),a.isCancelled=!0,delete this.streamSinks[i];break;default:throw new Error("Unexpected stream case")}},Hp=async function(t,i){var s,n,o;await Promise.allSettled([(s=t.startCall)==null?void 0:s.promise,(n=t.pullCall)==null?void 0:n.promise,(o=t.cancelCall)==null?void 0:o.promise]),delete this.streamControllers[i]};var Gl,Ug;class PL{constructor({parsedData:t,rawData:i}){F(this,Gl);F(this,Ug);y(this,Gl,t),y(this,Ug,i)}getRaw(){return g(this,Ug)}get(t){return g(this,Gl).get(t)??null}getAll(){return $y(g(this,Gl))}has(t){return g(this,Gl).has(t)}}Gl=new WeakMap,Ug=new WeakMap;const rd=Symbol("INTERNAL");var jg,Kg,qg,Qd;class TL{constructor(t,{name:i,intent:s,usage:n,rbGroups:o}){F(this,jg,!1);F(this,Kg,!1);F(this,qg,!1);F(this,Qd,!0);y(this,jg,!!(t&Ds.DISPLAY)),y(this,Kg,!!(t&Ds.PRINT)),this.name=i,this.intent=s,this.usage=n,this.rbGroups=o}get visible(){if(g(this,qg))return g(this,Qd);if(!g(this,Qd))return!1;const{print:t,view:i}=this.usage;return g(this,jg)?(i==null?void 0:i.viewState)!=="OFF":g(this,Kg)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,i,s=!1){t!==rd&&Et("Internal method `_setVisible` called."),y(this,qg,s),y(this,Qd,i)}}jg=new WeakMap,Kg=new WeakMap,qg=new WeakMap,Qd=new WeakMap;var da,ft,Jd,Zd,Yg,Zw;class DL{constructor(t,i=Ds.DISPLAY){F(this,Yg);F(this,da,null);F(this,ft,new Map);F(this,Jd,null);F(this,Zd,null);if(this.renderingIntent=i,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,y(this,Zd,t.order);for(const s of t.groups)g(this,ft).set(s.id,new TL(i,s));if(t.baseState==="OFF")for(const s of g(this,ft).values())s._setVisible(rd,!1);for(const s of t.on)g(this,ft).get(s)._setVisible(rd,!0);for(const s of t.off)g(this,ft).get(s)._setVisible(rd,!1);y(this,Jd,this.getHash())}}isVisible(t){if(g(this,ft).size===0)return!0;if(!t)return kv("Optional content group not defined."),!0;if(t.type==="OCG")return g(this,ft).has(t.id)?g(this,ft).get(t.id).visible:(Ue(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return x(this,Yg,Zw).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const i of t.ids){if(!g(this,ft).has(i))return Ue(`Optional content group not found: ${i}`),!0;if(g(this,ft).get(i).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const i of t.ids){if(!g(this,ft).has(i))return Ue(`Optional content group not found: ${i}`),!0;if(!g(this,ft).get(i).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const i of t.ids){if(!g(this,ft).has(i))return Ue(`Optional content group not found: ${i}`),!0;if(!g(this,ft).get(i).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const i of t.ids){if(!g(this,ft).has(i))return Ue(`Optional content group not found: ${i}`),!0;if(g(this,ft).get(i).visible)return!1}return!0}return Ue(`Unknown optional content policy ${t.policy}.`),!0}return Ue(`Unknown group type ${t.type}.`),!0}setVisibility(t,i=!0,s=!0){var o;const n=g(this,ft).get(t);if(!n){Ue(`Optional content group not found: ${t}`);return}if(s&&i&&n.rbGroups.length)for(const r of n.rbGroups)for(const a of r)a!==t&&((o=g(this,ft).get(a))==null||o._setVisible(rd,!1,!0));n._setVisible(rd,!!i,!0),y(this,da,null)}setOCGState({state:t,preserveRB:i}){let s;for(const n of t){switch(n){case"ON":case"OFF":case"Toggle":s=n;continue}const o=g(this,ft).get(n);if(o)switch(s){case"ON":this.setVisibility(n,!0,i);break;case"OFF":this.setVisibility(n,!1,i);break;case"Toggle":this.setVisibility(n,!o.visible,i);break}}y(this,da,null)}get hasInitialVisibility(){return g(this,Jd)===null||this.getHash()===g(this,Jd)}getOrder(){return g(this,ft).size?g(this,Zd)?g(this,Zd).slice():[...g(this,ft).keys()]:null}getGroups(){return g(this,ft).size>0?$y(g(this,ft)):null}getGroup(t){return g(this,ft).get(t)||null}getHash(){if(g(this,da)!==null)return g(this,da);const t=new PA;for(const[i,s]of g(this,ft))t.update(`${i}:${s.visible}`);return y(this,da,t.hexdigest())}}da=new WeakMap,ft=new WeakMap,Jd=new WeakMap,Zd=new WeakMap,Yg=new WeakSet,Zw=function(t){const i=t.length;if(i<2)return!0;const s=t[0];for(let n=1;n<i;n++){const o=t[n];let r;if(Array.isArray(o))r=x(this,Yg,Zw).call(this,o);else if(g(this,ft).has(o))r=g(this,ft).get(o).visible;else return Ue(`Optional content group not found: ${o}`),!0;switch(s){case"And":if(!r)return!1;break;case"Or":if(r)return!0;break;case"Not":return!r;default:return!0}}return s==="And"};class ML{constructor(t,{disableRange:i=!1,disableStream:s=!1}){ni(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:o,progressiveDone:r,contentDispositionFilename:a}=t;if(this._queuedChunks=[],this._progressiveDone=r,this._contentDispositionFilename=a,(o==null?void 0:o.length)>0){const l=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!i,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),t.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),t.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:i}){const s=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const n=this._rangeReaders.some(function(o){return o._begin!==t?!1:(o._enqueue(s),!0)});ni(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var i,s,n,o;t.total===void 0?(s=(i=this._rangeReaders[0])==null?void 0:i.onProgress)==null||s.call(i,{loaded:t.loaded}):(o=(n=this._fullRequestReader)==null?void 0:n.onProgress)==null||o.call(n,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const i=this._rangeReaders.indexOf(t);i>=0&&this._rangeReaders.splice(i,1)}getFullReader(){ni(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new IL(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new kL(this,t,i);return this._pdfDataRangeTransport.requestDataRange(t,i),this._rangeReaders.push(s),s}cancelAllRequests(t){var i;(i=this._fullRequestReader)==null||i.cancel(t);for(const s of this._rangeReaders.slice(0))s.cancel(t);this._pdfDataRangeTransport.abort()}}class IL{constructor(t,i,s=!1,n=null){this._stream=t,this._done=s||!1,this._filename=Ky(n)?n:null,this._queuedChunks=i||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class kL{constructor(t,i,s){this._stream=t,this._begin=i,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function _L(e){let t=!0,i=s("filename\\*","i").exec(e);if(i){i=i[1];let d=a(i);return d=unescape(d),d=l(d),d=c(d),o(d)}if(i=r(e),i){const d=c(i);return o(d)}if(i=s("filename","i").exec(e),i){i=i[1];let d=a(i);return d=c(d),o(d)}function s(d,h){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',h)}function n(d,h){if(d){if(!/^[\x00-\xFF]+$/.test(h))return h;try{const u=new TextDecoder(d,{fatal:!0}),f=Lv(h);h=u.decode(f),t=!1}catch{}}return h}function o(d){return t&&/[\x80-\xff]/.test(d)&&(d=n("utf-8",d),t&&(d=n("iso-8859-1",d))),d}function r(d){const h=[];let u;const f=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(u=f.exec(d))!==null;){let[,m,v,C]=u;if(m=parseInt(m,10),m in h){if(m===0)break;continue}h[m]=[v,C]}const p=[];for(let m=0;m<h.length&&m in h;++m){let[v,C]=h[m];C=a(C),v&&(C=unescape(C),m===0&&(C=l(C))),p.push(C)}return p.join("")}function a(d){if(d.startsWith('"')){const h=d.slice(1).split('\\"');for(let u=0;u<h.length;++u){const f=h[u].indexOf('"');f!==-1&&(h[u]=h[u].slice(0,f),h.length=u+1),h[u]=h[u].replaceAll(/\\(.)/g,"$1")}d=h.join('"')}return d}function l(d){const h=d.indexOf("'");if(h===-1)return d;const u=d.slice(0,h),p=d.slice(h+1).replace(/^[^']*'/,"");return n(u,p)}function c(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(h,u,f,p){if(f==="q"||f==="Q")return p=p.replaceAll("_"," "),p=p.replaceAll(/=([0-9a-fA-F]{2})/g,function(m,v){return String.fromCharCode(parseInt(v,16))}),n(u,p);try{p=atob(p)}catch{}return n(u,p)})}return""}function Jy(e,t){const i=new Headers;if(!e||!t||typeof t!="object")return i;for(const s in t){const n=t[s];n!==void 0&&i.append(s,n)}return i}function Zy({responseHeaders:e,isHttp:t,rangeChunkSize:i,disableRange:s}){const n={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(e.get("Content-Length"),10);return!Number.isInteger(o)||(n.suggestedLength=o,o<=2*i)||s||!t||e.get("Accept-Ranges")!=="bytes"||(e.get("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function eS(e){const t=e.get("Content-Disposition");if(t){let i=_L(t);if(i.includes("%"))try{i=decodeURIComponent(i)}catch{}if(Ky(i))return i}return null}function Hv(e,t){return e===404||e===0&&t.startsWith("file:")?new zc('Missing PDF "'+t+'".'):new _v(`Unexpected server response (${e}) while retrieving PDF "${t}".`,e)}function zA(e){return e===200||e===206}function WA(e,t,i){return{method:"GET",headers:e,signal:i.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function $A(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:(Ue(`getArrayBuffer - unexpected data format: ${e}`),new Uint8Array(e).buffer)}class Y0{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Jy(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return ni(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new LL(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new OL(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){var i;(i=this._fullRequestReader)==null||i.cancel(t);for(const s of this._rangeRequestReaders.slice(0))s.cancel(t)}}class LL{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const i=t.source;this._withCredentials=i.withCredentials||!1,this._contentLength=i.length,this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange;const s=new Headers(t.headers),n=i.url;fetch(n,WA(s,this._withCredentials,this._abortController)).then(o=>{if(!zA(o.status))throw Hv(o.status,n);this._reader=o.body.getReader(),this._headersCapability.resolve();const r=o.headers,{allowRangeRequests:a,suggestedLength:l}=Zy({responseHeaders:r,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=l||this._contentLength,this._filename=eS(r),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Wc("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:$A(t),done:!1})}cancel(t){var i;(i=this._reader)==null||i.cancel(t),this._abortController.abort()}}class OL{constructor(t,i,s){this._stream=t,this._reader=null,this._loaded=0;const n=t.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const o=new Headers(t.headers);o.append("Range",`bytes=${i}-${s-1}`);const r=n.url;fetch(r,WA(o,this._withCredentials,this._abortController)).then(a=>{if(!zA(a.status))throw Hv(a.status,r);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:$A(t),done:!1})}cancel(t){var i;(i=this._reader)==null||i.cancel(t),this._abortController.abort()}}const gC=200,fC=206;function NL(e){const t=e.response;return typeof t!="string"?t:Lv(t).buffer}class HL{constructor({url:t,httpHeaders:i,withCredentials:s}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Jy(this.isHttp,i),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,i,s){const n={begin:t,end:i};for(const o in s)n[o]=s[o];return this.request(n)}requestFull(t){return this.request(t)}request(t){const i=new XMLHttpRequest,s=this.currXhrId++,n=this.pendingRequests[s]={xhr:i};i.open("GET",this.url),i.withCredentials=this.withCredentials;for(const[o,r]of this.headers)i.setRequestHeader(o,r);return this.isHttp&&"begin"in t&&"end"in t?(i.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),n.expectedStatus=fC):n.expectedStatus=gC,i.responseType="arraybuffer",t.onError&&(i.onerror=function(o){t.onError(i.status)}),i.onreadystatechange=this.onStateChange.bind(this,s),i.onprogress=this.onProgress.bind(this,s),n.onHeadersReceived=t.onHeadersReceived,n.onDone=t.onDone,n.onError=t.onError,n.onProgress=t.onProgress,i.send(null),s}onProgress(t,i){var n;const s=this.pendingRequests[t];s&&((n=s.onProgress)==null||n.call(s,i))}onStateChange(t,i){var l,c,d;const s=this.pendingRequests[t];if(!s)return;const n=s.xhr;if(n.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),n.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],n.status===0&&this.isHttp){(l=s.onError)==null||l.call(s,n.status);return}const o=n.status||gC;if(!(o===gC&&s.expectedStatus===fC)&&o!==s.expectedStatus){(c=s.onError)==null||c.call(s,n.status);return}const a=NL(n);if(o===fC){const h=n.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);s.onDone({begin:parseInt(u[1],10),chunk:a})}else a?s.onDone({begin:0,chunk:a}):(d=s.onError)==null||d.call(s,n.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const i=this.pendingRequests[t].xhr;delete this.pendingRequests[t],i.abort()}}class GL{constructor(t){this._source=t,this._manager=new HL(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const i=this._rangeRequestReaders.indexOf(t);i>=0&&this._rangeRequestReaders.splice(i,1)}getFullReader(){return ni(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new BL(this._manager,this._source),this._fullRequestReader}getRangeReader(t,i){const s=new VL(this._manager,t,i);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){var i;(i=this._fullRequestReader)==null||i.cancel(t);for(const s of this._rangeRequestReaders.slice(0))s.cancel(t)}}class BL{constructor(t,i){this._manager=t;const s={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=i.url,this._fullRequestId=t.requestFull(s),this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._contentLength=i.length,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,i=this._manager.getRequestXhr(t),s=new Headers(i.getAllResponseHeaders().trim().split(/[\r\n]+/).map(r=>{const[a,...l]=r.split(": ");return[a,l.join(": ")]})),{allowRangeRequests:n,suggestedLength:o}=Zy({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});n&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=eS(s),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Hv(t,this._url),this._headersCapability.reject(this._storedError);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var i;(i=this.onProgress)==null||i.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class VL{constructor(t,i,s){this._manager=t;const n={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(i,s,n),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const i=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:i,done:!1}):this._queuedChunk=i,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=Hv(t,this._url);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var i;this.isStreamingSupported||(i=this.onProgress)==null||i.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const zL=/^[a-z][a-z0-9\-+.]+:/i;function WL(e){if(zL.test(e))return new URL(e);const t=Na.get("url");return new URL(t.pathToFileURL(e))}function UA(e,t,i){return e.protocol==="http:"?Na.get("http").request(e,{headers:t},i):Na.get("https").request(e,{headers:t},i)}class $L{constructor(t){this.source=t,this.url=WL(t.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.headers=Jy(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return ni(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new KL(this):new UL(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=this.isFsUrl?new qL(this,t,i):new jL(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){var i;(i=this._fullRequestReader)==null||i.cancel(t);for(const s of this._rangeRequestReaders.slice(0))s.cancel(t)}}class jA{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const i=t.source;this._contentLength=i.length,this._loaded=0,this._filename=null,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Wc("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class KA{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=t.source;this._isStreamingSupported=!i.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class UL extends jA{constructor(t){super(t);const i=Object.fromEntries(t.headers),s=n=>{if(n.statusCode===404){const l=new zc(`Missing PDF "${this._url}".`);this._storedError=l,this._headersCapability.reject(l);return}this._headersCapability.resolve(),this._setReadableStream(n);const o=new Headers(this._readableStream.headers),{allowRangeRequests:r,suggestedLength:a}=Zy({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=a||this._contentLength,this._filename=eS(o)};this._request=UA(this._url,i,s),this._request.on("error",n=>{this._storedError=n,this._headersCapability.reject(n)}),this._request.end()}}class jL extends KA{constructor(t,i,s){super(t);const n=Object.fromEntries(t.headers);n.Range=`bytes=${i}-${s-1}`;const o=r=>{if(r.statusCode===404){const a=new zc(`Missing PDF "${this._url}".`);this._storedError=a;return}this._setReadableStream(r)};this._request=UA(this._url,n,o),this._request.on("error",r=>{this._storedError=r}),this._request.end()}}class KL extends jA{constructor(t){super(t);const i=Na.get("fs");i.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=new zc(`Missing PDF "${this._url}".`)),this._storedError=s,this._headersCapability.reject(s)})}}class qL extends KA{constructor(t,i,s){super(t);const n=Na.get("fs");this._setReadableStream(n.createReadStream(this._url,{start:i,end:s-1}))}}const YL=1e5,ns=30,XL=.8;var Rx,ha,cs,Xg,Qg,Bl,qo,Jg,Zg,Vl,eh,th,ua,ih,ef,sh,zl,tf,sf,Wl,$l,nf,ga,nh,Mr,qA,YA,eb,Ns,Gp,tb,XA,QA;const Zt=class Zt{constructor({textContentSource:t,container:i,viewport:s}){F(this,Mr);F(this,ha,Promise.withResolvers());F(this,cs,null);F(this,Xg,!1);F(this,Qg,!!((Rx=globalThis.FontInspector)!=null&&Rx.enabled));F(this,Bl,null);F(this,qo,null);F(this,Jg,0);F(this,Zg,0);F(this,Vl,null);F(this,eh,null);F(this,th,0);F(this,ua,0);F(this,ih,Object.create(null));F(this,ef,[]);F(this,sh,null);F(this,zl,[]);F(this,tf,new WeakMap);F(this,sf,null);var l;if(t instanceof ReadableStream)y(this,sh,t);else if(typeof t=="object")y(this,sh,new ReadableStream({start(c){c.enqueue(t),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');y(this,cs,y(this,eh,i)),y(this,ua,s.scale*(globalThis.devicePixelRatio||1)),y(this,th,s.rotation),y(this,qo,{div:null,properties:null,ctx:null});const{pageWidth:n,pageHeight:o,pageX:r,pageY:a}=s.rawDims;y(this,sf,[1,0,0,-1,-r,a+o]),y(this,Zg,n),y(this,Jg,o),x(l=Zt,Ns,XA).call(l),Pc(i,s),g(this,ha).promise.finally(()=>{g(Zt,nh).delete(this),y(this,qo,null),y(this,ih,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:i}=es.platform;return Qe(this,"fontFamilyMap",new Map([["sans-serif",`${t&&i?"Calibri, ":""}sans-serif`],["monospace",`${t&&i?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{g(this,Vl).read().then(({value:i,done:s})=>{if(s){g(this,ha).resolve();return}g(this,Bl)??y(this,Bl,i.lang),Object.assign(g(this,ih),i.styles),x(this,Mr,qA).call(this,i.items),t()},g(this,ha).reject)};return y(this,Vl,g(this,sh).getReader()),g(Zt,nh).add(this),t(),g(this,ha).promise}update({viewport:t,onBefore:i=null}){var o;const s=t.scale*(globalThis.devicePixelRatio||1),n=t.rotation;if(n!==g(this,th)&&(i==null||i(),y(this,th,n),Pc(g(this,eh),{rotation:n})),s!==g(this,ua)){i==null||i(),y(this,ua,s);const r={div:null,properties:null,ctx:x(o=Zt,Ns,Gp).call(o,g(this,Bl))};for(const a of g(this,zl))r.properties=g(this,tf).get(a),r.div=a,x(this,Mr,eb).call(this,r)}}cancel(){var i;const t=new Wc("TextLayer task cancelled.");(i=g(this,Vl))==null||i.cancel(t).catch(()=>{}),y(this,Vl,null),g(this,ha).reject(t)}get textDivs(){return g(this,zl)}get textContentItemsStr(){return g(this,ef)}static cleanup(){if(!(g(this,nh).size>0)){g(this,Wl).clear();for(const{canvas:t}of g(this,$l).values())t.remove();g(this,$l).clear()}}};ha=new WeakMap,cs=new WeakMap,Xg=new WeakMap,Qg=new WeakMap,Bl=new WeakMap,qo=new WeakMap,Jg=new WeakMap,Zg=new WeakMap,Vl=new WeakMap,eh=new WeakMap,th=new WeakMap,ua=new WeakMap,ih=new WeakMap,ef=new WeakMap,sh=new WeakMap,zl=new WeakMap,tf=new WeakMap,sf=new WeakMap,Wl=new WeakMap,$l=new WeakMap,nf=new WeakMap,ga=new WeakMap,nh=new WeakMap,Mr=new WeakSet,qA=function(t){var n,o;if(g(this,Xg))return;(o=g(this,qo)).ctx??(o.ctx=x(n=Zt,Ns,Gp).call(n,g(this,Bl)));const i=g(this,zl),s=g(this,ef);for(const r of t){if(i.length>YL){Ue("Ignoring additional textDivs for performance reasons."),y(this,Xg,!0);return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const a=g(this,cs);y(this,cs,document.createElement("span")),g(this,cs).classList.add("markedContent"),r.id!==null&&g(this,cs).setAttribute("id",`${r.id}`),a.append(g(this,cs))}else r.type==="endMarkedContent"&&y(this,cs,g(this,cs).parentNode);continue}s.push(r.str),x(this,Mr,YA).call(this,r)}},YA=function(t){var m;const i=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};g(this,zl).push(i);const n=Ae.transform(g(this,sf),t.transform);let o=Math.atan2(n[1],n[0]);const r=g(this,ih)[t.fontName];r.vertical&&(o+=Math.PI/2);let a=g(this,Qg)&&r.fontSubstitution||r.fontFamily;a=Zt.fontFamilyMap.get(a)||a;const l=Math.hypot(n[2],n[3]),c=l*x(m=Zt,Ns,QA).call(m,a,g(this,Bl));let d,h;o===0?(d=n[4],h=n[5]-c):(d=n[4]+c*Math.sin(o),h=n[5]-c*Math.cos(o));const u="calc(var(--scale-factor)*",f=i.style;g(this,cs)===g(this,eh)?(f.left=`${(100*d/g(this,Zg)).toFixed(2)}%`,f.top=`${(100*h/g(this,Jg)).toFixed(2)}%`):(f.left=`${u}${d.toFixed(2)}px)`,f.top=`${u}${h.toFixed(2)}px)`),f.fontSize=`${u}${(g(Zt,ga)*l).toFixed(2)}px)`,f.fontFamily=a,s.fontSize=l,i.setAttribute("role","presentation"),i.textContent=t.str,i.dir=t.dir,g(this,Qg)&&(i.dataset.fontName=r.fontSubstitutionLoadedName||t.fontName),o!==0&&(s.angle=o*(180/Math.PI));let p=!1;if(t.str.length>1)p=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const v=Math.abs(t.transform[0]),C=Math.abs(t.transform[3]);v!==C&&Math.max(v,C)/Math.min(v,C)>1.5&&(p=!0)}if(p&&(s.canvasWidth=r.vertical?t.height:t.width),g(this,tf).set(i,s),g(this,qo).div=i,g(this,qo).properties=s,x(this,Mr,eb).call(this,g(this,qo)),s.hasText&&g(this,cs).append(i),s.hasEOL){const v=document.createElement("br");v.setAttribute("role","presentation"),g(this,cs).append(v)}},eb=function(t){var a;const{div:i,properties:s,ctx:n}=t,{style:o}=i;let r="";if(g(Zt,ga)>1&&(r=`scale(${1/g(Zt,ga)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:l}=o,{canvasWidth:c,fontSize:d}=s;x(a=Zt,Ns,tb).call(a,n,d*g(this,ua),l);const{width:h}=n.measureText(i.textContent);h>0&&(r=`scaleX(${c*g(this,ua)/h}) ${r}`)}s.angle!==0&&(r=`rotate(${s.angle}deg) ${r}`),r.length>0&&(o.transform=r)},Ns=new WeakSet,Gp=function(t=null){let i=g(this,$l).get(t||(t=""));if(!i){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),i=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),g(this,$l).set(t,i),g(this,nf).set(i,{size:0,family:""})}return i},tb=function(t,i,s){const n=g(this,nf).get(t);i===n.size&&s===n.family||(t.font=`${i}px ${s}`,n.size=i,n.family=s)},XA=function(){if(g(this,ga)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),y(this,ga,t.getBoundingClientRect().height),t.remove()},QA=function(t,i){const s=g(this,Wl).get(t);if(s)return s;const n=x(this,Ns,Gp).call(this,i);n.canvas.width=n.canvas.height=ns,x(this,Ns,tb).call(this,n,ns,t);const o=n.measureText("");let r=o.fontBoundingBoxAscent,a=Math.abs(o.fontBoundingBoxDescent);if(r){const d=r/(r+a);return g(this,Wl).set(t,d),n.canvas.width=n.canvas.height=0,d}n.strokeStyle="red",n.clearRect(0,0,ns,ns),n.strokeText("g",0,0);let l=n.getImageData(0,0,ns,ns).data;a=0;for(let d=l.length-1-3;d>=0;d-=4)if(l[d]>0){a=Math.ceil(d/4/ns);break}n.clearRect(0,0,ns,ns),n.strokeText("A",0,ns),l=n.getImageData(0,0,ns,ns).data,r=0;for(let d=0,h=l.length;d<h;d+=4)if(l[d]>0){r=ns-Math.floor(d/4/ns);break}n.canvas.width=n.canvas.height=0;const c=r?r/(r+a):XL;return g(this,Wl).set(t,c),c},F(Zt,Ns),F(Zt,Wl,new Map),F(Zt,$l,new Map),F(Zt,nf,new WeakMap),F(Zt,ga,null),F(Zt,nh,new Set);let ng=Zt;class og{static textContent(t){const i=[],s={items:i,styles:Object.create(null)};function n(o){var l;if(!o)return;let r=null;const a=o.name;if(a==="#text")r=o.value;else if(og.shouldBuildText(a))(l=o==null?void 0:o.attributes)!=null&&l.textContent?r=o.attributes.textContent:o.value&&(r=o.value);else return;if(r!==null&&i.push({str:r}),!!o.children)for(const c of o.children)n(c)}return n(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const QL=65536,JL=100,ZL=5e3,eO=Wi?uL:cL,tO=Wi?gL:kA,iO=Wi?hL:dL,sO=Wi?fL:NA;function nO(e={}){typeof e=="string"||e instanceof URL?e={url:e}:(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t=new ib,{docId:i}=t,s=e.url?oO(e.url):null,n=e.data?rO(e.data):null,o=e.httpHeaders||null,r=e.withCredentials===!0,a=e.password??null,l=e.range instanceof JA?e.range:null,c=Number.isInteger(e.rangeChunkSize)&&e.rangeChunkSize>0?e.rangeChunkSize:QL;let d=e.worker instanceof bd?e.worker:null;const h=e.verbosity,u=typeof e.docBaseUrl=="string"&&!Nv(e.docBaseUrl)?e.docBaseUrl:null,f=typeof e.cMapUrl=="string"?e.cMapUrl:null,p=e.cMapPacked!==!1,m=e.CMapReaderFactory||tO,v=typeof e.standardFontDataUrl=="string"?e.standardFontDataUrl:null,C=e.StandardFontDataFactory||sO,w=e.stopAtErrors!==!0,S=Number.isInteger(e.maxImageSize)&&e.maxImageSize>-1?e.maxImageSize:-1,b=e.isEvalSupported!==!1,E=typeof e.isOffscreenCanvasSupported=="boolean"?e.isOffscreenCanvasSupported:!Wi,A=typeof e.isChrome=="boolean"?e.isChrome:!es.platform.isFirefox&&typeof window<"u"&&!!(window!=null&&window.chrome),P=Number.isInteger(e.canvasMaxAreaInBytes)?e.canvasMaxAreaInBytes:-1,T=typeof e.disableFontFace=="boolean"?e.disableFontFace:Wi,D=e.fontExtraProperties===!0,N=e.enableXfa===!0,M=e.ownerDocument||globalThis.document,_=e.disableRange===!0,W=e.disableStream===!0,$=e.disableAutoFetch===!0,B=e.pdfBug===!0,q=e.CanvasFactory||eO,X=e.FilterFactory||iO,U=e.enableHWA===!0,pe=l?l.length:e.length??NaN,Ee=typeof e.useSystemFonts=="boolean"?e.useSystemFonts:!Wi&&!T,Ce=typeof e.useWorkerFetch=="boolean"?e.useWorkerFetch:m===kA&&C===NA&&f&&v&&mu(f,document.baseURI)&&mu(v,document.baseURI);e.canvasFactory&&N0("`canvasFactory`-instance option, please use `CanvasFactory` instead."),e.filterFactory&&N0("`filterFactory`-instance option, please use `FilterFactory` instead.");const le=null;B1(h);const ee={canvasFactory:new q({ownerDocument:M,enableHWA:U}),filterFactory:new X({docId:i,ownerDocument:M}),cMapReaderFactory:Ce?null:new m({baseUrl:f,isCompressed:p}),standardFontDataFactory:Ce?null:new C({baseUrl:v})};if(!d){const Z={verbosity:h,port:fr.workerPort};d=Z.port?bd.fromPort(Z):new bd(Z),t._worker=d}const ve={docId:i,apiVersion:"4.8.69",data:n,password:a,disableAutoFetch:$,rangeChunkSize:c,length:pe,docBaseUrl:u,enableXfa:N,evaluatorOptions:{maxImageSize:S,disableFontFace:T,ignoreErrors:w,isEvalSupported:b,isOffscreenCanvasSupported:E,isChrome:A,canvasMaxAreaInBytes:P,fontExtraProperties:D,useSystemFonts:Ee,cMapUrl:Ce?f:null,standardFontDataUrl:Ce?v:null}},Oe={disableFontFace:T,fontExtraProperties:D,ownerDocument:M,pdfBug:B,styleElement:le,loadingParams:{disableAutoFetch:$,enableXfa:N}};return d.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const Z=d.messageHandler.sendWithPromise("GetDocRequest",ve,n?[n.buffer]:null);let we;if(l)we=new ML(l,{disableRange:_,disableStream:W});else if(!n){if(!s)throw new Error("getDocument - no `url` parameter provided.");let Ne;Wi?Ne=typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype&&mu(s)?Y0:$L:Ne=mu(s)?Y0:GL,we=new Ne({url:s,length:pe,httpHeaders:o,withCredentials:r,rangeChunkSize:c,disableRange:_,disableStream:W})}return Z.then(Ne=>{if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const Se=new Ru(i,Ne,d.port),tt=new dO(Se,t,we,Oe,ee);t._transport=tt,Se.send("Ready",null)})}).catch(t._capability.reject),t}function oO(e){if(e instanceof URL)return e.href;try{return new URL(e,window.location).href}catch{if(Wi&&typeof e=="string")return e}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function rO(e){if(Wi&&typeof Buffer<"u"&&e instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if(typeof e=="string")return Lv(e);if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)||typeof e=="object"&&!isNaN(e==null?void 0:e.length))return new Uint8Array(e);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function X0(e){return typeof e=="object"&&Number.isInteger(e==null?void 0:e.num)&&e.num>=0&&Number.isInteger(e==null?void 0:e.gen)&&e.gen>=0}var hv;const uv=class uv{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Ki(uv,hv)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,i,s;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((i=this._transport)==null?void 0:i.destroy())}catch(n){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,n}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};hv=new WeakMap,F(uv,hv,0);let ib=uv;class JA{constructor(t,i,s=!1,n=null){this.length=t,this.initialData=i,this.progressiveDone=s,this.contentDispositionFilename=n,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,i){for(const s of this._rangeListeners)s(t,i)}onDataProgress(t,i){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(t,i)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const i of this._progressiveReadListeners)i(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,i){Et("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class aO{constructor(t,i){this._pdfInfo=t,this._transport=i}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Qe(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(i)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var fa,Yo,Zs,ad,Bp;class lO{constructor(t,i,s,n=!1){F(this,Zs);F(this,fa,null);F(this,Yo,!1);this._pageIndex=t,this._pageInfo=i,this._transport=s,this._stats=n?new O0:null,this._pdfBug=n,this.commonObjs=s.commonObjs,this.objs=new ZA,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:i=this.rotate,offsetX:s=0,offsetY:n=0,dontFlip:o=!1}={}){return new jf({viewBox:this.view,scale:t,rotation:i,offsetX:s,offsetY:n,dontFlip:o})}getAnnotations({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,i)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Qe(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:i,intent:s="display",annotationMode:n=qr.ENABLE,transform:o=null,background:r=null,optionalContentConfigPromise:a=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:d=null,isEditing:h=!1}){var b,E;(b=this._stats)==null||b.time("Overall");const u=this._transport.getRenderingIntent(s,n,d,h),{renderingIntent:f,cacheKey:p}=u;y(this,Yo,!1),x(this,Zs,Bp).call(this),a||(a=this._transport.getOptionalContentConfig(f));let m=this._intentStates.get(p);m||(m=Object.create(null),this._intentStates.set(p,m)),m.streamReaderCancelTimeout&&(clearTimeout(m.streamReaderCancelTimeout),m.streamReaderCancelTimeout=null);const v=!!(f&Ds.PRINT);m.displayReadyCapability||(m.displayReadyCapability=Promise.withResolvers(),m.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(E=this._stats)==null||E.time("Page Request"),this._pumpOperatorList(u));const C=A=>{var P;m.renderTasks.delete(w),(this._maybeCleanupAfterRender||v)&&y(this,Yo,!0),x(this,Zs,ad).call(this,!v),A?(w.capability.reject(A),this._abortOperatorList({intentState:m,reason:A instanceof Error?A:new Error(A)})):w.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(P=globalThis.Stats)!=null&&P.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},w=new nb({callback:C,params:{canvasContext:t,viewport:i,transform:o,background:r},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:m.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!v,pdfBug:this._pdfBug,pageColors:c});(m.renderTasks||(m.renderTasks=new Set)).add(w);const S=w.task;return Promise.all([m.displayReadyCapability.promise,a]).then(([A,P])=>{var T;if(this.destroyed){C();return}if((T=this._stats)==null||T.time("Rendering"),!(P.renderingIntent&f))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");w.initializeGraphics({transparency:A,optionalContentConfig:P}),w.operatorListChanged()}).catch(C),S}getOperatorList({intent:t="display",annotationMode:i=qr.ENABLE,printAnnotationStorage:s=null,isEditing:n=!1}={}){var c;function o(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}const r=this._transport.getRenderingIntent(t,i,s,n,!0);let a=this._intentStates.get(r.cacheKey);a||(a=Object.create(null),this._intentStates.set(r.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=o,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(r)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:i===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>og.textContent(s));const i=this.streamTextContent(t);return new Promise(function(s,n){function o(){r.read().then(function({value:l,done:c}){if(c){s(a);return}a.lang??(a.lang=l.lang),Object.assign(a.styles,l.styles),a.items.push(...l.items),o()},n)}const r=i.getReader(),a={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const s of i.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),y(this,Yo,!1),x(this,Zs,Bp).call(this),Promise.all(t)}cleanup(t=!1){y(this,Yo,!0);const i=x(this,Zs,ad).call(this,!1);return t&&i&&this._stats&&(this._stats=new O0),i}_startRenderPage(t,i){var n,o;const s=this._intentStates.get(i);s&&((n=this._stats)==null||n.timeEnd("Page Request"),(o=s.displayReadyCapability)==null||o.resolve(t))}_renderPageChunk(t,i){for(let s=0,n=t.length;s<n;s++)i.operatorList.fnArray.push(t.fnArray[s]),i.operatorList.argsArray.push(t.argsArray[s]);i.operatorList.lastChunk=t.lastChunk,i.operatorList.separateAnnots=t.separateAnnots;for(const s of i.renderTasks)s.operatorListChanged();t.lastChunk&&x(this,Zs,ad).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:i,annotationStorageSerializable:s,modifiedIds:n}){const{map:o,transfer:r}=s,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:i,annotationStorage:o,modifiedIds:n},r).getReader(),c=this._intentStates.get(i);c.streamReader=l;const d=()=>{l.read().then(({value:h,done:u})=>{if(u){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,c),d())},h=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const u of c.renderTasks)u.operatorListChanged();x(this,Zs,ad).call(this,!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(h);else if(c.opListReadCapability)c.opListReadCapability.reject(h);else throw h}})};d()}_abortOperatorList({intentState:t,reason:i,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(i instanceof jy){let n=JL;i.extraDelay>0&&i.extraDelay<1e3&&(n+=i.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:i,force:!0})},n);return}}if(t.streamReader.cancel(new Wc(i.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[n,o]of this._intentStates)if(o===t){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}}fa=new WeakMap,Yo=new WeakMap,Zs=new WeakSet,ad=function(t=!1){if(x(this,Zs,Bp).call(this),!g(this,Yo)||this.destroyed)return!1;if(t)return y(this,fa,setTimeout(()=>{y(this,fa,null),x(this,Zs,ad).call(this,!1)},ZL)),!1;for(const{renderTasks:i,operatorList:s}of this._intentStates.values())if(i.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),y(this,Yo,!1),!0},Bp=function(){g(this,fa)&&(clearTimeout(g(this,fa)),y(this,fa,null))};var Xo,gv;class cO{constructor(){F(this,Xo,new Map);F(this,gv,Promise.resolve())}postMessage(t,i){const s={data:structuredClone(t,i?{transfer:i}:null)};g(this,gv).then(()=>{for(const[n]of g(this,Xo))n.call(this,s)})}addEventListener(t,i,s=null){let n=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:o}=s;if(o.aborted){Ue("LoopbackPort - cannot use an `aborted` signal.");return}const r=()=>this.removeEventListener(t,i);n=()=>o.removeEventListener("abort",r),o.addEventListener("abort",r)}g(this,Xo).set(i,n)}removeEventListener(t,i){const s=g(this,Xo).get(i);s==null||s(),g(this,Xo).delete(i)}terminate(){for(const[,t]of g(this,Xo))t==null||t();g(this,Xo).clear()}}Xo=new WeakMap,gv=new WeakMap;var fv,Ul,jl,oh,Vp,rh,zp;const Ft=class Ft{constructor({name:t=null,port:i=null,verbosity:s=V1()}={}){F(this,oh);var n;if(this.name=t,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,i){if((n=g(Ft,jl))!=null&&n.has(i))throw new Error("Cannot use more than one PDFWorker per port.");(g(Ft,jl)||y(Ft,jl,new WeakMap)).set(i,this),this._initializeFromPort(i);return}this._initialize()}get promise(){return Wi?Promise.all([Na.promise,this._readyCapability.promise]):this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new Ru("main","worker",t),this._messageHandler.on("ready",function(){}),x(this,oh,Vp).call(this)}_initialize(){if(g(Ft,Ul)||g(Ft,rh,zp)){this._setupFakeWorker();return}let{workerSrc:t}=Ft;try{Ft._isSameOrigin(window.location.href,t)||(t=Ft._createCDNWrapper(new URL(t,window.location).href));const i=new Worker(t,{type:"module"}),s=new Ru("main","worker",i),n=()=>{o.abort(),s.destroy(),i.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},o=new AbortController;i.addEventListener("error",()=>{this._webWorker||n()},{signal:o.signal}),s.on("test",a=>{if(o.abort(),this.destroyed||!a){n();return}this._messageHandler=s,this._port=i,this._webWorker=i,x(this,oh,Vp).call(this)}),s.on("ready",a=>{if(o.abort(),this.destroyed){n();return}try{r()}catch{this._setupFakeWorker()}});const r=()=>{const a=new Uint8Array;s.send("test",a,[a.buffer])};r();return}catch{kv("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){g(Ft,Ul)||(Ue("Setting up fake worker."),y(Ft,Ul,!0)),Ft._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const i=new cO;this._port=i;const s=`fake${Ki(Ft,fv)._++}`,n=new Ru(s+"_worker",s,i);t.setup(n,i),this._messageHandler=new Ru(s,s+"_worker",i),x(this,oh,Vp).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(t=g(Ft,jl))==null||t.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){var s;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const i=(s=g(this,jl))==null?void 0:s.get(t.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new Ft(t)}static get workerSrc(){if(fr.workerSrc)return fr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Qe(this,"_setupFakeWorkerGlobal",(async()=>g(this,rh,zp)?g(this,rh,zp):(await import(this.workerSrc)).WorkerMessageHandler)())}};fv=new WeakMap,Ul=new WeakMap,jl=new WeakMap,oh=new WeakSet,Vp=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},rh=new WeakSet,zp=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},F(Ft,rh),F(Ft,fv,0),F(Ft,Ul,!1),F(Ft,jl),Wi&&(y(Ft,Ul,!0),fr.workerSrc||(fr.workerSrc="./pdf.worker.mjs")),Ft._isSameOrigin=(t,i)=>{let s;try{if(s=new URL(t),!s.origin||s.origin==="null")return!1}catch{return!1}const n=new URL(i,s);return s.origin===n.origin},Ft._createCDNWrapper=t=>{const i=`await import("${t}");`;return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))};let bd=Ft;var Qo,oo,ah,lh,ro,Kl,xu;class dO{constructor(t,i,s,n,o){F(this,Kl);F(this,Qo,new Map);F(this,oo,new Map);F(this,ah,new Map);F(this,lh,new Map);F(this,ro,null);this.messageHandler=t,this.loadingTask=i,this.commonObjs=new ZA,this.fontLoader=new aL({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Qe(this,"annotationStorage",new Xy)}getRenderingIntent(t,i=qr.ENABLE,s=null,n=!1,o=!1){let r=Ds.DISPLAY,a=Uw;switch(t){case"any":r=Ds.ANY;break;case"display":break;case"print":r=Ds.PRINT;break;default:Ue(`getRenderingIntent - invalid intent: ${t}`)}const l=r&Ds.PRINT&&s instanceof DA?s:this.annotationStorage;switch(i){case qr.DISABLE:r+=Ds.ANNOTATIONS_DISABLE;break;case qr.ENABLE:break;case qr.ENABLE_FORMS:r+=Ds.ANNOTATIONS_FORMS;break;case qr.ENABLE_STORAGE:r+=Ds.ANNOTATIONS_STORAGE,a=l.serializable;break;default:Ue(`getRenderingIntent - invalid annotationMode: ${i}`)}n&&(r+=Ds.IS_EDITING),o&&(r+=Ds.OPLIST);const{ids:c,hash:d}=l.modifiedIds,h=[r,a.hash,d];return{renderingIntent:r,cacheKey:h.join("_"),annotationStorageSerializable:a,modifiedIds:c}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=g(this,ro))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const n of g(this,oo).values())t.push(n._destroy());g(this,oo).clear(),g(this,ah).clear(),g(this,lh).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return t.push(i),Promise.all(t).then(()=>{var n;this.commonObjs.clear(),this.fontLoader.clear(),g(this,Qo).clear(),this.filterFactory.destroy(),ng.cleanup(),(n=this._networkStream)==null||n.cancelAllRequests(new Wc("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:i}=this;t.on("GetReader",(s,n)=>{ni(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},n.onPull=()=>{this._fullReader.read().then(function({value:o,done:r}){if(r){n.close();return}ni(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{n.error(o)})},n.onCancel=o=>{this._fullReader.cancel(o),n.ready.catch(r=>{if(!this.destroyed)throw r})}}),t.on("ReaderHeadersReady",async s=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:o,contentLength:r}=this._fullReader;return(!n||!o)&&(this._lastProgress&&((a=i.onProgress)==null||a.call(i,this._lastProgress)),this._fullReader.onProgress=l=>{var c;(c=i.onProgress)==null||c.call(i,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:n,isRangeSupported:o,contentLength:r}}),t.on("GetRangeReader",(s,n)=>{ni(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(s.begin,s.end);if(!o){n.close();return}n.onPull=()=>{o.read().then(function({value:r,done:a}){if(a){n.close();return}ni(r instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{n.error(r)})},n.onCancel=r=>{o.cancel(r),n.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,i._capability.resolve(new aO(s,this))}),t.on("DocException",function(s){let n;switch(s.name){case"PasswordException":n=new Rw(s.message,s.code);break;case"InvalidPDFException":n=new iA(s.message);break;case"MissingPDFException":n=new zc(s.message);break;case"UnexpectedResponseException":n=new _v(s.message,s.status);break;case"UnknownErrorException":n=new xw(s.message,s.details);break;default:Et("DocException - expected a valid Error.")}i._capability.reject(n)}),t.on("PasswordRequest",s=>{if(y(this,ro,Promise.withResolvers()),i.onPassword){const n=o=>{o instanceof Error?g(this,ro).reject(o):g(this,ro).resolve({password:o})};try{i.onPassword(n,s.code)}catch(o){g(this,ro).reject(o)}}else g(this,ro).reject(new Rw(s.message,s.code));return g(this,ro).promise}),t.on("DataLoaded",s=>{var n;(n=i.onProgress)==null||n.call(i,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;g(this,oo).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,n,o])=>{var r;if(this.destroyed||this.commonObjs.has(s))return null;switch(n){case"Font":const{disableFontFace:a,fontExtraProperties:l,pdfBug:c}=this._params;if("error"in o){const f=o.error;Ue(`Error during font loading: ${f}`),this.commonObjs.resolve(s,f);break}const d=c&&((r=globalThis.FontInspector)!=null&&r.enabled)?(f,p)=>globalThis.FontInspector.fontAdded(f,p):null,h=new lL(o,{disableFontFace:a,inspectFont:d});this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!l&&h.data&&(h.data=null),this.commonObjs.resolve(s,h)});break;case"CopyLocalImage":const{imageRef:u}=o;ni(u,"The imageRef must be defined.");for(const f of g(this,oo).values())for(const[,p]of f.objs)if((p==null?void 0:p.ref)===u)return p.dataLen?(this.commonObjs.resolve(s,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,o);break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),t.on("obj",([s,n,o,r])=>{var l;if(this.destroyed)return;const a=g(this,oo).get(n);if(!a.objs.has(s)){if(a._intentStates.size===0){(l=r==null?void 0:r.bitmap)==null||l.close();return}switch(o){case"Image":a.objs.resolve(s,r),(r==null?void 0:r.dataLen)>O1&&(a._maybeCleanupAfterRender=!0);break;case"Pattern":a.objs.resolve(s,r);break;default:throw new Error(`Got unknown object type ${o}`)}}}),t.on("DocProgress",s=>{var n;this.destroyed||(n=i.onProgress)==null||n.call(i,{loaded:s.loaded,total:s.total})}),t.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),t.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&Ue("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((s=this._fullReader)==null?void 0:s.filename)??null},i).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const i=t-1,s=g(this,ah).get(i);if(s)return s;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&g(this,lh).set(o.refStr,t);const r=new lO(i,o,this,this._params.pdfBug);return g(this,oo).set(i,r),r});return g(this,ah).set(i,n),n}getPageIndex(t){return X0(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:i})}getFieldObjects(){return x(this,Kl,xu).call(this,"GetFieldObjects")}hasJSActions(){return x(this,Kl,xu).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return x(this,Kl,xu).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return x(this,Kl,xu).call(this,"GetOptionalContentConfig").then(i=>new DL(i,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",i=g(this,Qo).get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,null).then(n=>{var o,r;return{info:n[0],metadata:n[1]?new PL(n[1]):null,contentDispositionFilename:((o=this._fullReader)==null?void 0:o.filename)??null,contentLength:((r=this._fullReader)==null?void 0:r.contentLength)??null}});return g(this,Qo).set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const i of g(this,oo).values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),g(this,Qo).clear(),this.filterFactory.destroy(!0),ng.cleanup()}}cachedPageNumber(t){if(!X0(t))return null;const i=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return g(this,lh).get(i)??null}}Qo=new WeakMap,oo=new WeakMap,ah=new WeakMap,lh=new WeakMap,ro=new WeakMap,Kl=new WeakSet,xu=function(t,i=null){const s=g(this,Qo).get(t);if(s)return s;const n=this.messageHandler.sendWithPromise(t,i);return g(this,Qo).set(t,n),n};const fp=Symbol("INITIAL_DATA");var Cn,of,sb;class ZA{constructor(){F(this,of);F(this,Cn,Object.create(null))}get(t,i=null){if(i){const n=x(this,of,sb).call(this,t);return n.promise.then(()=>i(n.data)),null}const s=g(this,Cn)[t];if(!s||s.data===fp)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const i=g(this,Cn)[t];return!!i&&i.data!==fp}resolve(t,i=null){const s=x(this,of,sb).call(this,t);s.data=i,s.resolve()}clear(){var t;for(const i in g(this,Cn)){const{data:s}=g(this,Cn)[i];(t=s==null?void 0:s.bitmap)==null||t.close()}y(this,Cn,Object.create(null))}*[Symbol.iterator](){for(const t in g(this,Cn)){const{data:i}=g(this,Cn)[t];i!==fp&&(yield[t,i])}}}Cn=new WeakMap,of=new WeakSet,sb=function(t){var i;return(i=g(this,Cn))[t]||(i[t]={...Promise.withResolvers(),data:fp})};var pa;class hO{constructor(t){F(this,pa,null);y(this,pa,t),this.onContinue=null}get promise(){return g(this,pa).capability.promise}cancel(t=0){g(this,pa).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=g(this,pa).operatorList;if(!t)return!1;const{annotationCanvasMap:i}=g(this,pa);return t.form||t.canvas&&(i==null?void 0:i.size)>0}}pa=new WeakMap;var ma,ql;const cl=class cl{constructor({callback:t,params:i,objs:s,commonObjs:n,annotationCanvasMap:o,operatorList:r,pageIndex:a,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:d=!1,pdfBug:h=!1,pageColors:u=null}){F(this,ma,null);this.callback=t,this.params=i,this.objs=s,this.commonObjs=n,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=r,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=h,this.pageColors=u,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new hO(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:i}){var a,l;if(this.cancelled)return;if(this._canvas){if(g(cl,ql).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");g(cl,ql).add(this._canvas)}this._pdfBug&&((a=globalThis.StepperManager)!=null&&a.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:n,transform:o,background:r}=this.params;this.gfx=new wd(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:i},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:o,viewport:n,transparency:t,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(t=null,i=0){var s;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),g(this,ma)&&(window.cancelAnimationFrame(g(this,ma)),y(this,ma,null)),g(cl,ql).delete(this._canvas),this.callback(t||new jy(`Rendering cancelled, page ${this._pageIndex+1}`,i))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?y(this,ma,window.requestAnimationFrame(()=>{y(this,ma,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),g(cl,ql).delete(this._canvas),this.callback())))}};ma=new WeakMap,ql=new WeakMap,F(cl,ql,new WeakSet);let nb=cl;const uO="4.8.69",gO="3634dab10";function Q0(e){return Math.floor(Math.max(0,Math.min(1,e))*255).toString(16).padStart(2,"0")}function lu(e){return Math.max(0,Math.min(255,255*e))}class J0{static CMYK_G([t,i,s,n]){return["G",1-Math.min(1,.3*t+.59*s+.11*i+n)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=lu(t),[t,t,t]}static G_HTML([t]){const i=Q0(t);return`#${i}${i}${i}`}static RGB_G([t,i,s]){return["G",.3*t+.59*i+.11*s]}static RGB_rgb(t){return t.map(lu)}static RGB_HTML(t){return`#${t.map(Q0).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,i,s,n]){return["RGB",1-Math.min(1,t+n),1-Math.min(1,s+n),1-Math.min(1,i+n)]}static CMYK_rgb([t,i,s,n]){return[lu(1-Math.min(1,t+n)),lu(1-Math.min(1,s+n)),lu(1-Math.min(1,i+n))]}static CMYK_HTML(t){const i=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(i)}static RGB_CMYK([t,i,s]){const n=1-t,o=1-i,r=1-s,a=Math.min(n,o,r);return["CMYK",n,o,r,a]}}class fO{create(t,i,s=!1){if(t<=0||i<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),s||(n.setAttribute("width",`${t}px`),n.setAttribute("height",`${i}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${t} ${i}`),n}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Et("Abstract method `_createSVG` called.")}}class tS extends fO{_createSVG(t){return document.createElementNS(Oo,t)}}class eF{static setupStorage(t,i,s,n,o){const r=n.getValue(i,{value:null});switch(s.name){case"textarea":if(r.value!==null&&(t.textContent=r.value),o==="print")break;t.addEventListener("input",a=>{n.setValue(i,{value:a.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(r.value===s.attributes.xfaOn?t.setAttribute("checked",!0):r.value===s.attributes.xfaOff&&t.removeAttribute("checked"),o==="print")break;t.addEventListener("change",a=>{n.setValue(i,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(r.value!==null&&t.setAttribute("value",r.value),o==="print")break;t.addEventListener("input",a=>{n.setValue(i,{value:a.target.value})})}break;case"select":if(r.value!==null){t.setAttribute("value",r.value);for(const a of s.children)a.attributes.value===r.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}t.addEventListener("input",a=>{const l=a.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;n.setValue(i,{value:c})});break}}static setAttributes({html:t,element:i,storage:s=null,intent:n,linkService:o}){const{attributes:r}=i,a=t instanceof HTMLAnchorElement;r.type==="radio"&&(r.name=`${r.name}-${n}`);for(const[l,c]of Object.entries(r))if(c!=null)switch(l){case"class":c.length&&t.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!a||l!=="href"&&l!=="newWindow")&&t.setAttribute(l,c)}a&&o.addLinkAttributes(t,r.href,r.newWindow),s&&r.dataId&&this.setupStorage(t,r.dataId,i,s)}static render(t){var h,u;const i=t.annotationStorage,s=t.linkService,n=t.xfaHtml,o=t.intent||"display",r=document.createElement(n.name);n.attributes&&this.setAttributes({html:r,element:n,intent:o,linkService:s});const a=o!=="richText",l=t.div;if(l.append(r),t.viewport){const f=`matrix(${t.viewport.transform.join(",")})`;l.style.transform=f}a&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(n.children.length===0){if(n.value){const f=document.createTextNode(n.value);r.append(f),a&&og.shouldBuildText(n.name)&&c.push(f)}return{textDivs:c}}const d=[[n,-1,r]];for(;d.length>0;){const[f,p,m]=d.at(-1);if(p+1===f.children.length){d.pop();continue}const v=f.children[++d.at(-1)[1]];if(v===null)continue;const{name:C}=v;if(C==="#text"){const S=document.createTextNode(v.value);c.push(S),m.append(S);continue}const w=(h=v==null?void 0:v.attributes)!=null&&h.xmlns?document.createElementNS(v.attributes.xmlns,C):document.createElement(C);if(m.append(w),v.attributes&&this.setAttributes({html:w,element:v,storage:i,intent:o,linkService:s}),((u=v.children)==null?void 0:u.length)>0)d.push([v,-1,w]);else if(v.value){const S=document.createTextNode(v.value);a&&og.shouldBuildText(C)&&c.push(S),w.append(S)}}for(const f of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:c}}static update(t){const i=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=i,t.div.hidden=!1}}const qf=1e3,pO=9,Dc=new WeakSet;function wr(e){return{width:e[2]-e[0],height:e[3]-e[1]}}class mO{static create(t){switch(t.data.annotationType){case Jt.LINK:return new tF(t);case Jt.TEXT:return new vO(t);case Jt.WIDGET:switch(t.data.fieldType){case"Tx":return new CO(t);case"Btn":return t.data.radioButton?new nF(t):t.data.checkBox?new bO(t):new yO(t);case"Ch":return new SO(t);case"Sig":return new wO(t)}return new $c(t);case Jt.POPUP:return new rb(t);case Jt.FREETEXT:return new cF(t);case Jt.LINE:return new xO(t);case Jt.SQUARE:return new EO(t);case Jt.CIRCLE:return new AO(t);case Jt.POLYLINE:return new dF(t);case Jt.CARET:return new PO(t);case Jt.INK:return new iS(t);case Jt.POLYGON:return new FO(t);case Jt.HIGHLIGHT:return new hF(t);case Jt.UNDERLINE:return new TO(t);case Jt.SQUIGGLY:return new DO(t);case Jt.STRIKEOUT:return new MO(t);case Jt.STAMP:return new uF(t);case Jt.FILEATTACHMENT:return new IO(t);default:return new Kt(t)}}}var Yl,ch,dh,rf,ob;const QS=class QS{constructor(t,{isRenderable:i=!1,ignoreBorder:s=!1,createQuadrilaterals:n=!1}={}){F(this,rf);F(this,Yl,null);F(this,ch,!1);F(this,dh,null);this.isRenderable=i,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,i&&(this.container=this._createContainer(s)),n&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:i,richText:s}){return!!(t!=null&&t.str||i!=null&&i.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return QS._hasPopupData(this.data)}updateEdited(t){var s;if(!this.container)return;g(this,Yl)||y(this,Yl,{rect:this.data.rect.slice(0)});const{rect:i}=t;i&&x(this,rf,ob).call(this,i),(s=g(this,dh))==null||s.popup.updateEdited(t)}resetEdited(){var t;g(this,Yl)&&(x(this,rf,ob).call(this,g(this,Yl).rect),(t=g(this,dh))==null||t.popup.resetEdited(),y(this,Yl,null))}_createContainer(t){const{data:i,parent:{page:s,viewport:n}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",i.id),this instanceof $c||(o.tabIndex=qf);const{style:r}=o;if(r.zIndex=this.parent.zIndex++,i.alternativeText&&(o.title=i.alternativeText),i.noRotate&&o.classList.add("norotate"),!i.rect||this instanceof rb){const{rotation:m}=i;return!i.hasOwnCanvas&&m!==0&&this.setRotation(m,o),o}const{width:a,height:l}=wr(i.rect);if(!t&&i.borderStyle.width>0){r.borderWidth=`${i.borderStyle.width}px`;const m=i.borderStyle.horizontalCornerRadius,v=i.borderStyle.verticalCornerRadius;if(m>0||v>0){const w=`calc(${m}px * var(--scale-factor)) / calc(${v}px * var(--scale-factor))`;r.borderRadius=w}else if(this instanceof nF){const w=`calc(${a}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;r.borderRadius=w}switch(i.borderStyle.style){case ru.SOLID:r.borderStyle="solid";break;case ru.DASHED:r.borderStyle="dashed";break;case ru.BEVELED:Ue("Unimplemented border style: beveled");break;case ru.INSET:Ue("Unimplemented border style: inset");break;case ru.UNDERLINE:r.borderBottomStyle="solid";break}const C=i.borderColor||null;C?(y(this,ch,!0),r.borderColor=Ae.makeHexColor(C[0]|0,C[1]|0,C[2]|0)):r.borderWidth=0}const c=Ae.normalizeRect([i.rect[0],s.view[3]-i.rect[1]+s.view[1],i.rect[2],s.view[3]-i.rect[3]+s.view[1]]),{pageWidth:d,pageHeight:h,pageX:u,pageY:f}=n.rawDims;r.left=`${100*(c[0]-u)/d}%`,r.top=`${100*(c[1]-f)/h}%`;const{rotation:p}=i;return i.hasOwnCanvas||p===0?(r.width=`${100*a/d}%`,r.height=`${100*l/h}%`):this.setRotation(p,o),o}setRotation(t,i=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:n}=this.parent.viewport.rawDims,{width:o,height:r}=wr(this.data.rect);let a,l;t%180===0?(a=100*o/s,l=100*r/n):(a=100*r/s,l=100*o/n),i.style.width=`${a}%`,i.style.height=`${l}%`,i.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(i,s,n)=>{const o=n.detail[i],r=o[0],a=o.slice(1);n.target.style[s]=J0[`${r}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[s]:J0[`${r}_rgb`](a)})};return Qe(this,"_commonActions",{display:i=>{const{display:s}=i.detail,n=s%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:s===1||s===2})},print:i=>{this.annotationStorage.setValue(this.data.id,{noPrint:!i.detail.print})},hidden:i=>{const{hidden:s}=i.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.target.disabled=i.detail.readonly},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{t("bgColor","backgroundColor",i)},fillColor:i=>{t("fillColor","backgroundColor",i)},fgColor:i=>{t("fgColor","color",i)},textColor:i=>{t("textColor","color",i)},borderColor:i=>{t("borderColor","borderColor",i)},strokeColor:i=>{t("strokeColor","borderColor",i)},rotation:i=>{const s=i.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,i){const s=this._commonActions;for(const n of Object.keys(i.detail)){const o=t[n]||s[n];o==null||o(i)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const s=this._commonActions;for(const[n,o]of Object.entries(i)){const r=s[n];if(r){const a={detail:{[n]:o},target:t};r(a),delete i[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[i,s,n,o]=this.data.rect.map(m=>Math.fround(m));if(t.length===8){const[m,v,C,w]=t.subarray(2,6);if(n===m&&o===v&&i===C&&s===w)return}const{style:r}=this.container;let a;if(g(this,ch)){const{borderColor:m,borderWidth:v}=r;r.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${m}" stroke-width="${v}">`],this.container.classList.add("hasBorder")}const l=n-i,c=o-s,{svgFactory:d}=this,h=d.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0);const u=d.createElement("defs");h.append(u);const f=d.createElement("clipPath"),p=`clippath_${this.data.id}`;f.setAttribute("id",p),f.setAttribute("clipPathUnits","objectBoundingBox"),u.append(f);for(let m=2,v=t.length;m<v;m+=8){const C=t[m],w=t[m+1],S=t[m+2],b=t[m+3],E=d.createElement("rect"),A=(S-i)/l,P=(o-w)/c,T=(C-S)/l,D=(w-b)/c;E.setAttribute("x",A),E.setAttribute("y",P),E.setAttribute("width",T),E.setAttribute("height",D),f.append(E),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${A}" y="${P}" width="${T}" height="${D}"/>`)}g(this,ch)&&(a.push("</g></svg>')"),r.backgroundImage=a.join("")),this.container.append(h),this.container.style.clipPath=`url(#${p})`}_createPopup(){const{data:t}=this,i=y(this,dh,new rb({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(i.render())}render(){Et("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,i=null){const s=[];if(this._fieldObjects){const n=this._fieldObjects[t];if(n)for(const{page:o,id:r,exportValues:a}of n){if(o===-1||r===i)continue;const l=typeof a=="string"?a:null,c=document.querySelector(`[data-element-id="${r}"]`);if(c&&!Dc.has(c)){Ue(`_getElementsByName - element not allowed: ${r}`);continue}s.push({id:r,exportValue:l,domElement:c})}return s}for(const n of document.getElementsByName(t)){const{exportValue:o}=n,r=n.getAttribute("data-element-id");r!==i&&Dc.has(n)&&s.push({id:r,exportValue:o,domElement:n})}return s}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const i of t)i.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:i}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:t,editId:i})})}};Yl=new WeakMap,ch=new WeakMap,dh=new WeakMap,rf=new WeakSet,ob=function(t){const{container:{style:i},data:{rect:s,rotation:n},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:r,pageX:a,pageY:l}}}}=this;s==null||s.splice(0,4,...t);const{width:c,height:d}=wr(t);i.left=`${100*(t[0]-a)/o}%`,i.top=`${100*(r-t[3]+l)/r}%`,n===0?(i.width=`${100*c/o}%`,i.height=`${100*d/r}%`):this.setRotation(n)};let Kt=QS;var Is,il,iF,sF;class tF extends Kt{constructor(i,s=null){super(i,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});F(this,Is);this.isTooltipOnly=i.data.isTooltipOnly}render(){const{data:i,linkService:s}=this,n=document.createElement("a");n.setAttribute("data-element-id",i.id);let o=!1;return i.url?(s.addLinkAttributes(n,i.url,i.newWindow),o=!0):i.action?(this._bindNamedAction(n,i.action),o=!0):i.attachment?(x(this,Is,iF).call(this,n,i.attachment,i.attachmentDest),o=!0):i.setOCGState?(x(this,Is,sF).call(this,n,i.setOCGState),o=!0):i.dest?(this._bindLink(n,i.dest),o=!0):(i.actions&&(i.actions.Action||i.actions["Mouse Up"]||i.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,i),o=!0),i.resetForm?(this._bindResetFormAction(n,i.resetForm),o=!0):this.isTooltipOnly&&!o&&(this._bindLink(n,""),o=!0)),this.container.classList.add("linkAnnotation"),o&&this.container.append(n),this.container}_bindLink(i,s){i.href=this.linkService.getDestinationHash(s),i.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&x(this,Is,il).call(this)}_bindNamedAction(i,s){i.href=this.linkService.getAnchorUrl(""),i.onclick=()=>(this.linkService.executeNamedAction(s),!1),x(this,Is,il).call(this)}_bindJSAction(i,s){i.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const o of Object.keys(s.actions)){const r=n.get(o);r&&(i[r]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:o}}),!1})}i.onclick||(i.onclick=()=>!1),x(this,Is,il).call(this)}_bindResetFormAction(i,s){const n=i.onclick;if(n||(i.href=this.linkService.getAnchorUrl("")),x(this,Is,il).call(this),!this._fieldObjects){Ue('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(i.onclick=()=>!1);return}i.onclick=()=>{var h;n==null||n();const{fields:o,refs:r,include:a}=s,l=[];if(o.length!==0||r.length!==0){const u=new Set(r);for(const f of o){const p=this._fieldObjects[f]||[];for(const{id:m}of p)u.add(m)}for(const f of Object.values(this._fieldObjects))for(const p of f)u.has(p.id)===a&&l.push(p)}else for(const u of Object.values(this._fieldObjects))l.push(...u);const c=this.annotationStorage,d=[];for(const u of l){const{id:f}=u;switch(d.push(f),u.type){case"text":{const m=u.defaultValue||"";c.setValue(f,{value:m});break}case"checkbox":case"radiobutton":{const m=u.defaultValue===u.exportValues;c.setValue(f,{value:m});break}case"combobox":case"listbox":{const m=u.defaultValue||"";c.setValue(f,{value:m});break}default:continue}const p=document.querySelector(`[data-element-id="${f}"]`);if(p){if(!Dc.has(p)){Ue(`_bindResetFormAction - element not allowed: ${f}`);continue}}else continue;p.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((h=this.linkService.eventBus)==null||h.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}Is=new WeakSet,il=function(){this.container.setAttribute("data-internal-link","")},iF=function(i,s,n=null){i.href=this.linkService.getAnchorUrl(""),s.description&&(i.title=s.description),i.onclick=()=>{var o;return(o=this.downloadManager)==null||o.openOrDownloadData(s.content,s.filename,n),!1},x(this,Is,il).call(this)},sF=function(i,s){i.href=this.linkService.getAnchorUrl(""),i.onclick=()=>(this.linkService.executeSetOCGState(s),!1),x(this,Is,il).call(this)};class vO extends Kt{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class $c extends Kt{render(){return this.container}showElementAndHideCanvas(t){var i;this.data.hasOwnCanvas&&(((i=t.previousSibling)==null?void 0:i.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return es.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,i,s,n,o){s.includes("mouse")?t.addEventListener(s,r=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:o(r),shift:r.shiftKey,modifier:this._getKeyModifier(r)}})}):t.addEventListener(s,r=>{var a;if(s==="blur"){if(!i.focused||!r.relatedTarget)return;i.focused=!1}else if(s==="focus"){if(i.focused)return;i.focused=!0}o&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:o(r)}}))})}_setEventListeners(t,i,s,n){var o,r,a;for(const[l,c]of s)(c==="Action"||(o=this.data.actions)!=null&&o[c])&&((c==="Focus"||c==="Blur")&&(i||(i={focused:!1})),this._setEventListener(t,i,l,c,n),c==="Focus"&&!((r=this.data.actions)!=null&&r.Blur)?this._setEventListener(t,i,"blur","Blur",null):c==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(t,i,"focus","Focus",null))}_setBackgroundColor(t){const i=this.data.backgroundColor||null;t.style.backgroundColor=i===null?"transparent":Ae.makeHexColor(i[0],i[1],i[2])}_setTextStyle(t){const i=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||pO,o=t.style;let r;const a=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-a),d=Math.round(c/(cC*n))||1,h=c/d;r=Math.min(n,l(h/cC))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-a);r=Math.min(n,l(c/cC))}o.fontSize=`calc(${r}px * var(--scale-factor))`,o.color=Ae.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(o.textAlign=i[this.data.textAlignment])}_setRequired(t,i){i?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",i)}}class CO extends $c{constructor(t){const i=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:i})}setPropertyOnSiblings(t,i,s,n){const o=this.annotationStorage;for(const r of this._getElementsByName(t.name,t.id))r.domElement&&(r.domElement[i]=s),o.setValue(r.id,{[n]:s})}render(){var n,o;const t=this.annotationStorage,i=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const r=t.getValue(i,{value:this.data.fieldValue});let a=r.value||"";const l=t.getValue(i,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let c=r.formattedValue||((n=this.data.textContent)==null?void 0:n.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const d={userValue:a,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=c??a,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",c??a),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Dc.add(s),s.setAttribute("data-element-id",i),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=qf,this._setRequired(s,this.data.required),l&&(s.maxLength=l),s.addEventListener("input",u=>{t.setValue(i,{value:u.target.value}),this.setPropertyOnSiblings(s,"value",u.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",u=>{const f=this.data.defaultFieldValue??"";s.value=d.userValue=f,d.formattedValue=null});let h=u=>{const{formattedValue:f}=d;f!=null&&(u.target.value=f),u.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",f=>{var m;if(d.focused)return;const{target:p}=f;d.userValue&&(p.value=d.userValue),d.lastCommittedValue=p.value,d.commitKey=1,(m=this.data.actions)!=null&&m.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",f=>{this.showElementAndHideCanvas(f.target);const p={value(m){d.userValue=m.detail.value??"",t.setValue(i,{value:d.userValue.toString()}),m.target.value=d.userValue},formattedValue(m){const{formattedValue:v}=m.detail;d.formattedValue=v,v!=null&&m.target!==document.activeElement&&(m.target.value=v),t.setValue(i,{formattedValue:v})},selRange(m){m.target.setSelectionRange(...m.detail.selRange)},charLimit:m=>{var S;const{charLimit:v}=m.detail,{target:C}=m;if(v===0){C.removeAttribute("maxLength");return}C.setAttribute("maxLength",v);let w=d.userValue;!w||w.length<=v||(w=w.slice(0,v),C.value=d.userValue=w,t.setValue(i,{value:w}),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:w,willCommit:!0,commitKey:1,selStart:C.selectionStart,selEnd:C.selectionEnd}}))}};this._dispatchEventFromSandbox(p,f)}),s.addEventListener("keydown",f=>{var v;d.commitKey=1;let p=-1;if(f.key==="Escape"?p=0:f.key==="Enter"&&!this.data.multiLine?p=2:f.key==="Tab"&&(d.commitKey=3),p===-1)return;const{value:m}=f.target;d.lastCommittedValue!==m&&(d.lastCommittedValue=m,d.userValue=m,(v=this.linkService.eventBus)==null||v.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:m,willCommit:!0,commitKey:p,selStart:f.target.selectionStart,selEnd:f.target.selectionEnd}}))});const u=h;h=null,s.addEventListener("blur",f=>{var m,v;if(!d.focused||!f.relatedTarget)return;(m=this.data.actions)!=null&&m.Blur||(d.focused=!1);const{value:p}=f.target;d.userValue=p,d.lastCommittedValue!==p&&((v=this.linkService.eventBus)==null||v.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:p,willCommit:!0,commitKey:d.commitKey,selStart:f.target.selectionStart,selEnd:f.target.selectionEnd}})),u(f)}),(o=this.data.actions)!=null&&o.Keystroke&&s.addEventListener("beforeinput",f=>{var E;d.lastCommittedValue=null;const{data:p,target:m}=f,{value:v,selectionStart:C,selectionEnd:w}=m;let S=C,b=w;switch(f.inputType){case"deleteWordBackward":{const A=v.substring(0,C).match(/\w*[^\w]*$/);A&&(S-=A[0].length);break}case"deleteWordForward":{const A=v.substring(C).match(/^[^\w]*\w*/);A&&(b+=A[0].length);break}case"deleteContentBackward":C===w&&(S-=1);break;case"deleteContentForward":C===w&&(b+=1);break}f.preventDefault(),(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:v,change:p||"",willCommit:!1,selStart:S,selEnd:b}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],f=>f.target.value)}if(h&&s.addEventListener("blur",h),this.data.comb){const f=(this.data.rect[2]-this.data.rect[0])/l;s.classList.add("comb"),s.style.letterSpacing=`calc(${f}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class wO extends $c{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class bO extends $c{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,i=this.data,s=i.id;let n=t.getValue(s,{value:i.exportValue===i.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",t.setValue(s,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return Dc.add(o),o.setAttribute("data-element-id",s),o.disabled=i.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=i.fieldName,n&&o.setAttribute("checked",!0),o.setAttribute("exportValue",i.exportValue),o.tabIndex=qf,o.addEventListener("change",r=>{const{name:a,checked:l}=r.target;for(const c of this._getElementsByName(a,s)){const d=l&&c.exportValue===i.exportValue;c.domElement&&(c.domElement.checked=d),t.setValue(c.id,{value:d})}t.setValue(s,{value:l})}),o.addEventListener("resetform",r=>{const a=i.defaultFieldValue||"Off";r.target.checked=a===i.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",r=>{const a={value(l){l.target.checked=l.detail.value!=="Off",t.setValue(s,{value:l.target.checked})}};this._dispatchEventFromSandbox(a,r)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],r=>r.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class nF extends $c{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,i=this.data,s=i.id;let n=t.getValue(s,{value:i.fieldValue===i.buttonValue}).value;if(typeof n=="string"&&(n=n!==i.buttonValue,t.setValue(s,{value:n})),n)for(const r of this._getElementsByName(i.fieldName,s))t.setValue(r.id,{value:!1});const o=document.createElement("input");if(Dc.add(o),o.setAttribute("data-element-id",s),o.disabled=i.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=i.fieldName,n&&o.setAttribute("checked",!0),o.tabIndex=qf,o.addEventListener("change",r=>{const{name:a,checked:l}=r.target;for(const c of this._getElementsByName(a,s))t.setValue(c.id,{value:!1});t.setValue(s,{value:l})}),o.addEventListener("resetform",r=>{const a=i.defaultFieldValue;r.target.checked=a!=null&&a===i.buttonValue}),this.enableScripting&&this.hasJSActions){const r=i.buttonValue;o.addEventListener("updatefromsandbox",a=>{const l={value:c=>{const d=r===c.detail.value;for(const h of this._getElementsByName(c.target.name)){const u=d&&h.id===s;h.domElement&&(h.domElement.checked=u),t.setValue(h.id,{value:u})}}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class yO extends tF{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const i=t.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class SO extends $c{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,i=this.data.id,s=t.getValue(i,{value:this.data.fieldValue}),n=document.createElement("select");Dc.add(n),n.setAttribute("data-element-id",i),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=qf;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",d=>{const h=this.data.defaultFieldValue;for(const u of n.options)u.selected=u.value===h});for(const d of this.data.options){const h=document.createElement("option");h.textContent=d.displayValue,h.value=d.exportValue,s.value.includes(d.exportValue)&&(h.setAttribute("selected",!0),o=!1),n.append(h)}let r=null;if(o){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),n.prepend(d),r=()=>{d.remove(),n.removeEventListener("input",r),r=null},n.addEventListener("input",r)}const a=d=>{const h=d?"value":"textContent",{options:u,multiple:f}=n;return f?Array.prototype.filter.call(u,p=>p.selected).map(p=>p[h]):u.selectedIndex===-1?null:u[u.selectedIndex][h]};let l=a(!1);const c=d=>{const h=d.target.options;return Array.prototype.map.call(h,u=>({displayValue:u.textContent,exportValue:u.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",d=>{const h={value(u){r==null||r();const f=u.detail.value,p=new Set(Array.isArray(f)?f:[f]);for(const m of n.options)m.selected=p.has(m.value);t.setValue(i,{value:a(!0)}),l=a(!1)},multipleSelection(u){n.multiple=!0},remove(u){const f=n.options,p=u.detail.remove;f[p].selected=!1,n.remove(p),f.length>0&&Array.prototype.findIndex.call(f,v=>v.selected)===-1&&(f[0].selected=!0),t.setValue(i,{value:a(!0),items:c(u)}),l=a(!1)},clear(u){for(;n.length!==0;)n.remove(0);t.setValue(i,{value:null,items:[]}),l=a(!1)},insert(u){const{index:f,displayValue:p,exportValue:m}=u.detail.insert,v=n.children[f],C=document.createElement("option");C.textContent=p,C.value=m,v?v.before(C):n.append(C),t.setValue(i,{value:a(!0),items:c(u)}),l=a(!1)},items(u){const{items:f}=u.detail;for(;n.length!==0;)n.remove(0);for(const p of f){const{displayValue:m,exportValue:v}=p,C=document.createElement("option");C.textContent=m,C.value=v,n.append(C)}n.options.length>0&&(n.options[0].selected=!0),t.setValue(i,{value:a(!0),items:c(u)}),l=a(!1)},indices(u){const f=new Set(u.detail.indices);for(const p of u.target.options)p.selected=f.has(p.index);t.setValue(i,{value:a(!0)}),l=a(!1)},editable(u){u.target.disabled=!u.detail.editable}};this._dispatchEventFromSandbox(h,d)}),n.addEventListener("input",d=>{var f;const h=a(!0),u=a(!1);t.setValue(i,{value:h}),d.preventDefault(),(f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:l,change:u,changeEx:h,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):n.addEventListener("input",function(d){t.setValue(i,{value:a(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class rb extends Kt{constructor(t){const{data:i,elements:s}=t;super(t,{isRenderable:Kt._hasPopupData(i)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new RO({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),i=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",i.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(s=>`${Uy}${s}`).join(",")),this.container}}var hh,pv,mv,uh,Xl,Gt,Jo,gh,af,lf,fh,Zo,wn,er,cf,tr,df,Ql,Jl,wt,Wp,ab,oF,rF,aF,lF,$p,Up,lb;class RO{constructor({container:t,color:i,elements:s,titleObj:n,modificationDate:o,contentsObj:r,richText:a,parent:l,rect:c,parentRect:d,open:h}){F(this,wt);F(this,hh,x(this,wt,aF).bind(this));F(this,pv,x(this,wt,lb).bind(this));F(this,mv,x(this,wt,Up).bind(this));F(this,uh,x(this,wt,$p).bind(this));F(this,Xl,null);F(this,Gt,null);F(this,Jo,null);F(this,gh,null);F(this,af,null);F(this,lf,null);F(this,fh,null);F(this,Zo,!1);F(this,wn,null);F(this,er,null);F(this,cf,null);F(this,tr,null);F(this,df,null);F(this,Ql,null);F(this,Jl,!1);var u;y(this,Gt,t),y(this,df,n),y(this,Jo,r),y(this,tr,a),y(this,lf,l),y(this,Xl,i),y(this,cf,c),y(this,fh,d),y(this,af,s),y(this,gh,qy.toDateObject(o)),this.trigger=s.flatMap(f=>f.getElementsToTriggerPopup());for(const f of this.trigger)f.addEventListener("click",g(this,uh)),f.addEventListener("mouseenter",g(this,mv)),f.addEventListener("mouseleave",g(this,pv)),f.classList.add("popupTriggerArea");for(const f of s)(u=f.container)==null||u.addEventListener("keydown",g(this,hh));g(this,Gt).hidden=!0,h&&x(this,wt,$p).call(this)}render(){if(g(this,wn))return;const t=y(this,wn,document.createElement("div"));if(t.className="popup",g(this,Xl)){const o=t.style.outlineColor=Ae.makeHexColor(...g(this,Xl));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${o} 30%, white)`:t.style.backgroundColor=Ae.makeHexColor(...g(this,Xl).map(a=>Math.floor(.7*(255-a)+a)))}const i=document.createElement("span");i.className="header";const s=document.createElement("h1");if(i.append(s),{dir:s.dir,str:s.textContent}=g(this,df),t.append(i),g(this,gh)){const o=document.createElement("span");o.classList.add("popupDate"),o.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),o.setAttribute("data-l10n-args",JSON.stringify({dateObj:g(this,gh).valueOf()})),i.append(o)}const n=g(this,wt,Wp);if(n)eF.render({xfaHtml:n,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const o=this._formatContents(g(this,Jo));t.append(o)}g(this,Gt).append(t)}_formatContents({str:t,dir:i}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=i;const n=t.split(/(?:\r\n?|\n)/);for(let o=0,r=n.length;o<r;++o){const a=n[o];s.append(document.createTextNode(a)),o<r-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:t,popupContent:i}){var s;g(this,Ql)||y(this,Ql,{contentsObj:g(this,Jo),richText:g(this,tr)}),t&&y(this,er,null),i&&(y(this,tr,x(this,wt,rF).call(this,i)),y(this,Jo,null)),(s=g(this,wn))==null||s.remove(),y(this,wn,null)}resetEdited(){var t;g(this,Ql)&&({contentsObj:Ki(this,Jo)._,richText:Ki(this,tr)._}=g(this,Ql),y(this,Ql,null),(t=g(this,wn))==null||t.remove(),y(this,wn,null),y(this,er,null))}forceHide(){y(this,Jl,this.isVisible),g(this,Jl)&&(g(this,Gt).hidden=!0)}maybeShow(){g(this,Jl)&&(g(this,wn)||x(this,wt,Up).call(this),y(this,Jl,!1),g(this,Gt).hidden=!1)}get isVisible(){return g(this,Gt).hidden===!1}}hh=new WeakMap,pv=new WeakMap,mv=new WeakMap,uh=new WeakMap,Xl=new WeakMap,Gt=new WeakMap,Jo=new WeakMap,gh=new WeakMap,af=new WeakMap,lf=new WeakMap,fh=new WeakMap,Zo=new WeakMap,wn=new WeakMap,er=new WeakMap,cf=new WeakMap,tr=new WeakMap,df=new WeakMap,Ql=new WeakMap,Jl=new WeakMap,wt=new WeakSet,Wp=function(){const t=g(this,tr),i=g(this,Jo);return t!=null&&t.str&&(!(i!=null&&i.str)||i.str===t.str)&&g(this,tr).html||null},ab=function(){var t,i,s;return((s=(i=(t=g(this,wt,Wp))==null?void 0:t.attributes)==null?void 0:i.style)==null?void 0:s.fontSize)||0},oF=function(){var t,i,s;return((s=(i=(t=g(this,wt,Wp))==null?void 0:t.attributes)==null?void 0:i.style)==null?void 0:s.color)||null},rF=function(t){const i=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:i}]}},n={style:{color:g(this,wt,oF),fontSize:g(this,wt,ab)?`calc(${g(this,wt,ab)}px * var(--scale-factor))`:""}};for(const o of t.split(`
`))i.push({name:"span",value:o,attributes:n});return s},aF=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&g(this,Zo))&&x(this,wt,$p).call(this)},lF=function(){if(g(this,er)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:n,pageY:o}}}=g(this,lf);let r=!!g(this,fh),a=r?g(this,fh):g(this,cf);for(const p of g(this,af))if(!a||Ae.intersect(p.data.rect,a)!==null){a=p.data.rect,r=!0;break}const l=Ae.normalizeRect([a[0],t[3]-a[1]+t[1],a[2],t[3]-a[3]+t[1]]),d=r?a[2]-a[0]+5:0,h=l[0]+d,u=l[1];y(this,er,[100*(h-n)/i,100*(u-o)/s]);const{style:f}=g(this,Gt);f.left=`${g(this,er)[0]}%`,f.top=`${g(this,er)[1]}%`},$p=function(){y(this,Zo,!g(this,Zo)),g(this,Zo)?(x(this,wt,Up).call(this),g(this,Gt).addEventListener("click",g(this,uh)),g(this,Gt).addEventListener("keydown",g(this,hh))):(x(this,wt,lb).call(this),g(this,Gt).removeEventListener("click",g(this,uh)),g(this,Gt).removeEventListener("keydown",g(this,hh)))},Up=function(){g(this,wn)||this.render(),this.isVisible?g(this,Zo)&&g(this,Gt).classList.add("focused"):(x(this,wt,lF).call(this),g(this,Gt).hidden=!1,g(this,Gt).style.zIndex=parseInt(g(this,Gt).style.zIndex)+1e3)},lb=function(){g(this,Gt).classList.remove("focused"),!(g(this,Zo)||!this.isVisible)&&(g(this,Gt).hidden=!0,g(this,Gt).style.zIndex=parseInt(g(this,Gt).style.zIndex)-1e3)};class cF extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=ze.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const i of this.textContent){const s=document.createElement("span");s.textContent=i,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var hf;class xO extends Kt{constructor(i){super(i,{isRenderable:!0,ignoreBorder:!0});F(this,hf,null)}render(){this.container.classList.add("lineAnnotation");const i=this.data,{width:s,height:n}=wr(i.rect),o=this.svgFactory.create(s,n,!0),r=y(this,hf,this.svgFactory.createElement("svg:line"));return r.setAttribute("x1",i.rect[2]-i.lineCoordinates[0]),r.setAttribute("y1",i.rect[3]-i.lineCoordinates[1]),r.setAttribute("x2",i.rect[2]-i.lineCoordinates[2]),r.setAttribute("y2",i.rect[3]-i.lineCoordinates[3]),r.setAttribute("stroke-width",i.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),o.append(r),this.container.append(o),!i.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,hf)}addHighlightArea(){this.container.classList.add("highlightArea")}}hf=new WeakMap;var uf;class EO extends Kt{constructor(i){super(i,{isRenderable:!0,ignoreBorder:!0});F(this,uf,null)}render(){this.container.classList.add("squareAnnotation");const i=this.data,{width:s,height:n}=wr(i.rect),o=this.svgFactory.create(s,n,!0),r=i.borderStyle.width,a=y(this,uf,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",r/2),a.setAttribute("y",r/2),a.setAttribute("width",s-r),a.setAttribute("height",n-r),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),o.append(a),this.container.append(o),!i.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,uf)}addHighlightArea(){this.container.classList.add("highlightArea")}}uf=new WeakMap;var gf;class AO extends Kt{constructor(i){super(i,{isRenderable:!0,ignoreBorder:!0});F(this,gf,null)}render(){this.container.classList.add("circleAnnotation");const i=this.data,{width:s,height:n}=wr(i.rect),o=this.svgFactory.create(s,n,!0),r=i.borderStyle.width,a=y(this,gf,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",s/2),a.setAttribute("cy",n/2),a.setAttribute("rx",s/2-r/2),a.setAttribute("ry",n/2-r/2),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),o.append(a),this.container.append(o),!i.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,gf)}addHighlightArea(){this.container.classList.add("highlightArea")}}gf=new WeakMap;var ff;class dF extends Kt{constructor(i){super(i,{isRenderable:!0,ignoreBorder:!0});F(this,ff,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:i,vertices:s,borderStyle:n,popupRef:o}}=this;if(!s)return this.container;const{width:r,height:a}=wr(i),l=this.svgFactory.create(r,a,!0);let c=[];for(let h=0,u=s.length;h<u;h+=2){const f=s[h]-i[0],p=i[3]-s[h+1];c.push(`${f},${p}`)}c=c.join(" ");const d=y(this,ff,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",c),d.setAttribute("stroke-width",n.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),l.append(d),this.container.append(l),!o&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,ff)}addHighlightArea(){this.container.classList.add("highlightArea")}}ff=new WeakMap;class FO extends dF{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class PO extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var pf;class iS extends Kt{constructor(i){super(i,{isRenderable:!0,ignoreBorder:!0});F(this,pf,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ze.HIGHLIGHT:ze.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:i,inkLists:s,borderStyle:n,popupRef:o}}=this,{width:r,height:a}=wr(i),l=this.svgFactory.create(r,a,!0);for(const c of s){let d=[];for(let u=0,f=c.length;u<f;u+=2){const p=c[u]-i[0],m=i[3]-c[u+1];d.push(`${p},${m}`)}d=d.join(" ");const h=this.svgFactory.createElement(this.svgElementName);g(this,pf).push(h),h.setAttribute("points",d),h.setAttribute("stroke-width",n.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(l),this._editOnDoubleClick(),this.container}getElementsToTriggerPopup(){return g(this,pf)}addHighlightArea(){this.container.classList.add("highlightArea")}}pf=new WeakMap;class hF extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ze.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class TO extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class DO extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class MO extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class uF extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ze.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var mf,vf,cb;class IO extends Kt{constructor(i){var n;super(i,{isRenderable:!0});F(this,vf);F(this,mf,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(n=this.linkService.eventBus)==null||n.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:i,data:s}=this;let n;s.hasAppearance||s.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),n.addEventListener("dblclick",x(this,vf,cb).bind(this)),y(this,mf,n);const{isMac:o}=es.platform;return i.addEventListener("keydown",r=>{r.key==="Enter"&&(o?r.metaKey:r.ctrlKey)&&x(this,vf,cb).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),i.append(n),i}getElementsToTriggerPopup(){return g(this,mf)}addHighlightArea(){this.container.classList.add("highlightArea")}}mf=new WeakMap,vf=new WeakSet,cb=function(){var i;(i=this.downloadManager)==null||i.openOrDownloadData(this.content,this.filename)};var Cf,Zl,ec,wf,Oc,gF,db;class kO{constructor({div:t,accessibilityManager:i,annotationCanvasMap:s,annotationEditorUIManager:n,page:o,viewport:r,structTreeLayer:a}){F(this,Oc);F(this,Cf,null);F(this,Zl,null);F(this,ec,new Map);F(this,wf,null);this.div=t,y(this,Cf,i),y(this,Zl,s),y(this,wf,a||null),this.page=o,this.viewport=r,this.zIndex=0,this._annotationEditorUIManager=n}hasEditableAnnotations(){return g(this,ec).size>0}async render(t){var r;const{annotations:i}=t,s=this.div;Pc(s,this.viewport);const n=new Map,o={data:null,layer:s,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new tS,annotationStorage:t.annotationStorage||new Xy,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const a of i){if(a.noHTML)continue;const l=a.annotationType===Jt.POPUP;if(l){const h=n.get(a.id);if(!h)continue;o.elements=h}else{const{width:h,height:u}=wr(a.rect);if(h<=0||u<=0)continue}o.data=a;const c=mO.create(o);if(!c.isRenderable)continue;if(!l&&a.popupRef){const h=n.get(a.popupRef);h?h.push(c):n.set(a.popupRef,[c])}const d=c.render();a.hidden&&(d.style.visibility="hidden"),await x(this,Oc,gF).call(this,d,a.id),c._isEditable&&(g(this,ec).set(c.data.id,c),(r=this._annotationEditorUIManager)==null||r.renderAnnotationElement(c))}x(this,Oc,db).call(this)}update({viewport:t}){const i=this.div;this.viewport=t,Pc(i,{rotation:t.rotation}),x(this,Oc,db).call(this),i.hidden=!1}getEditableAnnotations(){return Array.from(g(this,ec).values())}getEditableAnnotation(t){return g(this,ec).get(t)}}Cf=new WeakMap,Zl=new WeakMap,ec=new WeakMap,wf=new WeakMap,Oc=new WeakSet,gF=async function(t,i){var r,a;const s=t.firstChild||t,n=s.id=`${Uy}${i}`,o=await((r=g(this,wf))==null?void 0:r.getAriaAttributes(n));if(o)for(const[l,c]of o)s.setAttribute(l,c);this.div.append(t),(a=g(this,Cf))==null||a.moveElementInDOM(this.div,t,s,!1)},db=function(){if(!g(this,Zl))return;const t=this.div;for(const[i,s]of g(this,Zl)){const n=t.querySelector(`[data-annotation-id="${i}"]`);if(!n)continue;s.className="annotationContent";const{firstChild:o}=n;o?o.nodeName==="CANVAS"?o.replaceWith(s):o.classList.contains("annotationContent")?o.after(s):o.before(s):n.append(s)}g(this,Zl).clear()};const pp=/\r\n?|\n/g;var bn,xs,bf,tc,Es,Qt,fF,pF,mF,jp,Er,Kp,qp,vF,ub,CF;const yt=class yt extends pt{constructor(i){super({...i,name:"freeTextEditor"});F(this,Qt);F(this,bn);F(this,xs,"");F(this,bf,`${this.id}-editor`);F(this,tc,null);F(this,Es);y(this,bn,i.color||yt._defaultColor||pt._defaultLineColor),y(this,Es,i.fontSize||yt._defaultFontSize)}static get _keyboardManager(){const i=yt.prototype,s=r=>r.isEmpty(),n=Tc.TRANSLATE_SMALL,o=Tc.TRANSLATE_BIG;return Qe(this,"_keyboardManager",new Kf([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],i.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],i.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],i._translateEmpty,{args:[-n,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],i._translateEmpty,{args:[-o,0],checker:s}],[["ArrowRight","mac+ArrowRight"],i._translateEmpty,{args:[n,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],i._translateEmpty,{args:[o,0],checker:s}],[["ArrowUp","mac+ArrowUp"],i._translateEmpty,{args:[0,-n],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],i._translateEmpty,{args:[0,-o],checker:s}],[["ArrowDown","mac+ArrowDown"],i._translateEmpty,{args:[0,n],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],i._translateEmpty,{args:[0,o],checker:s}]]))}static initialize(i,s){pt.initialize(i,s);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(i,s){switch(i){case He.FREETEXT_SIZE:yt._defaultFontSize=s;break;case He.FREETEXT_COLOR:yt._defaultColor=s;break}}updateParams(i,s){switch(i){case He.FREETEXT_SIZE:x(this,Qt,fF).call(this,s);break;case He.FREETEXT_COLOR:x(this,Qt,pF).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[He.FREETEXT_SIZE,yt._defaultFontSize],[He.FREETEXT_COLOR,yt._defaultColor||pt._defaultLineColor]]}get propertiesToUpdate(){return[[He.FREETEXT_SIZE,g(this,Es)],[He.FREETEXT_COLOR,g(this,bn)]]}_translateEmpty(i,s){this._uiManager.translateSelectedEditors(i,s,!0)}getInitialTranslation(){const i=this.parentScale;return[-yt._internalPadding*i,-(yt._internalPadding+g(this,Es))*i]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(ze.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),y(this,tc,new AbortController);const i=this._uiManager.combinedSignal(g(this,tc));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:i}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:i}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:i}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:i}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:i})}disableEditMode(){var i;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",g(this,bf)),this._isDraggable=!0,(i=g(this,tc))==null||i.abort(),y(this,tc,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(i){this._focusEventsAllowed&&(super.focusin(i),i.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var i;this.width||(this.enableEditMode(),this.editorDiv.focus(),(i=this._initialOptions)!=null&&i.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const i=g(this,xs),s=y(this,xs,x(this,Qt,mF).call(this).trimEnd());if(i===s)return;const n=o=>{if(y(this,xs,o),!o){this.remove();return}x(this,Qt,qp).call(this),this._uiManager.rebuild(this),x(this,Qt,jp).call(this)};this.addCommands({cmd:()=>{n(s)},undo:()=>{n(i)},mustExec:!1}),x(this,Qt,jp).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(i){this.enterInEditMode()}keydown(i){i.target===this.div&&i.key==="Enter"&&(this.enterInEditMode(),i.preventDefault())}editorDivKeydown(i){yt._keyboardManager.exec(this,i)}editorDivFocus(i){this.isEditing=!0}editorDivBlur(i){this.isEditing=!1}editorDivInput(i){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let i,s;this.width&&(i=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",g(this,bf)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${g(this,Es)}px * var(--scale-factor))`,n.color=g(this,bn),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Em(this,this.div,["dblclick","keydown"]),this.width){const[o,r]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[d,h]=this.pageDimensions,[u,f]=this.pageTranslation;let p,m;switch(this.rotation){case 0:p=i+(a[0]-u)/d,m=s+this.height-(a[1]-f)/h;break;case 90:p=i+(a[0]-u)/d,m=s-(a[1]-f)/h,[l,c]=[c,-l];break;case 180:p=i-this.width+(a[0]-u)/d,m=s-(a[1]-f)/h,[l,c]=[-l,-c];break;case 270:p=i+(a[0]-u-this.height*h)/d,m=s+(a[1]-f-this.width*d)/h,[l,c]=[-c,l];break}this.setAt(p*o,m*r,l,c)}else this.setAt(i*o,s*r,this.width*o,this.height*r);x(this,Qt,qp).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(i){var p,m,v;const s=i.clipboardData||window.clipboardData,{types:n}=s;if(n.length===1&&n[0]==="text/plain")return;i.preventDefault();const o=x(p=yt,Er,ub).call(p,s.getData("text")||"").replaceAll(pp,`
`);if(!o)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const a=r.getRangeAt(0);if(!o.includes(`
`)){a.insertNode(document.createTextNode(o)),this.editorDiv.normalize(),r.collapseToStart();return}const{startContainer:l,startOffset:c}=a,d=[],h=[];if(l.nodeType===Node.TEXT_NODE){const C=l.parentElement;if(h.push(l.nodeValue.slice(c).replaceAll(pp,"")),C!==this.editorDiv){let w=d;for(const S of this.editorDiv.childNodes){if(S===C){w=h;continue}w.push(x(m=yt,Er,Kp).call(m,S))}}d.push(l.nodeValue.slice(0,c).replaceAll(pp,""))}else if(l===this.editorDiv){let C=d,w=0;for(const S of this.editorDiv.childNodes)w++===c&&(C=h),C.push(x(v=yt,Er,Kp).call(v,S))}y(this,xs,`${d.join(`
`)}${o}${h.join(`
`)}`),x(this,Qt,qp).call(this);const u=new Range;let f=d.reduce((C,w)=>C+w.length,0);for(const{firstChild:C}of this.editorDiv.childNodes)if(C.nodeType===Node.TEXT_NODE){const w=C.nodeValue.length;if(f<=w){u.setStart(C,f),u.setEnd(C,f);break}f-=w}r.removeAllRanges(),r.addRange(u)}get contentDiv(){return this.editorDiv}static async deserialize(i,s,n){var a;let o=null;if(i instanceof cF){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:d,rotation:h,id:u,popupRef:f},textContent:p,textPosition:m,parent:{page:{pageNumber:v}}}=i;if(!p||p.length===0)return null;o=i={annotationType:ze.FREETEXT,color:Array.from(c),fontSize:l,value:p.join(`
`),position:m,pageIndex:v-1,rect:d.slice(0),rotation:h,id:u,deleted:!1,popupRef:f}}const r=await super.deserialize(i,s,n);return y(r,Es,i.fontSize),y(r,bn,Ae.makeHexColor(...i.color)),y(r,xs,x(a=yt,Er,ub).call(a,i.value)),r.annotationElementId=i.id||null,r._initialData=o,r}serialize(i=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=yt._internalPadding*this.parentScale,n=this.getRect(s,s),o=pt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:g(this,bn)),r={annotationType:ze.FREETEXT,color:o,fontSize:g(this,Es),value:x(this,Qt,vF).call(this),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return i?r:this.annotationElementId&&!x(this,Qt,CF).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(i){const s=super.renderAnnotationElement(i);if(this.deleted)return s;const{style:n}=s;n.fontSize=`calc(${g(this,Es)}px * var(--scale-factor))`,n.color=g(this,bn),s.replaceChildren();for(const r of g(this,xs).split(`
`)){const a=document.createElement("div");a.append(r?document.createTextNode(r):document.createElement("br")),s.append(a)}const o=yt._internalPadding*this.parentScale;return i.updateEdited({rect:this.getRect(o,o),popupContent:g(this,xs)}),s}resetAnnotationElement(i){super.resetAnnotationElement(i),i.resetEdited()}};bn=new WeakMap,xs=new WeakMap,bf=new WeakMap,tc=new WeakMap,Es=new WeakMap,Qt=new WeakSet,fF=function(i){const s=o=>{this.editorDiv.style.fontSize=`calc(${o}px * var(--scale-factor))`,this.translate(0,-(o-g(this,Es))*this.parentScale),y(this,Es,o),x(this,Qt,jp).call(this)},n=g(this,Es);this.addCommands({cmd:s.bind(this,i),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:He.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},pF=function(i){const s=o=>{y(this,bn,this.editorDiv.style.color=o)},n=g(this,bn);this.addCommands({cmd:s.bind(this,i),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:He.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},mF=function(){var n;const i=[];this.editorDiv.normalize();let s=null;for(const o of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&o.nodeName==="BR"||(i.push(x(n=yt,Er,Kp).call(n,o)),s=o);return i.join(`
`)},jp=function(){const[i,s]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:o,div:r}=this,a=r.style.display,l=r.classList.contains("hidden");r.classList.remove("hidden"),r.style.display="hidden",o.div.append(this.div),n=r.getBoundingClientRect(),r.remove(),r.style.display=a,r.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=n.width/i,this.height=n.height/s):(this.width=n.height/i,this.height=n.width/s),this.fixAndSetPosition()},Er=new WeakSet,Kp=function(i){return(i.nodeType===Node.TEXT_NODE?i.nodeValue:i.innerText).replaceAll(pp,"")},qp=function(){if(this.editorDiv.replaceChildren(),!!g(this,xs))for(const i of g(this,xs).split(`
`)){const s=document.createElement("div");s.append(i?document.createTextNode(i):document.createElement("br")),this.editorDiv.append(s)}},vF=function(){return g(this,xs).replaceAll("Â "," ")},ub=function(i){return i.replaceAll(" ","Â ")},CF=function(i){const{value:s,fontSize:n,color:o,pageIndex:r}=this._initialData;return this._hasBeenMoved||i.value!==s||i.fontSize!==n||i.color.some((a,l)=>a!==o[l])||i.pageIndex!==r},F(yt,Er),Pe(yt,"_freeTextDefaultContent",""),Pe(yt,"_internalPadding",0),Pe(yt,"_defaultColor",null),Pe(yt,"_defaultFontSize",10),Pe(yt,"_type","freetext"),Pe(yt,"_editorType",ze.FREETEXT);let hb=yt;class wF{toSVGPath(){Et("Abstract method `toSVGPath` must be implemented.")}get box(){Et("Abstract getter `box` must be implemented.")}serialize(t,i){Et("Abstract method `serialize` must be implemented.")}get classNamesForDrawing(){Et("Abstract getter `classNamesForDrawing` must be implemented.")}get classNamesForOutlining(){Et("Abstract getter `classNamesForOutlining` must be implemented.")}get mustRemoveSelfIntersections(){return!1}}var As,yn,ph,mh,ao,je,ic,sc,yf,Sf,vh,Ch,va,Rf,vv,Cv,oi,Eu,bF,yF,SF,RF,xF,EF;const Go=class Go{constructor({x:t,y:i},s,n,o,r,a=0){F(this,oi);F(this,As);F(this,yn,[]);F(this,ph);F(this,mh);F(this,ao,[]);F(this,je,new Float64Array(18));F(this,ic);F(this,sc);F(this,yf);F(this,Sf);F(this,vh);F(this,Ch);F(this,va,[]);y(this,As,s),y(this,Ch,o*n),y(this,mh,r),g(this,je).set([NaN,NaN,NaN,NaN,t,i],6),y(this,ph,a),y(this,Sf,g(Go,Rf)*n),y(this,yf,g(Go,Cv)*n),y(this,vh,n),g(this,va).push(t,i)}isEmpty(){return isNaN(g(this,je)[8])}add({x:t,y:i}){var D;y(this,ic,t),y(this,sc,i);const[s,n,o,r]=g(this,As);let[a,l,c,d]=g(this,je).subarray(8,12);const h=t-c,u=i-d,f=Math.hypot(h,u);if(f<g(this,yf))return!1;const p=f-g(this,Sf),m=p/f,v=m*h,C=m*u;let w=a,S=l;a=c,l=d,c+=v,d+=C,(D=g(this,va))==null||D.push(t,i);const b=-C/p,E=v/p,A=b*g(this,Ch),P=E*g(this,Ch);return g(this,je).set(g(this,je).subarray(2,8),0),g(this,je).set([c+A,d+P],4),g(this,je).set(g(this,je).subarray(14,18),12),g(this,je).set([c-A,d-P],16),isNaN(g(this,je)[6])?(g(this,ao).length===0&&(g(this,je).set([a+A,l+P],2),g(this,ao).push(NaN,NaN,NaN,NaN,(a+A-s)/o,(l+P-n)/r),g(this,je).set([a-A,l-P],14),g(this,yn).push(NaN,NaN,NaN,NaN,(a-A-s)/o,(l-P-n)/r)),g(this,je).set([w,S,a,l,c,d],6),!this.isEmpty()):(g(this,je).set([w,S,a,l,c,d],6),Math.abs(Math.atan2(S-l,w-a)-Math.atan2(C,v))<Math.PI/2?([a,l,c,d]=g(this,je).subarray(2,6),g(this,ao).push(NaN,NaN,NaN,NaN,((a+c)/2-s)/o,((l+d)/2-n)/r),[a,l,w,S]=g(this,je).subarray(14,18),g(this,yn).push(NaN,NaN,NaN,NaN,((w+a)/2-s)/o,((S+l)/2-n)/r),!0):([w,S,a,l,c,d]=g(this,je).subarray(0,6),g(this,ao).push(((w+5*a)/6-s)/o,((S+5*l)/6-n)/r,((5*a+c)/6-s)/o,((5*l+d)/6-n)/r,((a+c)/2-s)/o,((l+d)/2-n)/r),[c,d,a,l,w,S]=g(this,je).subarray(12,18),g(this,yn).push(((w+5*a)/6-s)/o,((S+5*l)/6-n)/r,((5*a+c)/6-s)/o,((5*l+d)/6-n)/r,((a+c)/2-s)/o,((l+d)/2-n)/r),!0))}toSVGPath(){if(this.isEmpty())return"";const t=g(this,ao),i=g(this,yn);if(isNaN(g(this,je)[6])&&!this.isEmpty())return x(this,oi,bF).call(this);const s=[];s.push(`M${t[4]} ${t[5]}`);for(let n=6;n<t.length;n+=6)isNaN(t[n])?s.push(`L${t[n+4]} ${t[n+5]}`):s.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);x(this,oi,SF).call(this,s);for(let n=i.length-6;n>=6;n-=6)isNaN(i[n])?s.push(`L${i[n+4]} ${i[n+5]}`):s.push(`C${i[n]} ${i[n+1]} ${i[n+2]} ${i[n+3]} ${i[n+4]} ${i[n+5]}`);return x(this,oi,yF).call(this,s),s.join(" ")}newFreeDrawOutline(t,i,s,n,o,r){return new AF(t,i,s,n,o,r)}getOutlines(){var h;const t=g(this,ao),i=g(this,yn),s=g(this,je),[n,o,r,a]=g(this,As),l=new Float64Array((((h=g(this,va))==null?void 0:h.length)??0)+2);for(let u=0,f=l.length-2;u<f;u+=2)l[u]=(g(this,va)[u]-n)/r,l[u+1]=(g(this,va)[u+1]-o)/a;if(l[l.length-2]=(g(this,ic)-n)/r,l[l.length-1]=(g(this,sc)-o)/a,isNaN(s[6])&&!this.isEmpty())return x(this,oi,RF).call(this,l);const c=new Float64Array(g(this,ao).length+24+g(this,yn).length);let d=t.length;for(let u=0;u<d;u+=2){if(isNaN(t[u])){c[u]=c[u+1]=NaN;continue}c[u]=t[u],c[u+1]=t[u+1]}d=x(this,oi,EF).call(this,c,d);for(let u=i.length-6;u>=6;u-=6)for(let f=0;f<6;f+=2){if(isNaN(i[u+f])){c[d]=c[d+1]=NaN,d+=2;continue}c[d]=i[u+f],c[d+1]=i[u+f+1],d+=2}return x(this,oi,xF).call(this,c,d),this.newFreeDrawOutline(c,l,g(this,As),g(this,vh),g(this,ph),g(this,mh))}};As=new WeakMap,yn=new WeakMap,ph=new WeakMap,mh=new WeakMap,ao=new WeakMap,je=new WeakMap,ic=new WeakMap,sc=new WeakMap,yf=new WeakMap,Sf=new WeakMap,vh=new WeakMap,Ch=new WeakMap,va=new WeakMap,Rf=new WeakMap,vv=new WeakMap,Cv=new WeakMap,oi=new WeakSet,Eu=function(){const t=g(this,je).subarray(4,6),i=g(this,je).subarray(16,18),[s,n,o,r]=g(this,As);return[(g(this,ic)+(t[0]-i[0])/2-s)/o,(g(this,sc)+(t[1]-i[1])/2-n)/r,(g(this,ic)+(i[0]-t[0])/2-s)/o,(g(this,sc)+(i[1]-t[1])/2-n)/r]},bF=function(){const[t,i,s,n]=g(this,As),[o,r,a,l]=x(this,oi,Eu).call(this);return`M${(g(this,je)[2]-t)/s} ${(g(this,je)[3]-i)/n} L${(g(this,je)[4]-t)/s} ${(g(this,je)[5]-i)/n} L${o} ${r} L${a} ${l} L${(g(this,je)[16]-t)/s} ${(g(this,je)[17]-i)/n} L${(g(this,je)[14]-t)/s} ${(g(this,je)[15]-i)/n} Z`},yF=function(t){const i=g(this,yn);t.push(`L${i[4]} ${i[5]} Z`)},SF=function(t){const[i,s,n,o]=g(this,As),r=g(this,je).subarray(4,6),a=g(this,je).subarray(16,18),[l,c,d,h]=x(this,oi,Eu).call(this);t.push(`L${(r[0]-i)/n} ${(r[1]-s)/o} L${l} ${c} L${d} ${h} L${(a[0]-i)/n} ${(a[1]-s)/o}`)},RF=function(t){const i=g(this,je),[s,n,o,r]=g(this,As),[a,l,c,d]=x(this,oi,Eu).call(this),h=new Float64Array(36);return h.set([NaN,NaN,NaN,NaN,(i[2]-s)/o,(i[3]-n)/r,NaN,NaN,NaN,NaN,(i[4]-s)/o,(i[5]-n)/r,NaN,NaN,NaN,NaN,a,l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,(i[16]-s)/o,(i[17]-n)/r,NaN,NaN,NaN,NaN,(i[14]-s)/o,(i[15]-n)/r],0),this.newFreeDrawOutline(h,t,g(this,As),g(this,vh),g(this,ph),g(this,mh))},xF=function(t,i){const s=g(this,yn);return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],i),i+=6},EF=function(t,i){const s=g(this,je).subarray(4,6),n=g(this,je).subarray(16,18),[o,r,a,l]=g(this,As),[c,d,h,u]=x(this,oi,Eu).call(this);return t.set([NaN,NaN,NaN,NaN,(s[0]-o)/a,(s[1]-r)/l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,h,u,NaN,NaN,NaN,NaN,(n[0]-o)/a,(n[1]-r)/l],i),i+=24},F(Go,Rf,8),F(Go,vv,2),F(Go,Cv,g(Go,Rf)+g(Go,vv));let Fm=Go;var wh,nc,ir,xf,Fs,Ef,zt,ps,Au,Fu,FF;class AF extends wF{constructor(i,s,n,o,r,a){super();F(this,ps);F(this,wh);F(this,nc,null);F(this,ir);F(this,xf);F(this,Fs);F(this,Ef);F(this,zt);y(this,zt,i),y(this,Fs,s),y(this,wh,n),y(this,Ef,o),y(this,ir,r),y(this,xf,a),x(this,ps,FF).call(this,a);const{x:l,y:c,width:d,height:h}=g(this,nc);for(let u=0,f=i.length;u<f;u+=2)i[u]=(i[u]-l)/d,i[u+1]=(i[u+1]-c)/h;for(let u=0,f=s.length;u<f;u+=2)s[u]=(s[u]-l)/d,s[u+1]=(s[u+1]-c)/h}toSVGPath(){const i=[`M${g(this,zt)[4]} ${g(this,zt)[5]}`];for(let s=6,n=g(this,zt).length;s<n;s+=6){if(isNaN(g(this,zt)[s])){i.push(`L${g(this,zt)[s+4]} ${g(this,zt)[s+5]}`);continue}i.push(`C${g(this,zt)[s]} ${g(this,zt)[s+1]} ${g(this,zt)[s+2]} ${g(this,zt)[s+3]} ${g(this,zt)[s+4]} ${g(this,zt)[s+5]}`)}return i.push("Z"),i.join(" ")}serialize([i,s,n,o],r){const a=n-i,l=o-s;let c,d;switch(r){case 0:c=x(this,ps,Au).call(this,g(this,zt),i,o,a,-l),d=x(this,ps,Au).call(this,g(this,Fs),i,o,a,-l);break;case 90:c=x(this,ps,Fu).call(this,g(this,zt),i,s,a,l),d=x(this,ps,Fu).call(this,g(this,Fs),i,s,a,l);break;case 180:c=x(this,ps,Au).call(this,g(this,zt),n,s,-a,l),d=x(this,ps,Au).call(this,g(this,Fs),n,s,-a,l);break;case 270:c=x(this,ps,Fu).call(this,g(this,zt),n,o,-a,-l),d=x(this,ps,Fu).call(this,g(this,Fs),n,o,-a,-l);break}return{outline:Array.from(c),points:[Array.from(d)]}}get box(){return g(this,nc)}newOutliner(i,s,n,o,r,a=0){return new Fm(i,s,n,o,r,a)}getNewOutline(i,s){const{x:n,y:o,width:r,height:a}=g(this,nc),[l,c,d,h]=g(this,wh),u=r*d,f=a*h,p=n*d+l,m=o*h+c,v=this.newOutliner({x:g(this,Fs)[0]*u+p,y:g(this,Fs)[1]*f+m},g(this,wh),g(this,Ef),i,g(this,xf),s??g(this,ir));for(let C=2;C<g(this,Fs).length;C+=2)v.add({x:g(this,Fs)[C]*u+p,y:g(this,Fs)[C+1]*f+m});return v.getOutlines()}get mustRemoveSelfIntersections(){return!0}}wh=new WeakMap,nc=new WeakMap,ir=new WeakMap,xf=new WeakMap,Fs=new WeakMap,Ef=new WeakMap,zt=new WeakMap,ps=new WeakSet,Au=function(i,s,n,o,r){const a=new Float64Array(i.length);for(let l=0,c=i.length;l<c;l+=2)a[l]=s+i[l]*o,a[l+1]=n+i[l+1]*r;return a},Fu=function(i,s,n,o,r){const a=new Float64Array(i.length);for(let l=0,c=i.length;l<c;l+=2)a[l]=s+i[l+1]*o,a[l+1]=n+i[l]*r;return a},FF=function(i){const s=g(this,zt);let n=s[4],o=s[5],r=n,a=o,l=n,c=o,d=n,h=o;const u=i?Math.max:Math.min;for(let C=6,w=s.length;C<w;C+=6){if(isNaN(s[C]))r=Math.min(r,s[C+4]),a=Math.min(a,s[C+5]),l=Math.max(l,s[C+4]),c=Math.max(c,s[C+5]),h<s[C+5]?(d=s[C+4],h=s[C+5]):h===s[C+5]&&(d=u(d,s[C+4]));else{const S=Ae.bezierBoundingBox(n,o,...s.slice(C,C+6));r=Math.min(r,S[0]),a=Math.min(a,S[1]),l=Math.max(l,S[2]),c=Math.max(c,S[3]),h<S[3]?(d=S[2],h=S[3]):h===S[3]&&(d=u(d,S[2]))}n=s[C+4],o=s[C+5]}const f=r-g(this,ir),p=a-g(this,ir),m=l-r+2*g(this,ir),v=c-a+2*g(this,ir);y(this,nc,{x:f,y:p,width:m,height:v,lastPoint:[d,h]})};var Af,Ca,Sn,ss,PF,Yp,TF,DF,gb;class Z0{constructor(t,i=0,s=0,n=!0){F(this,ss);F(this,Af);F(this,Ca,[]);F(this,Sn,[]);let o=1/0,r=-1/0,a=1/0,l=-1/0;const c=10**-4;for(const{x:v,y:C,width:w,height:S}of t){const b=Math.floor((v-i)/c)*c,E=Math.ceil((v+w+i)/c)*c,A=Math.floor((C-i)/c)*c,P=Math.ceil((C+S+i)/c)*c,T=[b,A,P,!0],D=[E,A,P,!1];g(this,Ca).push(T,D),o=Math.min(o,b),r=Math.max(r,E),a=Math.min(a,A),l=Math.max(l,P)}const d=r-o+2*s,h=l-a+2*s,u=o-s,f=a-s,p=g(this,Ca).at(n?-1:-2),m=[p[0],p[2]];for(const v of g(this,Ca)){const[C,w,S]=v;v[0]=(C-u)/d,v[1]=(w-f)/h,v[2]=(S-f)/h}y(this,Af,{x:u,y:f,width:d,height:h,lastPoint:m})}getOutlines(){g(this,Ca).sort((i,s)=>i[0]-s[0]||i[1]-s[1]||i[2]-s[2]);const t=[];for(const i of g(this,Ca))i[3]?(t.push(...x(this,ss,gb).call(this,i)),x(this,ss,TF).call(this,i)):(x(this,ss,DF).call(this,i),t.push(...x(this,ss,gb).call(this,i)));return x(this,ss,PF).call(this,t)}}Af=new WeakMap,Ca=new WeakMap,Sn=new WeakMap,ss=new WeakSet,PF=function(t){const i=[],s=new Set;for(const r of t){const[a,l,c]=r;i.push([a,l,r],[a,c,r])}i.sort((r,a)=>r[1]-a[1]||r[0]-a[0]);for(let r=0,a=i.length;r<a;r+=2){const l=i[r][2],c=i[r+1][2];l.push(c),c.push(l),s.add(l),s.add(c)}const n=[];let o;for(;s.size>0;){const r=s.values().next().value;let[a,l,c,d,h]=r;s.delete(r);let u=a,f=l;for(o=[a,c],n.push(o);;){let p;if(s.has(d))p=d;else if(s.has(h))p=h;else break;s.delete(p),[a,l,c,d,h]=p,u!==a&&(o.push(u,f,a,f===l?l:c),u=a),f=f===l?c:l}o.push(u,f)}return new _O(n,g(this,Af))},Yp=function(t){const i=g(this,Sn);let s=0,n=i.length-1;for(;s<=n;){const o=s+n>>1,r=i[o][0];if(r===t)return o;r<t?s=o+1:n=o-1}return n+1},TF=function([,t,i]){const s=x(this,ss,Yp).call(this,t);g(this,Sn).splice(s,0,[t,i])},DF=function([,t,i]){const s=x(this,ss,Yp).call(this,t);for(let n=s;n<g(this,Sn).length;n++){const[o,r]=g(this,Sn)[n];if(o!==t)break;if(o===t&&r===i){g(this,Sn).splice(n,1);return}}for(let n=s-1;n>=0;n--){const[o,r]=g(this,Sn)[n];if(o!==t)break;if(o===t&&r===i){g(this,Sn).splice(n,1);return}}},gb=function(t){const[i,s,n]=t,o=[[i,s,n]],r=x(this,ss,Yp).call(this,n);for(let a=0;a<r;a++){const[l,c]=g(this,Sn)[a];for(let d=0,h=o.length;d<h;d++){const[,u,f]=o[d];if(!(c<=u||f<=l)){if(u>=l){if(f>c)o[d][1]=c;else{if(h===1)return[];o.splice(d,1),d--,h--}continue}o[d][2]=l,f>c&&o.push([i,c,f])}}}return o};var Ff,bh;class _O extends wF{constructor(i,s){super();F(this,Ff);F(this,bh);y(this,bh,i),y(this,Ff,s)}toSVGPath(){const i=[];for(const s of g(this,bh)){let[n,o]=s;i.push(`M${n} ${o}`);for(let r=2;r<s.length;r+=2){const a=s[r],l=s[r+1];a===n?(i.push(`V${l}`),o=l):l===o&&(i.push(`H${a}`),n=a)}i.push("Z")}return i.join(" ")}serialize([i,s,n,o],r){const a=[],l=n-i,c=o-s;for(const d of g(this,bh)){const h=new Array(d.length);for(let u=0;u<d.length;u+=2)h[u]=i+d[u]*l,h[u+1]=o-d[u+1]*c;a.push(h)}return a}get box(){return g(this,Ff)}get classNamesForDrawing(){return["highlight"]}get classNamesForOutlining(){return["highlightOutline"]}}Ff=new WeakMap,bh=new WeakMap;class fb extends Fm{newFreeDrawOutline(t,i,s,n,o,r){return new LO(t,i,s,n,o,r)}get classNamesForDrawing(){return["highlight","free"]}}class LO extends AF{get classNamesForDrawing(){return["highlight","free"]}get classNamesForOutlining(){return["highlightOutline","free"]}newOutliner(t,i,s,n,o,r=0){return new fb(t,i,s,n,o,r)}}var Rn,oc,yh,ti,Pf,Sh,Tf,Df,wa,xn,Rh,Mf,vt,pb,mb,vb,sl,MF,Wr;const rs=class rs{constructor({editor:t=null,uiManager:i=null}){F(this,vt);F(this,Rn,null);F(this,oc,null);F(this,yh);F(this,ti,null);F(this,Pf,!1);F(this,Sh,!1);F(this,Tf,null);F(this,Df);F(this,wa,null);F(this,xn,null);F(this,Rh);var s;t?(y(this,Sh,!1),y(this,Rh,He.HIGHLIGHT_COLOR),y(this,Tf,t)):(y(this,Sh,!0),y(this,Rh,He.HIGHLIGHT_DEFAULT_COLOR)),y(this,xn,(t==null?void 0:t._uiManager)||i),y(this,Df,g(this,xn)._eventBus),y(this,yh,(t==null?void 0:t.color)||((s=g(this,xn))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),g(rs,Mf)||y(rs,Mf,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Qe(this,"_keyboardManager",new Kf([[["Escape","mac+Escape"],rs.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],rs.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],rs.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],rs.prototype._moveToPrevious],[["Home","mac+Home"],rs.prototype._moveToBeginning],[["End","mac+End"],rs.prototype._moveToEnd]]))}renderButton(){const t=y(this,Rn,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const i=g(this,xn)._signal;t.addEventListener("click",x(this,vt,sl).bind(this),{signal:i}),t.addEventListener("keydown",x(this,vt,vb).bind(this),{signal:i});const s=y(this,oc,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=g(this,yh),t.append(s),t}renderMainDropdown(){const t=y(this,ti,x(this,vt,pb).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===g(this,Rn)){x(this,vt,sl).call(this,t);return}const i=t.target.getAttribute("data-color");i&&x(this,vt,mb).call(this,i,t)}_moveToNext(t){var i,s;if(!g(this,vt,Wr)){x(this,vt,sl).call(this,t);return}if(t.target===g(this,Rn)){(i=g(this,ti).firstChild)==null||i.focus();return}(s=t.target.nextSibling)==null||s.focus()}_moveToPrevious(t){var i,s;if(t.target===((i=g(this,ti))==null?void 0:i.firstChild)||t.target===g(this,Rn)){g(this,vt,Wr)&&this._hideDropdownFromKeyboard();return}g(this,vt,Wr)||x(this,vt,sl).call(this,t),(s=t.target.previousSibling)==null||s.focus()}_moveToBeginning(t){var i;if(!g(this,vt,Wr)){x(this,vt,sl).call(this,t);return}(i=g(this,ti).firstChild)==null||i.focus()}_moveToEnd(t){var i;if(!g(this,vt,Wr)){x(this,vt,sl).call(this,t);return}(i=g(this,ti).lastChild)==null||i.focus()}hideDropdown(){var t,i;(t=g(this,ti))==null||t.classList.add("hidden"),(i=g(this,wa))==null||i.abort(),y(this,wa,null)}_hideDropdownFromKeyboard(){var t;if(!g(this,Sh)){if(!g(this,vt,Wr)){(t=g(this,Tf))==null||t.unselect();return}this.hideDropdown(),g(this,Rn).focus({preventScroll:!0,focusVisible:g(this,Pf)})}}updateColor(t){if(g(this,oc)&&(g(this,oc).style.backgroundColor=t),!g(this,ti))return;const i=g(this,xn).highlightColors.values();for(const s of g(this,ti).children)s.setAttribute("aria-selected",i.next().value===t)}destroy(){var t,i;(t=g(this,Rn))==null||t.remove(),y(this,Rn,null),y(this,oc,null),(i=g(this,ti))==null||i.remove(),y(this,ti,null)}};Rn=new WeakMap,oc=new WeakMap,yh=new WeakMap,ti=new WeakMap,Pf=new WeakMap,Sh=new WeakMap,Tf=new WeakMap,Df=new WeakMap,wa=new WeakMap,xn=new WeakMap,Rh=new WeakMap,Mf=new WeakMap,vt=new WeakSet,pb=function(){const t=document.createElement("div"),i=g(this,xn)._signal;t.addEventListener("contextmenu",on,{signal:i}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,n]of g(this,xn).highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",n),o.title=s,o.setAttribute("data-l10n-id",g(rs,Mf)[s]);const r=document.createElement("span");o.append(r),r.className="swatch",r.style.backgroundColor=n,o.setAttribute("aria-selected",n===g(this,yh)),o.addEventListener("click",x(this,vt,mb).bind(this,n),{signal:i}),t.append(o)}return t.addEventListener("keydown",x(this,vt,vb).bind(this),{signal:i}),t},mb=function(t,i){i.stopPropagation(),g(this,Df).dispatch("switchannotationeditorparams",{source:this,type:g(this,Rh),value:t})},vb=function(t){rs._keyboardManager.exec(this,t)},sl=function(t){if(g(this,vt,Wr)){this.hideDropdown();return}if(y(this,Pf,t.detail===0),g(this,wa)||(y(this,wa,new AbortController),window.addEventListener("pointerdown",x(this,vt,MF).bind(this),{signal:g(this,xn).combinedSignal(g(this,wa))})),g(this,ti)){g(this,ti).classList.remove("hidden");return}const i=y(this,ti,x(this,vt,pb).call(this));g(this,Rn).append(i)},MF=function(t){var i;(i=g(this,ti))!=null&&i.contains(t.target)||this.hideDropdown()},Wr=function(){return g(this,ti)&&!g(this,ti).classList.contains("hidden")},F(rs,Mf,null);let Pm=rs;var xh,If,sr,rc,Eh,Ys,kf,_f,ac,En,Gi,ds,Ah,nr,ii,Fh,Xs,Lf,Ve,Cb,Xp,IF,kF,_F,wb,nl,en,ld,LF,Qp,Pu,OF,NF,HF,GF,BF;const at=class at extends pt{constructor(i){super({...i,name:"highlightEditor"});F(this,Ve);F(this,xh,null);F(this,If,0);F(this,sr);F(this,rc,null);F(this,Eh,null);F(this,Ys,null);F(this,kf,null);F(this,_f,0);F(this,ac,null);F(this,En,null);F(this,Gi,null);F(this,ds,!1);F(this,Ah,null);F(this,nr);F(this,ii,null);F(this,Fh,"");F(this,Xs);F(this,Lf,"");this.color=i.color||at._defaultColor,y(this,Xs,i.thickness||at._defaultThickness),y(this,nr,i.opacity||at._defaultOpacity),y(this,sr,i.boxes||null),y(this,Lf,i.methodOfCreation||""),y(this,Fh,i.text||""),this._isDraggable=!1,i.highlightId>-1?(y(this,ds,!0),x(this,Ve,Xp).call(this,i),x(this,Ve,nl).call(this)):g(this,sr)&&(y(this,xh,i.anchorNode),y(this,If,i.anchorOffset),y(this,kf,i.focusNode),y(this,_f,i.focusOffset),x(this,Ve,Cb).call(this),x(this,Ve,nl).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const i=at.prototype;return Qe(this,"_keyboardManager",new Kf([[["ArrowLeft","mac+ArrowLeft"],i._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],i._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],i._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],i._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:g(this,ds)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:g(this,Xs),methodOfCreation:g(this,Lf)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(i){return{numberOfColors:i.get("color").size}}static initialize(i,s){var n;pt.initialize(i,s),at._defaultColor||(at._defaultColor=((n=s.highlightColors)==null?void 0:n.values().next().value)||"#fff066")}static updateDefaultParams(i,s){switch(i){case He.HIGHLIGHT_DEFAULT_COLOR:at._defaultColor=s;break;case He.HIGHLIGHT_THICKNESS:at._defaultThickness=s;break}}translateInPage(i,s){}get toolbarPosition(){return g(this,Ah)}updateParams(i,s){switch(i){case He.HIGHLIGHT_COLOR:x(this,Ve,IF).call(this,s);break;case He.HIGHLIGHT_THICKNESS:x(this,Ve,kF).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[He.HIGHLIGHT_DEFAULT_COLOR,at._defaultColor],[He.HIGHLIGHT_THICKNESS,at._defaultThickness]]}get propertiesToUpdate(){return[[He.HIGHLIGHT_COLOR,this.color||at._defaultColor],[He.HIGHLIGHT_THICKNESS,g(this,Xs)||at._defaultThickness],[He.HIGHLIGHT_FREE,g(this,ds)]]}async addEditToolbar(){const i=await super.addEditToolbar();return i?(this._uiManager.highlightColors&&(y(this,Eh,new Pm({editor:this})),i.addColorPicker(g(this,Eh))),i):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(x(this,Ve,Pu).call(this))}getBaseTranslation(){return[0,0]}getRect(i,s){return super.getRect(i,s,x(this,Ve,Pu).call(this))}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){x(this,Ve,wb).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(x(this,Ve,nl).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(i){var n;let s=!1;this.parent&&!i?x(this,Ve,wb).call(this):i&&(x(this,Ve,nl).call(this,i),s=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(i),this.show(this._isVisible),s&&this.select()}rotate(i){var o,r,a;const{drawLayer:s}=this.parent;let n;g(this,ds)?(i=(i-this.rotation+360)%360,n=x(o=at,en,ld).call(o,g(this,En).box,i)):n=x(r=at,en,ld).call(r,this,i),s.rotate(g(this,Gi),i),s.rotate(g(this,ii),i),s.updateBox(g(this,Gi),n),s.updateBox(g(this,ii),x(a=at,en,ld).call(a,g(this,Ys).box,i))}render(){if(this.div)return this.div;const i=super.render();g(this,Fh)&&(i.setAttribute("aria-label",g(this,Fh)),i.setAttribute("role","mark")),g(this,ds)?i.classList.add("free"):this.div.addEventListener("keydown",x(this,Ve,LF).bind(this),{signal:this._uiManager._signal});const s=y(this,ac,document.createElement("div"));i.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=g(this,rc);const[n,o]=this.parentDimensions;return this.setDims(this.width*n,this.height*o),Em(this,g(this,ac),["pointerover","pointerleave"]),this.enableEditing(),i}pointerover(){this.isSelected||this.parent.drawLayer.addClass(g(this,ii),"hovered")}pointerleave(){this.isSelected||this.parent.drawLayer.removeClass(g(this,ii),"hovered")}_moveCaret(i){switch(this.parent.unselect(this),i){case 0:case 2:x(this,Ve,Qp).call(this,!0);break;case 1:case 3:x(this,Ve,Qp).call(this,!1);break}}select(){var i,s;super.select(),g(this,ii)&&((i=this.parent)==null||i.drawLayer.removeClass(g(this,ii),"hovered"),(s=this.parent)==null||s.drawLayer.addClass(g(this,ii),"selected"))}unselect(){var i;super.unselect(),g(this,ii)&&((i=this.parent)==null||i.drawLayer.removeClass(g(this,ii),"selected"),g(this,ds)||x(this,Ve,Qp).call(this,!1))}get _mustFixPosition(){return!g(this,ds)}show(i=this._isVisible){super.show(i),this.parent&&(this.parent.drawLayer.show(g(this,Gi),i),this.parent.drawLayer.show(g(this,ii),i))}static startHighlighting(i,s,{target:n,x:o,y:r}){const{x:a,y:l,width:c,height:d}=n.getBoundingClientRect(),h=new AbortController,u=i.combinedSignal(h),f=m=>{m.preventDefault(),m.stopPropagation()},p=m=>{h.abort(),x(this,en,GF).call(this,i,m)};window.addEventListener("blur",p,{signal:u}),window.addEventListener("pointerup",p,{signal:u}),window.addEventListener("pointerdown",f,{capture:!0,passive:!1,signal:u}),window.addEventListener("contextmenu",on,{signal:u}),n.addEventListener("pointermove",x(this,en,HF).bind(this,i),{signal:u}),this._freeHighlight=new fb({x:o,y:r},[a,l,c,d],i.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=i.drawLayer.draw(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static async deserialize(i,s,n){var m,v,C,w;let o=null;if(i instanceof hF){const{data:{quadPoints:S,rect:b,rotation:E,id:A,color:P,opacity:T,popupRef:D},parent:{page:{pageNumber:N}}}=i;o=i={annotationType:ze.HIGHLIGHT,color:Array.from(P),opacity:T,quadPoints:S,boxes:null,pageIndex:N-1,rect:b.slice(0),rotation:E,id:A,deleted:!1,popupRef:D}}else if(i instanceof iS){const{data:{inkLists:S,rect:b,rotation:E,id:A,color:P,borderStyle:{rawWidth:T},popupRef:D},parent:{page:{pageNumber:N}}}=i;o=i={annotationType:ze.HIGHLIGHT,color:Array.from(P),thickness:T,inkLists:S,boxes:null,pageIndex:N-1,rect:b.slice(0),rotation:E,id:A,deleted:!1,popupRef:D}}const{color:r,quadPoints:a,inkLists:l,opacity:c}=i,d=await super.deserialize(i,s,n);d.color=Ae.makeHexColor(...r),y(d,nr,c||1),l&&y(d,Xs,i.thickness),d.annotationElementId=i.id||null,d._initialData=o;const[h,u]=d.pageDimensions,[f,p]=d.pageTranslation;if(a){const S=y(d,sr,[]);for(let b=0;b<a.length;b+=8)S.push({x:(a[b]-f)/h,y:1-(a[b+1]-p)/u,width:(a[b+2]-a[b])/h,height:(a[b+1]-a[b+5])/u});x(m=d,Ve,Cb).call(m),x(v=d,Ve,nl).call(v),d.rotate(d.rotation)}else if(l){y(d,ds,!0);const S=l[0],b={x:S[0]-f,y:u-(S[1]-p)},E=new fb(b,[0,0,h,u],1,g(d,Xs)/2,!0,.001);for(let T=0,D=S.length;T<D;T+=2)b.x=S[T]-f,b.y=u-(S[T+1]-p),E.add(b);const{id:A,clipPathId:P}=s.drawLayer.draw(E,d.color,d._defaultOpacity,!0);x(C=d,Ve,Xp).call(C,{highlightOutlines:E.getOutlines(),highlightId:A,clipPathId:P}),x(w=d,Ve,nl).call(w)}return d}serialize(i=!1){if(this.isEmpty()||i)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),n=pt._colorManager.convert(this.color),o={annotationType:ze.HIGHLIGHT,color:n,opacity:g(this,nr),thickness:g(this,Xs),quadPoints:x(this,Ve,OF).call(this),outlines:x(this,Ve,NF).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:x(this,Ve,Pu).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!x(this,Ve,BF).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(i){return i.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};xh=new WeakMap,If=new WeakMap,sr=new WeakMap,rc=new WeakMap,Eh=new WeakMap,Ys=new WeakMap,kf=new WeakMap,_f=new WeakMap,ac=new WeakMap,En=new WeakMap,Gi=new WeakMap,ds=new WeakMap,Ah=new WeakMap,nr=new WeakMap,ii=new WeakMap,Fh=new WeakMap,Xs=new WeakMap,Lf=new WeakMap,Ve=new WeakSet,Cb=function(){const i=new Z0(g(this,sr),.001);y(this,En,i.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=g(this,En).box;const s=new Z0(g(this,sr),.0025,.001,this._uiManager.direction==="ltr");y(this,Ys,s.getOutlines());const{lastPoint:n}=g(this,Ys).box;y(this,Ah,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height])},Xp=function({highlightOutlines:i,highlightId:s,clipPathId:n}){var h,u;if(y(this,En,i),y(this,Ys,i.getNewOutline(g(this,Xs)/2+1.5,.0025)),s>=0)y(this,Gi,s),y(this,rc,n),this.parent.drawLayer.finalizeLine(s,i),y(this,ii,this.parent.drawLayer.drawOutline(g(this,Ys)));else if(this.parent){const f=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(g(this,Gi),i),this.parent.drawLayer.updateBox(g(this,Gi),x(h=at,en,ld).call(h,g(this,En).box,(f-this.rotation+360)%360)),this.parent.drawLayer.updateLine(g(this,ii),g(this,Ys)),this.parent.drawLayer.updateBox(g(this,ii),x(u=at,en,ld).call(u,g(this,Ys).box,f))}const{x:r,y:a,width:l,height:c}=i.box;switch(this.rotation){case 0:this.x=r,this.y=a,this.width=l,this.height=c;break;case 90:{const[f,p]=this.parentDimensions;this.x=a,this.y=1-r,this.width=l*p/f,this.height=c*f/p;break}case 180:this.x=1-r,this.y=1-a,this.width=l,this.height=c;break;case 270:{const[f,p]=this.parentDimensions;this.x=1-a,this.y=r,this.width=l*p/f,this.height=c*f/p;break}}const{lastPoint:d}=g(this,Ys).box;y(this,Ah,[(d[0]-r)/l,(d[1]-a)/c])},IF=function(i){const s=(r,a)=>{var l,c,d;this.color=r,(l=this.parent)==null||l.drawLayer.changeColor(g(this,Gi),r),(c=g(this,Eh))==null||c.updateColor(r),y(this,nr,a),(d=this.parent)==null||d.drawLayer.changeOpacity(g(this,Gi),a)},n=this.color,o=g(this,nr);this.addCommands({cmd:s.bind(this,i,at._defaultOpacity),undo:s.bind(this,n,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:He.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(i)},!0)},kF=function(i){const s=g(this,Xs),n=o=>{y(this,Xs,o),x(this,Ve,_F).call(this,o)};this.addCommands({cmd:n.bind(this,i),undo:n.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:He.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:i},!0)},_F=function(i){if(!g(this,ds))return;x(this,Ve,Xp).call(this,{highlightOutlines:g(this,En).getNewOutline(i/2)}),this.fixAndSetPosition();const[s,n]=this.parentDimensions;this.setDims(this.width*s,this.height*n)},wb=function(){g(this,Gi)===null||!this.parent||(this.parent.drawLayer.remove(g(this,Gi)),y(this,Gi,null),this.parent.drawLayer.remove(g(this,ii)),y(this,ii,null))},nl=function(i=this.parent){g(this,Gi)===null&&({id:Ki(this,Gi)._,clipPathId:Ki(this,rc)._}=i.drawLayer.draw(g(this,En),this.color,g(this,nr)),y(this,ii,i.drawLayer.drawOutline(g(this,Ys))),g(this,ac)&&(g(this,ac).style.clipPath=g(this,rc)))},en=new WeakSet,ld=function({x:i,y:s,width:n,height:o},r){switch(r){case 90:return{x:1-s-o,y:i,width:o,height:n};case 180:return{x:1-i-n,y:1-s-o,width:n,height:o};case 270:return{x:s,y:1-i-n,width:o,height:n}}return{x:i,y:s,width:n,height:o}},LF=function(i){at._keyboardManager.exec(this,i)},Qp=function(i){if(!g(this,xh))return;const s=window.getSelection();i?s.setPosition(g(this,xh),g(this,If)):s.setPosition(g(this,kf),g(this,_f))},Pu=function(){return g(this,ds)?this.rotation:0},OF=function(){if(g(this,ds))return null;const[i,s]=this.pageDimensions,[n,o]=this.pageTranslation,r=g(this,sr),a=new Float32Array(r.length*8);let l=0;for(const{x:c,y:d,width:h,height:u}of r){const f=c*i+n,p=(1-d-u)*s+o;a[l]=a[l+4]=f,a[l+1]=a[l+3]=p,a[l+2]=a[l+6]=f+h*i,a[l+5]=a[l+7]=p+u*s,l+=8}return a},NF=function(i){return g(this,En).serialize(i,x(this,Ve,Pu).call(this))},HF=function(i,s){this._freeHighlight.add(s)&&i.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},GF=function(i,s){this._freeHighlight.isEmpty()?i.drawLayer.remove(this._freeHighlightId):i.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},BF=function(i){const{color:s}=this._initialData;return i.color.some((n,o)=>n!==s[o])},F(at,en),Pe(at,"_defaultColor",null),Pe(at,"_defaultOpacity",1),Pe(at,"_defaultThickness",12),Pe(at,"_type","highlight"),Pe(at,"_editorType",ze.HIGHLIGHT),Pe(at,"_freeHighlightId",-1),Pe(at,"_freeHighlight",null),Pe(at,"_freeHighlightClipId","");let Tm=at;var lc,cc,lo,or,Qs,dc,hc,uc,rr,Ph,gc,fc,ba,de,VF,zF,WF,$F,yb,UF,Sb,jF,KF,qF,YF,XF,ol,Rb,xb,Eb,Jp,Zp,cd,Ab,em,Ir,QF,Fb,JF,ZF,Pb,tm,Tu;const It=class It extends pt{constructor(i){super({...i,name:"inkEditor"});F(this,de);F(this,lc,0);F(this,cc,0);F(this,lo,null);F(this,or,new Path2D);F(this,Qs,!1);F(this,dc,null);F(this,hc,!1);F(this,uc,!1);F(this,rr,null);F(this,Ph,null);F(this,gc,0);F(this,fc,0);F(this,ba,null);this.color=i.color||null,this.thickness=i.thickness||null,this.opacity=i.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(i,s){pt.initialize(i,s)}static updateDefaultParams(i,s){switch(i){case He.INK_THICKNESS:It._defaultThickness=s;break;case He.INK_COLOR:It._defaultColor=s;break;case He.INK_OPACITY:It._defaultOpacity=s/100;break}}updateParams(i,s){switch(i){case He.INK_THICKNESS:x(this,de,VF).call(this,s);break;case He.INK_COLOR:x(this,de,zF).call(this,s);break;case He.INK_OPACITY:x(this,de,WF).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[He.INK_THICKNESS,It._defaultThickness],[He.INK_COLOR,It._defaultColor||pt._defaultLineColor],[He.INK_OPACITY,Math.round(It._defaultOpacity*100)]]}get propertiesToUpdate(){return[[He.INK_THICKNESS,this.thickness||It._defaultThickness],[He.INK_COLOR,this.color||It._defaultColor||pt._defaultLineColor],[He.INK_OPACITY,Math.round(100*(this.opacity??It._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(x(this,de,Jp).call(this),x(this,de,Zp).call(this)),this.isAttachedToDOM||(this.parent.add(this),x(this,de,cd).call(this)),x(this,de,Tu).call(this)))}remove(){var i;this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,g(this,lo)&&(clearTimeout(g(this,lo)),y(this,lo,null)),(i=g(this,rr))==null||i.disconnect(),y(this,rr,null),super.remove())}setParent(i){!this.parent&&i?this._uiManager.removeShouldRescale(this):this.parent&&i===null&&this._uiManager.addShouldRescale(this),super.setParent(i)}onScaleChanging(){const[i,s]=this.parentDimensions,n=this.width*i,o=this.height*s;this.setDimensions(n,o)}enableEditMode(){g(this,Qs)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,x(this,de,Rb).call(this))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),x(this,de,xb).call(this))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){g(this,Qs)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),y(this,Qs,!0),this.div.classList.add("disabled"),x(this,de,Tu).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(i){this._focusEventsAllowed&&(super.focusin(i),this.enableEditMode())}canvasPointerdown(i){i.button!==0||!this.isInEditMode()||g(this,Qs)||(this.setInForeground(),i.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),x(this,de,UF).call(this,i.offsetX,i.offsetY))}canvasPointermove(i){i.preventDefault(),x(this,de,Sb).call(this,i.offsetX,i.offsetY)}canvasPointerup(i){i.preventDefault(),x(this,de,Eb).call(this,i)}canvasPointerleave(i){x(this,de,Eb).call(this,i)}get isResizable(){return!this.isEmpty()&&g(this,Qs)}render(){if(this.div)return this.div;let i,s;this.width&&(i=this.x,s=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[n,o,r,a]=x(this,de,$F).call(this);if(this.setAt(n,o,0,0),this.setDims(r,a),x(this,de,Jp).call(this),this.width){const[l,c]=this.parentDimensions;this.setAspectRatio(this.width*l,this.height*c),this.setAt(i*l,s*c,this.width*l,this.height*c),y(this,uc,!0),x(this,de,cd).call(this),this.setDims(this.width*l,this.height*c),x(this,de,ol).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return x(this,de,Zp).call(this),this.div}setDimensions(i,s){const n=Math.round(i),o=Math.round(s);if(g(this,gc)===n&&g(this,fc)===o)return;y(this,gc,n),y(this,fc,o),this.canvas.style.visibility="hidden";const[r,a]=this.parentDimensions;this.width=i/r,this.height=s/a,this.fixAndSetPosition(),g(this,Qs)&&x(this,de,Ab).call(this,i,s),x(this,de,cd).call(this),x(this,de,ol).call(this),this.canvas.style.visibility="visible",this.fixDims()}static async deserialize(i,s,n){var v,C,w;if(i instanceof iS)return null;const o=await super.deserialize(i,s,n);o.thickness=i.thickness,o.color=Ae.makeHexColor(...i.color),o.opacity=i.opacity;const[r,a]=o.pageDimensions,l=o.width*r,c=o.height*a,d=o.parentScale,h=i.thickness/2;y(o,Qs,!0),y(o,gc,Math.round(l)),y(o,fc,Math.round(c));const{paths:u,rect:f,rotation:p}=i;for(let{bezier:S}of u){S=x(v=It,Ir,JF).call(v,S,f,p);const b=[];o.paths.push(b);let E=d*(S[0]-h),A=d*(S[1]-h);for(let T=2,D=S.length;T<D;T+=6){const N=d*(S[T]-h),M=d*(S[T+1]-h),_=d*(S[T+2]-h),W=d*(S[T+3]-h),$=d*(S[T+4]-h),B=d*(S[T+5]-h);b.push([[E,A],[N,M],[_,W],[$,B]]),E=$,A=B}const P=x(this,Ir,QF).call(this,b);o.bezierPath2D.push(P)}const m=x(C=o,de,Pb).call(C);return y(o,cc,Math.max(pt.MIN_SIZE,m[2]-m[0])),y(o,lc,Math.max(pt.MIN_SIZE,m[3]-m[1])),x(w=o,de,Ab).call(w,l,c),o}serialize(){if(this.isEmpty())return null;const i=this.getRect(0,0),s=pt._colorManager.convert(this.ctx.strokeStyle);return{annotationType:ze.INK,color:s,thickness:this.thickness,opacity:this.opacity,paths:x(this,de,ZF).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,i),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};lc=new WeakMap,cc=new WeakMap,lo=new WeakMap,or=new WeakMap,Qs=new WeakMap,dc=new WeakMap,hc=new WeakMap,uc=new WeakMap,rr=new WeakMap,Ph=new WeakMap,gc=new WeakMap,fc=new WeakMap,ba=new WeakMap,de=new WeakSet,VF=function(i){const s=o=>{this.thickness=o,x(this,de,Tu).call(this)},n=this.thickness;this.addCommands({cmd:s.bind(this,i),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:He.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},zF=function(i){const s=o=>{this.color=o,x(this,de,ol).call(this)},n=this.color;this.addCommands({cmd:s.bind(this,i),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:He.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},WF=function(i){const s=o=>{this.opacity=o,x(this,de,ol).call(this)};i/=100;const n=this.opacity;this.addCommands({cmd:s.bind(this,i),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:He.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},$F=function(){const{parentRotation:i,parentDimensions:[s,n]}=this;switch(i){case 90:return[0,n,n,s];case 180:return[s,n,s,n];case 270:return[s,0,n,s];default:return[0,0,s,n]}},yb=function(){const{ctx:i,color:s,opacity:n,thickness:o,parentScale:r,scaleFactor:a}=this;i.lineWidth=o*r/a,i.lineCap="round",i.lineJoin="round",i.miterLimit=10,i.strokeStyle=`${s}${sL(n)}`},UF=function(i,s){this.canvas.addEventListener("contextmenu",on,{signal:this._uiManager._signal}),x(this,de,xb).call(this),y(this,dc,new AbortController);const n=this._uiManager.combinedSignal(g(this,dc));this.canvas.addEventListener("pointerleave",this.canvasPointerleave.bind(this),{signal:n}),this.canvas.addEventListener("pointermove",this.canvasPointermove.bind(this),{signal:n}),this.canvas.addEventListener("pointerup",this.canvasPointerup.bind(this),{signal:n}),this.isEditing=!0,g(this,uc)||(y(this,uc,!0),x(this,de,cd).call(this),this.thickness||(this.thickness=It._defaultThickness),this.color||(this.color=It._defaultColor||pt._defaultLineColor),this.opacity??(this.opacity=It._defaultOpacity)),this.currentPath.push([i,s]),y(this,hc,!1),x(this,de,yb).call(this),y(this,ba,()=>{x(this,de,qF).call(this),g(this,ba)&&window.requestAnimationFrame(g(this,ba))}),window.requestAnimationFrame(g(this,ba))},Sb=function(i,s){const[n,o]=this.currentPath.at(-1);if(this.currentPath.length>1&&i===n&&s===o)return;const r=this.currentPath;let a=g(this,or);if(r.push([i,s]),y(this,hc,!0),r.length<=2){a.moveTo(...r[0]),a.lineTo(i,s);return}r.length===3&&(y(this,or,a=new Path2D),a.moveTo(...r[0])),x(this,de,YF).call(this,a,...r.at(-3),...r.at(-2),i,s)},jF=function(){if(this.currentPath.length===0)return;const i=this.currentPath.at(-1);g(this,or).lineTo(...i)},KF=function(i,s){y(this,ba,null),i=Math.min(Math.max(i,0),this.canvas.width),s=Math.min(Math.max(s,0),this.canvas.height),x(this,de,Sb).call(this,i,s),x(this,de,jF).call(this);let n;if(this.currentPath.length!==1)n=x(this,de,XF).call(this);else{const c=[i,s];n=[[c,c.slice(),c.slice(),c]]}const o=g(this,or),r=this.currentPath;this.currentPath=[],y(this,or,new Path2D);const a=()=>{this.allRawPaths.push(r),this.paths.push(n),this.bezierPath2D.push(o),this._uiManager.rebuild(this)},l=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(x(this,de,Jp).call(this),x(this,de,Zp).call(this)),x(this,de,Tu).call(this))};this.addCommands({cmd:a,undo:l,mustExec:!0})},qF=function(){if(!g(this,hc))return;y(this,hc,!1);const i=Math.ceil(this.thickness*this.parentScale),s=this.currentPath.slice(-3),n=s.map(a=>a[0]),o=s.map(a=>a[1]);Math.min(...n)-i,Math.max(...n)+i,Math.min(...o)-i,Math.max(...o)+i;const{ctx:r}=this;r.save(),r.clearRect(0,0,this.canvas.width,this.canvas.height);for(const a of this.bezierPath2D)r.stroke(a);r.stroke(g(this,or)),r.restore()},YF=function(i,s,n,o,r,a,l){const c=(s+o)/2,d=(n+r)/2,h=(o+a)/2,u=(r+l)/2;i.bezierCurveTo(c+2*(o-c)/3,d+2*(r-d)/3,h+2*(o-h)/3,u+2*(r-u)/3,h,u)},XF=function(){const i=this.currentPath;if(i.length<=2)return[[i[0],i[0],i.at(-1),i.at(-1)]];const s=[];let n,[o,r]=i[0];for(n=1;n<i.length-2;n++){const[f,p]=i[n],[m,v]=i[n+1],C=(f+m)/2,w=(p+v)/2,S=[o+2*(f-o)/3,r+2*(p-r)/3],b=[C+2*(f-C)/3,w+2*(p-w)/3];s.push([[o,r],S,b,[C,w]]),[o,r]=[C,w]}const[a,l]=i[n],[c,d]=i[n+1],h=[o+2*(a-o)/3,r+2*(l-r)/3],u=[c+2*(a-c)/3,d+2*(l-d)/3];return s.push([[o,r],h,u,[c,d]]),s},ol=function(){if(this.isEmpty()){x(this,de,em).call(this);return}x(this,de,yb).call(this);const{canvas:i,ctx:s}=this;s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,i.width,i.height),x(this,de,em).call(this);for(const n of this.bezierPath2D)s.stroke(n)},Rb=function(){if(g(this,Ph))return;y(this,Ph,new AbortController);const i=this._uiManager.combinedSignal(g(this,Ph));this.canvas.addEventListener("pointerdown",this.canvasPointerdown.bind(this),{signal:i})},xb=function(){var i;(i=this.pointerdownAC)==null||i.abort(),this.pointerdownAC=null},Eb=function(i){var s;(s=g(this,dc))==null||s.abort(),y(this,dc,null),x(this,de,Rb).call(this),g(this,lo)&&clearTimeout(g(this,lo)),y(this,lo,setTimeout(()=>{y(this,lo,null),this.canvas.removeEventListener("contextmenu",on)},10)),x(this,de,KF).call(this,i.offsetX,i.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Jp=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Zp=function(){y(this,rr,new ResizeObserver(i=>{const s=i[0].contentRect;s.width&&s.height&&this.setDimensions(s.width,s.height)})),g(this,rr).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var i;(i=g(this,rr))==null||i.disconnect(),y(this,rr,null)},{once:!0})},cd=function(){if(!g(this,uc))return;const[i,s]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*i),this.canvas.height=Math.ceil(this.height*s),x(this,de,em).call(this)},Ab=function(i,s){const n=x(this,de,tm).call(this),o=(i-n)/g(this,cc),r=(s-n)/g(this,lc);this.scaleFactor=Math.min(o,r)},em=function(){const i=x(this,de,tm).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+i,this.translationY*this.scaleFactor+i)},Ir=new WeakSet,QF=function(i){const s=new Path2D;for(let n=0,o=i.length;n<o;n++){const[r,a,l,c]=i[n];n===0&&s.moveTo(...r),s.bezierCurveTo(a[0],a[1],l[0],l[1],c[0],c[1])}return s},Fb=function(i,s,n){const[o,r,a,l]=s;switch(n){case 0:for(let c=0,d=i.length;c<d;c+=2)i[c]+=o,i[c+1]=l-i[c+1];break;case 90:for(let c=0,d=i.length;c<d;c+=2){const h=i[c];i[c]=i[c+1]+o,i[c+1]=h+r}break;case 180:for(let c=0,d=i.length;c<d;c+=2)i[c]=a-i[c],i[c+1]+=r;break;case 270:for(let c=0,d=i.length;c<d;c+=2){const h=i[c];i[c]=a-i[c+1],i[c+1]=l-h}break;default:throw new Error("Invalid rotation")}return i},JF=function(i,s,n){const[o,r,a,l]=s;switch(n){case 0:for(let c=0,d=i.length;c<d;c+=2)i[c]-=o,i[c+1]=l-i[c+1];break;case 90:for(let c=0,d=i.length;c<d;c+=2){const h=i[c];i[c]=i[c+1]-r,i[c+1]=h-o}break;case 180:for(let c=0,d=i.length;c<d;c+=2)i[c]=a-i[c],i[c+1]-=r;break;case 270:for(let c=0,d=i.length;c<d;c+=2){const h=i[c];i[c]=l-i[c+1],i[c+1]=a-h}break;default:throw new Error("Invalid rotation")}return i},ZF=function(i,s,n,o){var d,h;const r=[],a=this.thickness/2,l=i*s+a,c=i*n+a;for(const u of this.paths){const f=[],p=[];for(let m=0,v=u.length;m<v;m++){const[C,w,S,b]=u[m];if(C[0]===b[0]&&C[1]===b[1]&&v===1){const W=i*C[0]+l,$=i*C[1]+c;f.push(W,$),p.push(W,$);break}const E=i*C[0]+l,A=i*C[1]+c,P=i*w[0]+l,T=i*w[1]+c,D=i*S[0]+l,N=i*S[1]+c,M=i*b[0]+l,_=i*b[1]+c;m===0&&(f.push(E,A),p.push(E,A)),f.push(P,T,D,N,M,_),p.push(P,T),m===v-1&&p.push(M,_)}r.push({bezier:x(d=It,Ir,Fb).call(d,f,o,this.rotation),points:x(h=It,Ir,Fb).call(h,p,o,this.rotation)})}return r},Pb=function(){let i=1/0,s=-1/0,n=1/0,o=-1/0;for(const r of this.paths)for(const[a,l,c,d]of r){const h=Ae.bezierBoundingBox(...a,...l,...c,...d);i=Math.min(i,h[0]),n=Math.min(n,h[1]),s=Math.max(s,h[2]),o=Math.max(o,h[3])}return[i,n,s,o]},tm=function(){return g(this,Qs)?Math.ceil(this.thickness*this.parentScale):0},Tu=function(i=!1){if(this.isEmpty())return;if(!g(this,Qs)){x(this,de,ol).call(this);return}const s=x(this,de,Pb).call(this),n=x(this,de,tm).call(this);y(this,cc,Math.max(pt.MIN_SIZE,s[2]-s[0])),y(this,lc,Math.max(pt.MIN_SIZE,s[3]-s[1]));const o=Math.ceil(n+g(this,cc)*this.scaleFactor),r=Math.ceil(n+g(this,lc)*this.scaleFactor),[a,l]=this.parentDimensions;this.width=o/a,this.height=r/l,this.setAspectRatio(o,r);const c=this.translationX,d=this.translationY;this.translationX=-s[0],this.translationY=-s[1],x(this,de,cd).call(this),x(this,de,ol).call(this),y(this,gc,o),y(this,fc,r),this.setDims(o,r);const h=i?n/this.scaleFactor/2:0;this.translate(c-this.translationX-h,d-this.translationY-h)},F(It,Ir),Pe(It,"_defaultColor",null),Pe(It,"_defaultOpacity",1),Pe(It,"_defaultThickness",1),Pe(It,"_type","ink"),Pe(It,"_editorType",ze.INK);let bb=It;var _t,xi,ya,ar,Sa,Th,co,lr,ho,Ps,Dh,Ye,Du,Mu,im,Db,eP,sm,Mb,nm,tP,iP;const Qu=class Qu extends pt{constructor(i){super({...i,name:"stampEditor"});F(this,Ye);F(this,_t,null);F(this,xi,null);F(this,ya,null);F(this,ar,null);F(this,Sa,null);F(this,Th,"");F(this,co,null);F(this,lr,null);F(this,ho,null);F(this,Ps,!1);F(this,Dh,!1);y(this,ar,i.bitmapUrl),y(this,Sa,i.bitmapFile)}static initialize(i,s){pt.initialize(i,s)}static get supportedTypes(){return Qe(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(s=>`image/${s}`))}static get supportedTypesStr(){return Qe(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(i){return this.supportedTypes.includes(i)}static paste(i,s){s.pasteEditor(ze.STAMP,{bitmapFile:i.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var i;return{type:"stamp",hasAltText:!!((i=this.altTextData)!=null&&i.altText)}}static computeTelemetryFinalData(i){const s=i.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(i=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:o,width:r,height:a}=i||this.copyCanvas(null,null,!0).imageData,l=await n.guess({name:"altText",request:{data:o,width:r,height:a,channels:o.length/(r*a)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),s&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var i,s;g(this,xi)&&(y(this,_t,null),this._uiManager.imageManager.deleteId(g(this,xi)),(i=g(this,co))==null||i.remove(),y(this,co,null),(s=g(this,lr))==null||s.disconnect(),y(this,lr,null),g(this,ho)&&(clearTimeout(g(this,ho)),y(this,ho,null))),super.remove()}rebuild(){if(!this.parent){g(this,xi)&&x(this,Ye,im).call(this);return}super.rebuild(),this.div!==null&&(g(this,xi)&&g(this,co)===null&&x(this,Ye,im).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(g(this,ya)||g(this,_t)||g(this,ar)||g(this,Sa)||g(this,xi))}get isResizable(){return!0}render(){if(this.div)return this.div;let i,s;if(this.width&&(i=this.x,s=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),g(this,_t)?x(this,Ye,Db).call(this):x(this,Ye,im).call(this),this.width&&!this.annotationElementId){const[n,o]=this.parentDimensions;this.setAt(i*n,s*o,this.width*n,this.height*o)}return this.div}copyCanvas(i,s,n=!1){var f;i||(i=224);const{width:o,height:r}=g(this,_t),a=new Aw;let l=g(this,_t),c=o,d=r,h=null;if(s){if(o>s||r>s){const T=Math.min(s/o,s/r);c=Math.floor(o*T),d=Math.floor(r*T)}h=document.createElement("canvas");const p=h.width=Math.ceil(c*a.sx),m=h.height=Math.ceil(d*a.sy);g(this,Ps)||(l=x(this,Ye,sm).call(this,p,m));const v=h.getContext("2d");v.filter=this._uiManager.hcmFilter;let C="white",w="#cfcfd8";this._uiManager.hcmFilter!=="none"?w="black":(f=window.matchMedia)!=null&&f.call(window,"(prefers-color-scheme: dark)").matches&&(C="#8f8f9d",w="#42414d");const S=15,b=S*a.sx,E=S*a.sy,A=new OffscreenCanvas(b*2,E*2),P=A.getContext("2d");P.fillStyle=C,P.fillRect(0,0,b*2,E*2),P.fillStyle=w,P.fillRect(0,0,b,E),P.fillRect(b,E,b,E),v.fillStyle=v.createPattern(A,"repeat"),v.fillRect(0,0,p,m),v.drawImage(l,0,0,l.width,l.height,0,0,p,m)}let u=null;if(n){let p,m;if(a.symmetric&&l.width<i&&l.height<i)p=l.width,m=l.height;else if(l=g(this,_t),o>i||r>i){const w=Math.min(i/o,i/r);p=Math.floor(o*w),m=Math.floor(r*w),g(this,Ps)||(l=x(this,Ye,sm).call(this,p,m))}const C=new OffscreenCanvas(p,m).getContext("2d",{willReadFrequently:!0});C.drawImage(l,0,0,l.width,l.height,0,0,p,m),u={width:p,height:m,data:C.getImageData(0,0,p,m).data}}return{canvas:h,width:c,height:d,imageData:u}}getImageForAltText(){return g(this,co)}static async deserialize(i,s,n){var m;let o=null;if(i instanceof uF){const{data:{rect:v,rotation:C,id:w,structParent:S,popupRef:b},container:E,parent:{page:{pageNumber:A}}}=i,P=E.querySelector("canvas"),T=n.imageManager.getFromCanvas(E.id,P);P.remove();const D=((m=await s._structTree.getAriaAttributes(`${Uy}${w}`))==null?void 0:m.get("aria-label"))||"";o=i={annotationType:ze.STAMP,bitmapId:T.id,bitmap:T.bitmap,pageIndex:A-1,rect:v.slice(0),rotation:C,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:D},isSvg:!1,structParent:S,popupRef:b}}const r=await super.deserialize(i,s,n),{rect:a,bitmap:l,bitmapUrl:c,bitmapId:d,isSvg:h,accessibilityData:u}=i;d&&n.imageManager.isValidId(d)?(y(r,xi,d),l&&y(r,_t,l)):y(r,ar,c),y(r,Ps,h);const[f,p]=r.pageDimensions;return r.width=(a[2]-a[0])/f,r.height=(a[3]-a[1])/p,r.annotationElementId=i.id||null,u&&(r.altTextData=u),r._initialData=o,y(r,Dh,!!o),r}serialize(i=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:ze.STAMP,bitmapId:g(this,xi),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:g(this,Ps),structTreeParentId:this._structTreeParentId};if(i)return n.bitmapUrl=x(this,Ye,nm).call(this,!0),n.accessibilityData=this.serializeAltText(!0),n;const{decorative:o,altText:r}=this.serializeAltText(!1);if(!o&&r&&(n.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const l=x(this,Ye,iP).call(this,n);if(l.isSame)return null;l.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,s===null)return n;s.stamps||(s.stamps=new Map);const a=g(this,Ps)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!s.stamps.has(g(this,xi)))s.stamps.set(g(this,xi),{area:a,serialized:n}),n.bitmap=x(this,Ye,nm).call(this,!1);else if(g(this,Ps)){const l=s.stamps.get(g(this,xi));a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=x(this,Ye,nm).call(this,!1))}return n}renderAnnotationElement(i){return i.updateEdited({rect:this.getRect(0,0)}),null}};_t=new WeakMap,xi=new WeakMap,ya=new WeakMap,ar=new WeakMap,Sa=new WeakMap,Th=new WeakMap,co=new WeakMap,lr=new WeakMap,ho=new WeakMap,Ps=new WeakMap,Dh=new WeakMap,Ye=new WeakSet,Du=function(i,s=!1){if(!i){this.remove();return}y(this,_t,i.bitmap),s||(y(this,xi,i.id),y(this,Ps,i.isSvg)),i.file&&y(this,Th,i.file.name),x(this,Ye,Db).call(this)},Mu=function(){if(y(this,ya,null),this._uiManager.enableWaiting(!1),!!g(this,co)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&g(this,_t)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&g(this,_t)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},im=function(){if(g(this,xi)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(g(this,xi)).then(n=>x(this,Ye,Du).call(this,n,!0)).finally(()=>x(this,Ye,Mu).call(this));return}if(g(this,ar)){const n=g(this,ar);y(this,ar,null),this._uiManager.enableWaiting(!0),y(this,ya,this._uiManager.imageManager.getFromUrl(n).then(o=>x(this,Ye,Du).call(this,o)).finally(()=>x(this,Ye,Mu).call(this)));return}if(g(this,Sa)){const n=g(this,Sa);y(this,Sa,null),this._uiManager.enableWaiting(!0),y(this,ya,this._uiManager.imageManager.getFromFile(n).then(o=>x(this,Ye,Du).call(this,o)).finally(()=>x(this,Ye,Mu).call(this)));return}const i=document.createElement("input");i.type="file",i.accept=Qu.supportedTypesStr;const s=this._uiManager._signal;y(this,ya,new Promise(n=>{i.addEventListener("change",async()=>{if(!i.files||i.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const o=await this._uiManager.imageManager.getFromFile(i.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),x(this,Ye,Du).call(this,o)}n()},{signal:s}),i.addEventListener("cancel",()=>{this.remove(),n()},{signal:s})}).finally(()=>x(this,Ye,Mu).call(this))),i.click()},Db=function(){const{div:i}=this;let{width:s,height:n}=g(this,_t);const[o,r]=this.pageDimensions,a=.75;if(this.width)s=this.width*o,n=this.height*r;else if(s>a*o||n>a*r){const h=Math.min(a*o/s,a*r/n);s*=h,n*=h}const[l,c]=this.parentDimensions;this.setDims(s*l/o,n*c/r),this._uiManager.enableWaiting(!1);const d=y(this,co,document.createElement("canvas"));d.setAttribute("role","img"),this.addContainer(d),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(i.hidden=!1),x(this,Ye,Mb).call(this,s,n),x(this,Ye,tP).call(this),g(this,Dh)||(this.parent.addUndoableEditor(this),y(this,Dh,!0)),this._reportTelemetry({action:"inserted_image"}),g(this,Th)&&d.setAttribute("aria-label",g(this,Th))},eP=function(i,s){var a;const[n,o]=this.parentDimensions;this.width=i/n,this.height=s/o,(a=this._initialOptions)!=null&&a.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,g(this,ho)!==null&&clearTimeout(g(this,ho)),y(this,ho,setTimeout(()=>{y(this,ho,null),x(this,Ye,Mb).call(this,i,s)},200))},sm=function(i,s){const{width:n,height:o}=g(this,_t);let r=n,a=o,l=g(this,_t);for(;r>2*i||a>2*s;){const c=r,d=a;r>2*i&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),a>2*s&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const h=new OffscreenCanvas(r,a);h.getContext("2d").drawImage(l,0,0,c,d,0,0,r,a),l=h.transferToImageBitmap()}return l},Mb=function(i,s){const n=new Aw,o=Math.ceil(i*n.sx),r=Math.ceil(s*n.sy),a=g(this,co);if(!a||a.width===o&&a.height===r)return;a.width=o,a.height=r;const l=g(this,Ps)?g(this,_t):x(this,Ye,sm).call(this,o,r),c=a.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(l,0,0,l.width,l.height,0,0,o,r)},nm=function(i){if(i){if(g(this,Ps)){const o=this._uiManager.imageManager.getSvgUrl(g(this,xi));if(o)return o}const s=document.createElement("canvas");return{width:s.width,height:s.height}=g(this,_t),s.getContext("2d").drawImage(g(this,_t),0,0),s.toDataURL()}if(g(this,Ps)){const[s,n]=this.pageDimensions,o=Math.round(this.width*s*Oa.PDF_TO_CSS_UNITS),r=Math.round(this.height*n*Oa.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(o,r);return a.getContext("2d").drawImage(g(this,_t),0,0,g(this,_t).width,g(this,_t).height,0,0,o,r),a.transferToImageBitmap()}return structuredClone(g(this,_t))},tP=function(){this._uiManager._signal&&(y(this,lr,new ResizeObserver(i=>{const s=i[0].contentRect;s.width&&s.height&&x(this,Ye,eP).call(this,s.width,s.height)})),g(this,lr).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var i;(i=g(this,lr))==null||i.disconnect(),y(this,lr,null)},{once:!0}))},iP=function(i){var c;const{rect:s,pageIndex:n,accessibilityData:{altText:o}}=this._initialData,r=i.rect.every((d,h)=>Math.abs(d-s[h])<1),a=i.pageIndex===n,l=(((c=i.accessibilityData)==null?void 0:c.alt)||"")===o;return{isSame:r&&a&&l,isSameAltText:l}},Pe(Qu,"_type","stamp"),Pe(Qu,"_editorType",ze.STAMP);let Tb=Qu;var pc,Mh,uo,Ra,cr,Ts,xa,Ih,kh,Bi,dr,Te,Ea,ki,sP,kb,_b,Lb,om;const cn=class cn{constructor({uiManager:t,pageIndex:i,div:s,structTreeLayer:n,accessibilityManager:o,annotationLayer:r,drawLayer:a,textLayer:l,viewport:c,l10n:d}){F(this,ki);F(this,pc);F(this,Mh,!1);F(this,uo,null);F(this,Ra,null);F(this,cr,null);F(this,Ts,new Map);F(this,xa,!1);F(this,Ih,!1);F(this,kh,!1);F(this,Bi,null);F(this,dr,null);F(this,Te);const h=[...g(cn,Ea).values()];if(!cn._initialized){cn._initialized=!0;for(const u of h)u.initialize(d,t)}t.registerEditorTypes(h),y(this,Te,t),this.pageIndex=i,this.div=s,y(this,pc,o),y(this,uo,r),this.viewport=c,y(this,Bi,l),this.drawLayer=a,this._structTree=n,g(this,Te).addLayer(this)}get isEmpty(){return g(this,Ts).size===0}get isInvisible(){return this.isEmpty&&g(this,Te).getMode()===ze.NONE}updateToolbar(t){g(this,Te).updateToolbar(t)}updateMode(t=g(this,Te).getMode()){switch(x(this,ki,om).call(this),t){case ze.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ze.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case ze.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:i}=this.div;for(const s of g(cn,Ea).values())i.toggle(`${s._type}Editing`,t===s._editorType);this.div.hidden=!1}hasTextLayer(t){var i;return t===((i=g(this,Bi))==null?void 0:i.div)}addInkEditorIfNeeded(t){if(g(this,Te).getMode()!==ze.INK)return;if(!t){for(const s of g(this,Ts).values())if(s.isEmpty()){s.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(t){g(this,Te).setEditingState(t)}addCommands(t){g(this,Te).addCommands(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var i;(i=g(this,uo))==null||i.div.classList.toggle("disabled",!t)}async enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const s of g(this,Ts).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(g(this,Te).removeChangedExistingAnnotation(s),t.add(s.annotationElementId));if(!g(this,uo))return;const i=g(this,uo).getEditableAnnotations();for(const s of i){if(s.hide(),g(this,Te).isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const n=await this.deserialize(s);n&&(this.addOrRebuild(n),n.enableEditing())}}disable(){var n;y(this,kh,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,i=new Map;for(const o of g(this,Ts).values())if(o.disableEditing(),!!o.annotationElementId){if(o.serialize()!==null){t.set(o.annotationElementId,o);continue}else i.set(o.annotationElementId,o);(n=this.getEditableAnnotation(o.annotationElementId))==null||n.show(),o.remove()}if(g(this,uo)){const o=g(this,uo).getEditableAnnotations();for(const r of o){const{id:a}=r.data;if(g(this,Te).isDeletedAnnotationElement(a))continue;let l=i.get(a);if(l){l.resetAnnotationElement(r),l.show(!1),r.show();continue}l=t.get(a),l&&(g(this,Te).addChangedExistingAnnotation(l),l.renderAnnotationElement(r)&&l.show(!1)),r.show()}}x(this,ki,om).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const o of g(cn,Ea).values())s.remove(`${o._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),y(this,kh,!1)}getEditableAnnotation(t){var i;return((i=g(this,uo))==null?void 0:i.getEditableAnnotation(t))||null}setActiveEditor(t){g(this,Te).getActive()!==t&&g(this,Te).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=g(this,Bi))!=null&&t.div&&!g(this,dr)){y(this,dr,new AbortController);const i=g(this,Te).combinedSignal(g(this,dr));g(this,Bi).div.addEventListener("pointerdown",x(this,ki,sP).bind(this),{signal:i}),g(this,Bi).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=g(this,Bi))!=null&&t.div&&g(this,dr)&&(g(this,dr).abort(),y(this,dr,null),g(this,Bi).div.classList.remove("highlighting"))}enableClick(){if(g(this,Ra))return;y(this,Ra,new AbortController);const t=g(this,Te).combinedSignal(g(this,Ra));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:t})}disableClick(){var t;(t=g(this,Ra))==null||t.abort(),y(this,Ra,null)}attach(t){g(this,Ts).set(t.id,t);const{annotationElementId:i}=t;i&&g(this,Te).isDeletedAnnotationElement(i)&&g(this,Te).removeDeletedAnnotationElement(t)}detach(t){var i;g(this,Ts).delete(t.id),(i=g(this,pc))==null||i.removePointerInTextLayer(t.contentDiv),!g(this,kh)&&t.annotationElementId&&g(this,Te).addDeletedAnnotationElement(t)}remove(t){this.detach(t),g(this,Te).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,g(this,Ih)||this.addInkEditorIfNeeded(!1)}changeParent(t){var i;t.parent!==this&&(t.parent&&t.annotationElementId&&(g(this,Te).addDeletedAnnotationElement(t.annotationElementId),pt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(i=t.parent)==null||i.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),g(this,Te).addEditor(t),this.attach(t),!t.isAttachedToDOM){const i=t.render();this.div.append(i),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),g(this,Te).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var s;if(!t.isAttachedToDOM)return;const{activeElement:i}=document;t.div.contains(i)&&!g(this,cr)&&(t._focusEventsAllowed=!1,y(this,cr,setTimeout(()=>{y(this,cr,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:g(this,Te)._signal}),i.focus())},0))),t._structTreeParentId=(s=g(this,pc))==null?void 0:s.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const i=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:i,undo:s,mustExec:!1})}getNextId(){return g(this,Te).getId()}combinedSignal(t){return g(this,Te).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=g(this,ki,kb))==null?void 0:t.canCreateNewEmptyEditor()}pasteEditor(t,i){g(this,Te).updateToolbar(t),g(this,Te).updateMode(t);const{offsetX:s,offsetY:n}=x(this,ki,Lb).call(this),o=this.getNextId(),r=x(this,ki,_b).call(this,{parent:this,id:o,x:s,y:n,uiManager:g(this,Te),isCentered:!0,...i});r&&this.add(r)}async deserialize(t){var i;return await((i=g(cn,Ea).get(t.annotationType??t.annotationEditorType))==null?void 0:i.deserialize(t,this,g(this,Te)))||null}createAndAddNewEditor(t,i,s={}){const n=this.getNextId(),o=x(this,ki,_b).call(this,{parent:this,id:n,x:t.offsetX,y:t.offsetY,uiManager:g(this,Te),isCentered:i,...s});return o&&this.add(o),o}addNewEditor(){this.createAndAddNewEditor(x(this,ki,Lb).call(this),!0)}setSelected(t){g(this,Te).setSelected(t)}toggleSelected(t){g(this,Te).toggleSelected(t)}unselect(t){g(this,Te).unselect(t)}pointerup(t){const{isMac:i}=es.platform;if(!(t.button!==0||t.ctrlKey&&i)&&t.target===this.div&&g(this,xa)){if(y(this,xa,!1),!g(this,Mh)){y(this,Mh,!0);return}if(g(this,Te).getMode()===ze.STAMP){g(this,Te).unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(g(this,Te).getMode()===ze.HIGHLIGHT&&this.enableTextSelection(),g(this,xa)){y(this,xa,!1);return}const{isMac:i}=es.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div)return;y(this,xa,!0);const s=g(this,Te).getActive();y(this,Mh,!s||s.isEmpty())}findNewParent(t,i,s){const n=g(this,Te).findParent(i,s);return n===null||n===this?!1:(n.changeParent(t),!0)}destroy(){var t,i;((t=g(this,Te).getActive())==null?void 0:t.parent)===this&&(g(this,Te).commitOrRemove(),g(this,Te).setActiveEditor(null)),g(this,cr)&&(clearTimeout(g(this,cr)),y(this,cr,null));for(const s of g(this,Ts).values())(i=g(this,pc))==null||i.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,g(this,Ts).clear(),g(this,Te).removeLayer(this)}render({viewport:t}){this.viewport=t,Pc(this.div,t);for(const i of g(this,Te).getEditors(this.pageIndex))this.add(i),i.rebuild();this.updateMode()}update({viewport:t}){g(this,Te).commitOrRemove(),x(this,ki,om).call(this);const i=this.viewport.rotation,s=t.rotation;if(this.viewport=t,Pc(this.div,{rotation:s}),i!==s)for(const n of g(this,Ts).values())n.rotate(s);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:t,pageHeight:i}=this.viewport.rawDims;return[t,i]}get scale(){return g(this,Te).viewParameters.realScale}};pc=new WeakMap,Mh=new WeakMap,uo=new WeakMap,Ra=new WeakMap,cr=new WeakMap,Ts=new WeakMap,xa=new WeakMap,Ih=new WeakMap,kh=new WeakMap,Bi=new WeakMap,dr=new WeakMap,Te=new WeakMap,Ea=new WeakMap,ki=new WeakSet,sP=function(t){g(this,Te).unselectAll();const{target:i}=t;if(i===g(this,Bi).div||(i.getAttribute("role")==="img"||i.classList.contains("endOfContent"))&&g(this,Bi).div.contains(i)){const{isMac:s}=es.platform;if(t.button!==0||t.ctrlKey&&s)return;g(this,Te).showAllEditors("highlight",!0,!0),g(this,Bi).div.classList.add("free"),this.toggleDrawing(),Tm.startHighlighting(this,g(this,Te).direction==="ltr",{target:g(this,Bi).div,x:t.x,y:t.y}),g(this,Bi).div.addEventListener("pointerup",()=>{g(this,Bi).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:g(this,Te)._signal}),t.preventDefault()}},kb=function(){return g(cn,Ea).get(g(this,Te).getMode())},_b=function(t){const i=g(this,ki,kb);return i?new i.prototype.constructor(t):null},Lb=function(){const{x:t,y:i,width:s,height:n}=this.div.getBoundingClientRect(),o=Math.max(0,t),r=Math.max(0,i),a=Math.min(window.innerWidth,t+s),l=Math.min(window.innerHeight,i+n),c=(o+a)/2-t,d=(r+l)/2-i,[h,u]=this.viewport.rotation%180===0?[c,d]:[d,c];return{offsetX:h,offsetY:u}},om=function(){y(this,Ih,!0);for(const t of g(this,Ts).values())t.isEmpty()&&t.remove();y(this,Ih,!1)},Pe(cn,"_initialized",!1),F(cn,Ea,new Map([hb,bb,Tb,Tm].map(t=>[t._editorType,t])));let Ib=cn;var go,Of,Xt,hr,Nf,Nb,Nc,Hb,nP;const yi=class yi{constructor({pageIndex:t}){F(this,Nc);F(this,go,null);F(this,Of,0);F(this,Xt,new Map);F(this,hr,new Map);this.pageIndex=t}setParent(t){if(!g(this,go)){y(this,go,t);return}if(g(this,go)!==t){if(g(this,Xt).size>0)for(const i of g(this,Xt).values())i.remove(),t.append(i);y(this,go,t)}}static get _svgFactory(){return Qe(this,"_svgFactory",new tS)}draw(t,i,s,n=!1){const o=Ki(this,Of)._++,r=x(this,Nc,Hb).call(this,t.box);r.classList.add(...t.classNamesForDrawing);const a=yi._svgFactory.createElement("defs");r.append(a);const l=yi._svgFactory.createElement("path");a.append(l);const c=`path_p${this.pageIndex}_${o}`;l.setAttribute("id",c),l.setAttribute("d",t.toSVGPath()),n&&g(this,hr).set(o,l);const d=x(this,Nc,nP).call(this,a,c),h=yi._svgFactory.createElement("use");return r.append(h),r.setAttribute("fill",i),r.setAttribute("fill-opacity",s),h.setAttribute("href",`#${c}`),g(this,Xt).set(o,r),{id:o,clipPathId:`url(#${d})`}}drawOutline(t){const i=Ki(this,Of)._++,s=x(this,Nc,Hb).call(this,t.box);s.classList.add(...t.classNamesForOutlining);const n=yi._svgFactory.createElement("defs");s.append(n);const o=yi._svgFactory.createElement("path");n.append(o);const r=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",r),o.setAttribute("d",t.toSVGPath()),o.setAttribute("vector-effect","non-scaling-stroke");let a;if(t.mustRemoveSelfIntersections){const d=yi._svgFactory.createElement("mask");n.append(d),a=`mask_p${this.pageIndex}_${i}`,d.setAttribute("id",a),d.setAttribute("maskUnits","objectBoundingBox");const h=yi._svgFactory.createElement("rect");d.append(h),h.setAttribute("width","1"),h.setAttribute("height","1"),h.setAttribute("fill","white");const u=yi._svgFactory.createElement("use");d.append(u),u.setAttribute("href",`#${r}`),u.setAttribute("stroke","none"),u.setAttribute("fill","black"),u.setAttribute("fill-rule","nonzero"),u.classList.add("mask")}const l=yi._svgFactory.createElement("use");s.append(l),l.setAttribute("href",`#${r}`),a&&l.setAttribute("mask",`url(#${a})`);const c=l.cloneNode();return s.append(c),l.classList.add("mainOutline"),c.classList.add("secondaryOutline"),g(this,Xt).set(i,s),i}finalizeLine(t,i){const s=g(this,hr).get(t);g(this,hr).delete(t),this.updateBox(t,i.box),s.setAttribute("d",i.toSVGPath())}updateLine(t,i){g(this,Xt).get(t).firstChild.firstChild.setAttribute("d",i.toSVGPath())}updatePath(t,i){g(this,hr).get(t).setAttribute("d",i.toSVGPath())}updateBox(t,i){var s;x(s=yi,Nf,Nb).call(s,g(this,Xt).get(t),i)}show(t,i){g(this,Xt).get(t).classList.toggle("hidden",!i)}rotate(t,i){g(this,Xt).get(t).setAttribute("data-main-rotation",i)}changeColor(t,i){g(this,Xt).get(t).setAttribute("fill",i)}changeOpacity(t,i){g(this,Xt).get(t).setAttribute("fill-opacity",i)}addClass(t,i){g(this,Xt).get(t).classList.add(i)}removeClass(t,i){g(this,Xt).get(t).classList.remove(i)}getSVGRoot(t){return g(this,Xt).get(t)}remove(t){g(this,hr).delete(t),g(this,go)!==null&&(g(this,Xt).get(t).remove(),g(this,Xt).delete(t))}destroy(){y(this,go,null);for(const t of g(this,Xt).values())t.remove();g(this,Xt).clear(),g(this,hr).clear()}};go=new WeakMap,Of=new WeakMap,Xt=new WeakMap,hr=new WeakMap,Nf=new WeakSet,Nb=function(t,{x:i=0,y:s=0,width:n=1,height:o=1}={}){const{style:r}=t;r.top=`${100*s}%`,r.left=`${100*i}%`,r.width=`${100*n}%`,r.height=`${100*o}%`},Nc=new WeakSet,Hb=function(t){var s;const i=yi._svgFactory.create(1,1,!0);return g(this,go).append(i),i.setAttribute("aria-hidden",!0),x(s=yi,Nf,Nb).call(s,i,t),i},nP=function(t,i){const s=yi._svgFactory.createElement("clipPath");t.append(s);const n=`clip_${i}`;s.setAttribute("id",n),s.setAttribute("clipPathUnits","objectBoundingBox");const o=yi._svgFactory.createElement("use");return s.append(o),o.setAttribute("href",`#${i}`),o.classList.add("clip"),n},F(yi,Nf);let Ob=yi;var OO=Ge.AbortException,NO=Ge.AnnotationEditorLayer,HO=Ge.AnnotationEditorParamsType,GO=Ge.AnnotationEditorType,BO=Ge.AnnotationEditorUIManager,VO=Ge.AnnotationLayer,zO=Ge.AnnotationMode,WO=Ge.ColorPicker,$O=Ge.DOMSVGFactory,UO=Ge.DrawLayer,jO=Ge.FeatureTest,KO=Ge.GlobalWorkerOptions,qO=Ge.ImageKind,YO=Ge.InvalidPDFException,XO=Ge.MissingPDFException,QO=Ge.OPS,JO=Ge.OutputScale,ZO=Ge.PDFDataRangeTransport,eN=Ge.PDFDateString,tN=Ge.PDFWorker,iN=Ge.PasswordResponses,sN=Ge.PermissionFlag,nN=Ge.PixelsPerInch,oN=Ge.RenderingCancelledException,rN=Ge.TextLayer,aN=Ge.UnexpectedResponseException,lN=Ge.Util,cN=Ge.VerbosityLevel,dN=Ge.XfaLayer,hN=Ge.build,uN=Ge.createValidAbsoluteUrl,gN=Ge.fetchData,fN=Ge.getDocument,pN=Ge.getFilenameFromUrl,mN=Ge.getPdfFilenameFromUrl,vN=Ge.getXfaPageViewport,CN=Ge.isDataScheme,wN=Ge.isPdfFile,bN=Ge.noContextMenu,yN=Ge.normalizeUnicode,SN=Ge.setLayerDimensions,RN=Ge.shadow,xN=Ge.version;const oP=Object.freeze(Object.defineProperty({__proto__:null,AbortException:OO,AnnotationEditorLayer:NO,AnnotationEditorParamsType:HO,AnnotationEditorType:GO,AnnotationEditorUIManager:BO,AnnotationLayer:VO,AnnotationMode:zO,ColorPicker:WO,DOMSVGFactory:$O,DrawLayer:UO,FeatureTest:jO,GlobalWorkerOptions:KO,ImageKind:qO,InvalidPDFException:YO,MissingPDFException:XO,OPS:QO,OutputScale:JO,PDFDataRangeTransport:ZO,PDFDateString:eN,PDFWorker:tN,PasswordResponses:iN,PermissionFlag:sN,PixelsPerInch:nN,RenderingCancelledException:oN,TextLayer:rN,UnexpectedResponseException:aN,Util:lN,VerbosityLevel:cN,XfaLayer:dN,build:hN,createValidAbsoluteUrl:uN,fetchData:gN,getDocument:fN,getFilenameFromUrl:pN,getPdfFilenameFromUrl:mN,getXfaPageViewport:vN,isDataScheme:CN,isPdfFile:wN,noContextMenu:bN,normalizeUnicode:yN,setLayerDimensions:SN,shadow:RN,version:xN},Symbol.toStringTag,{value:"Module"}));var pC=ME(()=>oP),EN=J(`<div class="relative w-[280px] max-w-full rounded-xl overflow-hidden border border-gray-200 dark:border-gray-700 bg-gray-50
  dark:bg-gray-900 cursor-pointer"><div class="absolute top-1 right-1 z-10
           flex gap-1 text-[11px]
           bg-white/80 dark:bg-gray-800/80
           backdrop-blur
           rounded-md shadow px-1.5 py-1"><a target="_blank" title="Má» PDF">ð</a> <button title="Táº£i xuá»ng">â¬</button></div> <canvas class="block w-full h-auto bg-white"></canvas> <div class="px-2 py-1 text-[10px] text-gray-500 truncate">Nháº¥n Äá» xem toÃ n mÃ n hÃ¬nh</div></div>`);function AN(e,t){ot(t,!1);let i=ge(t,"url",8),s=ge(t,"onOpen",8),n=re(),o=re(),r,a=1;const l=window.innerWidth<768;pC(pC().GlobalWorkerOptions.workerSrc=new URL(""+new URL("pdf.worker.min-GB3t0DcA.mjs",import.meta.url).href,import.meta.url).toString());async function c(){r||(r=await pC().getDocument(i()).promise);const v=await r.getPage(a),C=v.getViewport({scale:1}),w=R(o).clientWidth;let S;l?S=w/C.width:S=1;const b=v.getViewport({scale:S}),E=R(n).getContext("2d");Ji(n,R(n).width=b.width),Ji(n,R(n).height=b.height),await v.render({canvasContext:E,viewport:b}).promise}Ci(c);async function d(v){v.stopPropagation();const w=await(await fetch(i())).blob(),S=document.createElement("a");S.href=URL.createObjectURL(w),S.download=i().split("/").pop()||"file.pdf",S.click(),URL.revokeObjectURL(S.href)}lt();var h=EN(),u=I(h),f=I(u),p=L(f,2),m=L(u,2);ji(m,v=>G(n,v),()=>R(n)),ji(h,v=>G(o,v),()=>R(o)),Me(()=>fi(f,"href",i())),Y("click",p,d),Y("click",u,Gh(function(v){Pv.call(this,t,v)})),Y("click",h,()=>{var v;return(v=s())==null?void 0:v(i())}),O(e,h),rt()}var mC=ME(()=>oP),FN=J(`<div class="fixed inset-0 z-50
         bg-black/60 backdrop-blur-sm
         flex items-center justify-center"><div class="relative w-full h-full md:w-[90vw] md:h-[90vh]
           bg-white dark:bg-gray-900
           rounded-none md:rounded-xl
           flex flex-col"><div class="flex items-center justify-between
             px-3 py-2 border-b dark:border-gray-700"><span class="text-sm font-medium truncate"> </span> <div class="flex gap-2 text-sm"><button>â</button> <button>â</button> <a download="" title="Download">â¬</a> <button>â</button></div></div> <div class="flex-1 overflow-auto bg-gray-100 dark:bg-gray-800"><div class="flex justify-center p-4"><canvas class="bg-white shadow"></canvas></div></div></div></div>`);function PN(e,t){ot(t,!1);let i=ge(t,"url",8),s=ge(t,"onClose",8),n=re(),o=1,r=re(1.3),a;mC(mC().GlobalWorkerOptions.workerSrc=new URL(""+new URL("pdf.worker.min-GB3t0DcA.mjs",import.meta.url).href,import.meta.url).toString());async function l(){a||(a=await mC().getDocument(i()).promise);const T=await a.getPage(o),D=T.getViewport({scale:R(r)}),N=R(n).getContext("2d");Ji(n,R(n).width=D.width),Ji(n,R(n).height=D.height),await T.render({canvasContext:N,viewport:D}).promise}function c(){var T;(T=s())==null||T()}function d(T){T.key==="Escape"&&c()}Ci(()=>{document.body.style.overflow="hidden",window.addEventListener("keydown",d),l()}),_r(()=>{document.body.style.overflow="",window.removeEventListener("keydown",d)}),lt();var h=FN(),u=I(h),f=I(u),p=I(f),m=I(p),v=L(p,2),C=I(v),w=L(C,2),S=L(w,2),b=L(S,2),E=L(f,2),A=I(E),P=I(A);ji(P,T=>G(n,T),()=>R(n)),Me(T=>{Be(m,T),fi(S,"href",i())},[()=>(Re(i()),ie(()=>i().split("/").pop()))]),Y("click",C,()=>{G(r,R(r)+.1),l()}),Y("click",w,()=>{G(r,R(r)-.1),l()}),Y("click",b,c),Y("click",h,qI(c)),O(e,h),rt()}var TN=J('<p class="text-[10px] opacity-60 mb-1 svelte-13g6337"> </p>'),DN=J(`<div class="mb-1 px-3 py-2
           text-[11px]
           rounded-md
           border-l-4 border-blue-500
           bg-gray-100 dark:bg-gray-700/70
           text-gray-700 dark:text-gray-200 svelte-13g6337"><div class="font-semibold leading-tight text-gray-800 dark:text-gray-100 svelte-13g6337"> </div> <div class="mt-[2px]
             leading-snug
             text-gray-600 dark:text-gray-300
             line-clamp-2 svelte-13g6337"> </div></div>`),MN=J('<p class="whitespace-pre-line leading-snug svelte-13g6337"> </p>'),IN=J('<video class="rounded-md mt-1 max-h-64 w-full bg-black svelte-13g6337" controls playsinline="" webkit-playsinline="" preload="metadata"></video>',2),kN=J('<img class="rounded-md mt-1 max-h-64 cursor-pointer svelte-13g6337"/>'),_N=J(`<a target="_blank" class="flex items-center gap-2 mt-2 px-3 py-2 rounded-md
             bg-gray-100 dark:bg-gray-700 text-sm svelte-13g6337"> </a>`),LN=J('<img class="rounded-md cursor-pointer object-cover aspect-square svelte-13g6337"/>'),ON=J(`<div class="flex items-center justify-center
               bg-black/60 text-white text-sm rounded-md svelte-13g6337"> </div>`),NN=J('<div class="grid grid-cols-3 gap-1 mt-1 svelte-13g6337"><!> <!></div>'),HN=J('<span class="flex gap-1 px-1 rounded svelte-13g6337"><span class="svelte-13g6337"> </span> <span class="text-[10px] text-gray-600 dark:text-gray-300 font-semibold svelte-13g6337"> </span></span>'),GN=J("<div></div>"),BN=J('<button class="menu-item text-red-500 svelte-13g6337">ðï¸ XoÃ¡</button>'),VN=J(`<div class="context-menu fixed z-50
           w-[180px]
           bg-white dark:bg-gray-800
           border dark:border-gray-700 dark:text-white
           rounded-lg shadow-xl text-sm svelte-13g6337"><button class="menu-item svelte-13g6337">ð¬ Tráº£ lá»i</button> <button class="menu-item svelte-13g6337">ð Sao chÃ©p</button> <button class="menu-item svelte-13g6337">ð Reaction</button> <!></div>`),zN=J('<div><div><!> <!> <!> <!> <!> <p class="text-[9px] text-right opacity-60 mt-1 svelte-13g6337"> </p> <!></div> <div class="opacity-0 group-hover:opacity-100 ml-1 self-end transition svelte-13g6337"><!></div></div> <!> <!> <!>',1);function rP(e,t){ot(t,!1);const i=re(),s=re(),n=re();let o=re(!1),r=re(null),a=ge(t,"msg",8),l=ge(t,"myId",8),c=ge(t,"previousMsg",8,null),d=re(),h=re(),u=null;const f=450;let p=re(null),m=re({x:0,y:0}),v=re(!1),C=re([]),w=re(0);const S=a().from===l(),b=c()&&c().from===a().from;function E(k){const z="https://render-server-ezuf.onrender.com";return k&&(k.startsWith("http")?k.replace(/^http:\/\/localhost:\d+/,z):`${z}/${k.replace(/^\/+/,"")}`)}function A(k){k.stopPropagation(),P(a().reply_to.id)}Ci(()=>{var k,z,K,me;if(R(d))return(k=R(d))==null||k.addEventListener("touchstart",X,{passive:!0}),(z=R(d))==null||z.addEventListener("touchmove",pe,{passive:!0}),(K=R(d))==null||K.addEventListener("touchend",U,{passive:!0}),R(h)&&((me=R(h))==null||me.addEventListener("touchstart",A,{passive:!0})),()=>{var he,te,ue,De;(he=R(d))==null||he.removeEventListener("touchstart",X),(te=R(d))==null||te.removeEventListener("touchmove",pe),(ue=R(d))==null||ue.removeEventListener("touchend",U),(De=R(h))==null||De.removeEventListener("touchstart",A)}});async function P(k){if(!k)return;let z=document.getElementById(`msg-${k}`);if(z){T(z);return}let K=0;for(;!z&&K<1e3;){K++;const me=si(ka);if(!me.length)break;const he=me[0];tg(si(Tn),{firstMsg:he}),await Fc(),await new Promise(te=>setTimeout(te,80)),z=document.getElementById(`msg-${k}`)}z?T(z):console.warn("â KhÃ´ng tÃ¬m tháº¥y message gá»c:",k)}function T(k){k.scrollIntoView({behavior:"smooth",block:"center"}),k.classList.add("flash-highlight"),setTimeout(()=>{k.classList.remove("flash-highlight")},1200)}async function D(k){try{if(!(k!=null&&k.message))return;await navigator.clipboard.writeText(k.message),console.log("Copied message:",k.message)}catch(z){console.error("Copy failed",z)}finally{Ee()}}function N(k){window.dispatchEvent(new CustomEvent("open-reaction",{detail:{messageId:k.id}})),Ee()}const M=k=>/\.pdf$/i.test(k),_=k=>/\.(mp4|webm|mov|ogg)$/i.test(k),W=k=>!_(k)&&/\.(jpg|jpeg|png|gif|webp)$/i.test(k);function $(k=[]){const z={};for(const K of k)z[K]=(z[K]||0)+1;return Object.entries(z).sort((K,me)=>me[1]-K[1])}function B(k,z){const me=S?180:150,he=8,te=window.innerWidth,ue=window.innerHeight;k+180>te&&(k=te-180-he),z+me>ue&&(z=ue-me-he),k<he&&(k=he),z<he&&(z=he),G(p,a()),G(m,{x:k,y:z})}function q(k){k.preventDefault(),B(k.clientX,k.clientY)}function X(k){if(k.touches.length!==1)return;const z=k.touches[0];u=setTimeout(()=>{B(z.clientX,z.clientY)},f)}function U(){clearTimeout(u),u=null}function pe(){clearTimeout(u),u=null}function Ee(){G(p,null)}function Ce(k){dn.set({id:k.id,senderId:k.from,content:k.message,type:k.type}),Ee()}function le(k){k.target.closest(".context-menu")||Ee()}function ee(k){k.key==="Escape"&&Ee()}window.addEventListener("click",le),window.addEventListener("keydown",ee),Ti(()=>Re(a()),()=>{var k;G(i,a().type==="media"?E(((k=a().media)==null?void 0:k.url)||a().message):null)}),Ti(()=>(Re(a()),R(i)),()=>{var k,z;G(s,a().type==="media"?{url:R(i),name:((k=a().media)==null?void 0:k.name)||((z=R(i))==null?void 0:z.split("/").pop())}:null)}),Ti(()=>Re(a()),()=>{G(n,(()=>{if(a().type!=="album"||!a().message)return null;try{const k=typeof a().message=="string"?JSON.parse(a().message):a().message;return{urls:(k.urls||[]).map(E),fullUrls:(k.fullUrls||k.urls||[]).map(E)}}catch{return console.warn("â Invalid album message:",a().message),null}})())}),Po(),lt();var ve=zN(),Oe=ce(ve),Z=I(Oe),we=I(Z);{var Ne=k=>{var z=TN(),K=I(z);Me(()=>Be(K,(Re(a()),ie(()=>S?"Báº¡n":a().fromName||"User "+a().from)))),O(k,z)};ye(we,k=>{b||k(Ne)})}var Se=L(we,2);{var tt=k=>{var z=DN(),K=I(z),me=I(K),he=L(K,2),te=I(he);ji(z,ue=>G(h,ue),()=>R(h)),Me(()=>{Be(me,(Re(a()),Re(l()),ie(()=>a().reply_to.sender_id===l()?"Báº¡n":a().fromName||"User "+a().from))),Be(te,(Re(a()),ie(()=>a().reply_to.content)))}),Y("click",z,Gh(()=>P(a().reply_to.id))),O(k,z)};ye(Se,k=>{Re(a()),ie(()=>{var z,K;return(K=(z=a())==null?void 0:z.reply_to)==null?void 0:K.id})&&k(tt)})}var Mt=L(Se,2);{var St=k=>{var z=MN(),K=I(z);Me(()=>Be(K,(Re(a()),ie(()=>a().message)))),O(k,z)};ye(Mt,k=>{Re(a()),ie(()=>a().type==="text")&&k(St)})}var qt=L(Mt,2);{var Ht=k=>{var z=xe(),K=ce(z);{var me=te=>{var ue=IN();ue.muted=!0,Me(()=>fi(ue,"src",(R(s),ie(()=>R(s).url)))),O(te,ue)},he=te=>{var ue=xe(),De=ce(ue);{var Ke=Vt=>{AN(Vt,{get url(){return R(s),ie(()=>R(s).url)},onOpen:nt=>{G(r,nt),G(o,!0)}})},ai=Vt=>{var nt=xe(),Hs=ce(nt);{var Yc=Mo=>{var Za=kN();Me(()=>fi(Za,"src",(R(s),ie(()=>R(s).url)))),Y("click",Za,()=>{G(C,[R(s).url]),G(v,!0)}),O(Mo,Za)},Xv=Mo=>{var Za=_N(),lM=I(Za);Me(()=>{fi(Za,"href",(R(s),ie(()=>R(s).url))),Be(lM,`ð ${R(s),ie(()=>R(s).name)??""}`)}),O(Mo,Za)};ye(Hs,Mo=>{R(s),ie(()=>W(R(s).url))?Mo(Yc):Mo(Xv,!1)},!0)}O(Vt,nt)};ye(De,Vt=>{R(s),ie(()=>M(R(s).url))?Vt(Ke):Vt(ai,!1)},!0)}O(te,ue)};ye(K,te=>{R(s),ie(()=>_(R(s).url))?te(me):te(he,!1)})}O(k,z)};ye(qt,k=>{Re(a()),ie(()=>a().type==="media")&&k(Ht)})}var wi=L(qt,2);{var Ie=k=>{var z=NN(),K=I(z);Ai(K,1,()=>(R(n),ie(()=>R(n).urls.slice(0,6))),gs,(te,ue,De)=>{var Ke=LN();Me(()=>fi(Ke,"src",R(ue))),Y("click",Ke,()=>{G(C,R(n).fullUrls),G(w,De),G(v,!0)}),O(te,Ke)});var me=L(K,2);{var he=te=>{var ue=ON(),De=I(ue);Me(()=>Be(De,`+${R(n),ie(()=>R(n).urls.length-6)??""}`)),O(te,ue)};ye(me,te=>{R(n),ie(()=>R(n).urls.length>6)&&te(he)})}O(k,z)};ye(wi,k=>{Re(a()),R(n),ie(()=>a().type==="album"&&R(n))&&k(Ie)})}var Rt=L(wi,2),Le=I(Rt),it=L(Rt,2);{var Cs=k=>{var z=GN();Ai(z,5,()=>(Re(a()),ie(()=>$(a().reactions))),gs,(K,me)=>{var he=al(()=>Dx(R(me),2));let te=()=>R(he)[0],ue=()=>R(he)[1];var De=HN(),Ke=I(De),ai=I(Ke),Vt=L(Ke,2),nt=I(Vt);Me(()=>{Be(ai,te()),Be(nt,ue())}),O(K,De)}),Me(()=>$i(z,1,`absolute -bottom-2
          ${S?"right-2":"left-2"}
          flex gap-1 px-1.5 py-[2px]
          rounded-full shadow-md
          bg-white dark:bg-gray-800
          border dark:border-gray-700
          text-[11px] z-10`,"svelte-13g6337")),O(k,z)};ye(it,k=>{Re(a()),ie(()=>{var z;return(z=a().reactions)==null?void 0:z.length})&&k(Cs)})}ji(Z,k=>G(d,k),()=>R(d));var Nn=L(Z,2),oe=I(Nn);L1(oe,{get messageId(){return Re(a()),ie(()=>a().id)},get fromMe(){return S},onSelect:({messageId:k,reaction:z})=>{ul({type:"reaction",messageId:k,reaction:z})}});var _e=L(Oe,2);{var st=k=>{var z=VN(),K=I(z),me=L(K,2),he=L(me,2),te=L(he,2);{var ue=De=>{var Ke=BN();O(De,Ke)};ye(te,De=>{R(p),Re(l()),ie(()=>R(p).from===l())&&De(ue)})}Me(()=>ja(z,`top:${R(m),ie(()=>R(m).y)??""}px; left:${R(m),ie(()=>R(m).x)??""}px`)),Y("click",K,()=>Ce(R(p))),Y("click",me,()=>D(R(p))),Y("click",he,()=>N(R(p))),Y("click",z,Gh(function(De){Pv.call(this,t,De)})),O(k,z)};ye(_e,k=>{R(p)&&k(st)})}var Bt=L(_e,2);{var Hn=k=>{T1(k,{get images(){return R(C)},index:0,onClose:()=>G(v,!1)})};ye(Bt,k=>{R(v)&&k(Hn)})}var Gn=L(Bt,2);{var Q=k=>{PN(k,{get url(){return R(r)},onClose:()=>G(o,!1)})};ye(Gn,k=>{R(o)&&k(Q)})}Me(k=>{$i(Oe,1,`w-full flex ${S?"justify-end":"justify-start"} select-none group`,"svelte-13g6337"),fi(Z,"id",(Re(a()),ie(()=>"msg-"+a().id))),$i(Z,1,`relative max-w-[68%] px-3 py-2 pb-4 text-sm shadow-md rounded-2xl
    ${S?"bg-gradient-to-br from-blue-200 to-blue-300 text-gray-800 rounded-br-md":"bg-white dark:bg-gray-800  text-gray-800 dark:text-gray-200   border border-gray-200 dark:border-gray-700  rounded-bl-md"}
    ${b?"mt-[2px]":"mt-2"}`,"svelte-13g6337"),Be(Le,k)},[()=>(Re(_0),Re(a()),ie(()=>_0(a().time||a().created_at)))]),Y("contextmenu",Z,q),O(e,ve),rt()}var WN=J('<span class="text-[11px] text-gray-400 whitespace-nowrap"> </span>'),$N=J("<div></div>"),UN=J('<span class="absolute right-2 bottom-2 text-[10px] px-1.5 py-0.5 rounded bg-blue-100 text-blue-600">GROUP</span>'),jN=J(`<div><div class="w-10 h-10 rounded-full flex items-center justify-center
      bg-gray-200 text-gray-600 font-semibold text-lg uppercase"> </div> <div class="flex-1 min-w-0"><div class="flex items-center justify-between"><span class="font-medium text-gray-800 truncate"> </span> <!></div> <div class="text-[12px] text-gray-500 truncate mt-0.5"> </div></div> <!> <!></div>`);function aP(e,t){ot(t,!1);const i=re();let s=ge(t,"conversation",8),n=ge(t,"selectedId",8),o=ge(t,"onSelect",8,()=>{});function r(A){return A?new Date(A).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""}Ti(()=>(Re(n()),Re(s())),()=>{G(i,n()===s().conversationId)}),Po(),lt();var a=jN(),l=I(a),c=I(l),d=L(l,2),h=I(d),u=I(h),f=I(u),p=L(u,2);{var m=A=>{var P=WN(),T=I(P);Me(D=>Be(T,D),[()=>(Re(s()),ie(()=>r(s().lastMessageAt)))]),O(A,P)};ye(p,A=>{Re(s()),ie(()=>s().lastMessageAt)&&A(m)})}var v=L(h,2),C=I(v),w=L(d,2);{var S=A=>{var P=$N();Me(()=>$i(P,1,`
        w-3 h-3 rounded-full absolute left-2 bottom-2
        ${Re(s()),ie(()=>s().online?"bg-green-500":"bg-gray-300")??""}
      `)),O(A,P)};ye(w,A=>{Re(s()),ie(()=>s().type==="direct")&&A(S)})}var b=L(w,2);{var E=A=>{var P=UN();O(A,P)};ye(b,A=>{Re(s()),ie(()=>s().type==="group")&&A(E)})}Me(A=>{$i(a,1,`p-2 rounded-md mb-1 cursor-pointer transition select-none relative
    flex items-center gap-3 border border-transparent
    hover:bg-blue-50 active:scale-[0.98]
    ${R(i)?"bg-blue-100 border-blue-300 shadow-sm":""}
  `),Be(c,A),Be(f,(Re(s()),ie(()=>s().title))),Be(C,(Re(s()),ie(()=>s().lastMessagePreview||"No messages yet")))},[()=>(Re(s()),ie(()=>{var A,P;return((P=(A=s())==null?void 0:A.title)==null?void 0:P.charAt(0))??"?"}))]),Y("click",a,()=>o()(s())),O(e,a),rt()}var Mc=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,i){const s=t?this.allAsyncListeners:this.allSyncListeners;let n=s.get(e);return!n&&i&&(n=new Set,s.set(e,n)),n}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(e,t,i=!1){this.getListeners(e,i,!0).add(t)}removeEventListener(e,t,i=!1){const s=this.getListeners(e,i,!1);s&&(s.delete(t),s.size===0&&(i?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){this.getGlobalListeners(t).add(e)}removeGlobalListener(e,t=!1){this.getGlobalListeners(t).delete(e)}dispatchEvent(e){this.dispatchToListeners(e,!0),this.dispatchToListeners(e,!1),this.firedEvents[e.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){const i=e.type;if(t&&"event"in e){const a=e.event;a instanceof Event&&(e.eventPath=a.composedPath())}const{frameworkOverrides:s}=this,n=a=>{const l=s?()=>s.wrapIncoming(a):a;t?this.dispatchAsync(l):l()},o=this.getListeners(i,t,!1);if(((o==null?void 0:o.size)??0)>0){const a=new Set(o);for(const l of a)o!=null&&o.has(l)&&n(()=>l(e))}const r=this.getGlobalListeners(t);if(r.size>0){const a=new Set(r);for(const l of a)n(()=>l(i,e))}}getGlobalListeners(e){return e?this.globalAsyncListeners:this.globalSyncListeners}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){const t=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(t):t(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[];for(const t of e)t()}};function br(e){return e==null||e===""?null:e}function ae(e){return e!=null&&e!==""}function At(e){return!ae(e)}function Gb(e){return e!=null&&typeof e.toString=="function"?e.toString():null}function rg(e,t){const i=e?JSON.stringify(e):null,s=t?JSON.stringify(t):null;return i===s}function KN(e,t,i=!1){const s=e==null,n=t==null;if(e!=null&&e.toNumber&&(e=e.toNumber()),t!=null&&t.toNumber&&(t=t.toNumber()),s&&n)return 0;if(s)return-1;if(n)return 1;function o(r,a){return r>a?1:r<a?-1:0}if(typeof e!="string"||!i)return o(e,t);try{return e.localeCompare(t)}catch{return o(e,t)}}var qN=/[&<>"']/g,YN={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function tu(e){return(e==null?void 0:e.toString().toString())??null}function Vu(e){var t;return((t=tu(e))==null?void 0:t.replace(qN,i=>YN[i]))??null}function Wn(e){return e.eRootDiv.getRootNode()}function Dt(e){return Wn(e).activeElement}function pi(e){const{gos:t,eRootDiv:i}=e;let s=null;const n=t.get("getDocument");return n&&ae(n)?s=n():i&&(s=i.ownerDocument),s&&ae(s)?s:document}function lP(e){const t=Dt(e);return t===null||t===pi(e).body}function cP(e){return pi(e).defaultView||window}function sS(e){let t=null,i=null;try{t=pi(e).fullscreenElement}catch{}finally{t||(t=Wn(e));const s=t.querySelector("body");s?i=s:t instanceof ShadowRoot?i=t:t instanceof Document?i=t==null?void 0:t.documentElement:i=t}return i}function XN(e){const t=sS(e);return(t==null?void 0:t.clientWidth)??(window.innerWidth||-1)}function QN(e){const t=sS(e);return(t==null?void 0:t.clientHeight)??(window.innerHeight||-1)}function On(e,t,i){i==null||typeof i=="string"&&i==""?dP(e,t):an(e,t,i)}function an(e,t,i){e.setAttribute(hP(t),i.toString())}function dP(e,t){e.removeAttribute(hP(t))}function hP(e){return`aria-${e}`}function Ha(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function JN(e){let t;return e==="asc"?t="ascending":e==="desc"?t="descending":e==="mixed"?t="other":t="none",t}function ZN(e){return e.getAttribute("aria-label")}function zh(e,t){On(e,"label",t)}function ag(e,t){On(e,"labelledby",t)}function uP(e,t){On(e,"live",t)}function eH(e,t){On(e,"atomic",t)}function tH(e,t){On(e,"relevant",t)}function iH(e,t){On(e,"invalid",t)}function sH(e,t){On(e,"disabled",t)}function gP(e,t){On(e,"hidden",t)}function Bb(e,t){an(e,"expanded",t)}function nH(e,t){an(e,"setsize",t)}function oH(e,t){an(e,"posinset",t)}function rH(e,t){an(e,"multiselectable",t)}function aH(e,t){an(e,"rowcount",t)}function Dm(e,t){an(e,"rowindex",t)}function lH(e,t){an(e,"rowspan",t)}function cH(e,t){an(e,"colcount",t)}function fP(e,t){an(e,"colindex",t)}function dH(e,t){an(e,"colspan",t)}function hH(e,t){an(e,"sort",t)}function uH(e){dP(e,"sort")}function pP(e,t){On(e,"selected",t)}function gH(e,t){On(e,"controls",t)}function fH(e,t){gH(e,t.id),ag(t,e.id)}function eR(e,t){On(e,"owns",t)}function Gv(e,t){return t===void 0?e("ariaIndeterminate","indeterminate"):t===!0?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var pH="[tabindex], input, select, button, textarea, [href]",mP="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function zu(e){return!e||!e.matches("input, select, button, textarea")||!e.matches(mP)?!1:To(e)}function xt(e,t,i={}){const{skipAriaHidden:s}=i;e.classList.toggle("ag-hidden",!t),s||gP(e,!t)}function mH(e,t,i={}){const{skipAriaHidden:s}=i;e.classList.toggle("ag-invisible",!t),s||gP(e,!t)}function lg(e,t){const i="disabled",s=t?o=>o.setAttribute(i,""):o=>o.removeAttribute(i);s(e);const n=e.querySelectorAll("input")??[];for(const o of n)s(o)}function wc(e,t,i){let s=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,typeof i=="number"){if(++s>i)break}else if(e===i)break}return!1}function Uc(e){const{height:t,width:i,borderTopWidth:s,borderRightWidth:n,borderBottomWidth:o,borderLeftWidth:r,paddingTop:a,paddingRight:l,paddingBottom:c,paddingLeft:d,marginTop:h,marginRight:u,marginBottom:f,marginLeft:p,boxSizing:m}=window.getComputedStyle(e),v=Number.parseFloat;return{height:v(t||"0"),width:v(i||"0"),borderTopWidth:v(s||"0"),borderRightWidth:v(n||"0"),borderBottomWidth:v(o||"0"),borderLeftWidth:v(r||"0"),paddingTop:v(a||"0"),paddingRight:v(l||"0"),paddingBottom:v(c||"0"),paddingLeft:v(d||"0"),marginTop:v(h||"0"),marginRight:v(u||"0"),marginBottom:v(f||"0"),marginLeft:v(p||"0"),boxSizing:m}}function nS(e){const t=Uc(e);return t.boxSizing==="border-box"?t.height-t.paddingTop-t.paddingBottom-t.borderTopWidth-t.borderBottomWidth:t.height}function cg(e){const t=Uc(e);return t.boxSizing==="border-box"?t.width-t.paddingLeft-t.paddingRight-t.borderLeftWidth-t.borderRightWidth:t.width}function vP(e){const{height:t,marginBottom:i,marginTop:s}=Uc(e);return Math.floor(t+i+s)}function Mm(e){const{width:t,marginLeft:i,marginRight:s}=Uc(e);return Math.floor(t+i+s)}function CP(e){const t=e.getBoundingClientRect(),{borderTopWidth:i,borderLeftWidth:s,borderRightWidth:n,borderBottomWidth:o}=Uc(e);return{top:t.top+(i||0),left:t.left+(s||0),right:t.right+(n||0),bottom:t.bottom+(o||0)}}function Im(e,t){let i=e.scrollLeft;return t&&(i=Math.abs(i)),i}function km(e,t,i){i&&(t*=-1),e.scrollLeft=t}function Mi(e){for(;e!=null&&e.firstChild;)e.firstChild.remove()}function Dn(e){e!=null&&e.parentNode&&e.remove()}function wP(e){return!!e.offsetParent}function To(e){return e.checkVisibility?e.checkVisibility({checkVisibilityCSS:!0}):!(!wP(e)||window.getComputedStyle(e).visibility!=="visible")}function oS(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function bP(e,t,i){i&&i.nextSibling===t||(e.firstChild?i?i.nextSibling?e.insertBefore(t,i.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t):e.appendChild(t))}function yP(e,t){for(let i=0;i<t.length;i++){const s=t[i],n=e.children[i];n!==s&&e.insertBefore(s,n)}}function vH(e){return e.replace(/[A-Z]/g,t=>`-${t.toLocaleLowerCase()}`)}function Yf(e,t){if(t)for(const i of Object.keys(t)){const s=t[i];if(!(i!=null&&i.length)||s==null)continue;const n=vH(i),o=s.toString(),r=o.replace(/\s*!important/g,""),a=r.length!=o.length?"important":void 0;e.style.setProperty(n,r,a)}}function rm(e){return()=>{const t=e();return t?rS(t)||SP(t):!0}}function rS(e){return e.clientWidth<e.scrollWidth}function SP(e){return e.clientHeight<e.scrollHeight}function _m(e,t){t==="flex"?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):yo(e,t)}function yo(e,t){t=aS(t),e.style.width=t,e.style.maxWidth=t,e.style.minWidth=t}function Wu(e,t){t=aS(t),e.style.height=t,e.style.maxHeight=t,e.style.minHeight=t}function aS(e){return typeof e=="number"?`${e}px`:e}function lS(e){return e instanceof Node||e instanceof HTMLElement}function ks(e,t,i){i==null||i===""?e.removeAttribute(t):e.setAttribute(t,i.toString())}function qa(e,t,i){const n=cP(e).ResizeObserver,o=n?new n(i):null;return o==null||o.observe(t),()=>o==null?void 0:o.disconnect()}function Lr(e,t){const i=cP(e);i.requestAnimationFrame?i.requestAnimationFrame(t):i.webkitRequestAnimationFrame?i.webkitRequestAnimationFrame(t):i.setTimeout(t,0)}var RP="data-ref",vC;function tR(){return vC??(vC=document.createTextNode(" ")),vC.cloneNode()}function Xf(e){const{attrs:t,children:i,cls:s,ref:n,role:o,tag:r}=e,a=document.createElement(r);if(s&&(a.className=s),n&&a.setAttribute(RP,n),o&&a.setAttribute("role",o),t)for(const l of Object.keys(t))a.setAttribute(l,t[l]);if(i)if(typeof i=="string")a.textContent=i;else{let l=!0;for(const c of i)c&&(typeof c=="string"?(a.appendChild(document.createTextNode(c)),l=!1):typeof c=="function"?a.appendChild(c()):(l&&(a.appendChild(tR()),l=!1),a.append(Xf(c)),a.appendChild(tR())))}return a}var CH=["touchstart","touchend","touchmove","touchcancel","scroll"],wH=["wheel"],CC={},xP=(()=>{const e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return i=>{if(typeof CC[i]=="boolean")return CC[i];const s=document.createElement(e[i]||"div");return i="on"+i,CC[i]=i in s}})();function bH(e,t){return!t||!e?!1:SH(t).indexOf(e)>=0}function yH(e){const t=[];let i=e.target;for(;i;)t.push(i),i=i.parentElement;return t}function SH(e){const t=e;return t.path?t.path:t.composedPath?t.composedPath():yH(t)}function RH(e,t,i){const s=xH(t);let n;s!=null&&(n={passive:s}),e.addEventListener(t,i,n)}var xH=e=>{const t=CH.includes(e),i=wH.includes(e);if(t)return!0;if(i)return!1};function EP(e,t,i){if(i===0)return!1;const s=Math.abs(e.clientX-t.clientX),n=Math.abs(e.clientY-t.clientY);return Math.max(s,n)<=i}var $u=(e,t)=>{const i=e.identifier;for(let s=0,n=t.length;s<n;++s){const o=t[s];if(o.identifier===i)return o}return null};function dg(e,t){return e.gos.isElementInThisInstance(t.target)}function EH(e,t,i){const n=e.getBoundingClientRect().height,o=XN(i)-2,r=QN(i)-2;if(!e.offsetParent)return;const l=CP(e.offsetParent),{clientY:c,clientX:d}=t;let h=c-l.top-n/2,u=d-l.left-10;const f=pi(i),p=f.defaultView||window,m=p.pageYOffset||f.documentElement.scrollTop,v=p.pageXOffset||f.documentElement.scrollLeft;o>0&&u+e.clientWidth>o+v&&(u=o+v-e.clientWidth),u<0&&(u=0),r>0&&h+e.clientHeight>r+m&&(h=r+m-e.clientHeight),h<0&&(h=0),e.style.left=`${u}px`,e.style.top=`${h}px`}var am=(e,...t)=>{for(const i of t){const[s,n,o,r]=i;s.addEventListener(n,o,r),e.push(i)}},cS=e=>{if(e){for(const[t,i,s,n]of e)t.removeEventListener(i,s,n);e.length=0}},Ur=e=>{e.cancelable&&e.preventDefault()};function AH(e,t){return t}function AP(e){return(e==null?void 0:e.getLocaleTextFunc())??AH}function FH(e,t,i,s){const n=t[i];return e.getLocaleTextFunc()(i,typeof n=="function"?n(s):n,s)}function PH(e){return(t,i,s)=>e({key:t,defaultValue:i,variableValues:s})}function TH(e){return(t,i,s)=>{let n=e==null?void 0:e[t];if(n&&(s!=null&&s.length)){let o=0;for(;!(o>=s.length||n.indexOf("${variable}")===-1);)n=n.replace("${variable}",s[o++])}return n??i}}var Do=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.beans=e,this.stubContext=e.context,this.eventSvc=e.eventSvc,this.gos=e.gos}destroy(){const{destroyFunctions:e}=this;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,i){this.localEventService||(this.localEventService=new Mc),this.localEventService.addEventListener(e,t,i)}removeEventListener(e,t,i){var s;(s=this.localEventService)==null||s.removeEventListener(e,t,i)}dispatchLocalEvent(e){var t;(t=this.localEventService)==null||t.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventSvc,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){const i=[];for(const s of Object.keys(t)){const n=t[s];n&&i.push(this._setupListener(e,s,n))}return i}_setupListener(e,t,i){if(this.destroyed)return()=>null;let s;if(DH(e))e.__addEventListener(t,i),s=()=>(e.__removeEventListener(t,i),null);else{const n=MH(e);e instanceof HTMLElement?RH(e,t,i):n?e.addListener(t,i):e.addEventListener(t,i),s=n?()=>(e.removeListener(t,i),null):()=>(e.removeEventListener(t,i),null)}return this.destroyFunctions.push(s),()=>(s(),this.destroyFunctions=this.destroyFunctions.filter(n=>n!==s),null)}setupPropertyListener(e,t){const{gos:i}=this;i.addPropertyEventListener(e,t);const s=()=>(i.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(s),()=>(s(),this.destroyFunctions=this.destroyFunctions.filter(n=>n!==s),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupPropertyListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;const i=e.join("-")+this.propertyListenerId++,s=n=>{if(n.changeSet){if(n.changeSet&&n.changeSet.id===this.lastChangeSetIdLookup[i])return;this.lastChangeSetIdLookup[i]=n.changeSet.id}const o={type:"propertyChanged",changeSet:n.changeSet,source:n.source};t(o)};for(const n of e)this.setupPropertyListener(n,s)}getLocaleTextFunc(){return AP(this.beans.localeSvc)}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createOptionalManagedBean(e,t){return e?this.createManagedBean(e,t):void 0}createManagedBean(e,t){const i=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),i}createBean(e,t,i){return(t||this.stubContext).createBean(e,i)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function DH(e){return e.__addEventListener!==void 0}function MH(e){return e.eventServiceType==="global"}var V=class extends Do{},iR={};function dS(e,t){iR[t]||(e(),iR[t]=!0)}var IH={pending:!1,funcs:[]},kH={pending:!1,funcs:[]};function Vb(e,t="setTimeout",i){const s=t==="raf"?kH:IH;if(s.funcs.push(e),s.pending)return;s.pending=!0;const n=()=>{const o=s.funcs.slice();s.funcs.length=0,s.pending=!1;for(const r of o)r()};t==="raf"?Lr(i,n):window.setTimeout(n,0)}function Pi(e,t,i){let s;return function(...n){const o=this;window.clearTimeout(s),s=window.setTimeout(function(){e.isAlive()&&t.apply(o,n)},i)}}function sR(e,t){let i=0;return function(...s){const n=this,o=Date.now();o-i<t||(i=o,e.apply(n,s))}}function _H(e,t,i,s=100){const n=Date.now();let o=null,r=!1;const a=()=>{o!=null&&(window.clearInterval(o),o=null)};e.addDestroyFunc(a);const l=()=>{const c=Date.now()-n>s;(t()||c)&&(i(),r=!0,a())};l(),r||(o=window.setInterval(l,10))}var FP=new Set(["__proto__","constructor","prototype"]);function LH(e,t){if(e!=null){if(Array.isArray(e)){for(let i=0;i<e.length;i++)t(i.toString(),e[i]);return}for(const i of Object.keys(e).filter(s=>!FP.has(s)))t(i,e[i])}}function ts(e,t,i=!0,s=!1){ae(t)&&LH(t,(n,o)=>{let r=e[n];r!==o&&(s&&r==null&&o!=null&&typeof o=="object"&&o.constructor===Object&&(r={},e[n]=r),nR(o)&&nR(r)&&!Array.isArray(r)?ts(r,o,i,s):(i||o!==void 0)&&(e[n]=o))})}function nR(e){return typeof e=="object"&&e!==null}var hS=class No{static applyGlobalGridOptions(t){if(!No.gridOptions)return{...t};let i={};return ts(i,No.gridOptions,!0,!0),No.mergeStrategy==="deep"?ts(i,t,!0,!0):i={...i,...t},No.gridOptions.context&&(i.context=No.gridOptions.context),t.context&&(No.mergeStrategy==="deep"&&i.context&&ts(t.context,i.context,!0,!0),i.context=t.context),i}static applyGlobalGridOption(t,i){if(No.mergeStrategy==="deep"){const s=OH(t);if(s&&typeof s=="object"&&typeof i=="object")return No.applyGlobalGridOptions({[t]:i})[t]}return i}};hS.gridOptions=void 0;hS.mergeStrategy="shallow";var uS=hS;function OH(e){var t;return(t=uS.gridOptions)==null?void 0:t[e]}var NH={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,cellFlashDuration:500,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,rowDragInsertDelay:500,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1,rowNumbers:!1,enableFilterHandlers:!1},PP="https://www.ag-grid.com";function Ga(e,t,...i){e.get("debug")&&console.log("AG Grid: "+t,...i)}function Uu(e,...t){dS(()=>console.warn("AG Grid: "+e,...t),e+(t==null?void 0:t.join("")))}function yd(e,...t){dS(()=>console.error("AG Grid: "+e,...t),e+(t==null?void 0:t.join("")))}var TP=new Set,Lm={},Sd={},lm,DP=!1,MP=!1,HH=!1;function GH(e){const[t,i]=e.version.split(".")||[],[s,n]=lm.split(".")||[];return t===s&&i===n}function BH(e){var s;lm||(lm=e.version);const t=n=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${n} Please update all modules to the same version.`;e.version?GH(e)||yd(t(`'${e.moduleName}' is version ${e.version} but the other modules are version ${lm}.`)):yd(t(`'${e.moduleName}' is incompatible.`));const i=(s=e.validate)==null?void 0:s.call(e);i&&!i.isValid&&yd(`${i.message}`)}function hg(e,t,i=!1){i||(DP=!0),BH(e);const s=e.rowModels??["all"];TP.add(e);let n;t!==void 0?(MP=!0,Sd[t]===void 0&&(Sd[t]={}),n=Sd[t]):n=Lm;for(const o of s)n[o]===void 0&&(n[o]={}),n[o][e.moduleName]=e;if(e.dependsOn)for(const o of e.dependsOn)hg(o,t,i)}function VH(e){delete Sd[e]}function zb(e,t,i){const s=n=>{var o,r,a;return!!((o=Lm[n])!=null&&o[e])||!!((a=(r=Sd[t])==null?void 0:r[n])!=null&&a[e])};return s(i)||s("all")}function gS(){return MP}function zH(e,t){const i=Sd[e]??{};return[...Object.values(Lm.all??{}),...Object.values(i.all??{}),...Object.values(Lm[t]??{}),...Object.values(i[t]??{})]}function WH(){return new Set(TP)}function $H(){return DP}function UH(){return HH}var jH=class{static register(e){hg(e,void 0)}static registerModules(e){for(const t of e)hg(t,void 0)}},ne="34.3.1",oR=2e3,rR=100,IP="_version_",cm=null,Rd=`${PP}/javascript-data-grid`;function KH(e){cm=e}function qH(e){Rd=e}function kP(e,t,i){return(cm==null?void 0:cm(e,t))??[JH(e,t,i)]}function fS(e,t,i,s,n){e(`${s?"warning":"error"} #${t}`,...kP(t,i,n))}function YH(e){if(!e)return String(e);const t={};for(const i of Object.keys(e))typeof e[i]!="object"&&typeof e[i]!="function"&&(t[i]=e[i]);return JSON.stringify(t)}function XH(e){let t=e;return e instanceof Error?t=e.toString():typeof e=="object"&&(t=YH(e)),t}function Om(e){return e===void 0?"undefined":e===null?"null":e}function Wb(e,t){return`${e}?${t.toString()}`}function QH(e,t,i){const s=Array.from(t.entries()).sort((o,r)=>r[1].length-o[1].length);let n=Wb(e,t);for(const[o,r]of s){if(o===IP)continue;const a=n.length-i;if(a<=0)break;const l="...",c=a+l.length,d=r.length-c>rR?r.slice(0,r.length-c)+l:r.slice(0,rR)+l;t.set(o,d),n=Wb(e,t)}return n}function _P(e,t){const i=new URLSearchParams;if(i.append(IP,ne),t)for(const o of Object.keys(t))i.append(o,XH(t[o]));const s=`${Rd}/errors/${e}`,n=Wb(s,i);return n.length<=oR?n:QH(s,i,oR)}var JH=(e,t,i)=>{const s=_P(e,t);return`${`${i?i+` 
`:""}Visit ${s}`}${i?"":` 
  Alternatively register the ValidationModule to see the full message in the console.`}`};function j(...e){fS(Uu,e[0],e[1],!0)}function ut(...e){fS(yd,e[0],e[1],!1)}function Iu(e,t,i){fS(yd,e,t,!1,i)}function ZH(e,t){const i=t[0];return`error #${i} `+kP(i,t[1],e).join(" ")}function So(...e){return ZH(void 0,e)}function LP(e,t){return e.get("rowModelType")===t}function Ut(e,t){return LP(e,"clientSide")}function iu(e,t){return LP(e,"serverSide")}function Ii(e,t){return e.get("domLayout")===t}function bc(e){return Hm(e)!==void 0}function OP(e){return typeof e.get("getRowHeight")=="function"}function eG(e,t){return t?!e.get("enableStrictPivotColumnOrder"):e.get("maintainColumnOrder")}function Ba(e,t,i=!1,s){const{gos:n,environment:o}=e;if(s==null&&(s=o.getDefaultRowHeight()),OP(n)){if(i)return{height:s,estimated:!0};const l={node:t,data:t.data},c=n.getCallback("getRowHeight")(l);if($b(c))return c===0&&j(23),{height:Math.max(1,c),estimated:!1}}if(t.detail&&n.get("masterDetail"))return tG(n);const r=n.get("rowHeight");return{height:r&&$b(r)?r:s,estimated:!1}}function tG(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};const t=e.get("detailRowHeight");return $b(t)?{height:t,estimated:!1}:{height:300,estimated:!1}}function yc(e){const{environment:t,gos:i}=e,s=i.get("rowHeight");if(!s||At(s))return t.getDefaultRowHeight();const n=t.refreshRowHeightVariable();return n!==-1?n:(j(24),t.getDefaultRowHeight())}function $b(e){return!isNaN(e)&&typeof e=="number"&&isFinite(e)}function NP(e,t,i){const s=t[e.getDomDataKey()];return s?s[i]:void 0}function Ic(e,t,i,s){const n=e.getDomDataKey();let o=t[n];At(o)&&(o={},t[n]=o),o[i]=s}function xd(e){return e.get("ensureDomOrder")?!1:e.get("animateRows")}function HP(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||Ii(e,"print"))}function mo(e){const t=e.get("autoGroupColumnDef");return!(t!=null&&t.comparator)&&!e.get("treeData")}function Ub(e){const t=e.get("groupAggFiltering");if(typeof t=="function")return e.getCallback("groupAggFiltering");if(t===!0)return()=>!0}function GP(e){return e.get("grandTotalRow")}function BP(e,t){return t?!1:e.get("groupDisplayType")==="groupRows"}function VP(e,t,i){return!!t.group&&!t.footer&&BP(e,i)}function Wh(e){const t=e.getCallback("getRowId");return t===void 0?t:i=>{let s=t(i);return typeof s!="string"&&(dS(()=>j(25,{id:s}),"getRowIdString"),s=String(s)),s}}function iG(e,t){const i=e.get("groupHideParentOfSingleChild");return!!(i===!0||i==="leafGroupsOnly"&&t.leafGroup||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")&&t.leafGroup)}function sG(e){const t=e.get("maxConcurrentDatasourceRequests");return t>0?t:void 0}function Ed(e){return(e==null?void 0:e.checkboxes)??!0}function dm(e){return(e==null?void 0:e.mode)==="multiRow"&&(e.headerCheckbox??!0)}function Nm(e){if(typeof e=="object")return e.checkboxLocation??"selectionColumn"}function wC(e){return(e==null?void 0:e.hideDisabledCheckboxes)??!1}function nG(e){return typeof e.get("rowSelection")!="string"}function Tr(e){const t=e.get("cellSelection");return t!==void 0?!!t:e.get("enableRangeSelection")}function zP(e){const t=e.get("rowSelection")??"single";if(typeof t=="string"){const i=e.get("suppressRowClickSelection"),s=e.get("suppressRowDeselection");return i&&s?!1:i?"enableDeselection":s?"enableSelection":!0}return t.mode==="singleRow"||t.mode==="multiRow"?t.enableClickSelection??!1:!1}function oG(e){const t=zP(e);return t===!0||t==="enableSelection"}function rG(e){const t=zP(e);return t===!0||t==="enableDeselection"}function jb(e){const t=e.get("rowSelection");return typeof t=="string"?e.get("isRowSelectable"):t==null?void 0:t.isRowSelectable}function Hm(e){const t="beanName"in e&&e.beanName==="gos"?e.get("rowSelection"):e.rowSelection;if(typeof t=="string")switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}switch(t==null?void 0:t.mode){case"multiRow":case"singleRow":return t.mode;default:return}}function ug(e){return Hm(e)==="multiRow"}function aG(e){const t=e.get("rowSelection");return typeof t=="string"?e.get("rowMultiSelectWithClick"):(t==null?void 0:t.enableSelectionWithoutKeys)??!1}function Gm(e){const t=e.get("rowSelection");if(typeof t=="string"){const i=e.get("groupSelectsChildren"),s=e.get("groupSelectsFiltered");return i&&s?"filteredDescendants":i?"descendants":"self"}return(t==null?void 0:t.mode)==="multiRow"?t.groupSelects:void 0}function WP(e,t=!0){const i=e.get("rowSelection");return typeof i!="object"?t?"all":void 0:i.mode==="multiRow"?i.selectAll:"all"}function lG(e){const t=e.get("rowSelection");return typeof t=="string"?!1:(t==null?void 0:t.mode)==="multiRow"?t.ctrlASelectsRows??!1:!1}function gg(e){const t=Gm(e);return t==="descendants"||t==="filteredDescendants"}function aR(e){const t=e.get("rowSelection");return typeof t=="object"&&t.masterSelects||"self"}function cG(e){return e.isModuleRegistered("SetFilter")&&!e.get("suppressSetFilterByDefault")}function _s(e){return e.get("columnMenu")==="legacy"}function dG(e){return!_s(e)}function hG(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}function Fe(e,t){return e.addCommon(t)}function lR({gos:e},t){return t.button===2||t.ctrlKey&&e.get("allowContextMenuWithControlKey")}var uG={resizable:!0,sortable:!0},gG=0;function $P(){return gG++}function Va(e){return e instanceof jc}var jc=class extends V{constructor(e,t,i,s){super(),this.colDef=e,this.userProvidedColDef=t,this.colId=i,this.primary=s,this.isColumn=!0,this.instanceId=$P(),this.autoHeaderHeight=null,this.moving=!1,this.resizing=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.colEventSvc=new Mc,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.flex=null,this.colIdSanitised=Vu(i)}destroy(){var e;super.destroy(),(e=this.beans.rowSpanSvc)==null||e.deregister(this)}getInstanceId(){return this.instanceId}setState(){const{colDef:e,beans:{sortSvc:t,pinnedCols:i,colFlex:s}}=this;t==null||t.initCol(this);const n=e.hide;n!==void 0?this.visible=!n:this.visible=!e.initialHide,i==null||i.initCol(this),s==null||s.initCol(this)}setColDef(e,t,i){var n;const s=e.spanRows!==this.colDef.spanRows;this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),s&&((n=this.beans.rowSpanSvc)==null||n.deregister(this),this.initRowSpan()),this.dispatchColEvent("colDefChanged",i)}getUserProvidedColDef(){return this.userProvidedColDef}getParent(){return this.parent}getOriginalParent(){return this.originalParent}postConstruct(){this.setState(),this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.initRowSpan(),this.addPivotListener()}initDotNotation(){const{gos:e,colDef:{field:t,tooltipField:i}}=this,s=e.get("suppressFieldDotNotation");this.fieldContainsDots=ae(t)&&t.includes(".")&&!s,this.tooltipFieldContainsDots=ae(i)&&i.includes(".")&&!s}initMinAndMaxWidths(){const e=this.colDef;this.minWidth=e.minWidth??this.beans.environment.getDefaultColumnMinWidth(),this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){var e;(e=this.beans.tooltipSvc)==null||e.initCol(this)}initRowSpan(){var e;this.colDef.spanRows&&((e=this.beans.rowSpanSvc)==null||e.register(this))}addPivotListener(){const e=this.beans.pivotColDefSvc,t=this.colDef.pivotValueColumn;!e||!t||this.addManagedListeners(t,{colDefChanged:i=>{const s=e.recreateColDef(this.colDef);this.setColDef(s,s,i.source)}})}resetActualWidth(e){const t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t;const i=e.width,s=e.initialWidth;return i!=null?t=i:s!=null?t=s:t=200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){var t;return((t=this.beans.showRowGroupCols)==null?void 0:t.isRowGroupDisplayed(this,e))??!1}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}__addEventListener(e,t){this.colEventSvc.addEventListener(e,t)}__removeEventListener(e,t){this.colEventSvc.removeEventListener(e,t)}addEventListener(e,t){var s,n,o;this.frameworkEventListenerService=(n=(s=this.beans.frameworkOverrides).createLocalEventListenerWrapper)==null?void 0:n.call(s,this.frameworkEventListenerService,this.colEventSvc);const i=((o=this.frameworkEventListenerService)==null?void 0:o.wrap(e,t))??t;this.colEventSvc.addEventListener(e,i)}removeEventListener(e,t){var s;const i=((s=this.frameworkEventListenerService)==null?void 0:s.unwrap(e,t))??t;this.colEventSvc.removeEventListener(e,i)}createColumnFunctionCallbackParams(e){return Fe(this.gos,{node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){var t;return((t=this.beans.cellNavigation)==null?void 0:t.isSuppressNavigable(this,e))??!1}isCellEditable(e){var t;return((t=this.beans.editSvc)==null?void 0:t.isCellEditable({rowNode:e,column:this}))??!1}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){var t;return((t=this.beans.selectionSvc)==null?void 0:t.isCellCheckboxSelection(this,e))??!1}isSuppressPaste(e){var t;return this.isColumnFunc(e,((t=this.colDef)==null?void 0:t.suppressPaste)??null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??uG[e]}isColumnFunc(e,t){if(typeof t=="boolean")return t;if(typeof t=="function"){const i=this.createColumnFunctionCallbackParams(e);return t(i)}return!1}createColumnEvent(e,t){return Fe(this.gos,{type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sort}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.sort==="asc"}isSortDescending(){return this.sort==="desc"}isSortNone(){return At(this.sort)}isSorting(){return ae(this.sort)}getSortIndex(){return this.sortIndex}isMenuVisible(){return this.menuVisible}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchColEvent("leftChanged",t))}isFilterActive(){return this.filterActive}isHovered(){var e;return j(261),!!((e=this.beans.colHover)!=null&&e.isHovered(this))}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.dispatchColEvent("firstRightPinnedChanged",t))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.dispatchColEvent("lastLeftPinnedChanged",t))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(e,t){const i=e===!0;this.visible!==i&&(this.visible=i,this.dispatchColEvent("visibleChanged",t)),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getFirstRealParent(){let e=this.getOriginalParent();for(;e!=null&&e.isPadding();)e=e.getOriginalParent();return e}getColumnGroupPaddingInfo(){let e=this.getParent();if(!(e!=null&&e.isPadding()))return{numberOfParents:0,isSpanningTotal:!1};const t=e.getPaddingLevel()+1;let i=!0;for(;e;){if(!e.isPadding()){i=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:i}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return Fe(this.gos,{node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(At(this.colDef.colSpan))return 1;const t=this.createBaseColDefParams(e),i=this.colDef.colSpan(t);return Math.max(i,1)}getRowSpan(e){if(At(this.colDef.rowSpan))return 1;const t=this.createBaseColDefParams(e),i=this.colDef.rowSpan(t);return Math.max(i,1)}setActualWidth(e,t,i=!1){e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex!=null&&t!=="flex"&&t!=="gridInitializing"&&(this.flex=null),i||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.dispatchColEvent("widthChanged",e)}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex}isRowGroupActive(){return this.rowGroupActive}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}dispatchColEvent(e,t,i){const s=this.createColumnEvent(e,t);i&&ts(s,i),this.colEventSvc.dispatchEvent(s)}dispatchStateUpdatedEvent(e){this.colEventSvc.dispatchEvent({type:"columnStateUpdated",key:e})}};function Vi(e){return e instanceof hm}var hm=class extends V{constructor(e,t,i,s){super(),this.colGroupDef=e,this.groupId=t,this.padding=i,this.level=s,this.isColumn=!1,this.expandable=!1,this.instanceId=$P(),this.expandableListenerRemoveCallback=null,this.expanded=!!(e!=null&&e.openByDefault)}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(e=>e.isVisible()):!1}isPadding(){return this.padding}setExpanded(e){this.expanded=e===void 0?!1:e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}forEachLeafColumn(e){if(this.children)for(const t of this.children)Va(t)?e(t):Vi(t)&&t.forEachLeafColumn(e)}addLeafColumns(e){if(this.children)for(const t of this.children)Va(t)?e.push(t):Vi(t)&&t.addLeafColumns(e)}getColumnGroupShow(){const e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const e=this.onColumnVisibilityChanged.bind(this);for(const t of this.getLeafColumns())t.__addEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=()=>{for(const t of this.getLeafColumns())t.__removeEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,i=!1;const s=this.findChildrenRemovingPadding();for(let o=0,r=s.length;o<r;o++){const a=s[o];if(!a.isVisible())continue;const l=a.getColumnGroupShow();l==="open"?(e=!0,i=!0):l==="closed"?(t=!0,i=!0):(e=!0,t=!0)}const n=e&&t&&i;this.expandable!==n&&(this.expandable=n,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){const e=[],t=i=>{for(const s of i)Vi(s)&&s.isPadding()?t(s.children):e.push(s)};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},fG={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function cR(e,t,i){const s={},n=e.gos;return Object.assign(s,n.get("defaultColGroupDef")),Object.assign(s,t),n.validateColDef(s,i),s}var pG=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=Gb(e);let i=0;for(;;){let s=e??t;if(s?i!==0&&(s+="_"+i):s=i,!this.existingKeys[s]){const n=String(s);return e&&i>0&&j(273,{providedId:e,usedId:n}),this.existingKeys[n]=!0,n}i++}}};function Ct(e){if(e!=null&&e.length)return e[e.length-1]}function Ya(e,t,i){if(e===t)return!0;if(!e||!t)return e==null&&t==null;const s=e.length;if(s!==t.length)return!1;for(let n=0;n<s;n++)if(e[n]!==t[n]&&!(i!=null&&i(e[n],t[n])))return!1;return!0}function cu(e,t){if(e)for(const i of e)t(i)}function _n(e,t){const i=e.indexOf(t);i>=0&&e.splice(i,1)}function dR(e,t,i){for(let s=0;s<t.length;s++)_n(e,t[s]);for(let s=t.length-1;s>=0;s--)e.splice(i,0,t[s])}var Bv="ag-Grid-AutoColumn",UP="ag-Grid-SelectionColumn",jP="ag-Grid-RowNumbersColumn";function KP(e){const t=[],i=s=>{for(let n=0;n<s.length;n++){const o=s[n];Va(o)?t.push(o):Vi(o)&&i(o.getChildren())}};return i(e),t}function Bo(e){return e.reduce((t,i)=>t+i.getActualWidth(),0)}function Bm(e,t,i){const s={};if(!t)return;Sr(null,t,o=>{s[o.getInstanceId()]=o}),i&&Sr(null,i,o=>{s[o.getInstanceId()]=null});const n=Object.values(s).filter(o=>o!=null);e.context.destroyBeans(n)}function pS(e){return e.getId().startsWith(Bv)}function Or(e){const t=typeof e=="string"?e:"getColId"in e?e.getColId():e.colId;return(t==null?void 0:t.startsWith(UP))??!1}function yr(e){const t=typeof e=="string"?e:"getColId"in e?e.getColId():e.colId;return(t==null?void 0:t.startsWith(jP))??!1}function mG(e){return Or(e)||yr(e)}function Vm(e){let t=[];return e instanceof Array?t=e:typeof e=="string"&&(t=e.split(",")),t}function vG(e,t){return Ya(e,t,(i,s)=>i.getColId()===s.getColId())}function CG(e){e.map={};for(const t of e.list)e.map[t.getId()]=t}function Ad(e){return e==="optionsUpdated"?"gridOptionsChanged":e}function ju(e,t){const i=e===t,s=e.getColDef()===t,n=e.getColId()==t;return i||s||n}var wG=(e,t)=>(i,s)=>{const n={value1:void 0,value2:void 0};let o=!1;return e&&(e[i]!==void 0&&(n.value1=e[i],o=!0),ae(s)&&e[s]!==void 0&&(n.value2=e[s],o=!0)),!o&&t&&(t[i]!==void 0&&(n.value1=t[i]),ae(s)&&t[s]!==void 0&&(n.value2=t[s])),n},bG=(e,t)=>{Vi(e)&&e.setupExpandable(),e.originalParent=t};function yG(e,t=null,i,s,n){const o=new pG,{existingCols:r,existingGroups:a,existingColKeys:l}=SG(s);o.addExistingKeys(l);const c=qP(e,t,0,i,r,o,a,n),{colGroupSvc:d}=e,h=(d==null?void 0:d.findMaxDepth(c,0))??0,u=d?d.balanceColumnTree(c,0,h,o):c;return Sr(null,u,bG),{columnTree:u,treeDepth:h}}function SG(e){const t=[],i=[],s=[];return e&&Sr(null,e,n=>{if(Vi(n)){const o=n;i.push(o)}else{const o=n;s.push(o.getId()),t.push(o)}}),{existingCols:t,existingGroups:i,existingColKeys:s}}function qP(e,t,i,s,n,o,r,a){if(!t)return[];const{colGroupSvc:l}=e,c=new Array(t.length);for(let d=0;d<c.length;d++){const h=t[d];l&&PG(h)?c[d]=l.createProvidedColumnGroup(s,h,i,n,o,r,a):c[d]=RG(e,s,h,n,o,a)}return c}function RG(e,t,i,s,n,o){var l;const r=EG(i,s);r&&(s==null||s.splice(r.idx,1));let a=r==null?void 0:r.column;if(a){const c=Kb(e,i,a.getColId());a.setColDef(c,i,o),xG(e,a,c,o)}else{const c=n.getUniqueKey(i.colId,i.field),d=Kb(e,i,c);a=new jc(d,i,c,t),e.context.createBean(a)}return(l=e.dataTypeSvc)==null||l.addColumnListeners(a),a}function YP(e,t,i,s,n,o,r,a){const{sortSvc:l,pinnedCols:c,colFlex:d}=e;i!==void 0&&t.setVisible(!i,a),l&&(l.updateColSort(t,s,a),n!==void 0&&l.setColSortIndex(t,n)),o!==void 0&&(c==null||c.setColPinned(t,o)),r!==void 0&&(d==null||d.setColFlex(t,r))}function xG(e,t,i,s){YP(e,t,i.hide,i.sort,i.sortIndex,i.pinned,i.flex,s);const n=t.getFlex();if(!(n!=null&&n>0))if(i.width!=null)t.setActualWidth(i.width,s);else{const o=t.getActualWidth();t.setActualWidth(o,s)}}function EG(e,t){if(t)for(let i=0;i<t.length;i++){const s=t[i].getUserProvidedColDef();if(!s)continue;if(e.colId!=null){if(t[i].getId()===e.colId)return{idx:i,column:t[i]};continue}if(e.field!=null){if(s.field===e.field)return{idx:i,column:t[i]};continue}if(s===e)return{idx:i,column:t[i]}}}function Kb(e,t,i,s){const{gos:n,dataTypeSvc:o}=e,r={},a=n.get("defaultColDef");ts(r,a,!1,!0);const l=AG(e,r,t,i);l&&FG(e,l,r);const c=r.cellDataType;ts(r,t,!1,!0),c!==void 0&&(r.cellDataType=c);const d=n.get("autoGroupColumnDef"),h=mo(n);return t.rowGroup&&d&&h&&ts(r,{sort:d.sort,initialSort:d.initialSort},!1,!0),o&&(o.postProcess(r),o.validateColDef(r)),n.validateColDef(r,i,s),r}function AG(e,t,i,s){var r;const n=(r=e.dataTypeSvc)==null?void 0:r.updateColDefAndGetColumnType(t,i,s),o=i.type??n??t.type;return t.type=o,o?Vm(o):void 0}function FG(e,t,i){if(!t.length)return;const s=Object.assign({},fG),n=e.gos.get("columnTypes")||{};for(const o of Object.keys(n)){const r=n[o];o in s?j(34,{key:o}):(r.type&&j(35),s[o]=r)}for(const o of t){const r=s[o.trim()];r?ts(i,r,!1,!0):j(36,{t:o})}}function PG(e){return e.children!==void 0}function Sr(e,t,i){if(t)for(let s=0;s<t.length;s++){const n=t[s];Vi(n)&&Sr(n,n.getChildren(),i),i(n,e)}}function XP(e,t){const i=[],s=[],n=[];return e.forEach(r=>{const a=r.getColDef().lockPosition;a==="right"?n.push(r):a==="left"||a===!0?i.push(r):s.push(r)}),t.get("enableRtl")?[...n,...s,...i]:[...i,...s,...n]}function QP(e,t){let i=!0;return Sr(null,t,s=>{if(!Vi(s))return;const n=s,o=n.getColGroupDef();if(!(o==null?void 0:o.marryChildren))return;const a=[];for(const u of n.getLeafColumns()){const f=e.indexOf(u);a.push(f)}const l=Math.max.apply(Math,a),c=Math.min.apply(Math,a),d=l-c,h=n.getLeafColumns().length-1;d>h&&(i=!1)}),i}function JP(e,t){if(!e||e.length==0)return;const i=t(e[0]);for(let s=1;s<e.length;s++)if(i!==t(e[s]))return;return i}function ZP(e,t,i){if(!t.length)return;const s=t.length===1?t[0]:null,n=JP(t,o=>o.getPinned());e.dispatchEvent({type:"columnPinned",pinned:n??null,columns:t,column:s,source:i})}function TG(e,t,i){if(!t.length)return;const s=t.length===1?t[0]:null,n=JP(t,o=>o.isVisible());e.dispatchEvent({type:"columnVisible",visible:n,columns:t,column:s,source:i})}function DG(e,t,i,s){e.dispatchEvent({type:t,columns:i,column:i&&i.length==1?i[0]:null,source:s})}function $h(e,t,i,s,n=null){t!=null&&t.length&&e.dispatchEvent({type:"columnResized",columns:t,column:t.length===1?t[0]:null,flexColumns:n,finished:i,source:s})}function In(e,t,i){var E;const{colModel:s,rowGroupColsSvc:n,pivotColsSvc:o,autoColSvc:r,selectionColSvc:a,colAnimation:l,visibleCols:c,pivotResultCols:d,environment:h,valueColsSvc:u,eventSvc:f,gos:p}=e,m=s.getColDefCols()??[],v=a==null?void 0:a.getColumns();if(!m.length&&!(v!=null&&v.length))return!1;if(t!=null&&t.state&&!t.state.forEach)return j(32),!1;const C=(A,P,T,D,N)=>{if(!A)return;const M=wG(P,t.defaultState),_=M("flex").value1;if(YP(e,A,M("hide").value1,M("sort").value1,M("sortIndex").value1,M("pinned").value1,_,i),_==null){const W=M("width").value1;if(W!=null){const $=A.getColDef().minWidth??h.getDefaultColumnMinWidth();$!=null&&W>=$&&A.setActualWidth(W,i)}}N||!A.isPrimary()||(u==null||u.syncColumnWithState(A,i,M),n==null||n.syncColumnWithState(A,i,M,T),o==null||o.syncColumnWithState(A,i,M,D))},w=(A,P,T)=>{var Ce,le;const D=eT(e,i),N=P.slice(),M={},_={},W=[],$=[],B=[];let q=0;const X=(n==null?void 0:n.columns.slice())??[],U=(o==null?void 0:o.columns.slice())??[];for(const ee of A){const ve=ee.colId;if(ve.startsWith(Bv)){W.push(ee),B.push(ee);continue}if(Or(ve)){$.push(ee),B.push(ee);continue}const Z=T(ve);Z?(C(Z,ee,M,_,!1),_n(N,Z)):(B.push(ee),q+=1)}const pe=ee=>C(ee,null,M,_,!1);N.forEach(pe),n==null||n.sortColumns(hR.bind(n,M,X)),o==null||o.sortColumns(hR.bind(o,_,U)),s.refreshCols(!1,i);const Ee=(ee,ve,Oe=[])=>{for(const Z of ve){const we=ee(Z.colId);_n(Oe,we),C(we,Z,null,null,!0)}Oe.forEach(pe)};return Ee(ee=>(r==null?void 0:r.getColumn(ee))??null,W,(Ce=r==null?void 0:r.getColumns())==null?void 0:Ce.slice()),Ee(ee=>(a==null?void 0:a.getColumn(ee))??null,$,(le=a==null?void 0:a.getColumns())==null?void 0:le.slice()),IG(t,s,p),c.refresh(i),f.dispatchEvent({type:"columnEverythingChanged",source:i}),D(),{unmatchedAndAutoStates:B,unmatchedCount:q}};l==null||l.start();let{unmatchedAndAutoStates:S,unmatchedCount:b}=w(t.state||[],m,A=>s.getColDefCol(A));if(S.length>0||ae(t.defaultState)){const A=((E=d==null?void 0:d.getPivotResultCols())==null?void 0:E.list)??[];b=w(S,A,P=>(d==null?void 0:d.getPivotResultCol(P))??null).unmatchedCount}return l==null||l.finish(),b===0}function MG(e,t){var w,S;const{colModel:i,autoColSvc:s,selectionColSvc:n,eventSvc:o,gos:r}=e,a=i.getColDefCols();if(!(a!=null&&a.length))return;const l=i.getColDefColTree(),c=KP(l),d=[];let h=1e3,u=1e3;const f=b=>{const E=tT(b);At(E.rowGroupIndex)&&E.rowGroup&&(E.rowGroupIndex=h++),At(E.pivotIndex)&&E.pivot&&(E.pivotIndex=u++),d.push(E)};(w=s==null?void 0:s.getColumns())==null||w.forEach(f),(S=n==null?void 0:n.getColumns())==null||S.forEach(f),c==null||c.forEach(f),In(e,{state:d},t);const p=(s==null?void 0:s.getColumns())??[],C=[...(n==null?void 0:n.getColumns())??[],...p,...a].map(b=>({colId:b.colId}));In(e,{state:C,applyOrder:!0},t),o.dispatchEvent(Fe(r,{type:"columnsReset",source:t}))}function eT(e,t){const{rowGroupColsSvc:i,pivotColsSvc:s,valueColsSvc:n,colModel:o,sortSvc:r,eventSvc:a}=e,l={rowGroupColumns:(i==null?void 0:i.columns.slice())??[],pivotColumns:(s==null?void 0:s.columns.slice())??[],valueColumns:(n==null?void 0:n.columns.slice())??[]},c=zm(e),d={};for(const h of c)d[h.colId]=h;return()=>{const h=(A,P,T,D)=>{const N=P.map(D),M=T.map(D);if(Ya(N,M))return;const W=new Set(P);for(const B of T)W.delete(B)||W.add(B);const $=[...W];a.dispatchEvent({type:A,columns:$,column:$.length===1?$[0]:null,source:t})},u=A=>{const P=[];return o.forAllCols(T=>{const D=d[T.getColId()];D&&A(D,T)&&P.push(T)}),P},f=A=>A.getColId();h("columnRowGroupChanged",l.rowGroupColumns,(i==null?void 0:i.columns)??[],f),h("columnPivotChanged",l.pivotColumns,(s==null?void 0:s.columns)??[],f);const m=u((A,P)=>{const T=A.aggFunc!=null,D=T!=P.isValueActive(),N=T&&A.aggFunc!=P.getAggFunc();return D||N});m.length>0&&DG(a,"columnValueChanged",m,t),$h(a,u((A,P)=>A.width!=P.getActualWidth()),!0,t),ZP(a,u((A,P)=>A.pinned!=P.getPinned()),t),TG(a,u((A,P)=>A.hide==P.isVisible()),t);const b=u((A,P)=>A.sort!=P.getSort()||A.sortIndex!=P.getSortIndex());b.length>0&&(r==null||r.dispatchSortChangedEvents(t,b));const E=zm(e);_G(c,E,t,o,a)}}function zm(e){const{colModel:t,rowGroupColsSvc:i,pivotColsSvc:s}=e,n=t.getColDefCols();if(At(n)||!t.isAlive())return[];const o=i==null?void 0:i.columns,r=s==null?void 0:s.columns,a=[],l=d=>{const h=d.isRowGroupActive()&&o?o.indexOf(d):null,u=d.isPivotActive()&&r?r.indexOf(d):null,f=d.isValueActive()?d.getAggFunc():null,p=d.getSort()!=null?d.getSort():null,m=d.getSortIndex()!=null?d.getSortIndex():null;a.push({colId:d.getColId(),width:d.getActualWidth(),hide:!d.isVisible(),pinned:d.getPinned(),sort:p,sortIndex:m,aggFunc:f,rowGroup:d.isRowGroupActive(),rowGroupIndex:h,pivot:d.isPivotActive(),pivotIndex:u,flex:d.getFlex()??null})};t.forAllCols(d=>l(d));const c=new Map(t.getCols().map((d,h)=>[d.getColId(),h]));return a.sort((d,h)=>{const u=c.has(d.colId)?c.get(d.colId):-1,f=c.has(h.colId)?c.get(h.colId):-1;return u-f}),a}function tT(e){const t=(p,m)=>p??m??null,i=e.getColDef(),s=t(i.sort,i.initialSort),n=t(i.sortIndex,i.initialSortIndex),o=t(i.hide,i.initialHide),r=t(i.pinned,i.initialPinned),a=t(i.width,i.initialWidth),l=t(i.flex,i.initialFlex);let c=t(i.rowGroupIndex,i.initialRowGroupIndex),d=t(i.rowGroup,i.initialRowGroup);c==null&&!d&&(c=null,d=null);let h=t(i.pivotIndex,i.initialPivotIndex),u=t(i.pivot,i.initialPivot);h==null&&!u&&(h=null,u=null);const f=t(i.aggFunc,i.initialAggFunc);return{colId:e.getColId(),sort:s,sortIndex:n,hide:o,pinned:r,width:a,flex:l,rowGroup:d,rowGroupIndex:c,pivot:u,pivotIndex:h,aggFunc:f}}function IG(e,t,i){if(!e.applyOrder||!e.state)return;const s=[];for(const n of e.state)n.colId!=null&&s.push(n.colId);kG(t.cols,s,t,i)}function kG(e,t,i,s){if(e==null)return;let n=[];const o={};for(const a of t){if(o[a])continue;const l=e.map[a];l&&(n.push(l),o[a]=!0)}let r=0;for(const a of e.list){const l=a.getColId();if(o[l]!=null)continue;l.startsWith(Bv)?n.splice(r++,0,a):n.push(a)}if(n=XP(n,s),!QP(n,i.getColTree())){j(39);return}e.list=n}function _G(e,t,i,s,n){const o={};for(const d of t)o[d.colId]=d;const r={};for(const d of e)o[d.colId]&&(r[d.colId]=!0);const a=e.filter(d=>r[d.colId]),l=t.filter(d=>r[d.colId]),c=[];l.forEach((d,h)=>{const u=a==null?void 0:a[h];if(u&&u.colId!==d.colId){const f=s.getCol(u.colId);f&&c.push(f)}}),c.length&&n.dispatchEvent({type:"columnMoved",columns:c,column:c.length===1?c[0]:null,finished:!0,source:i})}var hR=(e,t,i,s)=>{const n=e[i.getId()],o=e[s.getId()],r=n!=null,a=o!=null;if(r&&a)return n-o;if(r)return-1;if(a)return 1;const l=t.indexOf(i),c=t.indexOf(s),d=l>=0,h=c>=0;return d&&h?l-c:d?-1:1},LG=class extends V{constructor(){super(...arguments),this.beanName="colModel",this.pivotMode=!1,this.ready=!1,this.changeEventsDispatching=!1}postConstruct(){this.pivotMode=this.gos.get("pivotMode"),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents","rowNumbers","hidePaddedHeaderRows"],e=>this.refreshAll(Ad(e.source))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],this.recreateColumnDefs.bind(this)),this.addManagedPropertyListener("pivotMode",e=>this.setPivotMode(this.gos.get("pivotMode"),Ad(e.source)))}createColsFromColDefs(e){var w,S,b;const{beans:t}=this,{valueCache:i,colAutosize:s,rowGroupColsSvc:n,pivotColsSvc:o,valueColsSvc:r,visibleCols:a,eventSvc:l,groupHierarchyColSvc:c}=t,d=this.colDefs?eT(t,e):void 0;i==null||i.expire();const h=(w=this.colDefCols)==null?void 0:w.list,u=(S=this.colDefCols)==null?void 0:S.tree,f=yG(t,this.colDefs,!0,u,e);Bm(t,(b=this.colDefCols)==null?void 0:b.tree,f.columnTree);const p=f.columnTree,m=f.treeDepth,v=KP(p),C={};for(const E of v)C[E.getId()]=E;this.colDefCols={tree:p,treeDepth:m,list:v,map:C},this.createColumnsForService([c],this.colDefCols,e),n==null||n.extractCols(e,h),o==null||o.extractCols(e,h),r==null||r.extractCols(e,h),this.ready=!0,this.refreshCols(!0,e),a.refresh(e),l.dispatchEvent({type:"columnEverythingChanged",source:e}),d&&(this.changeEventsDispatching=!0,d(),this.changeEventsDispatching=!1),l.dispatchEvent({type:"newColumnsLoaded",source:e}),e==="gridInitializing"&&(s==null||s.applyAutosizeStrategy())}refreshCols(e,t){var v;if(!this.colDefCols)return;const i=(v=this.cols)==null?void 0:v.tree;this.saveColOrder();const{autoColSvc:s,selectionColSvc:n,rowNumbersSvc:o,quickFilter:r,pivotResultCols:a,showRowGroupCols:l,rowAutoHeight:c,visibleCols:d,colViewport:h,eventSvc:u}=this.beans,f=this.selectCols(a,this.colDefCols);this.createColumnsForService([s,n,o],f,t);const p=eG(this.gos,this.showingPivotResult);(!e||p)&&this.restoreColOrder(f),this.positionLockedCols(f),l==null||l.refresh(),r==null||r.refreshCols(),this.setColSpanActive(),c==null||c.setAutoHeightActive(f),d.clear(),h.clear(),!Ya(i,this.cols.tree)&&u.dispatchEvent({type:"gridColumnsChanged"})}createColumnsForService(e,t,i){for(const s of e)s&&(s.createColumns(t,n=>{this.lastOrder=n(this.lastOrder),this.lastPivotOrder=n(this.lastPivotOrder)},i),s.addColumns(t))}selectCols(e,t){const i=(e==null?void 0:e.getPivotResultCols())??null;this.showingPivotResult=i!=null;const{map:s,list:n,tree:o,treeDepth:r}=i??t;return this.cols={list:n.slice(),map:{...s},tree:o.slice(),treeDepth:r},i&&(i.list.some(l=>{var c;return((c=this.cols)==null?void 0:c.map[l.getColId()])!==void 0})||(this.lastPivotOrder=null)),this.cols}getColsToShow(){if(!this.cols)return[];const{valueColsSvc:e,selectionColSvc:t,gos:i}=this.beans,s=this.isPivotMode()&&!this.showingPivotResult,n=t==null?void 0:t.isSelectionColumnEnabled(),o=i.get("rowNumbers"),r=e==null?void 0:e.columns;return this.cols.list.filter(l=>{const c=pS(l);if(s){const d=r==null?void 0:r.includes(l);return c||d||n&&Or(l)||o&&yr(l)}else return c||l.isVisible()})}refreshAll(e){this.ready&&(this.refreshCols(!1,e),this.beans.visibleCols.refresh(e))}setColsVisible(e,t=!1,i){In(this.beans,{state:e.map(s=>({colId:typeof s=="string"?s:s.getColId(),hide:!t}))},i)}restoreColOrder(e){const t=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!t)return;const i=t.filter(h=>e.map[h.getId()]!=null);if(i.length===0)return;if(i.length===e.list.length){e.list=i;return}const s=h=>{const u=h.getOriginalParent();return u?u.getChildren().length>1?!0:s(u):!1};if(!i.some(h=>s(h))){const h=new Set(i);for(const u of e.list)h.has(u)||i.push(u);e.list=i;return}const n=new Map;for(let h=0;h<i.length;h++){const u=i[h];n.set(u,h)}const o=e.list.filter(h=>!n.has(h));if(o.length===0){e.list=i;return}const r=(h,u)=>{const f=u?u.getOriginalParent():h.getOriginalParent();if(!f)return null;let p=null,m=null;for(const v of f.getChildren())if(!(v===u||v===h)){if(v instanceof jc){const C=n.get(v);if(C==null)continue;(p==null||p<C)&&(p=C,m=v);continue}v.forEachLeafColumn(C=>{const w=n.get(C);w!=null&&(p==null||p<w)&&(p=w,m=C)})}return m??r(h,f)},a=[],l=new Map;for(const h of o){const u=r(h,null);if(u==null){a.push(h);continue}const f=l.get(u);f===void 0?l.set(u,h):Array.isArray(f)?f.push(h):l.set(u,[f,h])}const c=new Array(e.list.length);let d=c.length-1;for(let h=a.length-1;h>=0;h--)c[d--]=a[h];for(let h=i.length-1;h>=0;h--){const u=i[h],f=l.get(u);if(f)if(Array.isArray(f))for(let p=f.length-1;p>=0;p--){const m=f[p];c[d--]=m}else c[d--]=f;c[d--]=u}e.list=c}positionLockedCols(e){e.list=XP(e.list,this.gos)}saveColOrder(){var e,t;this.showingPivotResult?this.lastPivotOrder=((e=this.cols)==null?void 0:e.list)??null:this.lastOrder=((t=this.cols)==null?void 0:t.list)??null}getColumnDefs(e){var t,i;return this.colDefCols&&((i=this.beans.colDefFactory)==null?void 0:i.getColumnDefs(this.colDefCols.list,this.showingPivotResult,this.lastOrder,((t=this.cols)==null?void 0:t.list)??[],e))}setColSpanActive(){var e;this.colSpanActive=!!((e=this.cols)!=null&&e.list.some(t=>t.getColDef().colSpan!=null))}isPivotMode(){return this.pivotMode}setPivotMode(e,t){if(e===this.pivotMode||(this.pivotMode=e,!this.ready))return;this.refreshCols(!1,t);const{visibleCols:i,eventSvc:s}=this.beans;i.refresh(t),s.dispatchEvent({type:"columnPivotModeChanged"})}isPivotActive(){var t;const e=(t=this.beans.pivotColsSvc)==null?void 0:t.columns;return this.pivotMode&&!!(e!=null&&e.length)}recreateColumnDefs(e){var i;if(!this.cols)return;(i=this.beans.autoColSvc)==null||i.updateColumns(e);const t=Ad(e.source);this.createColsFromColDefs(t)}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){var e;Bm(this.beans,(e=this.colDefCols)==null?void 0:e.tree),super.destroy()}getColTree(){var e;return((e=this.cols)==null?void 0:e.tree)??[]}getColDefColTree(){var e;return((e=this.colDefCols)==null?void 0:e.tree)??[]}getColDefCols(){var e;return((e=this.colDefCols)==null?void 0:e.list)??null}getCols(){var e;return((e=this.cols)==null?void 0:e.list)??[]}forAllCols(e){var o,r,a,l,c;const{pivotResultCols:t,autoColSvc:i,selectionColSvc:s,groupHierarchyColSvc:n}=this.beans;cu((o=this.colDefCols)==null?void 0:o.list,e),cu((r=i==null?void 0:i.columns)==null?void 0:r.list,e),cu((a=s==null?void 0:s.columns)==null?void 0:a.list,e),cu((l=n==null?void 0:n.columns)==null?void 0:l.list,e),cu((c=t==null?void 0:t.getPivotResultCols())==null?void 0:c.list,e)}getColsForKeys(e){return e?e.map(t=>this.getCol(t)).filter(t=>t!=null):[]}getColDefCol(e){var t;return(t=this.colDefCols)!=null&&t.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return e==null?null:this.getColFromCollection(e,this.cols)}getColById(e){var t;return((t=this.cols)==null?void 0:t.map[e])??null}getColFromCollection(e,t){if(t==null)return null;const{map:i,list:s}=t;if(typeof e=="string"&&i[e])return i[e];for(let a=0;a<s.length;a++)if(ju(s[a],e))return s[a];const{autoColSvc:n,selectionColSvc:o,groupHierarchyColSvc:r}=this.beans;return(n==null?void 0:n.getColumn(e))??(o==null?void 0:o.getColumn(e))??(r==null?void 0:r.getColumn(e))??null}},iT=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let i;return typeof t!="number"?i=0:i=t+1,this.existingIds[e]=i,i}};function Qf(e,t,i){return i&&e.addDestroyFunc(()=>t.destroyBean(i)),i??e}var se=null;function uR(e){return typeof(e==null?void 0:e.getGui)=="function"}var sT=class{constructor(e){this.cssClassStates={},this.getGui=e}toggleCss(e,t){var s;if(!e)return;if(e.indexOf(" ")>=0){const n=(e||"").split(" ");if(n.length>1){for(const o of n)this.toggleCss(o,t);return}}this.cssClassStates[e]!==t&&e.length&&((s=this.getGui())==null||s.classList.toggle(e,t),this.cssClassStates[e]=t)}},OG=0,Jf=class extends Do{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=OG++,this.cssManager=new sT(()=>this.eGui),this.componentSelectors=new Map((t??[]).map(i=>[i.selector,i])),e&&this.setTemplate(e)}preConstruct(){var t,i;this.wireTemplate(this.getGui());const e="component-"+((i=(t=Object.getPrototypeOf(this))==null?void 0:t.constructor)==null?void 0:i.name);for(const s of this.css??[])this.beans.environment.addGlobalCSS(s,e)}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getDataRefAttribute(e){return e.getAttribute?e.getAttribute(RP):null}applyElementsToComponent(e,t,i,s=null){if(t===void 0&&(t=this.getDataRefAttribute(e)),t){const n=this[t];if(n===se)this[t]=s??e;else{const o=i==null?void 0:i[t];if(!this.suppressDataRefValidation&&!o)throw new Error(`data-ref: ${t} on ${this.constructor.name} with ${n}`)}}}createChildComponentsFromTags(e,t){const i=[];for(const s of e.childNodes??[])i.push(s);for(const s of i){if(!(s instanceof HTMLElement))continue;const n=this.createComponentFromElement(s,o=>{const r=o.getGui();if(r)for(const a of s.attributes??[])r.setAttribute(a.name,a.value)},t);if(n){if(n.addItems&&s.children.length){this.createChildComponentsFromTags(s,t);const o=Array.prototype.slice.call(s.children);n.addItems(o)}this.swapComponentForNode(n,e,s)}else s.childNodes&&this.createChildComponentsFromTags(s,t)}}createComponentFromElement(e,t,i){const s=e.nodeName,n=this.getDataRefAttribute(e),o=s.indexOf("AG-")===0,r=o?this.componentSelectors.get(s):null;let a=null;if(r){const l=i&&n?i[n]:void 0;a=new r.component(l),a.setParentComponent(this),this.createBean(a,null,t)}else if(o)throw new Error(`selector: ${s}`);return this.applyElementsToComponent(e,n,i,a),a}swapComponentForNode(e,t,i){const s=e.getGui();t.replaceChild(s,i),t.insertBefore(document.createComment(i.nodeName),s),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e){const t=this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui());for(const i of e)i.setAttribute("tabindex",t.toString())}setTemplate(e,t,i){let s;typeof e=="string"||e==null?s=oS(e):s=Xf(e),this.setTemplateFromElement(s,t,i)}setTemplateFromElement(e,t,i,s=!1){if(this.eGui=e,this.suppressDataRefValidation=s,t)for(let n=0;n<t.length;n++){const o=t[n];this.componentSelectors.set(o.selector,o)}this.wireTemplate(e,i)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let i=t;return e==null?null:(i||(i=this.eGui),lS(e)?{element:e,parent:i}:{element:e.getGui(),parent:i})}prependChild(e,t){const{element:i,parent:s}=this.getContainerAndElement(e,t)||{};!i||!s||s.insertAdjacentElement("afterbegin",i)}appendChild(e,t){const{element:i,parent:s}=this.getContainerAndElement(e,t)||{};!i||!s||s.appendChild(i)}isDisplayed(){return this.displayed}setVisible(e,t={}){if(e!==this.visible){this.visible=e;const{skipAriaHidden:i}=t;mH(this.eGui,e,{skipAriaHidden:i})}}setDisplayed(e,t={}){if(e!==this.displayed){this.displayed=e;const{skipAriaHidden:i}=t;xt(this.eGui,e,{skipAriaHidden:i});const s={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(s)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),super.destroy()}addGuiEventListener(e,t,i){this.eGui.addEventListener(e,t,i),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,t))}addCss(e){this.cssManager.toggleCss(e,!0)}removeCss(e){this.cssManager.toggleCss(e,!1)}toggleCss(e,t){this.cssManager.toggleCss(e,t)}registerCSS(e){this.css||(this.css=[]),this.css.push(e)}},ct=class extends Jf{};function nT(e){return typeof e=="object"&&!!e.component}function NG(e,t){return new Ot(i=>{i(window.setInterval(e,t))})}var Ot=class ku{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(i=>this.onDone(i),i=>this.onReject(i))}static all(t){return t.length?new ku(i=>{let s=t.length;const n=new Array(s);t.forEach((o,r)=>{o.then(a=>{n[r]=a,s--,s===0&&i(n)})})}):ku.resolve()}static resolve(t=null){return new ku(i=>i(t))}then(t){return new ku(i=>{this.status===1?i(t(this.resolution)):this.waiters.push(s=>i(t(s)))})}onDone(t){this.status=1,this.resolution=t;for(const i of this.waiters)i(t)}onReject(t){}};function HG(e){return e?e.prototype&&"getGui"in e.prototype:!1}function oT(e,t,i,s){const{name:n}=i;let o,r,a,l,c,d;if(t){const h=t,u=h[n+"Selector"],f=u?u(s):null,p=m=>{typeof m=="string"?o=m:m!=null&&m!==!0&&(e.isFrameworkComponent(m)?a=m:r=m)};f?(p(f.component),l=f.params,c=f.popup,d=f.popupPosition):p(h[n])}return{compName:o,jsComp:r,fwComp:a,paramsFromSelector:l,popupFromSelector:c,popupPositionFromSelector:d}}var GG=class extends V{constructor(){super(...arguments),this.beanName="userCompFactory"}wireBeans(e){this.agCompUtils=e.agCompUtils,this.registry=e.registry,this.frameworkCompWrapper=e.frameworkCompWrapper,this.gridOptions=e.gridOptions}getCompDetailsFromGridOptions(e,t,i,s=!1){return this.getCompDetails(this.gridOptions,e,t,i,s)}getCompDetails(e,t,i,s,n=!1){var S;const{name:o,cellRenderer:r}=t;let{compName:a,jsComp:l,fwComp:c,paramsFromSelector:d,popupFromSelector:h,popupPositionFromSelector:u}=oT(this.beans.frameworkOverrides,e,t,s),f,p;const m=b=>{const E=this.registry.getUserComponent(o,b);E&&(l=E.componentFromFramework?void 0:E.component,c=E.componentFromFramework?E.component:void 0,f=E.params,p=E.processParams)};if(a!=null&&m(a),l==null&&c==null&&i!=null&&m(i),l&&r&&!HG(l)&&(l=(S=this.agCompUtils)==null?void 0:S.adaptFunction(t,l)),!l&&!c){const{validation:b}=this.beans;n&&(a!==i||!i)?a?b!=null&&b.isProvidedUserComp(a)||ut(50,{compName:a}):i?b||ut(260,{...this.gos.getModuleErrorParams(),propName:o,compName:i}):ut(216,{name:o}):i&&!b&&ut(146,{comp:i});return}const v=this.mergeParams(e,t,s,d,f,p),C=l==null,w=l??c;return{componentFromFramework:C,componentClass:w,params:v,type:t,popupFromSelector:h,popupPositionFromSelector:u,newAgStackInstance:()=>this.newAgStackInstance(w,C,v,t)}}newAgStackInstance(e,t,i,s){var a;const n=!t;let o;n?o=new e:o=this.frameworkCompWrapper.wrap(e,s.mandatoryMethods,s.optionalMethods,s),this.createBean(o);const r=(a=o.init)==null?void 0:a.call(o,i);return r==null?Ot.resolve(o):r.then(()=>o)}mergeParams(e,t,i,s=null,n,o){const r={...i,...n},a=e,l=a==null?void 0:a[t.name+"Params"];if(typeof l=="function"){const c=l(i);ts(r,c)}else typeof l=="object"&&ts(r,l);return ts(r,s),o?o(r):r}},BG={name:"dateComponent",mandatoryMethods:["getDate","setDate"],optionalMethods:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","refresh"]},VG={name:"dragAndDropImageComponent",mandatoryMethods:["setIcon","setLabel"]},zG={name:"headerComponent",optionalMethods:["refresh"]},WG={name:"innerHeaderComponent"},$G={name:"innerHeaderGroupComponent"},UG={name:"headerGroupComponent"},jG={name:"cellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},KG={name:"loadingCellRenderer",cellRenderer:!0},qG={name:"cellEditor",mandatoryMethods:["getValue"],optionalMethods:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},YG={name:"loadingOverlayComponent",optionalMethods:["refresh"]},XG={name:"noRowsOverlayComponent",optionalMethods:["refresh"]},QG={name:"tooltipComponent"},mS={name:"filter",mandatoryMethods:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethods:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},JG={name:"floatingFilterComponent",mandatoryMethods:["onParentModelChanged"],optionalMethods:["afterGuiAttached","refresh"]},ZG={name:"fullWidthCellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},e2={name:"loadingCellRenderer",cellRenderer:!0},t2={name:"groupRowRenderer",optionalMethods:["afterGuiAttached"],cellRenderer:!0},i2={name:"detailCellRenderer",optionalMethods:["refresh"],cellRenderer:!0};function s2(e,t){return e.getCompDetailsFromGridOptions(VG,"agDragAndDropImage",t,!0)}function n2(e,t,i){return e.getCompDetails(t,zG,"agColumnHeader",i)}function o2(e,t,i){return e.getCompDetails(t,WG,void 0,i)}function r2(e,t){const i=t.columnGroup.getColGroupDef();return e.getCompDetails(i,UG,"agColumnGroupHeader",t)}function a2(e,t,i){return e.getCompDetails(t,$G,void 0,i)}function l2(e,t){return e.getCompDetailsFromGridOptions(ZG,void 0,t,!0)}function c2(e,t){return e.getCompDetailsFromGridOptions(e2,"agLoadingCellRenderer",t,!0)}function d2(e,t){return e.getCompDetailsFromGridOptions(t2,"agGroupRowRenderer",t,!0)}function h2(e,t){return e.getCompDetailsFromGridOptions(i2,"agDetailCellRenderer",t,!0)}function gR(e,t,i){return e.getCompDetails(t,jG,void 0,i)}function fR(e,t,i){return e.getCompDetails(t,KG,"agSkeletonCellRenderer",i,!0)}function rT(e,t,i){return e.getCompDetails(t,qG,"agCellEditor",i,!0)}function u2(e,t,i,s){const n=t.filter;return nT(n)&&(t={filter:n.component,filterParams:t.filterParams}),e.getCompDetails(t,mS,s,i,!0)}function g2(e,t,i){return e.getCompDetails(t,BG,"agDateInput",i,!0)}function f2(e,t){return e.getCompDetailsFromGridOptions(YG,"agLoadingOverlay",t,!0)}function p2(e,t){return e.getCompDetailsFromGridOptions(XG,"agNoRowsOverlay",t,!0)}function m2(e,t){return e.getCompDetails(t.colDef,QG,"agTooltipComponent",t,!0)}function v2(e,t,i,s){return e.getCompDetails(t,JG,s,i)}function aT(e,t){return oT(e,t,mS)}function bC(e,t,i){return e.mergeParams(t,mS,i)}function fg(e){const t=e;return(t==null?void 0:t.getFrameworkComponentInstance)!=null?t.getFrameworkComponentInstance():e}function C2(e){return typeof e=="object"&&!!e.getComp}var H={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",ESCAPE:"Escape",SPACE:" ",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",DELETE:"Delete",F2:"F2",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",PAGE_HOME:"Home",PAGE_END:"End",A:"KeyA",C:"KeyC",D:"KeyD",V:"KeyV",X:"KeyX",Y:"KeyY",Z:"KeyZ"},vS=class extends Jf{isPopup(){return!0}setParentComponent(e){e.addCss("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;(e==null?void 0:e.isAlive())&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},yC,SC,RC,xC,qb,Yb,EC;function Xa(){return yC===void 0&&(yC=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),yC}function lT(){return SC===void 0&&(SC=/(firefox)/i.test(navigator.userAgent)),SC}function cT(){return RC===void 0&&(RC=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),RC}function Sc(){return xC===void 0&&(xC=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),xC}function Xb(e){if(!e)return null;const t=e.tabIndex,i=e.getAttribute("tabIndex");return t===-1&&(i===null||i===""&&!lT())?null:t.toString()}function w2(){if(EC!==void 0)return EC;if(!document.body)return-1;let e=1e6;const t=lT()?6e6:1e9,i=document.createElement("div");for(document.body.appendChild(i);;){const s=e*2;if(i.style.height=s+"px",s>t||i.clientHeight!==s)break;e=s}return i.remove(),EC=e,e}function b2(){return Yb==null&&dT(),Yb}function dT(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let i=t.offsetWidth-t.clientWidth;i===0&&t.clientWidth===0&&(i=null),t.parentNode&&t.remove(),i!=null&&(Yb=i,qb=i===0)}function hT(){return qb==null&&dT(),qb}var CS="T",y2=new RegExp(`[${CS} ]`),S2=new RegExp(`^\\d{4}-\\d{2}-\\d{2}(${CS}\\d{2}:\\d{2}:\\d{2}\\D?)?`);function vo(e,t){return e.toString().padStart(t,"0")}function Os(e,t=!0,i=CS){if(!e)return null;let s=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(n=>vo(n,2)).join("-");return t&&(s+=i+[e.getHours(),e.getMinutes(),e.getSeconds()].map(n=>vo(n,2)).join(":")),s}function mp(e,t=!0){return e?t?[String(e.getFullYear()),String(e.getMonth()+1),vo(e.getDate(),2),vo(e.getHours(),2),`:${vo(e.getMinutes(),2)}`,`:${vo(e.getSeconds(),2)}`]:[e.getFullYear(),e.getMonth()+1,vo(e.getDate(),2)].map(String):null}var AC=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"},pR=["January","February","March","April","May","June","July","August","September","October","November","December"],FC=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Qb(e,t){if(t==null)return Os(e,!1);const i=vo(e.getFullYear(),4),s={YYYY:()=>i.slice(i.length-4,i.length),YY:()=>i.slice(i.length-2,i.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>pR[e.getMonth()],MMM:()=>pR[e.getMonth()].slice(0,3),MM:()=>vo(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${AC(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${AC(e.getDate())}`,DD:()=>vo(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>FC[e.getDay()],ddd:()=>FC[e.getDay()].slice(0,3),dd:()=>FC[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${AC(e.getDay())}`,d:()=>`${e.getDay()}`},n=new RegExp(Object.keys(s).join("|"),"g");return t.replace(n,o=>o in s?s[o]():o)}function um(e,t=!1){return!!vs(e,t)}function R2(e){return um(e,!0)}function vs(e,t=!1,i){if(!e||!i&&!S2.test(e))return null;const[s,n]=e.split(y2);if(!s)return null;const o=s.split("-").map(f=>Number.parseInt(f,10));if(o.filter(f=>!isNaN(f)).length!==3)return null;const[r,a,l]=o,c=new Date(r,a-1,l);if(c.getFullYear()!==r||c.getMonth()!==a-1||c.getDate()!==l||!n&&t)return null;if(!n||n==="00:00:00")return c;const[d,h,u]=n.split(":").map(f=>Number.parseInt(f,10));if(d>=0&&d<24)c.setHours(d);else if(t)return null;if(h>=0&&h<60)c.setMinutes(h);else if(t)return null;if(u>=0&&u<60)c.setSeconds(u);else if(t)return null;return c}function Jb(e){const{inputValue:t,allSuggestions:i,hideIrrelevant:s,filterByPercentageOfBestMatch:n}=e;let o=(i??[]).map((l,c)=>({value:l,relevance:x2(t,l),idx:c}));if(o.sort((l,c)=>l.relevance-c.relevance),s&&(o=o.filter(l=>l.relevance<Math.max(l.value.length,t.length))),o.length>0&&n&&n>0){const c=o[0].relevance*n;o=o.filter(d=>c-d.relevance<0)}const r=[],a=[];for(const l of o)r.push(l.value),a.push(l.idx);return{values:r,indices:a}}function x2(e,t){e.length<t.length&&([e,t]=[t,e]);let i=[],s=[];const n=e.length,o=t.length;for(let a=0;a<=o;a++)i[a]=a;let r=0;for(let a=1;a<=n;a++){s[0]=a;for(let l=1;l<=o;l++){const c=e[a-1],d=t[l-1];if(c.toLocaleLowerCase()===d.toLocaleLowerCase())++r,c===d&&++r,a>1&&l>1&&e[a-2].toLocaleLowerCase()===t[l-2].toLocaleLowerCase()&&(++r,e[a-2]===t[l-2]&&++r),a<n/2-10&&++r,s[l]=i[l-1];else{const h=s[l-1],u=i[l],f=i[l-1];s[l]=1+Math.min(h,u,f)}}[i,s]=[s,i]}return i[o]/(r+1)}function uT(e){var i;return e.altKey||e.ctrlKey||e.metaKey?!1:((i=e.key)==null?void 0:i.length)===1}var Zb=!1,Wm=0;function E2(e){Wm>0||(e.addEventListener("keydown",$m),e.addEventListener("mousedown",$m))}function A2(e){Wm>0||(e.removeEventListener("keydown",$m),e.removeEventListener("mousedown",$m))}function $m(e){const t=Zb,i=e.type==="keydown";i&&(e.ctrlKey||e.metaKey||e.altKey)||t!==i&&(Zb=i)}function F2(e){const t=pi(e);return E2(t),Wm++,()=>{Wm--,A2(t)}}function P2(){return Zb}function Fd(e,t,i=!1){const s=pH;let n=mP;t&&(n+=", "+t),i&&(n+=', [tabindex="-1"]');const o=Array.prototype.slice.apply(e.querySelectorAll(s)).filter(l=>To(l)),r=Array.prototype.slice.apply(e.querySelectorAll(n));return r.length?((l,c)=>l.filter(d=>c.indexOf(d)===-1))(o,r):o}function kc(e,t=!1,i=!1,s=!1){const n=Fd(e,s?".ag-tab-guard":null,i),o=t?Ct(n):n[0];return o?(o.focus({preventScroll:!0}),!0):!1}function Kc(e,t,i,s){const n=Fd(t,i?':not([tabindex="-1"])':null),o=Dt(e);let r;i?r=n.findIndex(l=>l.contains(o)):r=n.indexOf(o);const a=r+(s?-1:1);return a<0||a>=n.length?null:n[a]}function gT(e,t=5){let i=0;for(;e&&Xb(e)===null&&++i<=t;)e=e.parentElement;return Xb(e)===null?null:e}var T2=".ag-label{white-space:nowrap}:where(.ag-ltr) .ag-label{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-label-align-right) .ag-label{order:1}:where(.ag-ltr) :where(.ag-label-align-right) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-rtl) :where(.ag-label-align-right) .ag-label{margin-right:var(--ag-spacing)}.ag-label-align-right>*{flex:none}.ag-label-align-top{align-items:flex-start;flex-direction:column;>*{align-self:stretch}}.ag-label-ellipsis{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-label-align-top) .ag-label{margin-bottom:calc(var(--ag-spacing)*.5)}",D2=class extends Jf{constructor(e,t,i){super(t,i),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{},this.registerCSS(T2)}postConstruct(){this.addCss("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:i,labelAlignment:s,disabled:n}=this.config;n!=null&&this.setDisabled(n),e!=null&&this.setLabelSeparator(e),t!=null&&this.setLabel(t),i!=null&&this.setLabelWidth(i),this.setLabelAlignment(s||this.labelAlignment),this.refreshLabel()}refreshLabel(){const{label:e,eLabel:t}=this;Mi(t),typeof e=="string"?t.innerText=e+this.labelSeparator:e&&t.appendChild(e),e===""?(xt(t,!1),Ha(t,"presentation")):(xt(t,!0),Ha(t,null))}setLabelSeparator(e){return this.labelSeparator===e?this:(this.labelSeparator=e,this.label!=null&&this.refreshLabel(),this)}getLabelId(){const e=this.eLabel;return e.id=e.id||`ag-${this.getCompId()}-label`,e.id}getLabel(){return this.label}setLabel(e){return this.label===e?this:(this.label=e,this.refreshLabel(),this)}setLabelAlignment(e){const i=this.getGui().classList;return i.toggle("ag-label-align-left",e==="left"),i.toggle("ag-label-align-right",e==="right"),i.toggle("ag-label-align-top",e==="top"),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return this.label==null?this:(_m(this.eLabel,e),this)}setDisabled(e){e=!!e;const t=this.getGui();return lg(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},fT=class extends D2{constructor(e,t,i,s){super(e,t,i),this.className=s}postConstruct(){super.postConstruct();const{width:e,value:t,onValueChange:i}=this.config;e!=null&&this.setWidth(e),t!=null&&this.setValue(t),i!=null&&this.onValueChange(i),this.className&&this.addCss(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){const e=this.getAriaElement(),t=this.getLabelId(),i=this.getLabel();i==null||i==""||ZN(e)!==null?ag(e,""):ag(e,t??"")}setAriaLabel(e){return zh(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return yo(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e?this:(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"}),this)}};function M2(e){return{tag:"div",role:"presentation",children:[{tag:"div",ref:"eLabel",cls:"ag-input-field-label"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-input-wrapper",role:"presentation",children:[{tag:e,ref:"eInput",cls:"ag-input-field-input"}]}]}}var gl=class extends fT{constructor(e,t,i="text",s="input"){super(e,(e==null?void 0:e.template)??M2(s),[],t),this.inputType=i,this.displayFieldTag=s,this.eLabel=se,this.eWrapper=se,this.eInput=se}postConstruct(){super.postConstruct(),this.setInputType(this.inputType);const{eLabel:e,eWrapper:t,eInput:i,className:s}=this;e.classList.add(`${s}-label`),t.classList.add(`${s}-input-wrapper`),i.classList.add(`${s}-input`),this.addCss("ag-input-field"),i.id=i.id||`ag-${this.getCompId()}-input`;const{inputName:n,inputWidth:o}=this.config;n!=null&&this.setInputName(n),o!=null&&this.setInputWidth(o),this.addInputListeners(),this.activateTabIndex([i])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(e){this.displayFieldTag==="input"&&(this.inputType=e,ks(this.eInput,"type",e))}getInputElement(){return this.eInput}setInputWidth(e){return _m(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){const t=this.eInput;return t.maxLength=e,this}setInputPlaceholder(e){return ks(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return zh(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return lg(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(e===!0)ks(this.eInput,"autocomplete",null);else{const t=typeof e=="string"?e:"off";ks(this.eInput,"autocomplete",t)}return this}},wS=class extends gl{constructor(e,t="ag-checkbox",i="checkbox"){super(e,t,i),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:e,passive:t}=this.config;typeof e=="boolean"&&this.setReadOnly(e),typeof t=="boolean"&&this.setPassive(t)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){const t=this.getInputElement();return t.name=e,this}isSelected(){return this.selected}setSelected(e,t){if(this.isSelected()===e)return;this.previousValue=this.isSelected(),e=this.selected=typeof e=="boolean"?e:void 0;const i=this.eInput;i.checked=e,i.indeterminate=e===void 0,t||this.dispatchChange(this.selected,this.previousValue)}dispatchChange(e,t,i){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:i});const s=this.getInputElement();this.eventSvc.dispatchEvent({type:"checkboxChanged",id:s.id,name:s.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),i=this.selected=e.target.checked;this.refreshSelectedClass(i),this.dispatchChange(i,t,e)}refreshSelectedClass(e){const t=this.eWrapper.classList;t.toggle("ag-checked",e===!0),t.toggle("ag-indeterminate",e==null)}},bS={selector:"AG-CHECKBOX",component:wS},I2=class extends wS{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){const t=this.eInput;e.selected&&e.name&&t.name&&t.name===e.name&&e.id&&t.id!==e.id&&this.setValue(!1,!0)}},qc=class extends gl{constructor(e,t="ag-text-field",i="text"){super(e,t,i)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){const i=this.eInput;return i.value!==e&&(i.value=ae(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){const e=new RegExp(`[${this.config.allowedCharPattern}]`),t=i=>{uT(i)&&i.key&&!e.test(i.key)&&i.preventDefault()};this.addManagedListeners(this.eInput,{keydown:t,paste:i=>{var n;const s=(n=i.clipboardData)==null?void 0:n.getData("text");s!=null&&s.split("").some(o=>!e.test(o))&&i.preventDefault()}})}},Vv={selector:"AG-INPUT-TEXT-FIELD",component:qc},k2=class extends gl{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){const i=super.setValue(e,t);return this.eInput.value=e,i}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}},_2={selector:"AG-INPUT-TEXT-AREA",component:k2},yS=class extends qc{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct();const e=this.eInput;this.addManagedListeners(e,{blur:()=>{const o=Number.parseFloat(e.value),r=isNaN(o)?"":this.normalizeValue(o.toString());this.value!==r&&this.setValue(r)},wheel:this.onWheel.bind(this)}),e.step="any";const{precision:t,min:i,max:s,step:n}=this.config;typeof t=="number"&&this.setPrecision(t),typeof i=="number"&&this.setMin(i),typeof s=="number"&&this.setMax(s),typeof n=="number"&&this.setStep(n)}onWheel(e){Dt(this.beans)===this.eInput&&e.preventDefault()}normalizeValue(e){return e===""?"":(this.precision!=null&&(e=this.adjustPrecision(e)),e)}adjustPrecision(e,t){const i=this.precision;if(i==null)return e;if(t){const n=Number.parseFloat(e).toFixed(i);return Number.parseFloat(n).toString()}const s=String(e).split(".");if(s.length>1){if(s[1].length<=i)return e;if(i>0)return`${s[0]}.${s[1].slice(0,i)}`}return s[0]}setMin(e){return this.min===e?this:(this.min=e,ks(this.eInput,"min",e),this)}setMax(e){return this.max===e?this:(this.max=e,ks(this.eInput,"max",e),this)}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e?this:(this.step=e,ks(this.eInput,"step",e),this)}setValue(e,t){return this.setValueOrInputValue(i=>super.setValue(i,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(t=>super.setValue(t,!0),t=>{this.eInput.value=t},e)}setValueOrInputValue(e,t,i){if(ae(i)){let s=this.isScientificNotation(i);if(s&&this.eInput.validity.valid)return e(i);if(!s){i=this.adjustPrecision(i);const n=this.normalizeValue(i);s=i!=n}if(s)return t(i)}return e(i)}getValue(){const e=this.eInput;if(!e.validity.valid)return;const t=e.value;return this.isScientificNotation(t)?this.adjustPrecision(t,!0):super.getValue()}isScientificNotation(e){return typeof e=="string"&&e.includes("e")}},L2={selector:"AG-INPUT-NUMBER-FIELD",component:yS},O2=class extends qc{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();const e=Xa();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){Dt(this.beans)===this.eInput&&e.preventDefault()}setMin(e){const t=e instanceof Date?Os(e??null,!!this.includeTime)??void 0:e;return this.min===t?this:(this.min=t,ks(this.eInput,"min",t),this)}setMax(e){const t=e instanceof Date?Os(e??null,!!this.includeTime)??void 0:e;return this.max===t?this:(this.max=t,ks(this.eInput,"max",t),this)}setStep(e){return this.step===e?this:(this.step=e,ks(this.eInput,"step",e),this)}setIncludeTime(e){return this.includeTime===e?this:(this.includeTime=e,super.setInputType(e?"datetime-local":"date"),e&&this.setStep(1),this)}getDate(){if(this.eInput.validity.valid)return vs(this.getValue())??void 0}setDate(e,t){this.setValue(Os(e??null,this.includeTime),t)}},pT={selector:"AG-INPUT-DATE-FIELD",component:O2},N2=".ag-list-item{align-items:center;display:flex;height:var(--ag-list-item-height);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;&.ag-active-item{background-color:var(--ag-row-hover-color)}}",H2="ag-active-item",G2=(e,t)=>({tag:"div",cls:`ag-list-item ag-${e}-list-item`,attrs:{role:"option"},children:[{tag:"span",ref:"eText",children:t}]}),B2=class extends Jf{constructor(e,t,i){super(G2(e,t)),this.label=t,this.value=i,this.eText=se}postConstruct(){this.createTooltip(),this.addEventListeners()}setHighlighted(e){const t=this.getGui();t.classList.toggle(H2,e),pP(t,e),this.dispatchLocalEvent({type:"itemHighlighted",highlighted:e})}getHeight(){return this.getGui().clientHeight}setIndex(e,t){const i=this.getGui();oH(i,e),nH(i,t)}createTooltip(){const e={getTooltipValue:()=>this.label,getGui:()=>this.getGui(),getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>rS(this.eText)},t=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("highlightTooltipFeature",!1,e,this));t&&(this.tooltipFeature=t)}addEventListeners(){const e=this.getParentComponent();e&&(this.addGuiEventListener("mouseover",()=>{e.highlightItem(this)}),this.addGuiEventListener("mousedown",t=>{t.preventDefault(),t.stopPropagation(),e.setValue(this.value)}))}},V2=class extends Jf{constructor(e="default"){super({tag:"div",cls:`ag-list ag-${e}-list`}),this.cssIdentifier=e,this.options=[],this.listItems=[],this.highlightedItem=null,this.registerCSS(N2)}postConstruct(){const e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()})}handleKeyDown(e){const t=e.key;switch(t){case H.ENTER:if(!this.highlightedItem)this.setValue(this.getValue());else{const i=this.listItems.indexOf(this.highlightedItem);this.setValueByIndex(i)}break;case H.DOWN:case H.UP:e.preventDefault(),this.navigate(t);break;case H.PAGE_DOWN:case H.PAGE_UP:case H.PAGE_HOME:case H.PAGE_END:e.preventDefault(),this.navigateToPage(t);break}}addOptions(e){for(const t of e)this.addOption(t);return this}addOption(e){const{value:t,text:i}=e,s=i??t;return this.options.push({value:t,text:s}),this.renderOption(t,s),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0);for(const e of this.listItems)e.destroy();Mi(this.getGui()),this.listItems=[],this.refreshAriaRole()}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(e==null)return this.reset(t),this;const i=this.options.findIndex(s=>s.value===e);if(i!==-1){const s=this.options[i];this.value=s.value,this.displayValue=s.text,this.highlightItem(this.listItems[i]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const e=this.options.findIndex(t=>t.value===this.value);e!==-1&&this.highlightItem(this.listItems[e])}highlightItem(e){const t=e.getGui();if(!To(t))return;this.clearHighlighted(),e.setHighlighted(!0),this.highlightedItem=e;const i=this.getGui(),{scrollTop:s,clientHeight:n}=i,{offsetTop:o,offsetHeight:r}=t;(o+r>s+n||o<s)&&t.scrollIntoView({block:"nearest"})}hideItemTooltip(){var e,t;(t=(e=this.highlightedItem)==null?void 0:e.tooltipFeature)==null||t.attemptToHideTooltip()}destroy(){this.hideItemTooltip(),super.destroy()}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}clearHighlighted(){var e;(e=this.highlightedItem)==null||e.setHighlighted(!1),this.highlightedItem=null}renderOption(e,t){const i=new B2(this.cssIdentifier,t,e);i.setParentComponent(this);const s=this.createManagedBean(i);this.listItems.push(s),this.getGui().appendChild(s.getGui())}navigate(e){const t=e===H.DOWN;let i;const{listItems:s,highlightedItem:n}=this;if(!n)i=t?s[0]:Ct(s);else{let r=s.indexOf(n)+(t?1:-1);r=Math.min(Math.max(r,0),s.length-1),i=s[r]}this.highlightItem(i)}navigateToPage(e){const{listItems:t,highlightedItem:i}=this;if(!i||t.length===0)return;const s=t.indexOf(i),n=this.options.length-1,o=t[0].getHeight(),r=Math.floor(this.getGui().clientHeight/o);let a=-1;e===H.PAGE_HOME?a=0:e===H.PAGE_END?a=n:e===H.PAGE_DOWN?a=Math.min(s+r,n):e===H.PAGE_UP&&(a=Math.max(s-r,0)),a!==-1&&this.highlightItem(t[a])}refreshAriaRole(){Ha(this.getGui(),this.options.length===0?"presentation":"listbox")}updateIndices(){this.refreshAriaRole();const e=this.listItems,t=e.length;e.forEach((i,s)=>{i.setIndex(s+1,t)})}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},z2=".ag-picker-field-display{flex:1 1 auto}.ag-picker-field{align-items:center;display:flex}.ag-picker-field-icon{border:0;cursor:pointer;display:flex;margin:0;padding:0}.ag-picker-field-wrapper{background-color:var(--ag-picker-button-background-color);border:var(--ag-picker-button-border);border-radius:5px;min-height:max(var(--ag-list-item-height),calc(var(--ag-spacing)*4));overflow:hidden;&:where(.ag-picker-has-focus),&:where(:focus-within){background-color:var(--ag-picker-button-focus-background-color);border:var(--ag-picker-button-focus-border);box-shadow:var(--ag-focus-shadow);&:where(.invalid){box-shadow:var(--ag-focus-error-shadow)}}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:disabled{opacity:.5}}",W2={tag:"div",cls:"ag-picker-field",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-picker-field-wrapper ag-picker-collapsed",children:[{tag:"div",ref:"eDisplayField",cls:"ag-picker-field-display"},{tag:"div",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},$2=class extends fT{constructor(e){if(super(e,(e==null?void 0:e.template)||W2,(e==null?void 0:e.agComponents)||[],e==null?void 0:e.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=se,this.eWrapper=se,this.eDisplayField=se,this.eIcon=se,this.registerCSS(z2),this.ariaRole=e==null?void 0:e.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;const{pickerGap:t,maxPickerHeight:i,variableWidth:s,minPickerWidth:n,maxPickerWidth:o}=e;t!=null&&(this.pickerGap=t),this.variableWidth=!!s,i!=null&&this.setPickerMaxHeight(i),n!=null&&this.setPickerMinWidth(n),o!=null&&this.setPickerMaxWidth(o)}postConstruct(){super.postConstruct(),this.setupAria();const e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);const t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});const{pickerIcon:i,inputWidth:s}=this.config;if(i){const n=this.beans.iconSvc.createIconNoSpan(i);n&&this.eIcon.appendChild(n)}s!=null&&this.setInputWidth(s)}setupAria(){const e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),Bb(e,!1),this.ariaRole&&Ha(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const t=this.getFocusableElement();if(t!==this.eWrapper&&(e==null?void 0:e.target)===t)return;e.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case H.UP:case H.DOWN:case H.ENTER:case H.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case H.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));const t=this.getLocaleTextFunc(),{config:{pickerAriaLabelKey:i,pickerAriaLabelValue:s,modalPicker:n=!0},maxPickerHeight:o,minPickerWidth:r,maxPickerWidth:a,variableWidth:l,beans:c,eWrapper:d}=this,h={modal:n,eChild:e,closeOnEsc:!0,closedCallback:()=>{const m=lP(c);this.beforeHidePicker(),m&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(i,s),anchorToElement:d};e.style.position="absolute";const u=c.popupSvc,f=u.addPopup(h);l?(r&&(e.style.minWidth=r),e.style.width=aS(Mm(d)),a&&(e.style.maxWidth=a)):_m(e,a??Mm(d));const p=o??`${nS(u.getPopupParent())}px`;return e.style.setProperty("max-height",p),this.alignPickerToComponent(),f.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerGap:e,config:{pickerType:t},beans:{popupSvc:i,gos:s},eWrapper:n,pickerComponent:o}=this,r=s.get("enableRtl")?"right":"left";i.positionPopupByComponent({type:t,eventSource:n,ePopup:o.getGui(),position:"under",alignSide:r,keepWithinBounds:!0,nudgeY:e})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;const t=this.getAriaElement();Bb(t,e);const i=this.eWrapper.classList;i.toggle("ag-picker-expanded",e),i.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){var t;(t=this.pickerComponent)!=null&&t.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&(this.hideCurrentPicker(),this.dispatchLocalEvent({type:"pickerHidden"}))}setInputWidth(e){return _m(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return typeof e=="number"&&(e=`${e}px`),this.minPickerWidth=e??void 0,this}setPickerMaxWidth(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerWidth=e??void 0,this}setPickerMaxHeight(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerHeight=e??void 0,this}destroy(){this.hidePicker(),super.destroy()}},U2=".ag-select{align-items:center;display:flex;&.ag-disabled{opacity:.5}}:where(.ag-select){.ag-picker-field-wrapper{cursor:default}&.ag-disabled .ag-picker-field-wrapper:focus{box-shadow:none}&:not(.ag-cell-editor,.ag-label-align-top){min-height:var(--ag-list-item-height)}.ag-picker-field-display{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-picker-field-icon{align-items:center;display:flex}}:where(.ag-ltr) :where(.ag-select){.ag-picker-field-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding)/2);padding-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-select){.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:calc(var(--ag-cell-horizontal-padding)/2)}}.ag-select-list{background-color:var(--ag-picker-list-background-color);border:var(--ag-picker-list-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);overflow:hidden auto}.ag-select-list-item{cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none;:where(span){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}}:where(.ag-ltr) .ag-select-list-item{padding-left:calc(var(--ag-cell-horizontal-padding)/2)}:where(.ag-rtl) .ag-select-list-item{padding-right:calc(var(--ag-cell-horizontal-padding)/2)}",SS=class extends $2{constructor(e){super({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"selectOpen",ariaRole:"combobox",...e}),this.registerCSS(U2)}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{shouldDisplayTooltip:rm(()=>this.eDisplayField),getGui:()=>this.getGui()})),super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options:e,value:t,placeholder:i}=this.config;e!=null&&this.addOptions(e),t!=null&&this.setValue(t,!0),i&&t==null&&(this.eDisplayField.textContent=i),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){const e=this.createBean(new V2("select"));this.listComponent=e,e.setParentComponent(this);const t=e.getAriaElement(),i=`ag-select-list-${e.getCompId()}`;t.setAttribute("id",i),fH(this.getAriaElement(),t),e.addManagedElementListeners(e.getGui(),{mousedown:s=>{s==null||s.preventDefault()}}),e.addManagedListeners(e,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})},fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}beforeHidePicker(){var e;(e=this.listComponent)==null||e.hideItemTooltip(),super.beforeHidePicker()}onKeyDown(e){var i;const{key:t}=e;switch(t===H.TAB&&this.hidePicker(),t){case H.ENTER:case H.UP:case H.DOWN:case H.PAGE_UP:case H.PAGE_DOWN:case H.PAGE_HOME:case H.PAGE_END:e.preventDefault(),this.isPickerDisplayed?(i=this.listComponent)==null||i.handleKeyDown(e):super.onKeyDown(e);break;case H.ESCAPE:super.onKeyDown(e);break;case H.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e);break}}showPicker(){const e=this.listComponent;e&&(super.showPicker(),e.refreshHighlighted())}addOptions(e){for(const t of e)this.addOption(t);return this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){var e;return(e=this.listComponent)==null||e.clearOptions(),this.setValue(void 0,!0),this}setValue(e,t,i){const{listComponent:s,config:{placeholder:n},eDisplayField:o,tooltipFeature:r}=this;if(this.value===e||!s)return this;if(i||s.setValue(e,!0),s.getValue()===this.getValue())return this;let l=s.getDisplayValue();return l==null&&n&&(l=n),o.textContent=l,r==null||r.setTooltipAndRefresh(l??null),super.setValue(e,t)}destroy(){this.listComponent=this.destroyBean(this.listComponent),super.destroy()}},j2={selector:"AG-SELECT",component:SS},K2=':where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart),:where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]){box-sizing:border-box;&:after,&:before{box-sizing:border-box}&:where(div,span,label):focus-visible{box-shadow:inset var(--ag-focus-shadow);outline:none;&:where(.invalid){box-shadow:inset var(--ag-focus-error-shadow)}}&:where(button){color:inherit}}:where(.ag-root-wrapper,ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]) ::-ms-clear{display:none}.ag-hidden{display:none!important}.ag-invisible{visibility:hidden!important}.ag-popup-child{top:0;z-index:5;&:where(:not(.ag-tooltip-custom)){box-shadow:var(--ag-popup-shadow)}}.ag-input-wrapper,.ag-picker-field-wrapper{align-items:center;display:flex;flex:1 1 auto;line-height:normal;position:relative}.ag-input-field{align-items:center;display:flex;flex-direction:row}.ag-input-field-input:where(:not([type=checkbox],[type=radio])){flex:1 1 auto;min-width:0;width:100%}.ag-chart,.ag-dnd-ghost,.ag-external,.ag-popup,.ag-root-wrapper{cursor:default;line-height:normal;white-space:normal;-webkit-font-smoothing:antialiased;background-color:var(--ag-background-color);color:var(--ag-text-color);color-scheme:var(--ag-browser-color-scheme);font-family:var(--ag-font-family);font-size:var(--ag-font-size);--ag-indentation-level:0}:where(.ag-icon):before{align-items:center;background-color:currentcolor;color:inherit;content:"";display:flex;font-family:inherit;font-size:var(--ag-icon-size);font-style:normal;font-variant:normal;height:var(--ag-icon-size);justify-content:center;line-height:var(--ag-icon-size);-webkit-mask-size:contain;mask-size:contain;text-transform:none;width:var(--ag-icon-size)}.ag-icon{background-position:50%;background-repeat:no-repeat;background-size:contain;color:var(--ag-icon-color);display:block;height:var(--ag-icon-size);position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-icon-size)}.ag-disabled,[disabled]{.ag-icon{opacity:.5}&.ag-icon-grip{opacity:.35}}.ag-resizer{pointer-events:none;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none;z-index:1}:where(.ag-resizer){&.ag-resizer-topLeft{cursor:nwse-resize;height:5px;left:0;top:0;width:5px}&.ag-resizer-top{cursor:ns-resize;height:5px;left:5px;right:5px;top:0}&.ag-resizer-topRight{cursor:nesw-resize;height:5px;right:0;top:0;width:5px}&.ag-resizer-right{bottom:5px;cursor:ew-resize;right:0;top:5px;width:5px}&.ag-resizer-bottomRight{bottom:0;cursor:nwse-resize;height:5px;right:0;width:5px}&.ag-resizer-bottom{bottom:0;cursor:ns-resize;height:5px;left:5px;right:5px}&.ag-resizer-bottomLeft{bottom:0;cursor:nesw-resize;height:5px;left:0;width:5px}&.ag-resizer-left{bottom:5px;cursor:ew-resize;left:0;top:5px;width:5px}}',xx,Ex,RS=typeof window!="object"||!((Ex=(xx=window==null?void 0:window.document)==null?void 0:xx.fonts)!=null&&Ex.forEach),Uh=(e,t,i,s,n,o)=>{if(RS)return;s&&(e=`@layer ${CSS.escape(s)} { ${e} }`);let r=Pd.map.get(t);if(r||(r=[],Pd.map.set(t,r)),r.some(d=>d.css===e))return;const a=document.createElement("style");o&&a.setAttribute("nonce",o),a.dataset.agGlobalCss=i,a.textContent=e;const l={css:e,el:a,priority:n};let c;for(const d of r){if(d.priority>n)break;c=d}if(c){c.el.insertAdjacentElement("afterend",a);const d=r.indexOf(c);r.splice(d+1,0,l)}else t.insertBefore(a,t.querySelector(":not(title, meta)")),r.push(l)},mT=(e,t,i,s)=>{Uh(K2,e,"shared",t,0,i),s==null||s.forEach((n,o)=>n.forEach(r=>Uh(r,e,o,t,0,i)))},q2=e=>{Pd.grids.add(e)},Y2=e=>{if(Pd.grids.delete(e),Pd.grids.size===0){Pd.map=new WeakMap;for(const t of document.head.querySelectorAll("style[data-ag-global-css]"))t.remove()}},mR,Pd=(mR=typeof window=="object"?window:{}).agStyleInjectionState??(mR.agStyleInjectionState={map:new WeakMap,grids:new Set}),Ro=e=>new vT(e),jr="$default",X2=0,vT=class{constructor({feature:e,params:t,modeParams:i={},css:s,cssImports:n}){this.feature=e,this.css=s,this.cssImports=n,this.modeParams={[jr]:{...i[jr]??{},...t??{}},...i}}use(e,t,i){let s=this._inject;if(s==null){let{css:n}=this;if(n){const o=`ag-theme-${this.feature??"part"}-${++X2}`;typeof n=="function"&&(n=n()),n=`:where(.${o}) {
${n}
}
`;for(const r of this.cssImports??[])n=`@import url(${JSON.stringify(r)});
${n}`;s={css:n,class:o}}else s=!1;this._inject=s}return s&&e&&Uh(s.css,e,s.class,t,1,i),s?s.class:!1}},Q2=e=>e.replace(/[A-Z]/g,t=>`-${t}`).toLowerCase(),CT=e=>`--ag-${Q2(e)}`,xo=e=>`var(${CT(e)})`,J2=(e,t,i)=>Math.max(t,Math.min(i,e)),Z2=e=>{const t=new Map;return i=>{const s=i;return t.has(s)||t.set(s,e(i)),t.get(s)}},$n=e=>({ref:"accentColor",mix:e}),Vs=e=>({ref:"foregroundColor",mix:e}),Js=e=>({ref:"foregroundColor",mix:e,onto:"backgroundColor"}),eB=e=>({ref:"foregroundColor",mix:e,onto:"headerBackgroundColor"}),fs={ref:"backgroundColor"},gd={ref:"foregroundColor"},pr={ref:"accentColor"},Um={backgroundColor:"#fff",foregroundColor:"#181d1f",borderColor:Vs(.15),chromeBackgroundColor:Js(.02),browserColorScheme:"light"},tB={...Um,textColor:gd,accentColor:"#2196f3",invalidColor:"#e02525",fontFamily:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue","sans-serif"],subtleTextColor:{ref:"textColor",mix:.5},borderWidth:1,borderRadius:4,spacing:8,fontSize:14,focusShadow:{spread:3,color:$n(.5)},focusErrorShadow:{spread:3,color:{ref:"invalidColor",onto:"backgroundColor",mix:.5}},popupShadow:"0 0 16px #00000026",cardShadow:"0 1px 4px 1px #00000018",dropdownShadow:{ref:"cardShadow"},listItemHeight:{calc:"max(iconSize, dataFontSize) + widgetVerticalSpacing"},dragAndDropImageBackgroundColor:fs,dragAndDropImageBorder:!0,dragAndDropImageNotAllowedBorder:{color:{ref:"invalidColor",onto:"dragAndDropImageBackgroundColor",mix:.5}},dragAndDropImageShadow:{ref:"popupShadow"},iconSize:16,iconColor:"inherit",toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonOnBackgroundColor:pr,toggleButtonOffBackgroundColor:Js(.3),toggleButtonSwitchBackgroundColor:fs,toggleButtonSwitchInset:2,tooltipBackgroundColor:{ref:"chromeBackgroundColor"},tooltipErrorBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.1},tooltipTextColor:{ref:"textColor"},tooltipErrorTextColor:{ref:"invalidColor"},tooltipBorder:!0,tooltipErrorBorder:{color:{ref:"invalidColor",onto:"backgroundColor",mix:.25}}},iB=["colorScheme","color","length","scale","borderStyle","border","shadow","image","fontFamily","fontWeight","duration"],sB=Z2(e=>(e=e.toLowerCase(),iB.find(t=>e.endsWith(t.toLowerCase()))??"length")),zv=e=>typeof e=="object"&&(e!=null&&e.ref)?xo(e.ref):typeof e=="string"?e:typeof e=="number"?String(e):!1,xS=e=>{if(typeof e=="string")return e;if(e&&"ref"in e){const t=xo(e.ref);return e.mix==null?t:`color-mix(in srgb, ${e.onto?xo(e.onto):"transparent"}, ${t} ${J2(e.mix*100,0,100)}%)`}return!1},nB=zv,fd=e=>typeof e=="string"?e:typeof e=="number"?`${e}px`:e&&"calc"in e?`calc(${e.calc.replace(/ ?[*/+] ?/g," $& ").replace(/-?\b[a-z][a-z0-9]*\b(?![-(])/gi,i=>i[0]==="-"?i:" "+xo(i)+" ")})`:e&&"ref"in e?xo(e.ref):!1,oB=zv,ey=(e,t)=>typeof e=="string"?e:e===!0?ey({},t):e===!1?t==="columnBorder"?ey({color:"transparent"},t):"none":e&&"ref"in e?xo(e.ref):wT(e.style??"solid")+" "+fd(e.width??{ref:"borderWidth"})+" "+xS(e.color??{ref:"borderColor"}),rB=e=>typeof e=="string"?e:e===!1?"none":e&&"ref"in e?xo(e.ref):[fd(e.offsetX??0),fd(e.offsetY??0),fd(e.radius??0),fd(e.spread??0),xS(e.color??{ref:"foregroundColor"})].join(" "),wT=zv,bT=e=>typeof e=="string"?e.includes(",")?e:vR(e):e&&"googleFont"in e?bT(e.googleFont):e&&"ref"in e?xo(e.ref):Array.isArray(e)?e.map(t=>(typeof t=="object"&&"googleFont"in t&&(t=t.googleFont),vR(t))).join(", "):!1,vR=e=>/^[\w-]+$|\w\(/.test(e)?e:JSON.stringify(e),aB=zv,yT=e=>typeof e=="string"?e:e&&"url"in e?`url(${JSON.stringify(e.url)})`:e&&"svg"in e?yT({url:`data:image/svg+xml,${encodeURIComponent(e.svg)}`}):e&&"ref"in e?xo(e.ref):!1,lB=(e,t,i)=>typeof e=="string"?e:typeof e=="number"?(e>=10&&i.warn(104,{value:e,param:t}),`${e}s`):e&&"ref"in e?xo(e.ref):!1,cB={color:xS,colorScheme:nB,length:fd,scale:oB,border:ey,borderStyle:wT,shadow:rB,image:yT,fontFamily:bT,fontWeight:aB,duration:lB},dB=(e,t,i)=>{const s=sB(e);return cB[s](t,e,i)},hB=e=>new ST(e),ST=class RT{constructor(t,i=[]){this.themeLogger=t,this.parts=i}withPart(t){return typeof t=="function"&&(t=t()),t instanceof vT?new RT(this.themeLogger,[...this.parts,t]):(this.themeLogger.preInitErr(259,"Invalid part",{part:t}),this)}withoutPart(t){return this.withPart(Ro({feature:t}))}withParams(t,i=jr){return this.withPart(Ro({modeParams:{[i]:t}}))}_startUse({styleContainer:t,cssLayer:i,nonce:s,loadThemeGoogleFonts:n,moduleCss:o}){if(RS)return;gB(),mT(t,i,s,o);const r=uB(this);if(r.length>0)for(const a of r)n&&fB(a,s);for(const a of this.parts)a.use(t,i,s)}_getCssClass(){return this._cssClassCache??(this._cssClassCache=CR(this.parts).map(t=>t.use(void 0,void 0,void 0)).filter(Boolean).join(" "))}_getModeParams(){let t=this._paramsCache;if(!t){const i={[jr]:{...tB}};for(const s of CR(this.parts))for(const n of Object.keys(s.modeParams)){const o=s.modeParams[n];if(o){const r=i[n]??(i[n]={}),a=new Set;for(const l of Object.keys(o)){const c=o[l];c!==void 0&&(r[l]=c,a.add(l))}if(n===jr)for(const l of Object.keys(i)){const c=i[l];if(l!==jr)for(const d of a)delete c[d]}}}this._paramsCache=t=i}return t}_getPerInstanceCss(t){const i="##SELECTOR##";let s=this._paramsCssCache;if(!s){let n="",o="";const r=this._getModeParams();for(const l of Object.keys(r)){const c=r[l];if(l!==jr){const h=`:where([data-ag-theme-mode="${typeof CSS=="object"?CSS.escape(l):l}"]) & {
`;n+=h,o+=h}for(const d of Object.keys(c).sort()){const h=c[d],u=dB(d,h,this.themeLogger);if(u===!1)this.themeLogger.error(107,{key:d,value:h});else{const f=CT(d),p=f.replace("--ag-","--ag-inherited-");n+=`	${f}: var(${p}, ${u});
`,o+=`	${p}: var(${f});
`}}l!==jr&&(n+=`}
`,o+=`}
`)}let a=`${i} {
${n}}
`;a+=`:has(> ${i}):not(${i}) {
${o}}
`,this._paramsCssCache=s=a}return s.replaceAll(i,`:where(.${t})`)}},CR=e=>{const t=new Map;for(const s of e)t.set(s.feature,s);const i=[];for(const s of e)(!s.feature||t.get(s.feature)===s)&&i.push(s);return i},uB=e=>{const t=new Set,i=o=>{if(Array.isArray(o))o.forEach(i);else{const r=o==null?void 0:o.googleFont;typeof r=="string"&&t.add(r)}};return Object.values(e._getModeParams()).flatMap(o=>Object.values(o)).forEach(i),Array.from(t).sort()},wR=!1,gB=()=>{if(!wR){wR=!0;for(const e of Array.from(document.head.querySelectorAll('style[data-ag-scope="legacy"]')))e.remove()}},fB=async(e,t)=>{const i=`@import url('https://${pB}/css2?family=${encodeURIComponent(e)}:wght@100;200;300;400;500;600;700;800;900&display=swap');
`;Uh(i,document.head,`googleFont:${e}`,void 0,0,t)},pB="fonts.googleapis.com",mB=1,vB=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,this.instanceId=mB++,e!=null&&e.beanClasses&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){this.id=e.id,this.beans.context=this,this.destroyCallback=e.destroyCallback;for(const t of Object.keys(e.providedBeanInstances))this.beans[t]=e.providedBeanInstances[t];for(const t of e.beanClasses){const i=new t;i.beanName?this.beans[i.beanName]=i:console.error(`Bean ${t.name} is missing beanName`),this.createdBeans.push(i)}for(const t of e.derivedBeans??[]){const{beanName:i,bean:s}=t(this);this.beans[i]=s,this.createdBeans.push(s)}e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){return this.initBeans([e],t),e}initBeans(e,t){var s,n,o,r;const i=this.beans;for(const a of e)(s=a.preWireBeans)==null||s.call(a,i),(n=a.wireBeans)==null||n.call(a,i);for(const a of e)(o=a.preConstruct)==null||o.call(a);t&&e.forEach(t);for(const a of e)(r=a.postConstruct)==null||r.call(a)}getBeans(){return this.beans}getBean(e){return this.beans[e]}getId(){return this.id}destroy(){var t;if(this.destroyed)return;this.destroyed=!0;const e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[],(t=this.destroyCallback)==null||t.call(this)}destroyBean(e){var t;(t=e==null?void 0:e.destroy)==null||t.call(e)}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},CB=0,wB=class extends Do{constructor(){super(...arguments),this.beanName="environment",this.paramsClass=`ag-theme-params-${++CB}`,this.globalCSS=[]}wireBeans(e){this.eRootDiv=e.eRootDiv}postConstruct(){const{gos:e,eRootDiv:t}=this;e.setInstanceDomData(t),this.eStyleContainer=e.get("themeStyleContainer")??(t.getRootNode()===document?document.head:t),this.cssLayer=e.get("themeCssLayer"),this.styleNonce=e.get("styleNonce"),this.addManagedPropertyListener("theme",()=>this.handleThemeChange()),this.handleThemeChange(),this.initVariables(),this.addDestroyFunc(()=>Y2(this)),this.mutationObserver=new MutationObserver(()=>{this.fireStylesChangedEvent("themeChanged")}),this.addDestroyFunc(()=>this.mutationObserver.disconnect())}applyThemeClasses(e,t=[]){const{theme:i}=this;let s;i?s=`${this.paramsClass} ${i._getCssClass()}`:s=this.applyLegacyThemeClasses();for(const n of Array.from(e.classList))n.startsWith("ag-theme-")&&e.classList.remove(n);if(s){const n=e.className;e.className=`${n}${n?" ":""}${s}${t!=null&&t.length?" "+t.join(" "):""}`}}applyLegacyThemeClasses(){let e="";this.mutationObserver.disconnect();let t=this.eRootDiv;for(;t;){let i=!1;for(const s of Array.from(t.classList))s.startsWith("ag-theme-")&&(i=!0,e=e?`${e} ${s}`:s);i&&this.mutationObserver.observe(t,{attributes:!0,attributeFilter:["class"]}),t=t.parentElement}return e}addGlobalCSS(e,t){this.theme?Uh(e,this.eStyleContainer,t,this.cssLayer,0,this.styleNonce):this.globalCSS.push([e,t])}handleThemeChange(){const{gos:e,theme:t}=this,i=e.get("theme");let s;if(i==="legacy")s=void 0;else{const n=i??this.getDefaultTheme();n instanceof ST?s=n:this.themeError(n)}s!==t&&this.handleNewTheme(s),this.postProcessThemeChange(s,i)}handleNewTheme(e){const{gos:t,eRootDiv:i,globalCSS:s}=this,n=this.getAdditionalCss();if(e){q2(this),mT(this.eStyleContainer,this.cssLayer,this.styleNonce,n);for(const[r,a]of s)Uh(r,this.eStyleContainer,a,this.cssLayer,0,this.styleNonce);s.length=0}this.theme=e,e==null||e._startUse({loadThemeGoogleFonts:t.get("loadThemeGoogleFonts"),styleContainer:this.eStyleContainer,cssLayer:this.cssLayer,nonce:this.styleNonce,moduleCss:n});let o=this.eParamsStyle;if(!o){o=this.eParamsStyle=Xf({tag:"style"});const r=t.get("styleNonce");r&&o.setAttribute("nonce",r),i.appendChild(o)}RS||(o.textContent=(e==null?void 0:e._getPerInstanceCss(this.paramsClass))||""),this.applyThemeClasses(i),this.fireStylesChangedEvent("themeChanged")}},bB=class extends Do{constructor(){super(...arguments),this.beanName="registry"}registerDynamicBeans(e){if(e){this.dynamicBeans??(this.dynamicBeans={});for(const t of Object.keys(e))this.dynamicBeans[t]=e[t]}}createDynamicBean(e,t,...i){if(!this.dynamicBeans)throw new Error(this.getDynamicError(e,!0));const s=this.dynamicBeans[e];if(s==null){if(t)throw new Error(this.getDynamicError(e,!1));return}return new s(...i)}},yB=class extends Do{constructor(){super(...arguments),this.beanName="eventSvc",this.eventServiceType="global",this.globalSvc=new Mc}addListener(e,t,i){this.globalSvc.addEventListener(e,t,i)}removeListener(e,t,i){this.globalSvc.removeEventListener(e,t,i)}addGlobalListener(e,t=!1){this.globalSvc.addGlobalListener(e,t)}removeGlobalListener(e,t=!1){this.globalSvc.removeGlobalListener(e,t)}dispatchEvent(e){this.globalSvc.dispatchEvent(this.gos.addCommon(e))}dispatchEventOnce(e){this.globalSvc.dispatchEventOnce(this.gos.addCommon(e))}},xT=class extends Do{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}postConstruct(){this.refreshTooltip()}setBrowserTooltip(e,t){const i="title",s=this.ctrl.getGui();s&&(e!=null&&(e!=""||t)?s.setAttribute(i,e):s.removeAttribute(i))}updateTooltipText(){const{getTooltipValue:e}=this.ctrl;e&&(this.tooltip=e())}createTooltipFeatureIfNeeded(){if(this.tooltipManager==null){const e=this.beans.registry.createDynamicBean("tooltipStateManager",!0,this.ctrl,()=>this.tooltip);e&&(this.tooltipManager=this.createBean(e,this.beans.context))}}attemptToShowTooltip(){var e;(e=this.tooltipManager)==null||e.prepareToShowTooltip()}attemptToHideTooltip(){var e;(e=this.tooltipManager)==null||e.hideTooltip()}setTooltipAndRefresh(e){this.tooltip=e,this.refreshTooltip()}refreshTooltip(e){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)):(this.setBrowserTooltip(e?"":null,e),this.createTooltipFeatureIfNeeded())}destroy(){this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context),super.destroy()}},SB=1e3,RB=1e3,bR=100,yR,vp=!1,xB=class extends Do{constructor(e,t){super(),this.tooltipCtrl=e,this.getTooltipValue=t,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(e){this.popupSvc=e.popupSvc}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");const e=this.tooltipCtrl.getGui();this.tooltipTrigger===0&&this.addManagedListeners(e,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.tooltipTrigger===1&&this.addManagedListeners(e,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(e,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(e,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(e){const t=this.gos.get(e);return Math.max(200,t)}getTooltipDelay(e){var t,i,s,n;return e==="show"?((i=(t=this.tooltipCtrl).getTooltipShowDelayOverride)==null?void 0:i.call(t))??this.getGridOptionsTooltipDelay("tooltipShowDelay"):((n=(s=this.tooltipCtrl).getTooltipHideDelayOverride)==null?void 0:n.call(s))??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const e=this.gos.get("tooltipTrigger");return!e||e==="hover"?0:1}onMouseEnter(e){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!Sc()&&(vp?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(e)},bR):this.prepareToShowTooltip(e))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){var n;const t=e.relatedTarget,i=this.tooltipCtrl.getGui(),s=(n=this.tooltipComp)==null?void 0:n.getGui();this.isInteractingWithTooltip||i.contains(t)||this.interactionEnabled&&(s!=null&&s.contains(t))||this.setToDoNothing()}onKeyDown(){this.isInteractingWithTooltip&&(this.isInteractingWithTooltip=!1),this.setToDoNothing()}prepareToShowTooltip(e){if(this.state!=0||vp)return;let t=0;e&&(t=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=e||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),t),this.state=1}isLastTooltipHiddenRecently(){return Date.now()-yR<SB}setToDoNothing(e){!e&&this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.clearEventHandlers(),this.onDocumentKeyDownCallback&&(this.onDocumentKeyDownCallback(),this.onDocumentKeyDownCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){var n,o;const e=this.getTooltipValue(),t=this.tooltipCtrl;if(!ae(e)||t.shouldDisplayTooltip&&!t.shouldDisplayTooltip()){this.setToDoNothing();return}const i=this.gos.addCommon({location:((n=t.getLocation)==null?void 0:n.call(t))??"UNKNOWN",value:e,hideTooltipCallback:()=>this.hideTooltip(!0),...(o=t.getAdditionalParams)==null?void 0:o.call(t)});this.state=2,this.tooltipInstanceCount++;const s=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.createTooltipComp(i,s)}hideTooltip(e){!e&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),yR=Date.now()),this.eventSvc.dispatchEvent({type:"tooltipHide",parentGui:this.tooltipCtrl.getGui()}),e&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(e,t){var r;if(this.state!==2||this.tooltipInstanceCount!==e){this.destroyBean(t);return}const s=t.getGui();this.tooltipComp=t,s.classList.contains("ag-tooltip")||s.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&s.classList.add("ag-tooltip-animate"),this.interactionEnabled&&s.classList.add("ag-tooltip-interactive");const n=this.getLocaleTextFunc(),o=(r=this.popupSvc)==null?void 0:r.addPopup({eChild:s,ariaLabel:n("ariaLabelTooltip","Tooltip")});if(o&&(this.tooltipPopupDestroyFunc=o.hideFunc),this.positionTooltip(),this.tooltipTrigger===1){const a=()=>this.setToDoNothing();[this.onBodyScrollEventCallback]=this.addManagedEventListeners({bodyScroll:a}),this.setEventHandlers(a)}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(s,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),[this.onDocumentKeyDownCallback]=this.addManagedElementListeners(pi(this.beans),{keydown:a=>{s.contains(a==null?void 0:a.target)||this.onKeyDown()}}),this.tooltipTrigger===1&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(s,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventSvc.dispatchEvent({type:"tooltipShow",tooltipGui:s,parentGui:this.tooltipCtrl.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){var i;const e=(i=this.tooltipComp)==null?void 0:i.getGui(),t=Dt(this.beans);return!!e&&e.contains(t)}onTooltipFocusOut(e){const t=this.tooltipCtrl.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,t.contains(e.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){var t,i;const e={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?(t=this.popupSvc)==null||t.positionPopupUnderMouseEvent({...e,mouseEvent:this.lastMouseEvent}):(i=this.popupSvc)==null||i.positionPopupByComponent({...e,eventSource:this.tooltipCtrl.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5})}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const e=this.tooltipPopupDestroyFunc,t=this.tooltipComp,i=this.tooltipTrigger===0?RB:0;window.setTimeout(()=>{e(),this.destroyBean(t)},i),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){for(const e of[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener])e&&e();this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){vp=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},bR)}unlockService(){vp=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}},EB=class extends xT{constructor(e,t,i){super(e,i),this.highlightTracker=t,this.onHighlight=this.onHighlight.bind(this)}postConstruct(){super.postConstruct(),this.wireHighlightListeners()}wireHighlightListeners(){this.addManagedPropertyListener("tooltipTrigger",({currentValue:e})=>{this.setTooltipMode(e)}),this.setTooltipMode(this.gos.get("tooltipTrigger")),this.highlightTracker.addEventListener("itemHighlighted",this.onHighlight)}onHighlight(e){this.tooltipMode===1&&(e.highlighted?this.attemptToShowTooltip():this.attemptToHideTooltip())}setTooltipMode(e="focus"){this.tooltipMode=e==="focus"?1:0}destroy(){this.highlightTracker.removeEventListener("itemHighlighted",this.onHighlight),super.destroy()}},Cp=0,AB=200,FB=class extends Do{constructor(){super(...arguments),this.beanName="popupSvc",this.popupList=[]}getPopupParent(){const e=this.gos.get("popupParent");return e||this.getDefaultPopupParent()}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:i,nudgeY:s,skipObserver:n}=e;this.positionPopup({ePopup:t,nudgeX:i,nudgeY:s,keepWithinBounds:!0,skipObserver:n,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e,e.type,e.ePopup,null,e.mouseEvent)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){const{ePopup:t,nudgeX:i,nudgeY:s,keepWithinBounds:n,eventSource:o,alignSide:r="left",position:a="over",type:l}=e,c=o.getBoundingClientRect(),d=this.getParentRect();this.setAlignedTo(o,t);const h=()=>{let u=c.left-d.left;r==="right"&&(u-=t.offsetWidth-c.width);let f;return a==="over"?(f=c.top-d.top,this.setAlignedStyles(t,"over")):(this.setAlignedStyles(t,"under"),this.shouldRenderUnderOrAbove(t,c,d,e.nudgeY||0)==="under"?f=c.top-d.top+c.height:f=c.top-t.offsetHeight-(s||0)*2-d.top),{x:u,y:f}};this.positionPopup({ePopup:t,nudgeX:i,nudgeY:s,keepWithinBounds:n,updatePosition:h,postProcessCallback:()=>this.callPostProcessPopup(e,l,t,o,null)})}shouldRenderUnderOrAbove(e,t,i,s){const n=i.bottom-t.bottom,o=t.top-i.top,r=e.offsetHeight+s;return n>r?"under":o>r||o>n?"above":"under"}setAlignedStyles(e,t){const i=this.getPopupIndex(e);if(i===-1)return;const s=this.popupList[i],{alignedToElement:n}=s;if(!n)return;const o=["right","left","over","above","under"];for(const r of o)n.classList.remove(`ag-has-popup-positioned-${r}`),e.classList.remove(`ag-popup-positioned-${r}`);t&&(n.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}setAlignedTo(e,t){const i=this.getPopupIndex(t);if(i!==-1){const s=this.popupList[i];s.alignedToElement=e}}positionPopup(e){const{ePopup:t,keepWithinBounds:i,nudgeX:s,nudgeY:n,skipObserver:o,updatePosition:r}=e,a={width:0,height:0},l=(c=!1)=>{let{x:d,y:h}=r();c&&t.clientWidth===a.width&&t.clientHeight===a.height||(a.width=t.clientWidth,a.height=t.clientHeight,s&&(d+=s),n&&(h+=n),i&&(d=this.keepXYWithinBounds(t,d,1),h=this.keepXYWithinBounds(t,h,0)),t.style.left=`${d}px`,t.style.top=`${h}px`,e.postProcessCallback&&e.postProcessCallback())};if(l(),!o){const c=qa(this.beans,t,()=>l(!0));setTimeout(()=>c(),AB)}}getParentRect(){const e=pi(this.beans);let t=this.getPopupParent();return t===e.body?t=e.documentElement:getComputedStyle(t).position==="static"&&(t=t.offsetParent),CP(t)}keepXYWithinBounds(e,t,i){const s=i===0,n=s?"clientHeight":"clientWidth",o=s?"top":"left",r=s?"height":"width",a=s?"scrollTop":"scrollLeft",l=pi(this.beans),c=l.documentElement,d=this.getPopupParent(),h=e.getBoundingClientRect(),u=d.getBoundingClientRect(),f=l.documentElement.getBoundingClientRect(),p=d===l.body,m=Math.ceil(h[r]);let C=p?(s?vP:Mm)(c)+c[a]:d[n];p&&(C-=Math.abs(f[o]-u[o]));const w=C-m;return Math.min(Math.max(t,0),Math.max(w,0))}addPopup(e){const{eChild:t,ariaLabel:i,ariaOwns:s,alwaysOnTop:n,positionCallback:o,anchorToElement:r}=e,a=this.getPopupIndex(t);if(a!==-1)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(t);const l=this.createPopupWrapper(t,!!n,i,s),c=this.addEventListenersToPopup({...e,wrapperEl:l});return o&&o(),this.addPopupToPopupList(t,l,c,r),{hideFunc:c}}initialisePopupPosition(e){const i=this.getPopupParent().getBoundingClientRect();ae(e.style.top)||(e.style.top=`${i.top*-1}px`),ae(e.style.left)||(e.style.left=`${i.left*-1}px`)}createPopupWrapper(e,t,i,s){const n=this.getPopupParent(),{environment:o,gos:r}=this.beans,a=Xf({tag:"div"});return o.applyThemeClasses(a),a.classList.add("ag-popup"),e.classList.add(r.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||Ha(e,"dialog"),i?zh(e,i):s&&(e.id||(e.id=`popup-component-${Cp}`),eR(s,e.id)),a.appendChild(e),n.appendChild(a),t?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),a}addEventListenersToPopup(e){const t=this.beans,i=pi(t),{wrapperEl:s,eChild:n,closedCallback:o,afterGuiAttached:r,closeOnEsc:a,modal:l,ariaOwns:c}=e;let d=!1;const h=m=>{if(!s.contains(Dt(t)))return;m.key===H.ESCAPE&&!this.isStopPropagation(m)&&p({keyboardEvent:m})},u=m=>p({mouseEvent:m}),f=m=>p({touchEvent:m}),p=(m={})=>{const{mouseEvent:v,touchEvent:C,keyboardEvent:w,forceHide:S}=m;!S&&(this.isEventFromCurrentPopup({mouseEvent:v,touchEvent:C},n)||d)||(d=!0,s.remove(),i.removeEventListener("keydown",h),i.removeEventListener("mousedown",u),i.removeEventListener("touchstart",f),i.removeEventListener("contextmenu",u),this.eventSvc.removeListener("dragStarted",u),o&&o(v||C||w),this.removePopupFromPopupList(n,c))};return r&&r({hidePopup:p}),window.setTimeout(()=>{a&&i.addEventListener("keydown",h),l&&(i.addEventListener("mousedown",u),this.eventSvc.addListener("dragStarted",u),i.addEventListener("touchstart",f),i.addEventListener("contextmenu",u))},0),p}addPopupToPopupList(e,t,i,s){this.popupList.push({element:e,wrapper:t,hideFunc:i,instanceId:Cp,isAnchored:!!s}),s&&this.setPopupPositionRelatedToElement(e,s),Cp=Cp+1}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){const i=this.getPopupIndex(e);if(i===-1)return;const s=this.popupList[i];if(s.stopAnchoringPromise&&s.stopAnchoringPromise.then(o=>o&&o()),s.stopAnchoringPromise=void 0,s.isAnchored=!1,!t)return;const n=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:s.hideFunc});return s.stopAnchoringPromise=n,s.isAnchored=!0,n}removePopupFromPopupList(e,t){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),t&&eR(t,null),this.popupList=this.popupList.filter(i=>i.element!==e)}keepPopupPositionedRelativeTo(e){const t=this.getPopupParent(),i=t.getBoundingClientRect(),{element:s,ePopup:n}=e,o=s.getBoundingClientRect(),r=h=>Number.parseInt(h.substring(0,h.length-1),10),a=(h,u)=>{const f=i[h]-o[h],p=r(n.style[h]);return{initialDiff:f,lastDiff:f,initial:p,last:p,direction:u}},l=a("top",0),c=a("left",1),d=this.beans.frameworkOverrides;return new Ot(h=>{d.wrapIncoming(()=>{NG(()=>{const u=t.getBoundingClientRect(),f=s.getBoundingClientRect();if(f.top==0&&f.left==0&&f.height==0&&f.width==0){e.hidePopup();return}const m=(v,C)=>{const w=r(n.style[C]);v.last!==w&&(v.initial=w,v.last=w);const S=u[C]-f[C];if(S!=v.lastDiff){const b=this.keepXYWithinBounds(n,v.initial+v.initialDiff-S,v.direction);n.style[C]=`${b}px`,v.last=b}v.lastDiff=S};m(l,"top"),m(c,"left")},200).then(u=>{h(()=>{u!=null&&window.clearInterval(u)})})},"popupPositioning")})}isEventFromCurrentPopup(e,t){const{mouseEvent:i,touchEvent:s}=e,n=i||s;if(!n)return!1;const o=this.getPopupIndex(t);if(o===-1)return!1;for(let r=o;r<this.popupList.length;r++){const a=this.popupList[r];if(bH(a.element,n))return!0}return this.isElementWithinCustomPopup(n.target)}isElementWithinCustomPopup(e){const t=pi(this.beans);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||e.parentElement===null)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const i=this.getWrapper(e);i&&(i.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(i))}bringPopupToFront(e){const t=this.getPopupParent(),i=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),s=i.length,n=this.getWrapper(e);if(!n||s<=1||!t.contains(e))return;const o=[],r=[];for(const u of i)u!==n&&(u.classList.contains("ag-always-on-top")?r.push(u):o.push(u));const a=[],l=r.length,h=n.classList.contains("ag-always-on-top")||!l?[...o,...r,n]:[...o,n,...r];for(let u=0;u<=s;u++){const f=h[u];if(i[u]===h[u]||f===n)continue;const p=f.querySelectorAll("div");for(const m of p)m.scrollTop!==0&&a.push([m,m.scrollTop]);u===0?t.insertAdjacentElement("afterbegin",f):h[u-1].insertAdjacentElement("afterend",f)}for(;a.length;){const u=a.pop();u[0].scrollTop=u[1]}}},PB=class extends vS{constructor(){super({tag:"div",cls:"ag-tooltip"})}init(e){const{value:t}=e,i=this.getGui();i.textContent=tu(t);const s=e.location.replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase();i.classList.add(`ag-${s}-tooltip`)}},ET=(e,t)=>{if(t!=null&&(e!=null&&e.setPointerCapture))try{return e.setPointerCapture(t),e.hasPointerCapture(t)}catch{}return!1},TB=(e,t)=>{if(typeof PointerEvent>"u"||!(t instanceof PointerEvent))return null;const i=t.pointerId;if(!ET(e,i))return null;const s={eElement:e,pointerId:i,onLost(n){MB(s,n)}};return e.addEventListener("lostpointercapture",s.onLost),s},DB=e=>{if(!e)return;AT(e);const{eElement:t,pointerId:i}=e;if(t){try{t.releasePointerCapture(i)}catch{}e.eElement=null}},AT=e=>{const{eElement:t,onLost:i}=e;t&&i&&(t.removeEventListener("lostpointercapture",i),e.onLost=null)},MB=(e,t)=>{AT(e);const{eElement:i,pointerId:s}=e;i&&t.pointerId===s&&ET(i,s)},Bs,fo,Lo=e=>{if(!fo)fo=new WeakSet;else if(fo.has(e))return!1;return fo.add(e),!0},IB=class extends Do{constructor(){super(...arguments),this.beanName="dragSvc",this.dragging=!1,this.drag=null,this.dragSources=[]}get startTarget(){var e;return((e=this.drag)==null?void 0:e.start.target)??null}isPointer(){return!!(Bs!=null&&Bs.has(Wn(this.beans)))}hasPointerCapture(){var t,i,s;const e=(t=this.drag)==null?void 0:t.pointerCapture;return!!(e&&((s=(i=this.beans.eRootDiv).hasPointerCapture)!=null&&s.call(i,e.pointerId)))}destroy(){this.drag&&this.cancelDrag();const e=this.dragSources;for(const t of e)SR(t);e.length=0,super.destroy()}removeDragSource(e){const t=this.dragSources;for(let i=0,s=t.length;i<s;++i){const n=t[i];if(n.params===e){t.splice(i,1),SR(n);break}}}addDragSource(e){if(!this.isAlive())return;const{eElement:t,includeTouch:i}=e,s=[];let n;if(i){const c=t.style;c&&(n=c.touchAction,c.touchAction="none")}const o={handlers:s,params:e,oldTouchAction:n};this.dragSources.push(o),am(s,[t,"pointerdown",c=>this.onPointerDown(e,c),{passive:!1}],[t,"mousedown",c=>this.onMouseDown(e,c)]);const l=this.gos.get("suppressTouch");i&&!l&&am(s,[t,"touchstart",d=>this.onTouchStart(e,d),{passive:!1}])}cancelDrag(e){var i,s;const t=this.drag;e??(e=t==null?void 0:t.eElement),e&&this.eventSvc.dispatchEvent({type:"dragCancelled",target:e}),(s=t==null?void 0:(i=t.params).onDragCancel)==null||s.call(i),this.destroyDrag()}shouldPreventMouseEvent(e){const t=e.type;return(t==="mousemove"||t==="pointermove")&&e.cancelable&&dg(this.beans,e)&&!zu(TC(e))}initDrag(e,...t){this.drag=e;const i=this.beans,s=a=>this.onScroll(a),n=a=>this.onKeyDown(a),o=Wn(i),r=pi(i);am(e.handlers,[o,"contextmenu",Ur],[o,"keydown",n],[r,"scroll",s,{capture:!0}],[r.defaultView||window,"scroll",s],...t)}destroyDrag(){this.dragging=!1;const e=this.drag;if(e){const t=e.rootEl;(Bs==null?void 0:Bs.get(t))===e&&(Bs==null||Bs.delete(t)),this.drag=null,DB(e.pointerCapture),cS(e.handlers)}}onPointerDown(e,t){if(this.isPointer())return;const i=this.beans;if(fo!=null&&fo.has(t))return;const s=t.pointerType;if(s==="touch"&&(i.gos.get("suppressTouch")||!e.includeTouch||(e.stopPropagationForTouch&&t.stopPropagation(),zu(TC(t))))||!t.isPrimary||s==="mouse"&&t.button!==0)return;this.destroyDrag();const n=Wn(i),o=e.eElement,r=t.pointerId,a=new PC(n,e,t,r);Bs??(Bs=new WeakMap),Bs.set(n,a);const l=h=>{h.pointerId===r&&this.onMouseOrPointerMove(h)},c=h=>{h.pointerId===r&&this.onMouseOrPointerUp(h)},d=h=>{h.pointerId===r&&Lo(h)&&this.cancelDrag()};this.initDrag(a,[n,"pointerup",c],[n,"pointercancel",d],[n,"pointermove",l,{passive:!1}],[n,"touchmove",Ur,{passive:!1}],[o,"mousemove",Ur,{passive:!1}]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):Lo(t)}onTouchStart(e,t){if(this.gos.get("suppressTouch")||!e.includeTouch||!Lo(t)||zu(TC(t)))return;if(e.stopPropagationForTouch&&t.stopPropagation(),this.isPointer()){Ur(t);return}this.destroyDrag();const s=this.beans,n=Wn(s),o=new PC(n,e,t.touches[0]),r=c=>this.onTouchMove(c),a=c=>this.onTouchUp(c),l=t.target??e.eElement;this.initDrag(o,[Wn(s),"touchmove",Ur,{passive:!1}],[l,"touchmove",r,{passive:!0}],[l,"touchend",a,{passive:!0}],[l,"touchcancel",a,{passive:!0}]),e.dragStartPixels===0&&this.onMove(o.start)}onMouseDown(e,t){if(t.button!==0||fo!=null&&fo.has(t)||this.isPointer())return;const i=this.beans;this.destroyDrag();const s=new PC(Wn(i),e,t),n=a=>this.onMouseOrPointerMove(a),o=a=>this.onMouseOrPointerUp(a),r=Wn(i);this.initDrag(s,[r,"mousemove",n],[r,"mouseup",o]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):Lo(t)}onScroll(e){var s;if(!Lo(e))return;const t=this.drag,i=t==null?void 0:t.lastDrag;i&&this.dragging&&((s=t.params)==null||s.onDragging(i))}onMouseOrPointerMove(e){var t;Lo(e)&&(Xa()&&((t=pi(this.beans).getSelection())==null||t.removeAllRanges()),this.shouldPreventMouseEvent(e)&&Ur(e),this.onMove(e))}onTouchMove(e){const t=this.drag;if(!t||!Lo(e))return;const i=$u(t.start,e.touches);i&&(e.preventDefault(),this.onMove(i))}onMove(e){const t=this.drag;if(!t)return;t.lastDrag=e;const i=t.params;if(!this.dragging){const s=t.start,o=i.dragStartPixels??4;if(EP(e,s,o)||(this.dragging=!0,i.capturePointer&&(t.pointerCapture=TB(this.beans.eRootDiv,e)),this.eventSvc.dispatchEvent({type:"dragStarted",target:i.eElement}),i.onDragStart(s),this.drag!==t)||(i.onDragging(s),this.drag!==t))return}i.onDragging(e)}onTouchUp(e){const t=this.drag;t&&Lo(e)&&this.onUp($u(t.start,e.changedTouches))}onMouseOrPointerUp(e){Lo(e)&&this.onUp(e)}onUp(e){const t=this.drag;t&&(e||(e=t.lastDrag),e&&this.dragging&&(this.dragging=!1,t.params.onDragStop(e),this.eventSvc.dispatchEvent({type:"dragStopped",target:t.params.eElement})),this.destroyDrag())}onKeyDown(e){e.key===H.ESCAPE&&this.cancelDrag()}},SR=e=>{cS(e.handlers);const t=e.oldTouchAction;if(t!=null){const i=e.params.eElement.style;i&&(i.touchAction=t)}},PC=class{constructor(e,t,i,s=null){this.rootEl=e,this.params=t,this.start=i,this.pointerId=s,this.handlers=[],this.lastDrag=null,this.pointerCapture=null,this.eElement=t.eElement}},TC=e=>{const t=e.target;return t instanceof Element?t:null},kB=class extends Do{constructor(){super(...arguments),this.beanName="dragAndDrop",this.dragSourceAndParamsList=[],this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.dragSource=null,this.dragImageParent=null,this.dragImageCompPromise=null,this.dragImageComp=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.dropTargets=[],this.lastDropTarget=null}addDragSource(e,t=!1){const i={capturePointer:!0,dragSource:e,eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:s=>this.onDragStart(e,s),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push(i),this.beans.dragSvc.addDragSource(i)}setDragImageCompIcon(e,t=!1){const i=this.dragImageComp;i&&(t||this.dragImageLastIcon!==e)&&(this.dragImageLastIcon=e,i.setIcon(e,t))}removeDragSource(e){var n;const{dragSourceAndParamsList:t,beans:i}=this,s=t.find(o=>o.dragSource===e);s&&((n=i.dragSvc)==null||n.removeDragSource(s),_n(t,s))}destroy(){const{dragSourceAndParamsList:e,dropTargets:t,beans:i}=this,s=i.dragSvc;for(const n of e)s==null||s.removeDragSource(n);e.length=0,t.length=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){const e=this.lastMouseEvent;e&&this.onDragging(e,!0)}onDragStart(e,t){var s;this.lastMouseEvent=t,this.dragSource=e,this.dragItem=e.getDragItem();const i=e.eElement.getBoundingClientRect();this.dragInitialSourcePointerOffsetX=t.clientX-i.left,this.dragInitialSourcePointerOffsetY=t.clientY-i.top,(s=e.onDragStarted)==null||s.call(e),this.createAndUpdateDragImageComp(e)}onDragStop(e){var s,n;const{dragSource:t,lastDropTarget:i}=this;if((s=t==null?void 0:t.onDragStopped)==null||s.call(t),i){const o=this.dropTargetEvent(i,e,!1);(n=i.onDragStop)==null||n.call(i,o)}this.clearDragAndDropProperties()}onDragCancel(){var s,n;const{dragSource:e,lastDropTarget:t,lastMouseEvent:i}=this;if((s=e==null?void 0:e.onDragCancelled)==null||s.call(e),t&&i){const o=this.dropTargetEvent(t,i,!1);(n=t.onDragCancel)==null||n.call(t,o)}this.clearDragAndDropProperties()}onDragging(e,t=!1){var a,l,c;this.positionDragImageComp(e);const i=this.findCurrentDropTarget(e),{lastDropTarget:s,dragSource:n,dragItem:o}=this;let r=!1;if(i!==s){if(r=!0,s){const d=this.dropTargetEvent(s,e,t);(a=s.onDragLeave)==null||a.call(s,d)}if(s!==null&&!i?this.handleExit(n,o):s===null&&i&&this.handleEnter(n,o),i){const d=this.dropTargetEvent(i,e,t);(l=i.onDragEnter)==null||l.call(i,d)}this.lastDropTarget=i}else if(i){const d=this.dropTargetEvent(i,e,t);(c=i.onDragging)==null||c.call(i,d),d!=null&&d.changed&&(r=!0)}this.lastMouseEvent=e,r&&this.updateDragImageComp()}clearDragAndDropProperties(){this.removeDragImageComp(this.dragImageComp),this.dragImageCompPromise=null,this.dragImageParent=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.lastDropTarget=null,this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.dragSource=null}getAllContainersFromDropTarget(e){const t=e.getSecondaryContainers?e.getSecondaryContainers():null,i=[[e.getContainer()]];return t?i.concat(t):i}isMouseOnDropTarget(e,t){const i=this.getAllContainersFromDropTarget(t);let s=!1;const n=(a,l)=>{for(const c of l){const{width:d,height:h,left:u,right:f,top:p,bottom:m}=c.getBoundingClientRect();if(d===0||h===0)return!1;const v=a.clientX>=u&&a.clientX<f,C=a.clientY>=p&&a.clientY<m;if(!v||!C)return!1}return!0};for(const a of i)if(n(e,a)){s=!0;break}const{eElement:o,type:r}=this.dragSource;return t.targetContainsSource&&!t.getContainer().contains(o)?!1:s&&t.isInterestedIn(r,o)}findCurrentDropTarget(e){const t=this.dropTargets.filter(o=>this.isMouseOnDropTarget(e,o)),i=t.length;if(i===0)return null;if(i===1)return t[0];const n=Wn(this.beans).elementsFromPoint(e.clientX,e.clientY);for(const o of n)for(const r of t)if(this.getAllContainersFromDropTarget(r).flatMap(l=>l).indexOf(o)!==-1)return r;return null}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter(t=>t.getContainer()!==e.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(e){return this.dropTargets.find(t=>t.external&&t.getContainer()===e)||null}dropTargetEvent(e,t,i){const{dragSource:s,dragItem:n,lastDraggingEvent:o,lastMouseEvent:r,dragInitialSourcePointerOffsetX:a,dragInitialSourcePointerOffsetY:l}=this,c=e.getContainer(),d=c.getBoundingClientRect(),{clientX:h,clientY:u}=t,f=h-((r==null?void 0:r.clientX)||0),p=u-((r==null?void 0:r.clientY)||0),m=this.createEvent({event:t,x:h-d.left,y:u-d.top,vDirection:p>0?"down":p<0?"up":null,hDirection:f<0?"left":f>0?"right":null,initialSourcePointerOffsetX:a,initialSourcePointerOffsetY:l,dragSource:s,fromNudge:i,dragItem:n,dropZoneTarget:c,dropTarget:(o==null?void 0:o.dropTarget)??null,changed:!!(o!=null&&o.changed)});return this.lastDraggingEvent=m,m}positionDragImageComp(e){var i;const t=(i=this.dragImageComp)==null?void 0:i.getGui();t&&EH(t,e,this.beans)}removeDragImageComp(e){var t;this.dragImageComp===e&&(this.dragImageComp=null),e&&((t=e.getGui())==null||t.remove(),this.destroyBean(e))}createAndUpdateDragImageComp(e){const t=this.createDragImageComp(e)??null;this.dragImageCompPromise=t,t==null||t.then(i=>{if(t!==this.dragImageCompPromise||!this.lastMouseEvent||!this.isAlive()){this.destroyBean(i);return}this.dragImageCompPromise=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0;const s=this.dragImageComp;s!==i&&(this.dragImageComp=i,this.removeDragImageComp(s)),i&&(this.appendDragImageComp(i),this.updateDragImageComp())})}appendDragImageComp(e){var n;const t=e.getGui(),i=t.style;i.position="absolute",i.zIndex="9999",(n=this.beans.dragSvc)!=null&&n.hasPointerCapture()&&(i.pointerEvents="none"),this.gos.setInstanceDomData(t),this.beans.environment.applyThemeClasses(t),i.top="20px",i.left="20px";const s=sS(this.beans);this.dragImageParent=s,s?s.appendChild(t):this.warnNoBody()}updateDragImageComp(){var r;const{dragImageComp:e,dragSource:t,lastDropTarget:i,lastDraggingEvent:s,dragImageLastLabel:n}=this;if(!e)return;this.setDragImageCompIcon(((r=i==null?void 0:i.getIconName)==null?void 0:r.call(i,s))??null);let o=t==null?void 0:t.dragItemName;typeof o=="function"&&(o=o(s)),o||(o=""),n!==o&&(this.dragImageLastLabel=o,e.setLabel(o))}},_B=class extends kB{createEvent(e){return Fe(this.gos,e)}createDragImageComp(e){const{gos:t,beans:i}=this,s=s2(i.userCompFactory,Fe(t,{dragSource:e}));return s==null?void 0:s.newAgStackInstance()}handleEnter(e,t){var i;(i=e==null?void 0:e.onGridEnter)==null||i.call(e,t)}handleExit(e,t){var i;(i=e==null?void 0:e.onGridExit)==null||i.call(e,t)}warnNoBody(){j(54)}isDropZoneWithinThisGrid(e){return this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody.contains(e.dropZoneTarget)}registerGridDropTarget(e,t){const i={getContainer:e,isInterestedIn:s=>s===1||s===0,getIconName:()=>"notAllowed"};this.addDropTarget(i),t.addDestroyFunc(()=>this.removeDropTarget(i))}};function FT(e,t){return e+"_"+t}function $t(e){return e instanceof pg}var pg=class extends V{constructor(e,t,i,s){super(),this.providedColumnGroup=e,this.groupId=t,this.partId=i,this.pinned=s,this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null,this.colIdSanitised=Vu(this.getUniqueId())}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}getUniqueId(){return FT(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!e||e.length===0?!1:e.every(t=>t.isMoving())}checkLeft(){for(const e of this.displayedChildren)$t(e)&&e.checkLeft();if(this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const t=Ct(this.displayedChildren).getLeft();this.setLeft(t)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;for(const t of this.displayedChildren??[])e+=t.getActualWidth();return e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;for(const t of this.displayedChildren)t.isResizable()&&(e=!0);return e}getMinWidth(){let e=0;for(const t of this.displayedChildren)e+=t.getMinWidth();return e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){var e;return!!((e=this.getColGroupDef())!=null&&e.autoHeaderHeight)}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){for(const t of this.displayedChildren??[])Va(t)?e.push(t):$t(t)&&t.addDisplayedLeafColumns(e)}addLeafColumns(e){for(const t of this.children??[])Va(t)?e.push(t):$t(t)&&t.addLeafColumns(e)}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return!this.isPadding()||!(e!=null&&e.isPadding())?0:1+e.getPaddingLevel()}calculateDisplayedColumns(){var i;this.displayedChildren=[];let e=this;for(;e!=null&&e.isPadding();)e=e.getParent();if(!(e?e.getProvidedColumnGroup().isExpandable():!1)){this.displayedChildren=this.children,this.dispatchLocalEvent({type:"displayedChildrenChanged"});return}for(const s of this.children??[]){if($t(s)&&!((i=s.displayedChildren)!=null&&i.length))continue;switch(s.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(s);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(s);break;default:this.displayedChildren.push(s);break}}this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},ty="row-group-",ES="t-",AS="b-",LB=0,za=class{constructor(e){this.master=!1,this.detail=void 0,this.rowIndex=null,this.key=null,this.sourceRowIndex=-1,this._leafs=void 0,this.childrenMapped=null,this.treeParent=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=LB++,this.alreadyRendered=!1,this.hovered=!1,this.__selected=!1,this.beans=e}get allLeafChildren(){var t,i;const e=this._leafs;return e===void 0?((i=(t=this.beans.groupStage)==null?void 0:t.loadLeafs)==null?void 0:i.call(t,this))??null:e}set allLeafChildren(e){this._leafs=e}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){var a,l,c;const{valueCache:i,eventSvc:s}=this.beans,n=this.data;this.data=e,i==null||i.onDataChanged(),this.updateDataOnDetailNode(),this.resetQuickFilterAggregateText();const o=this.createDataChangedEvent(e,n,t);if((a=this.__localEventService)==null||a.dispatchEvent(o),this.sibling){this.sibling.data=e;const d=this.sibling.createDataChangedEvent(e,n,t);(l=this.sibling.__localEventService)==null||l.dispatchEvent(d)}s.dispatchEvent({type:"rowNodeDataChanged",node:this});const r=this.pinnedSibling;r&&(r.data=e,(c=r.__localEventService)==null||c.dispatchEvent(r.createDataChangedEvent(e,n,t)),s.dispatchEvent({type:"rowNodeDataChanged",node:r}))}updateDataOnDetailNode(){const e=this.detailNode;e&&(e.data=this.data)}createDataChangedEvent(e,t,i){return{type:"dataChanged",node:this,oldData:t,newData:e,update:i}}getRowIndexString(){return this.rowIndex==null?(ut(13),null):this.rowPinned==="top"?ES+this.rowIndex:this.rowPinned==="bottom"?AS+this.rowIndex:this.rowIndex.toString()}setDataAndId(e,t){var r,a;const{selectionSvc:i}=this.beans,s=(r=i==null?void 0:i.createDaemonNode)==null?void 0:r.call(i,this),n=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),i&&(i.updateRowSelectable(this),i.syncInRowNode(this,s));const o=this.createDataChangedEvent(e,n,!1);(a=this.__localEventService)==null||a.dispatchEvent(o)}setId(e){var i;const t=Wh(this.beans.gos);if(t)if(this.data){const s=((i=this.parent)==null?void 0:i.getRoute())??[];this.id=t({data:this.data,parentKeys:s.length>0?s:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(ty)&&ut(14,{groupPrefix:ty})}else this.id=void 0;else this.id=e}setRowTop(e){if(this.oldRowTop=this.rowTop,this.rowTop===e)return;this.rowTop=e,this.dispatchRowEvent("topChanged");const t=e!==null;this.displayed!==t&&(this.displayed=t,this.dispatchRowEvent("displayedChanged"))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(e){this.hovered=e}isHovered(){return this.hovered}setRowHeight(e,t=!1){this.rowHeight=e,this.rowHeightEstimated=t,this.dispatchRowEvent("heightChanged")}setExpanded(e,t,i){var s;(s=this.beans.expansionSvc)==null||s.setExpanded(this,e,t,i)}setDataValue(e,t,i){var d;const{colModel:s,valueSvc:n,gos:o,editSvc:r}=this.beans,a=typeof e!="string"?e:s.getCol(e)??s.getColDefCol(e);if(!a)return!1;const l=n.getValueForDisplay(a,this,void 0,void 0,"api").value;if(o.get("readOnlyEdit")){const{beans:{eventSvc:h},data:u,rowIndex:f,rowPinned:p}=this;return h.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:f,rowPinned:p,column:a,colDef:a.colDef,data:u,node:this,oldValue:l,newValue:t,value:t,source:i}),!1}if(r&&!r.committing){const h=r.setDataValue({rowNode:this,column:a},t,i);if(h!=null)return h}const c=n.setValue(this,a,t,i);return this.dispatchCellChangedEvent(a,t,l),c&&((d=this.pinnedSibling)==null||d.dispatchCellChangedEvent(a,t,l)),c}updateHasChildren(){var i;let e=this.group&&!this.footer||!!((i=this.childrenAfterGroup)!=null&&i.length);const{rowChildrenSvc:t}=this.beans;t&&(e=t.getHasChildrenValue(this)),e!==this.__hasChildren&&(this.__hasChildren=!!e,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(e,t,i){var n;const s={type:"cellChanged",node:this,column:e,newValue:t,oldValue:i};(n=this.__localEventService)==null||n.dispatchEvent(s)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){var e;return((e=this.beans.expansionSvc)==null?void 0:e.isExpandable(this))??!1}isSelected(){if(this.footer)return this.sibling.isSelected();const e=this.rowPinned&&this.pinnedSibling;return e?e.isSelected():this.__selected}depthFirstSearch(e){const t=this.childrenAfterGroup;if(t)for(let i=0,s=t.length;i<s;++i)t[i].depthFirstSearch(e);e(this)}dispatchRowEvent(e){var t;(t=this.__localEventService)==null||t.dispatchEvent({type:e,node:this})}setSelected(e,t=!1,i="api"){var s;(s=this.beans.selectionSvc)==null||s.setNodesSelected({nodes:[this],newValue:e,clearSelection:t,source:i})}isRowPinned(){return!!this.rowPinned}__addEventListener(e,t){(this.__localEventService??(this.__localEventService=new Mc)).addEventListener(e,t)}__removeEventListener(e,t){this.removeLocalListener(e,t)}addEventListener(e,t){var n,o,r,a;(n=this.beans.validation)==null||n.checkRowEvents(e);const i=this.__localEventService??(this.__localEventService=new Mc);this.frameworkEventListenerService=(r=(o=this.beans.frameworkOverrides).createLocalEventListenerWrapper)==null?void 0:r.call(o,this.frameworkEventListenerService,i);const s=((a=this.frameworkEventListenerService)==null?void 0:a.wrap(e,t))??t;i.addEventListener(e,s)}removeEventListener(e,t){var s;const i=((s=this.frameworkEventListenerService)==null?void 0:s.unwrap(e,t))??t;this.removeLocalListener(e,i)}removeLocalListener(e,t){const i=this.__localEventService;i&&(i.removeEventListener(e,t),i.noRegisteredListenersExist()&&(this.__localEventService=null))}isFullWidthCell(){if(j(61),this.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this}):!1}getRoute(){if(this.level===-1)return[];if(this.key==null)return;const e=[];let t=this;for(;(t==null?void 0:t.key)!=null;)e.push(t.key),t=t.parent;return e.reverse()}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.dispatchRowEvent("rowIndexChanged"))}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.dispatchRowEvent("allChildrenCountChanged"))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.dispatchRowEvent("uiLevelChanged"))}getFirstChild(){var t;const e=this.childStore;return e?e.getFirstNode():((t=this.childrenAfterSort)==null?void 0:t[0])??null}};function OB(e,t,i){return Fe(t,{type:i,node:e,data:e.data,rowIndex:e.rowIndex,rowPinned:e.rowPinned})}var NB=new Set(["__autoHeights","__checkAutoHeightsDebounced","__localEventService","__objectId","_leafs","childStore","oldRowTop","sticky","treeNodeFlags","treeParent"]),HB=(e,t)=>{const i=new za(t);for(const s of Object.keys(e))NB.has(s)||(i[s]=e[s]);return i.oldRowTop=null,i},PT=e=>{for(;e!=null&&e.length;){const t=e[0];if(t.data)return t;e=t.childrenAfterGroup}},TT={agSetColumnFilter:"agSetColumnFilterHandler",agMultiColumnFilter:"agMultiColumnFilterHandler",agGroupColumnFilter:"agGroupColumnFilterHandler",agNumberColumnFilter:"agNumberColumnFilterHandler",agDateColumnFilter:"agDateColumnFilterHandler",agTextColumnFilter:"agTextColumnFilterHandler"},GB=new Set(Object.values(TT));function Hr(e,t){const i=e.filterUi;if(!i)return null;if(i.created)return i.promise;if(t)return null;const s=i.create(i.refreshed),n=i;return n.created=!0,n.promise=s,s}function BB(e,t,i,s,n,o,r){var a;return(a=t.refresh)==null||a.call(t,{...i,model:s,source:o,additionalEventAttributes:r}),e().then(l=>{if(l){const{filter:c,filterParams:d}=l;DT(c,d,s,n,o,r)}})}function DT(e,t,i,s,n,o){var r;(r=e==null?void 0:e.refresh)==null||r.call(e,{...t,model:i,state:s,source:n,additionalEventAttributes:o})}function MT(e,t,i){const s=e();s!=null&&s.created&&s.promise.then(n=>{const o=t();DT(n,s.filterParams,o,i()??{model:o},"ui")})}function RR(e,t,i,s,n,o,r){let a,l=!1,c;switch(e){case"apply":{const d=s();c=(d==null?void 0:d.model)??null,r&&(c=r(c)),a={state:d==null?void 0:d.state,model:c},l=!0;break}case"clear":{a={model:null};break}case"reset":{a={model:null},l=!0,c=null;break}case"cancel":{a={model:i()};break}}n(a),l?o(c):MT(t,i,s)}function li(e,t){return e[t]??null}function jt(e){return Xf(e)}function VB(e){return{tag:"div",cls:e}}var zB=class extends ct{constructor(e){const{className:t="ag-filter-apply-panel"}=e??{};super(VB(t)),this.listeners=[],this.validationMessage=null,this.className=t}updateButtons(e,t){const i=this.buttons;if(this.buttons=e,i===e)return;const s=this.getGui();Mi(s);let n;this.destroyListeners();const o=document.createDocumentFragment(),r=this.className,a=({type:c,label:d})=>{const h=C=>{this.dispatchLocalEvent({type:c,event:C})};["apply","clear","reset","cancel"].includes(c)||j(75);const u=c==="apply",p=jt({tag:"button",attrs:{type:u&&t?"submit":"button"},ref:`${c}FilterButton`,cls:`ag-button ag-standard-button ${r}-button${u?" "+r+"-apply-button":""}`,children:d});this.activateTabIndex([p]),u&&(n=p);const m=C=>{C.key===H.ENTER&&(C.preventDefault(),h(C))},v=this.listeners;p.addEventListener("click",h),v.push(()=>p.removeEventListener("click",h)),p.addEventListener("keydown",m),v.push(()=>p.removeEventListener("keydown",m)),o.append(p)};for(const c of e)a(c);this.eApply=n;const l=this.validationTooltipFeature;n&&!l?this.validationTooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eApply,getLocation:()=>"advancedFilter",getTooltipShowDelayOverride:()=>1e3})):!n&&l&&(this.validationTooltipFeature=this.destroyBean(l)),s.append(o)}getApplyButton(){return this.eApply}updateValidity(e,t=null){var s;const i=this.eApply;i&&(lg(i,e===!1),this.validationMessage=t??null,(s=this.validationTooltipFeature)==null||s.setTooltipAndRefresh(this.validationMessage))}destroyListeners(){for(const e of this.listeners)e();this.listeners=[]}destroy(){this.destroyListeners(),super.destroy()}},WB={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd",filterSummaryInactive:"is (All)",filterSummaryContains:"contains",filterSummaryNotContains:"does not contain",filterSummaryTextEquals:"equals",filterSummaryTextNotEqual:"does not equal",filterSummaryStartsWith:"begins with",filterSummaryEndsWith:"ends with",filterSummaryBlank:"is blank",filterSummaryNotBlank:"is not blank",filterSummaryEquals:"=",filterSummaryNotEqual:"!=",filterSummaryGreaterThan:">",filterSummaryGreaterThanOrEqual:">=",filterSummaryLessThan:"<",filterSummaryLessThanOrEqual:"<=",filterSummaryInRange:"between",filterSummaryInRangeValues:e=>`(${e[0]}, ${e[1]})`,filterSummaryTextQuote:e=>`"${e[0]}"`};function Yr(e,t,i){return FH(e,WB,t,i)}function FS(e,t){const{debounceMs:i}=e;return Wv(e)?(i!=null&&j(71),0):i??t}function Wv(e){var t;return(((t=e.buttons)==null?void 0:t.indexOf("apply"))??-1)>=0}var $B=class extends ct{constructor(e,t,i,s,n,o){super(),this.column=e,this.wrapper=t,this.eventParent=i,this.updateModel=s,this.isGlobalButtons=n,this.enableGlobalButtonCheck=o,this.hidePopup=null,this.applyActive=!1}postConstruct(){const{comp:e,params:t}=this.wrapper,i=t,s=i.useForm,n=s?"form":"div";this.setTemplate({tag:n,cls:"ag-filter-wrapper"}),s&&this.addManagedElementListeners(this.getGui(),{submit:o=>{o==null||o.preventDefault()},keydown:this.handleKeyDown.bind(this)}),this.appendChild(e.getGui()),this.params=i,this.resetButtonsPanel(i),this.addManagedListeners(this.eventParent,{filterParamsChanged:({column:o,params:r})=>{o===this.column&&this.resetButtonsPanel(r,this.params)},filterStateChanged:({column:o,state:r})=>{var a;o===this.column&&((a=this.eButtons)==null||a.updateValidity(r.valid!==!1))},filterAction:({column:o,action:r,event:a})=>{o===this.column&&this.afterAction(r,a)},...this.enableGlobalButtonCheck?{filterGlobalButtons:({isGlobal:o})=>{if(o!==this.isGlobalButtons){this.isGlobalButtons=o;const r=this.params;this.resetButtonsPanel(r,r,!0)}}}:void 0})}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup)}resetButtonsPanel(e,t,i){const{buttons:s,readOnly:n}=t??{},{buttons:o,readOnly:r,useForm:a}=e;if(!i&&n===r&&rg(s,o))return;const l=o&&o.length>0&&!e.readOnly&&!this.isGlobalButtons;let c=this.eButtons;if(l){const d=o.map(h=>{const u=`${h}Filter`;return{type:h,label:Yr(this,u)}});if(this.applyActive=Wv(this.params),!c){c=this.createBean(new zB),this.appendChild(c.getGui());const h=this.column,u=f=>({event:p})=>{this.updateModel(h,f,{fromButtons:!0}),this.afterAction(f,p)};c==null||c.addManagedListeners(c,{apply:u("apply"),clear:u("clear"),reset:u("reset"),cancel:u("cancel")}),this.eButtons=c}c.updateButtons(d,a)}else this.applyActive=!1,c&&(Dn(c.getGui()),this.eButtons=this.destroyBean(c))}close(e){const t=this.hidePopup;if(!t)return;const i=e,s=i==null?void 0:i.key;let n;(s===H.ENTER||s===H.SPACE)&&(n={keyboardEvent:i}),t(n),this.hidePopup=null}afterAction(e,t){const{params:i,applyActive:s}=this,n=i==null?void 0:i.closeOnApply;switch(e){case"apply":{t==null||t.preventDefault(),n&&s&&this.close(t);break}case"reset":{n&&s&&this.close();break}case"cancel":{n&&this.close(t);break}}}handleKeyDown(e){!e.defaultPrevented&&e.key===H.ENTER&&this.applyActive&&(this.updateModel(this.column,"apply",{fromButtons:!0}),this.afterAction("apply",e))}destroy(){this.hidePopup=null,this.eButtons=this.destroyBean(this.eButtons)}},UB={tag:"div",cls:"ag-filter"},jB=class extends ct{constructor(e,t,i){super(UB),this.column=e,this.source=t,this.enableGlobalButtonCheck=i,this.wrapper=null}postConstruct(){var e;(e=this.beans.colFilter)==null||e.activeFilterComps.add(this),this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return this.wrapper!=null}getFilter(){var e;return((e=this.wrapper)==null?void 0:e.then(t=>t.comp))??null}afterInit(){var e;return((e=this.wrapper)==null?void 0:e.then(()=>{}))??Ot.resolve()}afterGuiAttached(e){var t;this.afterGuiAttachedParams=e,(t=this.wrapper)==null||t.then(i=>{var s,n,o;(s=this.comp)==null||s.afterGuiAttached(e),(o=(n=i==null?void 0:i.comp)==null?void 0:n.afterGuiAttached)==null||o.call(n,e)})}afterGuiDetached(){var e;(e=this.wrapper)==null||e.then(t=>{var i,s;(s=(i=t==null?void 0:t.comp)==null?void 0:i.afterGuiDetached)==null||s.call(i)})}createFilter(e){const{column:t,source:i,beans:{colFilter:s}}=this,n=s.getFilterUiForDisplay(t)??null;this.wrapper=n,n==null||n.then(o=>{var c;if(!o)return;const{isHandler:r,comp:a}=o;let l;if(r){const d=!!this.enableGlobalButtonCheck,h=this.createBean(new $B(t,o,s,s.updateModel.bind(s),d&&s.isGlobalButtons,d));this.comp=h,l=h.getGui()}else l=a.getGui(),ae(l)||j(69,{guiFromFilter:l});this.appendChild(l),e?this.eventSvc.dispatchEvent({type:"filterOpened",column:t,source:i,eGui:this.getGui()}):(c=a.afterGuiAttached)==null||c.call(a,this.afterGuiAttachedParams)})}onFilterDestroyed(e){const{source:t,column:i}=e;(t==="api"||t==="paramsUpdated")&&i.getId()===this.column.getId()&&this.beans.colModel.getColDefCol(this.column)&&(Mi(this.getGui()),this.comp=this.destroyBean(this.comp),this.createFilter())}destroy(){var e;(e=this.beans.colFilter)==null||e.activeFilterComps.delete(this),this.eventSvc.dispatchEvent({type:"filterClosed",column:this.column}),this.wrapper=null,this.comp=this.destroyBean(this.comp),this.afterGuiAttachedParams=void 0,super.destroy()}},xR={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},ER=["january","february","march","april","may","june","july","august","september","october","november","december"];function KB(e,t){return e==null?-1:t==null?1:Number.parseFloat(e)-Number.parseFloat(t)}function AR(e){return e instanceof Date&&!isNaN(e.getTime())}var iy={number:()=>{},boolean:()=>({maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(e,t)=>t,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(e,t)=>t===!1,numberOfInputs:0}]}),date:()=>({isValidDate:AR}),dateString:({dataTypeDefinition:e})=>({comparator:(t,i)=>{const s=e.dateParser(i);return i==null||s<t?-1:s>t?1:0},isValidDate:t=>typeof t=="string"&&AR(e.dateParser(t))}),dateTime:e=>iy.date(e),dateTimeString:e=>iy.dateString(e),object:()=>{},text:()=>{}},sy={number:()=>({comparator:KB}),boolean:({t:e})=>({valueFormatter:t=>ae(t.value)?e(String(t.value),t.value?"True":"False"):e("blanks","(Blanks)")}),date:({formatValue:e,t})=>({valueFormatter:i=>{const s=e(i);return ae(s)?s:t("blanks","(Blanks)")},treeList:!0,treeListFormatter:(i,s)=>{if(i==="NaN")return t("invalidDate","Invalid Date");if(s===1&&i!=null){const n=ER[Number(i)-1];return t(n,xR[n])}return i??t("blanks","(Blanks)")},treeListPathGetter:i=>mp(i,!1)}),dateString:({formatValue:e,dataTypeDefinition:t,t:i})=>({valueFormatter:s=>{const n=e(s);return ae(n)?n:i("blanks","(Blanks)")},treeList:!0,treeListPathGetter:s=>mp(t.dateParser(s??void 0),!1),treeListFormatter:(s,n)=>{if(n===1&&s!=null){const o=ER[Number(s)-1];return i(o,xR[o])}return s??i("blanks","(Blanks)")}}),dateTime:e=>{const t=sy.date(e);return t.treeListPathGetter=mp,t},dateTimeString(e){const t=e.dataTypeDefinition.dateParser,i=sy.dateString(e);return i.treeListPathGetter=s=>mp(t(s??void 0)),i},object:({formatValue:e,t})=>({valueFormatter:i=>{const s=e(i);return ae(s)?s:t("blanks","(Blanks)")}}),text:()=>{}};function qB(e,t,i,s,n,o,r){let a=t,l=i;const c=e==="agSetColumnFilter";!l&&s.baseDataType==="object"&&!c&&(l=({column:f,node:p})=>n({column:f,node:p,value:o.valueSvc.getValue(f,p)}));const h=(c?sy:iy)[s.baseDataType],u=h({dataTypeDefinition:s,formatValue:n,t:r});return a=typeof t=="object"?{...u,...t}:u,{filterParams:a,filterValueGetter:l}}var YB={boolean:"agTextColumnFilter",date:"agDateColumnFilter",dateString:"agDateColumnFilter",dateTime:"agDateColumnFilter",dateTimeString:"agDateColumnFilter",number:"agNumberColumnFilter",object:"agTextColumnFilter",text:"agTextColumnFilter"},XB={boolean:"agTextColumnFloatingFilter",date:"agDateColumnFloatingFilter",dateString:"agDateColumnFloatingFilter",dateTime:"agDateColumnFloatingFilter",dateTimeString:"agDateColumnFloatingFilter",number:"agNumberColumnFloatingFilter",object:"agTextColumnFloatingFilter",text:"agTextColumnFloatingFilter"};function QB(e,t=!1){return(t?XB:YB)[e??"text"]}var IT="ag-resizer-wrapper",Gr=(e,t)=>({tag:"div",ref:`${e}Resizer`,cls:`ag-resizer ag-resizer-${t}`}),JB={tag:"div",cls:IT,children:[Gr("eTopLeft","topLeft"),Gr("eTop","top"),Gr("eTopRight","topRight"),Gr("eRight","right"),Gr("eBottomRight","bottomRight"),Gr("eBottom","bottom"),Gr("eBottomLeft","bottomLeft"),Gr("eLeft","left")]},ZB=class extends V{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}wireBeans(e){this.popupSvc=e.popupSvc,this.dragSvc=e.dragSvc}center(e){const{clientHeight:t,clientWidth:i}=this.offsetParent,s=i/2-this.getWidth()/2,n=t/2-this.getHeight()/2;this.offsetElement(s,n,e)}initialisePosition(e){if(this.positioned)return;const{centered:t,forcePopupParentAsOffsetParent:i,minWidth:s,width:n,minHeight:o,height:r,x:a,y:l}=this.config;this.offsetParent||this.setOffsetParent();let c=0,d=0;const h=To(this.element);if(h){const u=this.findBoundaryElement(),f=window.getComputedStyle(u);if(f.minWidth!=null){const p=u.offsetWidth-this.element.offsetWidth;d=Number.parseInt(f.minWidth,10)-p}if(f.minHeight!=null){const p=u.offsetHeight-this.element.offsetHeight;c=Number.parseInt(f.minHeight,10)-p}}if(this.minHeight=o||c,this.minWidth=s||d,n&&this.setWidth(n),r&&this.setHeight(r),(!n||!r)&&this.refreshSize(),t)this.center(e);else if(a||l)this.offsetElement(a,l,e);else if(h&&i){let u=this.boundaryEl,f=!0;if(u||(u=this.findBoundaryElement(),f=!1),u){const p=Number.parseFloat(u.style.top),m=Number.parseFloat(u.style.left);f?this.offsetElement(isNaN(m)?0:m,isNaN(p)?0:p,e):this.setPosition(m,p)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){var s,n;if(!this.config.popup||e===this.movable)return;this.movable=e;const i=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?((s=this.dragSvc)==null||s.addDragSource(i),this.moveElementDragListener=i):((n=this.dragSvc)==null||n.removeDragSource(i),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),typeof e=="boolean"){if(e===!1)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach(t=>{var r;const s=!!e[t],n=this.getResizerElement(t),o={dragStartPixels:0,eElement:n,onDragStart:a=>this.onResizeStart(a,t),onDragging:this.onResize.bind(this),onDragStop:a=>this.onResizeEnd(a,t)};(s||!this.isAlive()&&!s)&&(s?((r=this.dragSvc)==null||r.addDragSource(o),this.resizeListeners.push(o),n.style.pointerEvents="all"):n.style.pointerEvents="none",this.resizable[t]=s)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;t!==-1&&(this.element.style.width=`${t}px`),e!==-1&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,i=this.element;let s=!1;if(typeof e=="string"&&e.includes("%"))Wu(i,e),e=vP(i),s=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const n=this.getAvailableHeight();n&&e>n&&(e=n)}this.getHeight()!==e&&(s?(i.style.maxHeight="unset",i.style.minHeight="unset"):t?Wu(i,e):(i.style.height=`${e}px`,i.style.flex="0 0 auto",this.lastSize.height=typeof e=="number"?e:Number.parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:i}=this.offsetParent;if(!i)return null;const s=this.element.getBoundingClientRect(),n=this.offsetParent.getBoundingClientRect(),o=e?this.position.y:s.top,r=e?0:n.top;let a=0;if(t){const c=this.element.parentElement;if(c){const{bottom:d}=c.getBoundingClientRect();a=d-s.bottom}}return i+r-o-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:i}=this.config;let s=!1;if(typeof e=="string"&&e.includes("%"))yo(t,e),e=Mm(t),s=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:n}=this.offsetParent,o=i?this.position.x:this.element.getBoundingClientRect().left;n&&e+o>n&&(e=n-o)}this.getWidth()!==e&&(s?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?yo(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width=typeof e=="number"?e:Number.parseFloat(e)))}offsetElement(e=0,t=0,i){var o;const{forcePopupParentAsOffsetParent:s}=this.config,n=s?this.boundaryEl:this.element;n&&((o=this.popupSvc)==null||o.positionPopup({ePopup:n,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t}),postProcessCallback:i}),this.setPosition(Number.parseFloat(n.style.left),Number.parseFloat(n.style.top)))}constrainSizeToAvailableHeight(e){var i,s;if(!this.config.forcePopupParentAsOffsetParent)return;const t=()=>{const n=this.getAvailableHeight();this.element.style.setProperty("max-height",`${n}px`)};e&&this.popupSvc?((i=this.resizeObserverSubscriber)==null||i.call(this),this.resizeObserverSubscriber=qa(this.beans,(s=this.popupSvc)==null?void 0:s.getPopupParent(),t)):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:i,isTop:s,anywhereWithin:n,topBuffer:o}=e,r=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y,l=this.shouldSkipX(t,!!i,!!n,r)?0:r,c=this.shouldSkipY(t,!!s,o,a)?0:a;return{movementX:l,movementY:c}}shouldSkipX(e,t,i,s){const n=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),r=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:n.left;let l=a<=0&&o.left>=e.clientX||o.right<=e.clientX&&o.right<=r.right;return l?!0:(t?l=s<0&&e.clientX>a+o.left||s>0&&e.clientX<a+o.left:i?l=s<0&&e.clientX>r.right||s>0&&e.clientX<a+o.left:l=s<0&&e.clientX>r.right||s>0&&e.clientX<r.right,l)}shouldSkipY(e,t,i=0,s){const n=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),r=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:n.top;let l=a<=0&&o.top>=e.clientY||o.bottom<=e.clientY&&o.bottom<=r.bottom;return l?!0:(t?l=s<0&&e.clientY>a+o.top+i||s>0&&e.clientY<a+o.top:l=s<0&&e.clientY>r.bottom||s>0&&e.clientY<r.bottom,l)}createResizeMap(){const e=t=>({element:this.element.querySelector(`[data-ref=${t}Resizer]`)});this.resizerMap={topLeft:e("eTopLeft"),top:e("eTop"),topRight:e("eTopRight"),right:e("eRight"),bottomRight:e("eBottomRight"),bottom:e("eBottom"),bottomLeft:e("eBottomLeft"),left:e("eLeft")}}addResizers(){if(this.resizersAdded)return;const e=this.element;e&&(e.appendChild(jt(JB)),this.createResizeMap(),this.resizersAdded=!0)}removeResizers(){this.resizerMap=void 0;const e=this.element.querySelector(`.${IT}`);e==null||e.remove(),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:i,forcePopupParentAsOffsetParent:s}=this.config;!i&&!s&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter(i=>!i.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const e=this.getSiblings()||[];let t=0,i=0;for(let s=0;s<e.length;s++){const n=e[s],o=!!n.style.flex&&n.style.flex!=="0 0 auto";if(n===this.element)continue;let r=this.minHeight||0,a=this.minWidth||0;if(o){const l=window.getComputedStyle(n);l.minHeight&&(r=Number.parseInt(l.minHeight,10)),l.minWidth&&(a=Number.parseInt(l.minWidth,10))}else r=n.offsetHeight,a=n.offsetWidth;t+=r,i+=a}return{height:t,width:i}}applySizeToSiblings(e){let t=null;const i=this.getSiblings();if(i){for(let s=0;s<i.length;s++){const n=i[s];n!==t&&(e?n.style.height=`${n.offsetHeight}px`:n.style.width=`${n.offsetWidth}px`,n.style.flex="0 0 auto",n===this.element&&(t=i[s+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup:t,forcePopupParentAsOffsetParent:i}=this.config,{isTop:s,isRight:n,isBottom:o,isLeft:r}=this.currentResizer,a=n||r,l=o||s,{movementX:c,movementY:d}=this.calculateMouseMovement({e,isLeft:r,isTop:s}),h=this.position.x,u=this.position.y;let f=0,p=0;if(a&&c){const m=r?-1:1,v=this.getWidth(),C=v+c*m;let w=!1;r&&(f=v-C,(h+f<=0||C<=this.minWidth)&&(w=!0,f=0)),w||this.setWidth(C)}if(l&&d){const m=s?-1:1,v=this.getHeight(),C=v+d*m;let w=!1;s?(p=v-C,(u+p<=0||C<=this.minHeight)&&(w=!0,p=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&v<C&&this.getMinSizeOfSiblings().height+C>this.element.parentElement.offsetHeight&&(w=!0),w||this.setHeight(C)}this.updateDragStartPosition(e.clientX,e.clientY),((t||i)&&f||p)&&this.offsetElement(h+f,u+p)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:i}=this.position;let s;this.config.calculateTopBuffer&&(s=this.config.calculateTopBuffer());const{movementX:n,movementY:o}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:s});this.offsetElement(t+n,i+o),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent&&this.popupSvc?this.offsetParent=this.popupSvc.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if(window.getComputedStyle(e).position!=="static")return e;e=e.parentElement}return this.element}clearResizeListeners(){var e;for(;this.resizeListeners.length;){const t=this.resizeListeners.pop();(e=this.dragSvc)==null||e.removeDragSource(t)}}destroy(){var e;super.destroy(),this.moveElementDragListener&&((e=this.dragSvc)==null||e.removeDragSource(this.moveElementDragListener)),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},kT="__ag_Grid_Stop_Propagation";function _c(e){e[kT]=!0}function Rr(e){return e[kT]===!0}var eV="ag-focus-managed",su=class extends V{constructor(e,t={}){super(),this.eFocusable=e,this.callbacks=t,this.callbacks={shouldStopEventPropagation:()=>!1,onTabKeyDown:i=>{if(i.defaultPrevented)return;const s=Kc(this.beans,this.eFocusable,!1,i.shiftKey);s&&(s.focus(),i.preventDefault())},...t}}postConstruct(){const{eFocusable:e,callbacks:{onFocusIn:t,onFocusOut:i}}=this;e.classList.add(eV),this.addKeyDownListeners(e),t&&this.addManagedElementListeners(e,{focusin:t}),i&&this.addManagedElementListeners(e,{focusout:i})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:t=>{if(t.defaultPrevented||Rr(t))return;const{callbacks:i}=this;if(i.shouldStopEventPropagation(t)){_c(t);return}t.key===H.TAB?i.onTabKeyDown(t):i.handleKeyDown&&i.handleKeyDown(t)}})}},tV=class extends ct{constructor(e,t){super(),this.filterNameKey=e,this.cssIdentifier=t,this.applyActive=!1,this.debouncePending=!1,this.defaultDebounceMs=0}postConstruct(){const e={tag:"div",cls:`ag-filter-body-wrapper ag-${this.cssIdentifier}-body-wrapper`,children:[this.createBodyTemplate()]};this.setTemplate(e,this.getAgComponents()),this.createManagedBean(new su(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=this.createBean(new ZB(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}))}handleKeyDown(e){}init(e){const t=e;this.setParams(t),this.setModelIntoUi(t.state.model,!0).then(()=>this.updateUiVisibility())}refresh(e){const t=e,i=this.params;this.params=t,t.source==="colDef"&&this.updateParams(t,i);const n=t.state,o=this.state;return this.state=n,(n.model!==o.model||n.state!==o.state)&&this.setModelIntoUi(n.model),!0}setParams(e){this.params=e,this.state=e.state,this.commonUpdateParams(e)}updateParams(e,t){this.commonUpdateParams(e,t)}commonUpdateParams(e,t){this.applyActive=Wv(e),this.setupApplyDebounced()}doesFilterPass(e){j(283);const{getHandler:t,model:i,column:s}=this.params;return t().doesFilterPass({...e,model:i,handlerParams:this.beans.colFilter.getHandlerParams(s)})}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return j(284),this.params.model!=null}setupApplyDebounced(){const e=FS(this.params,this.defaultDebounceMs),t=Pi(this,this.checkApplyDebounce.bind(this),e);this.applyDebounced=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.doApplyModel())}getModel(){return j(285),this.params.model}setModel(e){j(286);const{beans:t,params:i}=this;return t.colFilter.setModelForColumnLegacy(i.column,e)}applyModel(e="api"){return this.doApplyModel()}canApply(e){return!0}doApplyModel(e){const{params:t,state:i}=this,s=!this.areModelsEqual(t.model,i.model);return s&&t.onAction("apply",e),s}onNewRowsLoaded(){}onUiChanged(e,t=!1){this.updateUiVisibility();const i=this.getModelFromUi(),s={model:i,state:this.getState(),valid:this.canApply(i)};this.state=s;const n=this.params;n.onStateChange(s),n.onUiChange(this.getUiChangeEventParams()),this.gos.get("enableFilterHandlers")||this.eventSvc.dispatchEvent({type:"filterModified",column:n.column,filterInstance:this}),e??(e=this.applyActive?void 0:"debounce"),e==="immediately"?this.doApplyModel({afterFloatingFilter:t,afterDataChange:!1}):e==="debounce"&&this.applyDebounced()}getState(){}getUiChangeEventParams(){}afterGuiAttached(e){this.lastContainerType=e==null?void 0:e.container,this.refreshFilterResizer(e==null?void 0:e.container)}refreshFilterResizer(e){const{positionableFeature:t,gos:i}=this;if(!t)return;const s=e==="floatingFilter"||e==="columnFilter";s?(t.restoreLastSize(),t.setResizable(i.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(t.removeSizeFromEl(),t.setResizable(!1)),t.constrainSizeToAvailableHeight(s)}afterGuiDetached(){var e;this.checkApplyDebounce(),(e=this.positionableFeature)==null||e.constrainSizeToAvailableHeight(!1)}destroy(){this.positionableFeature=this.destroyBean(this.positionableFeature),super.destroy()}translate(e){return Yr(this,e)}getPositionableElement(){return this.getGui()}areModelsEqual(e,t){return e===t||e==null&&t==null?!0:e==null||t==null?!1:this.areNonNullModelsEqual(e,t)}};function _T(e){return!!e.operator}function iV(e,t,i){if(t==null)return null;let s=null;const{compName:n,jsComp:o,fwComp:r}=aT(e,t);return n?s={agSetColumnFilter:"agSetColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[n]:o==null&&r==null&&t.filter===!0&&(s=i()),s}var An={AUTO_HEIGHT:"ag-layout-auto-height",NORMAL:"ag-layout-normal",PRINT:"ag-layout-print"},PS=class extends V{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.gos.get("domLayout"),t={autoHeight:e==="autoHeight",normal:e==="normal",print:e==="print"},i=t.autoHeight?An.AUTO_HEIGHT:t.print?An.PRINT:An.NORMAL;this.view.updateLayoutClasses(i,t)}},Br="Viewport",FR="fakeVScrollComp",DC=["fakeHScrollComp","centerHeader","topCenter","bottomCenter","stickyTopCenter","stickyBottomCenter"],PR=100,MC=150,sV=class extends V{constructor(e){super(),this.clearRetryListenerFncs=[],this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.lastIsHorizontalScrollShowing=!1,this.scrollTimer=0,this.isScrollActive=!1,this.isVerticalPositionInvalidated=!0,this.isHorizontalPositionInvalidated=!0,this.eBodyViewport=e,this.resetLastHScrollDebounced=Pi(this,()=>this.lastScrollSource[1]=null,MC),this.resetLastVScrollDebounced=Pi(this,()=>this.lastScrollSource[0]=null,MC)}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.animationFrameSvc=e.animationFrameSvc,this.visibleCols=e.visibleCols}destroy(){super.destroy(),this.clearRetryListenerFncs=[],window.clearTimeout(this.scrollTimer)}postConstruct(){this.enableRtl=this.gos.get("enableRtl");const e=this.invalidateVerticalScroll.bind(this),t=this.invalidateHorizontalScroll.bind(this);this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),bodyHeightChanged:e,scrollGapChanged:t}),this.addManagedElementListeners(this.eBodyViewport,{scroll:e}),this.ctrlsSvc.whenReady(this,i=>{this.centerRowsCtrl=i.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}invalidateHorizontalScroll(){this.isHorizontalPositionInvalidated=!0}invalidateVerticalScroll(){this.isVerticalPositionInvalidated=!0}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.eViewport,{scroll:this.onHScroll.bind(this,Br)});for(const e of DC){const t=this.ctrlsSvc.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){const e=this.ctrlsSvc.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),i=t?Pi(this,this.onVScroll.bind(this,Br),PR):this.onVScroll.bind(this,Br),s=t?Pi(this,this.onVScroll.bind(this,FR),PR):this.onVScroll.bind(this,FR);this.addManagedElementListeners(this.eBodyViewport,{scroll:i}),this.registerScrollPartner(e,s)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){this.centerRowsCtrl!=null&&(e===void 0&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(const t of[...DC,Br]){if(this.lastScrollSource[1]===t)continue;const i=this.getViewportForSource(t);km(i,e,this.enableRtl)}}getViewportForSource(e){return e===Br?this.centerRowsCtrl.eViewport:this.ctrlsSvc.get(e).eViewport}isControllingScroll(e,t){return this.lastScrollSource[t]==null?(t===0?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;const t=this.centerRowsCtrl.eViewport,{scrollLeft:i}=t;if(this.shouldBlockScrollUpdate(1,i,!0))return;const s=Im(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(s),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;if(e===Br?t=this.eBodyViewport.scrollTop:t=this.ctrlsSvc.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0))return;const{animationFrameSvc:i}=this;i==null||i.setScrollTop(t),this.nextScrollTop=t,e===Br?this.ctrlsSvc.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,i!=null&&i.active?i.schedule():this.scrollGridIfNeeded(!0),this.resetLastVScrollDebounced()}doHorizontalScroll(e){const t=this.ctrlsSvc.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}isScrolling(){return this.isScrollActive}fireScrollEvent(e){const t={type:"bodyScroll",direction:e===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.isScrollActive=!0,this.eventSvc.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout(()=>{this.scrollTimer=0,this.isScrollActive=!1,this.eventSvc.dispatchEvent({...t,type:"bodyScrollEnd"})},MC)}shouldBlockScrollUpdate(e,t,i=!1){return i&&!Sc()?!1:e===0?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t)}shouldBlockVerticalScroll(e){const t=nS(this.eBodyViewport),{scrollHeight:i}=this.eBodyViewport;return e<0||e+t>i}shouldBlockHorizontalScroll(e){const t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:i}=this.centerRowsCtrl.eViewport;if(this.enableRtl){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>i}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){const e=this.scrollLeft;let t=!1;for(const i of DC)if(this.getViewportForSource(i).scrollLeft!==e){t=!0;break}t&&this.onHScroll(Br)}scrollGridIfNeeded(e=!1){const t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,e&&this.invalidateVerticalScroll(),this.redrawRowsAfterScroll()),t}setHorizontalScrollPosition(e,t=!1){const s=this.centerRowsCtrl.eViewport.scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(this.enableRtl?e=e>0?0:s:e=Math.min(Math.max(e,0),s)),km(this.centerRowsCtrl.eViewport,Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.invalidateVerticalScroll(),this.eBodyViewport.scrollTop=e}getVScrollPosition(){if(!this.isVerticalPositionInvalidated){const{lastOffsetHeight:i,lastScrollTop:s}=this;return{top:s,bottom:s+i}}this.isVerticalPositionInvalidated=!1;const{scrollTop:e,offsetHeight:t}=this.eBodyViewport;return this.lastScrollTop=e,this.lastOffsetHeight=t,{top:e,bottom:e+t}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.isHorizontalPositionInvalidated&&(this.lastIsHorizontalScrollShowing=this.centerRowsCtrl.isHorizontalScrollShowing(),this.isHorizontalPositionInvalidated=!1),this.lastIsHorizontalScrollShowing}scrollHorizontally(e){const t=this.centerRowsCtrl.eViewport.scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.eViewport.scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){const{rowModel:i}=this.beans,s=i.getRowCount();let n=-1;for(let o=0;o<s;o++){const r=i.getRow(o);if(typeof e=="function"){if(r&&e(r)){n=o;break}}else if(e===r||e===r.data){n=o;break}}n>=0&&this.ensureIndexVisible(n,t)}ensureIndexVisible(e,t,i=0){if(Ii(this.gos,"print"))return;const{rowModel:s}=this.beans,n=s.getRowCount();if(typeof e!="number"||e<0||e>=n){j(88,{index:e});return}this.clearRetryListeners();const{frameworkOverrides:o,pageBounds:r,rowContainerHeight:a,rowRenderer:l}=this.beans;o.wrapIncoming(()=>{var p,m;const c=this.ctrlsSvc.getGridBodyCtrl(),d=s.getRow(e);let h,u,f=0;this.invalidateVerticalScroll();do{const{stickyTopHeight:v,stickyBottomHeight:C}=c,w=d.rowTop,S=d.rowHeight,b=r.getPixelOffset(),E=d.rowTop-b,A=E+d.rowHeight,P=this.getVScrollPosition(),T=a.divStretchOffset,D=P.top+T,N=P.bottom+T,M=N-D,_=a.getScrollPositionForPixel(E),W=a.getScrollPositionForPixel(A-M),$=Math.min((_+W)/2,E),B=D+v>E,q=N-C<A;let X=null;t==="top"?X=_-v:t==="bottom"?X=W+C:t==="middle"?X=$:B?X=_-v:q&&(W-_>M?X=_-v:X=W+C),X!==null&&(this.setVerticalScrollPosition(X),l.redraw({afterScroll:!0})),h=w!==d.rowTop||S!==d.rowHeight,u=v!==c.stickyTopHeight||C!==c.stickyBottomHeight,f++}while((h||u)&&f<10);if((p=this.animationFrameSvc)==null||p.flushAllFrames(),i<10&&(d!=null&&d.stub||!((m=this.beans.rowAutoHeight)!=null&&m.areRowsMeasured()))){const v=this.getVScrollPosition().top;this.clearRetryListenerFncs=this.addManagedEventListeners({bodyScroll:()=>{const C=this.getVScrollPosition().top;v!==C&&this.clearRetryListeners()},modelUpdated:()=>{this.clearRetryListeners(),!(e>=s.getRowCount())&&this.ensureIndexVisible(e,t,i+1)}})}})}clearRetryListeners(){for(const e of this.clearRetryListenerFncs)e();this.clearRetryListenerFncs=[]}ensureColumnVisible(e,t="auto"){const{colModel:i,frameworkOverrides:s}=this.beans,n=i.getCol(e);if(!n||n.isPinned()||!this.visibleCols.isColDisplayed(n))return;const o=this.getPositionedHorizontalScroll(n,t);s.wrapIncoming(()=>{var r;o!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(o),this.centerRowsCtrl.onHorizontalViewportChanged(),(r=this.animationFrameSvc)==null||r.flushAllFrames()})}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:i,columnAfterEnd:s}=this.isColumnOutsideViewport(e),n=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),o=this.centerRowsCtrl.getCenterWidth(),r=this.enableRtl;let a=(r?i:s)||n,l=r?s:i;t!=="auto"&&(a=t==="start",l=t==="end");const c=t==="middle";if(a||l||c){const{colLeft:d,colMiddle:h,colRight:u}=this.getColumnBounds(e);return c?h-o/2:a?r?u:d:r?d-o:u-o}return null}isColumnOutsideViewport(e){const{start:t,end:i}=this.getViewportBounds(),{colLeft:s,colRight:n}=this.getColumnBounds(e),o=this.enableRtl,r=o?t>n:i<n,a=o?i<s:t>s;return{columnBeforeStart:r,columnAfterEnd:a}}getColumnBounds(e){const t=this.enableRtl,i=this.visibleCols.bodyWidth,s=e.getActualWidth(),n=e.getLeft(),o=t?-1:1,r=t?i-n:n,a=r+s*o,l=r+s/2*o;return{colLeft:r,colMiddle:l,colRight:a}}getViewportBounds(){const e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft(),i=t,s=e+t;return{start:i,end:s,width:e}}},TS=class extends V{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){const e=Ii(this.gos,"print"),{visibleCols:t,scrollVisibleSvc:i}=this.beans,s=t.bodyWidth,n=t.getColsLeftWidth(),o=t.getDisplayedColumnsRightWidth();let r;e?r=s+n+o:(r=s,this.addSpacer&&(this.gos.get("enableRtl")?n:o)===0&&i.verticalScrollShowing&&(r+=i.getScrollbarWidth())),this.callback(r)}},nV=class extends V{constructor(e){super(),this.centerContainerCtrl=e}wireBeans(e){this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){const{beans:e,centerContainerCtrl:t,gridBodyCtrl:i}=this,s=()=>{Lr(e,()=>{this.onCenterViewportResized()})};t.registerViewportResizeListener(s),i.registerBodyViewportResizeListener(s)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleSvc.updateScrollGap(),this.centerContainerCtrl.isViewportInTheDOMTree()){const{pinnedCols:e,colFlex:t}=this.beans;e==null||e.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const i=this.centerContainerCtrl.getCenterWidth();i!==this.centerWidth&&(this.centerWidth=i,t==null||t.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.scrollFeature.checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const e=this.gridBodyCtrl.eBodyViewport,t=nS(e);this.bodyHeight!==t&&(this.bodyHeight=t,this.eventSvc.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){if(!this.isAlive())return;const e={horizontalScrollShowing:this.centerContainerCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleSvc.setScrollsVisible(e)}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.beans.colViewport.setScrollPosition(e,t)}};function gm(e,t,i,s){var o;const n=(o=t.getColDef().cellRendererParams)==null?void 0:o.suppressMouseEventHandling;return LT(e,t,i,s,n)}function oV(e,t,i,s){const n=t==null?void 0:t.suppressMouseEventHandling;return LT(e,void 0,i,s,n)}function LT(e,t,i,s,n){return n?n(Fe(e,{column:t,node:i,event:s})):!1}function OT(e,t,i){let s=t;for(;s;){const n=NP(e,s,i);if(n)return n;s=s.parentElement}return null}var jm="cellCtrl";function DS(e,t){return OT(e,t,jm)}var Km="renderedRow";function rV(e,t){return OT(e,t,Km)}function ny(e,t,i,s,n){const o=s?s.getColDef().suppressKeyboardEvent:void 0;if(!o)return!1;const r=Fe(e,{event:t,editing:n,column:s,node:i,data:i.data,colDef:s.getColDef()});return!!(o&&o(r))}function aV(e){const{pinnedRowModel:t,rowModel:i}=e,[s,n]=[(t==null?void 0:t.isEmpty("top"))??!0,(t==null?void 0:t.isEmpty("bottom"))??!0],o=s?null:"top";let r,a;n?(r=null,a=i.getRowCount()-1):(r="bottom",a=(t==null?void 0:t.getPinnedBottomRowCount())??-1);const{visibleCols:l,rangeSvc:c}=e,d=l.allCols;!c||!(d!=null&&d.length)||c.setCellRange({rowStartIndex:0,rowStartPinned:o,rowEndIndex:a,rowEndPinned:r})}var lV=65,cV=67,dV=86,hV=68,uV=90,gV=89;function fV(e){const{keyCode:t}=e;let i;switch(t){case lV:i=H.A;break;case cV:i=H.C;break;case dV:i=H.V;break;case hV:i=H.D;break;case uV:i=H.Z;break;case gV:i=H.Y;break;default:i=e.code}return i}var pV=class extends V{constructor(e){super(),this.element=e}postConstruct(){var e;this.addKeyboardListeners(),this.addMouseListeners(),(e=this.beans.touchSvc)==null||e.mockRowContextMenu(this),this.editSvc=this.beans.editSvc}addKeyboardListeners(){const e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){const t=["dblclick","contextmenu","mouseover","mouseout","click",xP("touchstart")?"touchstart":"mousedown"];for(const i of t){const s=this.processMouseEvent.bind(this,i);this.addManagedElementListeners(this.element,{[i]:s})}}processMouseEvent(e,t){var n;if(!dg(this.beans,t)||Rr(t))return;const{cellCtrl:i,rowCtrl:s}=this.getControlsForEventTarget(t.target);e==="contextmenu"?(i!=null&&i.column&&i.dispatchCellContextMenuEvent(t),(n=this.beans.contextMenuSvc)==null||n.handleContextMenuMouseEvent(t,void 0,s,i)):(i&&i.onMouseEvent(e,t),s&&s.onMouseEvent(e,t))}getControlsForEventTarget(e){const{gos:t}=this;return{cellCtrl:DS(t,e),rowCtrl:rV(t,e)}}processKeyboardEvent(e,t){const{cellCtrl:i,rowCtrl:s}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(i?this.processCellKeyboardEvent(i,e,t):s!=null&&s.isFullWidth()&&this.processFullWidthRowKeyboardEvent(s,e,t))}processCellKeyboardEvent(e,t,i){var o,r;const s=((o=this.editSvc)==null?void 0:o.isEditing(e,{withOpenEditor:!0}))??!1;!ny(this.gos,i,e.rowNode,e.column,s)&&t==="keydown"&&(!s&&((r=this.beans.navigation)!=null&&r.handlePageScrollingKey(i))||e.onKeyDown(i),this.doGridOperations(i,s),uT(i)&&e.processCharacter(i)),t==="keydown"&&this.eventSvc.dispatchEvent(e.createEvent(i,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,i){const{rowNode:s}=e,{focusSvc:n,navigation:o}=this.beans,r=n.getFocusedCell(),a=r==null?void 0:r.column;if(!ny(this.gos,i,s,a,!1)){const c=i.key;if(t==="keydown")switch(c){case H.PAGE_HOME:case H.PAGE_END:case H.PAGE_UP:case H.PAGE_DOWN:o==null||o.handlePageScrollingKey(i,!0);break;case H.LEFT:case H.RIGHT:if(!this.gos.get("embedFullWidthRows"))break;case H.UP:case H.DOWN:e.onKeyboardNavigate(i);break;case H.TAB:e.onTabKeyDown(i);break}}t==="keydown"&&this.eventSvc.dispatchEvent(e.createRowEvent("cellKeyDown",i))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!dg(this.beans,e))return;const i=fV(e),{clipboardSvc:s,undoRedo:n}=this.beans;if(i===H.A)return this.onCtrlAndA(e);if(i===H.C)return this.onCtrlAndC(s,e);if(i===H.D)return this.onCtrlAndD(s,e);if(i===H.V)return this.onCtrlAndV(s,e);if(i===H.X)return this.onCtrlAndX(s,e);if(i===H.Y)return this.onCtrlAndY(n);if(i===H.Z)return this.onCtrlAndZ(n,e)}onCtrlAndA(e){const{beans:{rowModel:t,rangeSvc:i,selectionSvc:s},gos:n}=this;i&&Tr(n)&&!lG(n)&&t.isRowsToRender()?aV(this.beans):s&&s.selectAllRowNodes({source:"keyboardSelectAll",selectAll:WP(n)}),e.preventDefault()}onCtrlAndC(e,t){var s;if(!e||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:i}=this.getControlsForEventTarget(t.target);(s=this.editSvc)!=null&&s.isEditing(i,{withOpenEditor:!0})||(t.preventDefault(),e.copyToClipboard())}onCtrlAndX(e,t){var s;if(!e||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:i}=this.getControlsForEventTarget(t.target);(s=this.editSvc)!=null&&s.isEditing(i,{withOpenEditor:!0})||(t.preventDefault(),e.cutToClipboard(void 0,"ui"))}onCtrlAndV(e,t){var s;const{cellCtrl:i}=this.getControlsForEventTarget(t.target);(s=this.editSvc)!=null&&s.isEditing(i,{withOpenEditor:!0})||e&&!this.gos.get("suppressClipboardPaste")&&e.pasteFromClipboard()}onCtrlAndD(e,t){e&&!this.gos.get("suppressClipboardPaste")&&e.copyRangeDown(),t.preventDefault()}onCtrlAndZ(e,t){!this.gos.get("undoRedoCellEditing")||!e||(t.preventDefault(),t.shiftKey?e.redo("ui"):e.undo("ui"))}onCtrlAndY(e){e==null||e.redo("ui")}},NT=class extends V{constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this,this.beans.rowContainerHeight)})}onHeightChanged(e){const t=e.uiContainerHeight,i=t!=null?`${t}px`:"";this.eContainer.style.height=i,this.eViewport&&(this.eViewport.style.height=i)}},wp=e=>e.topRowCtrls,bp=e=>e.getStickyTopRowCtrls(),yp=e=>e.getStickyBottomRowCtrls(),Sp=e=>e.bottomRowCtrls,Rp=e=>e.allRowCtrls,IC=e=>e.getCtrls("top"),kC=e=>e.getCtrls("center"),_C=e=>e.getCtrls("bottom"),mV={center:{type:"center",name:"center-cols",getRowCtrls:Rp,getSpannedRowCtrls:kC},left:{type:"left",name:"pinned-left-cols",pinnedType:"left",getRowCtrls:Rp,getSpannedRowCtrls:kC},right:{type:"right",name:"pinned-right-cols",pinnedType:"right",getRowCtrls:Rp,getSpannedRowCtrls:kC},fullWidth:{type:"fullWidth",name:"full-width",fullWidth:!0,getRowCtrls:Rp},topCenter:{type:"center",name:"floating-top",getRowCtrls:wp,getSpannedRowCtrls:IC},topLeft:{type:"left",name:"pinned-left-floating",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:wp,getSpannedRowCtrls:IC},topRight:{type:"right",name:"pinned-right-floating",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:wp,getSpannedRowCtrls:IC},topFullWidth:{type:"fullWidth",name:"floating-top-full-width",fullWidth:!0,getRowCtrls:wp},stickyTopCenter:{type:"center",name:"sticky-top",getRowCtrls:bp},stickyTopLeft:{type:"left",name:"pinned-left-sticky-top",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:bp},stickyTopRight:{type:"right",name:"pinned-right-sticky-top",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:bp},stickyTopFullWidth:{type:"fullWidth",name:"sticky-top-full-width",fullWidth:!0,getRowCtrls:bp},stickyBottomCenter:{type:"center",name:"sticky-bottom",getRowCtrls:yp},stickyBottomLeft:{type:"left",name:"pinned-left-sticky-bottom",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:yp},stickyBottomRight:{type:"right",name:"pinned-right-sticky-bottom",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:yp},stickyBottomFullWidth:{type:"fullWidth",name:"sticky-bottom-full-width",fullWidth:!0,getRowCtrls:yp},bottomCenter:{type:"center",name:"floating-bottom",getRowCtrls:Sp,getSpannedRowCtrls:_C},bottomLeft:{type:"left",name:"pinned-left-floating-bottom",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:Sp,getSpannedRowCtrls:_C},bottomRight:{type:"right",name:"pinned-right-floating-bottom",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:Sp,getSpannedRowCtrls:_C},bottomFullWidth:{type:"fullWidth",name:"floating-bottom-full-width",fullWidth:!0,getRowCtrls:Sp}};function HT(e){return`ag-${Zf(e).name}-viewport`}function fm(e){const t=Zf(e);return t.container??`ag-${t.name}-container`}function vV(e){return`ag-${Zf(e).name}-spanned-cells-container`}function Zf(e){return mV[e]}var CV=["topCenter","topLeft","topRight"],wV=["bottomCenter","bottomLeft","bottomRight"],bV=["center","left","right"],yV=["center","left","right","fullWidth"],SV=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],RV=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],xV=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],GT=["stickyTopCenter","stickyTopLeft","stickyTopRight"],BT=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],EV=[...GT,"stickyTopFullWidth",...BT,"stickyBottomFullWidth"],AV=[...CV,...wV,...bV,...GT,...BT],FV=class extends V{constructor(e){super(),this.name=e,this.visible=!0,this.EMPTY_CTRLS=[],this.options=Zf(e)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new nV(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.beans.ctrlsSvc.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}setComp(e,t,i,s){this.comp=e,this.eContainer=t,this.eSpannedContainer=i,this.eViewport=s,this.createManagedBean(new pV(this.eViewport??this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();const{pinnedCols:n,rangeSvc:o}=this.beans,r=()=>this.onPinnedWidthChanged();this.forContainers(RV,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(n==null?void 0:n.createPinnedWidthFeature(!0,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:r})}),this.forContainers(xV,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(n==null?void 0:n.createPinnedWidthFeature(!1,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:r})}),this.forContainers(yV,()=>this.createManagedBean(new NT(this.eContainer,this.name==="center"?s:void 0))),o&&this.forContainers(AV,()=>this.createManagedBean(o.createDragListenerFeature(this.eContainer))),this.forContainers(SV,()=>this.createManagedBean(new TS(a=>this.comp.setContainerWidth(`${a}px`)))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}addListeners(){const{spannedRowRenderer:e,gos:t}=this.beans,i=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({displayedColumnsChanged:i,displayedColumnsWidthChanged:i,displayedRowsChanged:s=>this.onDisplayedRowsChanged(s.afterScroll)}),i(),this.onDisplayedRowsChanged(),e&&this.options.getSpannedRowCtrls&&t.get("enableCellSpan")&&this.addManagedListeners(e,{spannedRowsUpdated:()=>{const s=this.options.getSpannedRowCtrls(e);s&&this.comp.setSpannedRowCtrls(s,!1)}})}listenOnDomOrder(){if(EV.indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}const t=()=>{const i=this.gos.get("ensureDomOrder"),s=Ii(this.gos,"print");this.comp.setDomOrder(i||s)};this.addManagedPropertyListener("domLayout",t),t()}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){const{dragSvc:e}=this.beans;if(!e)return;const t=i=>{e.dragging&&i.cancelable&&i.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",t))}onHorizontalViewportChanged(e=!1){const t=this.getCenterWidth(),i=this.getCenterViewportScrollLeft();this.beans.colViewport.setScrollPosition(t,i,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return cg(this.eViewport)}getCenterViewportScrollLeft(){return Im(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const t=qa(this.beans,this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportInTheDOMTree(){return wP(this.eViewport)}getViewportScrollLeft(){return Im(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||rS(this.eViewport)}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){km(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(this.options.pinnedType!=null)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(e=!1){const t=this.options.getRowCtrls(this.beans.rowRenderer);if(!this.visible||t.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}const i=Ii(this.gos,"print"),n=this.gos.get("embedFullWidthRows")||i,o=t.filter(r=>{const a=r.isFullWidth();return this.options.fullWidth?!n&&a:n||!a});this.comp.setRowCtrls({rowCtrls:o,useFlushSync:e})}},VT="ag-force-vertical-scroll",PV="ag-selectable",TV="ag-column-moving",DV=class extends V{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colModel=e.colModel,this.scrollVisibleSvc=e.scrollVisibleSvc,this.pinnedRowModel=e.pinnedRowModel,this.filterManager=e.filterManager,this.rowGroupColsSvc=e.rowGroupColsSvc}setComp(e,t,i,s,n,o,r){var a,l;this.comp=e,this.eGridBody=t,this.eBodyViewport=i,this.eTop=s,this.eBottom=n,this.eStickyTop=o,this.eStickyBottom=r,this.eCenterColsViewport=i.querySelector(`.${HT("center")}`),this.eFullWidthContainer=i.querySelector(`.${fm("fullWidth")}`),this.eStickyTopFullWidthContainer=o.querySelector(`.${fm("stickyTopFullWidth")}`),this.eStickyBottomFullWidthContainer=r.querySelector(`.${fm("stickyBottomFullWidth")}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",c=>this.setCellTextSelection(c.currentValue)),this.createManagedBean(new PS(this.comp)),this.scrollFeature=this.createManagedBean(new sV(i)),(a=this.beans.rowDragSvc)==null||a.setupRowDrag(i,this),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([s,i,n,o,r]),this.setGridRootRole(),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),(l=this.filterManager)==null||l.setupAdvFilterHeaderComp(s),this.ctrlsSvc.register("gridBodyCtrl",this)}addEventListeners(){const e=this.setFloatingHeights.bind(this),t=this.setGridRootRole.bind(this),i=this.toggleRowResizeStyles.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.updateScrollingClasses.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,pinnedRowsChanged:e,headerHeightChanged:this.setStickyTopOffsetTop.bind(this),columnRowGroupChanged:t,columnPivotChanged:t,rowResizeStarted:i,rowResizeEnded:i}),this.addManagedPropertyListener("treeData",t)}toggleRowResizeStyles(e){const t=e.type==="rowResizeStarted";this.eBodyViewport.classList.toggle("ag-prevent-animation",t)}onGridColumnsChanged(){const e=this.beans.colModel.getCols();this.comp.setColumnCount(e.length)}onScrollVisibilityChanged(){const{scrollVisibleSvc:e}=this,t=e.verticalScrollShowing;this.setVerticalScrollPaddingVisible(t),this.setStickyWidth(t),this.setStickyBottomOffsetBottom();const i=t&&e.getScrollbarWidth()||0,s=hT()?16:0,n=`calc(100% + ${i+s}px)`;Lr(this.beans,()=>this.comp.setBodyViewportWidth(n)),this.updateScrollingClasses()}setGridRootRole(){const{rowGroupColsSvc:e,colModel:t}=this;let i=this.gos.get("treeData");if(!i){const s=t.isPivotMode();i=(e?e.columns.length:0)>=(s?2:1)}this.comp.setGridRootRole(i?"treegrid":"grid")}addFocusListeners(e){for(const t of e)this.addManagedElementListeners(t,{focusin:i=>{const{target:s}=i,n=wc(s,"ag-root",t);t.classList.toggle("ag-has-focus",!n)},focusout:i=>{const{target:s,relatedTarget:n}=i,o=t.contains(n),r=wc(n,"ag-root",t);wc(s,"ag-root",t)||(!o||r)&&t.classList.remove("ag-has-focus")}})}setColumnMovingCss(e){this.comp.setColumnMovingCss(TV,e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss(PV,e)}updateScrollingClasses(){const{eGridBody:{classList:e},scrollVisibleSvc:t}=this;e.toggle("ag-body-vertical-content-no-gap",!t.verticalScrollGap),e.toggle("ag-body-horizontal-content-no-gap",!t.horizontalScrollGap)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){var e;(e=this.beans.editSvc)==null||e.addStopEditingWhenGridLosesFocus([this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom])}updateRowCount(){var n,o;const e=(((n=this.ctrlsSvc.getHeaderRowContainerCtrl())==null?void 0:n.getRowCount())??0)+(((o=this.filterManager)==null?void 0:o.getHeaderRowCount())??0),{rowModel:t}=this.beans,i=t.isLastRowIndexKnown()?t.getRowCount():-1,s=i===-1?-1:e+i;this.comp.setRowCount(s)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gos.get("alwaysShowVerticalScroll"),t=e?VT:null,i=Ii(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||i&&SP(this.eBodyViewport)}setupRowAnimationCssClass(){const{rowContainerHeight:e,environment:t}=this.beans;let i=t.sizesMeasured;const s=()=>{const n=i&&xd(this.gos)&&!e.stretching,o=n?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(o,n)};s(),this.addManagedEventListeners({heightScaleChanged:s}),this.addManagedPropertyListener("animateRows",s),this.addManagedEventListeners({gridStylesChanged:()=>{!i&&t.sizesMeasured&&(i=!0,s())}})}addBodyViewportListener(){const{eBodyViewport:e,eStickyTop:t,eStickyBottom:i,eTop:s,eBottom:n,beans:{popupSvc:o,touchSvc:r}}=this,a=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(e,{contextmenu:a}),r==null||r.mockBodyContextMenu(this,a),this.addManagedElementListeners(e,{wheel:this.onBodyViewportWheel.bind(this,o)});const l=this.onStickyWheel.bind(this);for(const d of[t,i,s,n])this.addManagedElementListeners(d,{wheel:l});const c=this.onHorizontalWheel.bind(this);for(const d of["left","right","topLeft","topRight","bottomLeft","bottomRight"])this.addManagedElementListeners(this.ctrlsSvc.get(d).eContainer,{wheel:c});this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){const{deltaX:t,deltaY:i,shiftKey:s}=e;(s||Math.abs(t)>Math.abs(i))&&dg(this.beans,e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){const{deltaY:t}=e;this.scrollVertically(t)>0&&e.preventDefault()}onHorizontalWheel(e){const{deltaX:t,deltaY:i,shiftKey:s}=e;(s||Math.abs(t)>Math.abs(i))&&this.scrollGridBodyToMatchEvent(e)}scrollGridBodyToMatchEvent(e){const{deltaX:t,deltaY:i}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||i})}onBodyViewportContextMenu(e,t,i){var n;if(!e&&!i)return;this.gos.get("preventDefaultOnContextMenu")&&(e||i).preventDefault();const{target:s}=e||t;(s===this.eBodyViewport||s===this.ctrlsSvc.get("center").eViewport)&&((n=this.beans.contextMenuSvc)==null||n.showContextMenu({mouseEvent:e,touchEvent:i,value:null,anchorToElement:this.eGridBody,source:"ui"}))}onBodyViewportWheel(e,t){this.gos.get("suppressScrollWhenPopupsAreOpen")&&e!=null&&e.hasAnchoredPopup()&&t.preventDefault()}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.scrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}setFloatingHeights(){const{pinnedRowModel:e,beans:{environment:t}}=this,i=e==null?void 0:e.getPinnedTopTotalHeight(),s=e==null?void 0:e.getPinnedBottomTotalHeight(),n=t.getPinnedRowBorderWidth(),o=t.getRowBorderWidth(),r=n-o,a=i?r+i:0,l=s?r+s:0;this.comp.setTopHeight(a),this.comp.setBottomHeight(l),this.comp.setTopInvisible(a<=0),this.comp.setBottomInvisible(l<=0),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}setStickyWidth(e){if(!e)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{const t=this.scrollVisibleSvc.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}}setStickyTopOffsetTop(){var n,o;const t=this.ctrlsSvc.get("gridHeaderCtrl").headerHeight+(((n=this.filterManager)==null?void 0:n.getHeaderHeight())??0),i=((o=this.pinnedRowModel)==null?void 0:o.getPinnedTopTotalHeight())??0;let s=0;t>0&&(s+=t),i>0&&(s+=i),s>0&&(s+=1),this.comp.setStickyTopTop(`${s}px`)}setStickyBottomOffsetBottom(){const{pinnedRowModel:e,scrollVisibleSvc:t,comp:i}=this,s=(e==null?void 0:e.getPinnedBottomTotalHeight())??0,o=t.horizontalScrollShowing&&t.getScrollbarWidth()||0,r=s+o;i.setStickyBottomBottom(`${r}px`)}};function MV(e,t){var i;return((i=DS(e,t.target))==null?void 0:i.getFocusedCellPosition())??null}function TR(e,t){const i=Ii(e.gos,"normal"),s=t;let n,o;s.clientX!=null||s.clientY!=null?(n=s.clientX,o=s.clientY):(n=s.x,o=s.y);const{pageFirstPixel:r}=e.pageBounds.getCurrentPagePixelRange();if(o+=r,i){const a=e.ctrlsSvc.getScrollFeature(),l=a.getVScrollPosition(),c=a.getHScrollPosition();n+=c.left,o+=l.top}return{x:n,y:o}}var zT=class extends ct{constructor(e,t){super(),this.direction=t,this.eViewport=se,this.eContainer=se,this.hideTimeout=0,this.setTemplate(e)}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.toggleCss("ag-apple-scrollbar",cT()||Sc())}destroy(){super.destroy(),window.clearTimeout(this.hideTimeout)}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=hT(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const e=this.getGui(),t=()=>this.toggleCss("ag-scrollbar-active",!0),i=()=>this.toggleCss("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:i,touchend:i})}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),Lr(this.beans,()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=0),this.toggleCss("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.toggleCss("ag-scrollbar-scrolling",!1),this.hideTimeout=0},400)}})}attemptSettingScrollPosition(e){const t=this.eViewport;_H(this,()=>To(t),()=>this.setScrollPosition(e),100)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}},IV={tag:"div",cls:"ag-body-horizontal-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eLeftSpacer",cls:"ag-horizontal-left-spacer"},{tag:"div",ref:"eViewport",cls:"ag-body-horizontal-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-horizontal-scroll-container"}]},{tag:"div",ref:"eRightSpacer",cls:"ag-horizontal-right-spacer"}]},kV=class extends zT{constructor(){super(IV,"horizontal"),this.eLeftSpacer=se,this.eRightSpacer=se,this.setScrollVisibleDebounce=0}wireBeans(e){this.visibleCols=e.visibleCols,this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.refreshCompBottom.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.beans.ctrlsSvc.register("fakeHScrollComp",this),this.createManagedBean(new TS(t=>this.eContainer.style.width=`${t}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}destroy(){window.clearTimeout(this.setScrollVisibleDebounce),super.destroy()}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}refreshCompBottom(){var t;if(!this.invisibleScrollbar)return;const e=((t=this.beans.pinnedRowModel)==null?void 0:t.getPinnedBottomTotalHeight())??0;this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleSvc.verticalScrollShowing;let t=this.visibleCols.getDisplayedColumnsRightWidth();const i=!this.enableRtl&&e,s=this.scrollVisibleSvc.getScrollbarWidth();i&&(t+=s),yo(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=s);let n=this.visibleCols.getColsLeftWidth();this.enableRtl&&e&&(n+=s),yo(this.eLeftSpacer,n),this.eLeftSpacer.classList.toggle("ag-scroller-corner",n<=s)}setScrollVisible(){const e=this.scrollVisibleSvc.horizontalScrollShowing,t=this.invisibleScrollbar,i=this.gos.get("suppressHorizontalScroll"),s=e&&this.scrollVisibleSvc.getScrollbarWidth()||0,o=i?0:s===0&&t?16:s,r=()=>{this.setScrollVisibleDebounce=0,this.toggleCss("ag-scrollbar-invisible",t),Wu(this.getGui(),o),Wu(this.eViewport,o),Wu(this.eContainer,o),o||this.eContainer.style.setProperty("min-height","1px"),this.setVisible(e,{skipAriaHidden:!0})};window.clearTimeout(this.setScrollVisibleDebounce),e?this.setScrollVisibleDebounce=window.setTimeout(r,100):r()}getScrollPosition(){return Im(this.eViewport,this.enableRtl)}setScrollPosition(e){To(this.eViewport)||this.attemptSettingScrollPosition(e),km(this.eViewport,e,this.enableRtl)}},_V={selector:"AG-FAKE-HORIZONTAL-SCROLL",component:kV},LV={tag:"div",cls:"ag-body-vertical-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eViewport",cls:"ag-body-vertical-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-vertical-scroll-container"}]}]},OV=class extends zT{constructor(){super(LV,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new NT(this.eContainer));const{ctrlsSvc:e}=this.beans;e.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this,e)})}setScrollVisible(){const{scrollVisibleSvc:e}=this.beans,t=e.verticalScrollShowing,i=this.invisibleScrollbar,s=t&&e.getScrollbarWidth()||0,n=s===0&&i?16:s;this.toggleCss("ag-scrollbar-invisible",i),yo(this.getGui(),n),yo(this.eViewport,n),yo(this.eContainer,n),this.setDisplayed(t,{skipAriaHidden:!0})}onRowContainerHeightChanged(e){const i=e.getGridBodyCtrl().eBodyViewport,s=this.getScrollPosition(),n=i.scrollTop;s!=n&&this.setScrollPosition(n,!0)}getScrollPosition(){return this.eViewport.scrollTop}setScrollPosition(e,t){!t&&!To(this.eViewport)&&this.attemptSettingScrollPosition(e),this.eViewport.scrollTop=e}},NV={selector:"AG-FAKE-VERTICAL-SCROLL",component:OV},HV="ag-column-first",GV="ag-column-last";function WT(e,t,i,s){return At(e)?[]:VV(e.headerClass,e,t,i,s)}function $T(e,t,i){e.toggleCss(HV,i.isColAtEdge(t,"first")),e.toggleCss(GV,i.isColAtEdge(t,"last"))}function BV(e,t,i,s){return Fe(t,{colDef:e,column:i,columnGroup:s})}function VV(e,t,i,s,n){if(At(e))return[];let o;if(typeof e=="function"){const r=BV(t,i,s,n);o=e(r)}else o=e;return typeof o=="string"?[o]:Array.isArray(o)?[...o]:[]}function zV(e,t,i){t.addManagedElementListeners(i,{keydown:s=>{if(!s.defaultPrevented&&s.key===H.TAB){const n=s.shiftKey;Kc(e,i,!1,n)||jh(e,n)&&s.preventDefault()}}})}function WV(e,t){return e.ctrlsSvc.get("gridCtrl").focusInnerElement(t)}function Rc(e){var t;return e.gos.get("suppressHeaderFocus")||!!((t=e.overlays)!=null&&t.isExclusive())}function $v(e){var t;return e.gos.get("suppressCellFocus")||!!((t=e.overlays)!=null&&t.isExclusive())}function jh(e,t,i=!1){const s=e.ctrlsSvc.get("gridCtrl");return!i&&s.focusNextInnerContainer(t)?!0:((i||!t&&!s.isDetailGrid())&&s.forceFocusOutOfContainer(t),!1)}function wo(e){var t;return((t=e.ctrlsSvc.getHeaderRowContainerCtrl())==null?void 0:t.getRowCount())??0}function MS(e){const t=[],i=e.ctrlsSvc.getHeaderRowContainerCtrls();for(const s of i){if(!s)continue;const n=s.getGroupRowCount()||0;for(let o=0;o<n;o++){const r=s.getGroupRowCtrlAtIndex(o),a=t[o];if(r){const l=$V(e,r);(a==null||l>a)&&(t[o]=l)}}}return t}function $V(e,t){let s=e.colModel.isPivotMode()?jV(e):jT(e);const n=t.getHeaderCellCtrls();for(const o of n){const{column:r}=o,a=r.getAutoHeaderHeight();a!=null&&a>s&&r.isAutoHeaderHeight()&&(s=a)}return s}function IS(e){let i=e.colModel.isPivotMode()?UV(e):ep(e);return e.colModel.forAllCols(s=>{const n=s.getAutoHeaderHeight();n!=null&&n>i&&s.isAutoHeaderHeight()&&(i=n)}),i}function ep(e){return e.gos.get("headerHeight")??e.environment.getDefaultHeaderHeight()}function UT(e){return e.gos.get("floatingFiltersHeight")??ep(e)}function jT(e){return e.gos.get("groupHeaderHeight")??ep(e)}function UV(e){return e.gos.get("pivotHeaderHeight")??ep(e)}function jV(e){return e.gos.get("pivotGroupHeaderHeight")??jT(e)}function KV(e,t){return e.headerRowIndex===t.headerRowIndex&&e.column===t.column}var qV=class extends V{setComp(e,t,i){this.comp=e,this.eGui=t;const{beans:s}=this,{headerNavigation:n,touchSvc:o,ctrlsSvc:r}=s;n&&this.createManagedBean(new su(i,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this,s),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this,s)}),this.onPivotModeChanged(s),this.setupHeaderHeight();const a=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:a}),o==null||o.mockHeaderContextMenu(this,a),r.register("gridHeaderCtrl",this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({headerRowsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>Lr(this.beans,()=>e()),gridStylesChanged:e,advancedFilterEnabledChanged:e})}setHeaderHeight(){var o;const{beans:e}=this;let t=0;const i=MS(e).reduce((r,a)=>r+a,0),s=IS(e);if((o=e.filterManager)!=null&&o.hasFloatingFilters()&&(t+=UT(e)),t+=i,t+=s,this.headerHeight===t)return;this.headerHeight=t;const n=`${t+1}px`;this.comp.setHeightAndMinHeight(n),this.eventSvc.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(e){const t=e.colModel.isPivotMode();this.comp.toggleCss("ag-pivot-on",t),this.comp.toggleCss("ag-pivot-off",!t)}onDisplayedColumnsChanged(e){const i=e.visibleCols.allCols.some(s=>s.isSpanHeaderHeight());this.comp.toggleCss("ag-header-allow-overflow",i)}onTabKeyDown(e){const t=this.gos.get("enableRtl"),i=e.shiftKey,s=i!==t?"LEFT":"RIGHT",{beans:n}=this,{headerNavigation:o,focusSvc:r}=n;(o.navigateHorizontally(s,!0,e)||!i&&r.focusOverlay(!1)||jh(n,i,!0))&&e.preventDefault()}handleKeyDown(e){let t=null;const{headerNavigation:i}=this.beans;switch(e.key){case H.LEFT:t="LEFT";case H.RIGHT:{ae(t)||(t="RIGHT"),i.navigateHorizontally(t,!1,e)&&e.preventDefault();break}case H.UP:t="UP";case H.DOWN:{ae(t)||(t="DOWN"),i.navigateVertically(t,e)&&e.preventDefault();break}default:return}}onFocusOut(e){const{relatedTarget:t}=e,{eGui:i,beans:s}=this;!t&&i.contains(Dt(s))||i.contains(t)||(s.focusSvc.focusedHeader=null)}onHeaderContextMenu(e,t,i){var r;const{menuSvc:s,ctrlsSvc:n}=this.beans;if(!e&&!i||!(s!=null&&s.isHeaderContextMenuEnabled()))return;const{target:o}=e??t;(o===this.eGui||o===((r=n.getHeaderRowContainerCtrl())==null?void 0:r.eViewport))&&s.showHeaderContextMenu(void 0,e,i)}},kS=class extends ct{constructor(e,t){super(e),this.ctrl=t}getCtrl(){return this.ctrl}},YV={tag:"div",cls:"ag-header-cell",role:"columnheader",children:[{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"},{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"}]},XV=class extends kS{constructor(e){super(YV,e),this.eResize=se,this.eHeaderCompWrapper=se,this.headerCompVersion=0}postConstruct(){const e=this.getGui(),t=()=>{const s=this.ctrl.getSelectAllGui();s&&(this.eResize.insertAdjacentElement("afterend",s),this.addDestroyFunc(()=>s.remove()))},i={setWidth:s=>e.style.width=s,toggleCss:(s,n)=>this.toggleCss(s,n),setUserStyles:s=>Yf(e,s),setAriaSort:s=>s?hH(e,s):uH(e),setUserCompDetails:s=>this.setUserCompDetails(s),getUserCompInstance:()=>this.headerComp,refreshSelectAllGui:t,removeSelectAllGui:()=>{var s;return(s=this.ctrl.getSelectAllGui())==null?void 0:s.remove()}};this.ctrl.setComp(i,this.getGui(),this.eResize,this.eHeaderCompWrapper,void 0),t()}destroy(){this.destroyHeaderComp(),super.destroy()}destroyHeaderComp(){var e;this.headerComp&&((e=this.headerCompGui)==null||e.remove(),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(e){this.headerCompVersion++;const t=this.headerCompVersion;e.newAgStackInstance().then(i=>this.afterCompCreated(t,i))}afterCompCreated(e,t){if(e!=this.headerCompVersion||!this.isAlive()){this.destroyBean(t);return}this.destroyHeaderComp(),this.headerComp=t,this.headerCompGui=t.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())}},QV={tag:"div",cls:"ag-header-group-cell",role:"columnheader",children:[{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"},{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"}]},JV=class extends kS{constructor(e){super(QV,e),this.eResize=se,this.eHeaderCompWrapper=se}postConstruct(){const e=this.getGui(),t=(s,n)=>n!=null?e.setAttribute(s,n):e.removeAttribute(s),i={toggleCss:(s,n)=>this.toggleCss(s,n),setUserStyles:s=>Yf(e,s),setHeaderWrapperHidden:s=>{s?this.eHeaderCompWrapper.style.setProperty("display","none"):this.eHeaderCompWrapper.style.removeProperty("display")},setHeaderWrapperMaxHeight:s=>{s!=null?this.eHeaderCompWrapper.style.setProperty("max-height",`${s}px`):this.eHeaderCompWrapper.style.removeProperty("max-height"),this.eHeaderCompWrapper.classList.toggle("ag-header-cell-comp-wrapper-limited-height",s!=null)},setResizableDisplayed:s=>xt(this.eResize,s),setWidth:s=>e.style.width=s,setAriaExpanded:s=>t("aria-expanded",s),setUserCompDetails:s=>this.setUserCompDetails(s),getUserCompInstance:()=>this.headerGroupComp};this.ctrl.setComp(i,e,this.eResize,this.eHeaderCompWrapper,void 0)}setUserCompDetails(e){e.newAgStackInstance().then(t=>this.afterHeaderCompCreated(t))}afterHeaderCompCreated(e){const t=()=>this.destroyBean(e);if(!this.isAlive()){t();return}const i=this.getGui(),s=e.getGui();this.eHeaderCompWrapper.appendChild(s),this.addDestroyFunc(t),this.headerGroupComp=e,this.ctrl.setDragSource(i)}},ZV={tag:"div",cls:"ag-header-cell ag-floating-filter",role:"gridcell",children:[{tag:"div",ref:"eFloatingFilterBody",role:"presentation"},{tag:"div",ref:"eButtonWrapper",cls:"ag-floating-filter-button ag-hidden",role:"presentation",children:[{tag:"button",ref:"eButtonShowMainFilter",cls:"ag-button ag-floating-filter-button-button",attrs:{type:"button",tabindex:"-1"}}]}]},ez=class extends kS{constructor(e){super(ZV,e),this.eFloatingFilterBody=se,this.eButtonWrapper=se,this.eButtonShowMainFilter=se}postConstruct(){const e=this.getGui(),t={toggleCss:(i,s)=>this.toggleCss(i,s),setUserStyles:i=>Yf(e,i),addOrRemoveBodyCssClass:(i,s)=>this.eFloatingFilterBody.classList.toggle(i,s),setButtonWrapperDisplayed:i=>xt(this.eButtonWrapper,i),setCompDetails:i=>this.setCompDetails(i),getFloatingFilterComp:()=>this.compPromise,setWidth:i=>e.style.width=i,setMenuIcon:i=>this.eButtonShowMainFilter.appendChild(i)};this.ctrl.setComp(t,e,this.eButtonShowMainFilter,this.eFloatingFilterBody,void 0)}setCompDetails(e){if(!e){this.destroyFloatingFilterComp(),this.compPromise=null;return}this.compPromise=e.newAgStackInstance(),this.compPromise.then(t=>this.afterCompCreated(t))}destroy(){this.destroyFloatingFilterComp(),super.destroy()}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.floatingFilterComp.getGui().remove(),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(e){if(e){if(!this.isAlive()){this.destroyBean(e);return}this.destroyFloatingFilterComp(),this.floatingFilterComp=e,this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached()}}},tz=class extends ct{constructor(e){super({tag:"div",cls:e.headerRowClass,role:"row"}),this.ctrl=e,this.headerComps={}}postConstruct(){this.getGui().setAttribute("tabindex",String(this.gos.get("tabIndex"))),Dm(this.getGui(),this.ctrl.getAriaRowIndex());const t={setHeight:i=>this.getGui().style.height=i,setTop:i=>this.getGui().style.top=i,setHeaderCtrls:(i,s)=>this.setHeaderCtrls(i,s),setWidth:i=>this.getGui().style.width=i,setRowIndex:i=>Dm(this.getGui(),i)};this.ctrl.setComp(t,void 0)}destroy(){this.setHeaderCtrls([],!1),super.destroy()}setHeaderCtrls(e,t){if(!this.isAlive())return;const i=this.headerComps;this.headerComps={};for(const s of e){const n=s.instanceId;let o=i[n];delete i[n],o==null&&(o=this.createHeaderComp(s),this.getGui().appendChild(o.getGui())),this.headerComps[n]=o}if(Object.values(i).forEach(s=>{s.getGui().remove(),this.destroyBean(s)}),t){const s=Object.values(this.headerComps);s.sort((o,r)=>{const a=o.getCtrl().column.getLeft(),l=r.getCtrl().column.getLeft();return a-l});const n=s.map(o=>o.getGui());yP(this.getGui(),n)}}createHeaderComp(e){let t;switch(this.ctrl.type){case"group":t=new JV(e);break;case"filter":t=new ez(e);break;default:t=new XV(e);break}return this.createBean(t),t.setParentComponent(this),t}},_S=class extends V{constructor(e,t,i,s){super(),this.columnOrGroup=e,this.eCell=t,this.colsSpanning=s,this.columnOrGroup=e,this.ariaEl=t.querySelector("[role=columnheader]")||t,this.beans=i}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){const{beans:e,colsSpanning:t}=this;return e.gos.get("enableRtl")&&t?Ct(t):this.columnOrGroup}postConstruct(){const e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){const{gos:e,colAnimation:t}=this.beans,i=e.get("suppressColumnMoveAnimation"),s=ae(this.columnOrGroup.getOldLeft());(t==null?void 0:t.isActive())&&s&&!i?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=this.modifyLeftForPrintLayout(e,e.getOldLeft()),i=this.modifyLeftForPrintLayout(e,e.getLeft());this.setLeft(t),this.actualLeft=i,this.beans.colAnimation.executeNextVMTurn(()=>{this.actualLeft===i&&this.setLeft(i)})}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){const{gos:i,visibleCols:s}=this.beans;if(!Ii(i,"print")||e.getPinned()==="left")return t;const o=s.getColsLeftWidth();if(e.getPinned()==="right"){const r=s.bodyWidth;return o+r+t}return o+t}setLeft(e){if(ae(e)&&(this.eCell.style.left=`${e}px`),$t(this.columnOrGroup)){const t=this.columnOrGroup.getLeafColumns();if(!t.length)return;t.length>1&&dH(this.ariaEl,t.length)}}},iz=0,KT="headerCtrl",LS=class extends V{constructor(e,t){super(),this.column=e,this.rowCtrl=t,this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.reAttemptToFocus=!1,this.instanceId=e.getUniqueId()+"-"+iz++}postConstruct(){const e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}setComp(e,t,i,s,n){t.setAttribute("col-id",this.column.colIdSanitised),this.wireComp(e,t,i,s,n),this.reAttemptToFocus&&(this.reAttemptToFocus=!1,this.focus(this.lastFocusEvent??void 0))}shouldStopEventPropagation(e){const{headerRowIndex:t,column:i}=this.beans.focusSvc.focusedHeader,s=i.getDefinition(),n=s==null?void 0:s.suppressHeaderKeyboardEvent;if(!ae(n))return!1;const o=Fe(this.gos,{colDef:s,column:i,headerRowIndex:t,event:e});return!!n(o)}getWrapperHasFocus(){return Dt(this.beans)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}refreshHeaderStyles(){const e=this.column.getDefinition();if(!e)return;const{headerStyle:t}=e;let i;if(typeof t=="function"){const s=this.getHeaderClassParams();i=t(s)}else i=t;i&&this.comp.setUserStyles(i)}onGuiFocus(){this.eventSvc.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){const{wrapperElement:t,checkMeasuringCallback:i,compBean:s}=e,{beans:n}=this,o=h=>{if(!this.isAlive()||!s.isAlive())return;const{paddingTop:u,paddingBottom:f,borderBottomWidth:p,borderTopWidth:m}=Uc(this.eGui),v=u+f+p+m,w=t.offsetHeight+v;if(h<5){const S=pi(n),b=!(S!=null&&S.contains(t)),E=w==0;if(b||E){Vb(()=>o(h+1),"raf",n);return}}this.setColHeaderHeight(this.column,w)};let r=!1,a;const l=()=>{const h=this.column.isAutoHeaderHeight();h&&!r&&c(),!h&&r&&d()},c=()=>{r=!0,this.comp.toggleCss("ag-header-cell-auto-height",!0),o(0),a=qa(this.beans,t,()=>o(0))},d=()=>{r=!1,a&&a(),this.comp.toggleCss("ag-header-cell-auto-height",!1),a=void 0};l(),s.addDestroyFunc(()=>d()),s.addManagedListeners(this.column,{widthChanged:()=>r&&o(0)}),s.addManagedEventListeners({sortChanged:()=>{r&&window.setTimeout(()=>o(0))}}),i&&i(l)}onDisplayedColumnsChanged(){const{comp:e,column:t,beans:i,eGui:s}=this;!e||!t||!s||($T(e,t,i.visibleCols),fP(s,i.visibleCols.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){const e=Rc(this.beans);this.eGui&&ks(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){var o;const t=Dt(this.beans),i=e.key===H.LEFT||e.key===H.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey||((this.isResizing||i)&&(e.preventDefault(),e.stopImmediatePropagation()),!i))return;const n=e.key===H.LEFT!==this.gos.get("enableRtl")?"left":"right";if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const r=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(r,e.shiftKey),(o=this.resizeFeature)==null||o.toggleColumnResizing(!0)}else this.moveHeader(n)}moveHeader(e){var t;(t=this.beans.colMoves)==null||t.moveHeader(e,this.eGui,this.column,this.rowCtrl.pinned,this)}getViewportAdjustedResizeDiff(e){const t=this.getResizeDiff(e),{pinnedCols:i}=this.beans;return i?i.getHeaderResizeDiff(t,this.column):t}getResizeDiff(e){const{gos:t,column:i}=this;let s=e.key===H.LEFT!==t.get("enableRtl");const n=i.getPinned(),o=t.get("enableRtl");return n&&o!==(n==="right")&&(s=!s),(s?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{var e;(e=this.resizeFeature)==null||e.toggleColumnResizing(!1)},150))}handleKeyDown(e){const t=this.getWrapperHasFocus();switch(e.key){case H.PAGE_DOWN:case H.PAGE_UP:case H.PAGE_HOME:case H.PAGE_END:t&&e.preventDefault()}}addDomData(e){const t=KT,{eGui:i,gos:s}=this;Ic(s,i,t,this),e.addDestroyFunc(()=>Ic(s,i,t,null))}focus(e){if(!this.isAlive())return!1;const{eGui:t}=this;return t?(t.focus(),this.lastFocusEvent=e||null):this.reAttemptToFocus=!0,!0}focusThis(){this.beans.focusSvc.focusedHeader={headerRowIndex:this.rowCtrl.rowIndex,column:this.column}}removeDragSource(){var e;this.dragSource&&((e=this.beans.dragAndDrop)==null||e.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,i){const s=e??t,{menuSvc:n,gos:o}=this.beans;o.get("preventDefaultOnContextMenu")&&s.preventDefault(),n!=null&&n.isHeaderContextMenuEnabled(i)&&n.showHeaderContextMenu(i,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",i)}dispatchColumnMouseEvent(e,t){this.eventSvc.dispatchEvent({type:e,column:t})}setColHeaderHeight(e,t){if(!e.setAutoHeaderHeight(t))return;const{eventSvc:i}=this;e.isColumn?i.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"}):i.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.rowCtrl=null}},sz=class extends LS{constructor(){super(...arguments),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map}wireComp(e,t,i,s,n){this.comp=e;const{rowCtrl:o,column:r,beans:a}=this,{colResize:l,context:c,colHover:d,rangeSvc:h}=a,u=Qf(this,c,n);this.setGui(t,u),this.updateState(),this.setupWidth(u),this.setupMovingCss(u),this.setupMenuClass(u),this.setupSortableClass(u),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:s,checkMeasuringCallback:p=>this.setRefreshFunction("measuring",p),compBean:u}),this.addColumnHoverListener(u),this.setupFilterClass(u),this.setupStylesFromColDef(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(u),this.setupSelectAll(u),this.setupUserComp(),this.refreshAria(),l?this.resizeFeature=u.createManagedBean(l.createResizeFeature(o.pinned,r,i,e,this)):xt(i,!1),d==null||d.createHoverFeature(u,[r],t),h==null||h.createRangeHighlightFeature(u,r,e),u.createManagedBean(new _S(r,t,a)),u.createManagedBean(new su(t,{shouldStopEventPropagation:p=>this.shouldStopEventPropagation(p),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(u),u.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader","enableAdvancedFilter"],()=>this.refresh()),u.addManagedListeners(r,{colDefChanged:()=>this.refresh()}),u.addManagedListeners(r,{headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});const f=()=>this.checkDisplayName();u.addManagedEventListeners({columnValueChanged:f,columnRowGroupChanged:f,columnPivotChanged:f,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),u.addDestroyFunc(()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()})}resizeHeader(e,t){var i;(i=this.beans.colResize)==null||i.resizeHeader(this.column,e,t)}getHeaderClassParams(){const{column:e,beans:t}=this,i=e.colDef;return Fe(t.gos,{colDef:i,column:e,floatingFilter:!1})}setupUserComp(){const e=this.lookupUserCompDetails();e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){const e=this.createParams(),t=this.column.getColDef();return n2(this.beans.userCompFactory,t,e)}createParams(){const{menuSvc:e,sortSvc:t,colFilter:i,gos:s}=this.beans;return Fe(s,{column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&!!(e!=null&&e.isHeaderFilterButtonEnabled(this.column)),enableFilterIcon:!!i&&(!this.openFilterEnabled||_s(this.gos)),showColumnMenu:(o,r)=>{e==null||e.showColumnMenu({column:this.column,buttonElement:o,positionBy:"button",onClosedCallback:r})},showColumnMenuAfterMouseClick:(o,r)=>{e==null||e.showColumnMenu({column:this.column,mouseEvent:o,positionBy:"mouse",onClosedCallback:r})},showFilter:o=>{e==null||e.showFilterMenu({column:this.column,buttonElement:o,containerType:"columnFilter",positionBy:"button"})},progressSort:o=>{t==null||t.progressSort(this.column,!!o,"uiColumnSorted")},setSort:(o,r)=>{t==null||t.setSortForColumn(this.column,o,!!r,"uiColumnSorted")},eGridHeader:this.eGui,setTooltip:(o,r)=>{s.assertModuleRegistered("Tooltip",3),this.setupTooltip(o,r)}})}setupSelectAll(e){var i;const{selectionSvc:t}=this.beans;t&&(this.selectAllFeature=e.createOptionalManagedBean(t.createSelectAllFeature(this.column)),(i=this.selectAllFeature)==null||i.setComp(this),e.addManagedPropertyListener("rowSelection",()=>{var n;const s=t.createSelectAllFeature(this.column);s&&!this.selectAllFeature?(this.selectAllFeature=e.createManagedBean(s),(n=this.selectAllFeature)==null||n.setComp(this),this.comp.refreshSelectAllGui()):this.selectAllFeature&&!s&&(this.comp.removeSelectAllGui(),this.selectAllFeature=this.destroyBean(this.selectAllFeature))}))}getSelectAllGui(){var e;return(e=this.selectAllFeature)==null?void 0:e.getCheckboxGui()}handleKeyDown(e){var t;super.handleKeyDown(e),e.key===H.SPACE&&((t=this.selectAllFeature)==null||t.onSpaceKeyDown(e)),e.key===H.ENTER&&this.onEnterKeyDown(e),e.key===H.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){var t;e.ctrlKey||e.metaKey?this.showMenuOnKeyPress(e,!0):this.sortable&&((t=this.beans.sortSvc)==null||t.progressSort(this.column,e.shiftKey,"uiColumnSorted"))}showMenuOnKeyPress(e,t){const i=this.comp.getUserCompInstance();DR(i)&&i.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription()),P2()&&this.setActiveHeader(!0)}onFocusOut(e){this.eGui.contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){var i;this.tooltipFeature=(i=this.beans.tooltipSvc)==null?void 0:i.setupHeaderTooltip(this.tooltipFeature,this,e,t)}setupStylesFromColDef(){this.setRefreshFunction("headerStyles",this.refreshHeaderStyles.bind(this)),this.refreshHeaderStyles()}setupClassesFromColDef(){const e=()=>{const t=this.column.getColDef(),i=WT(t,this.gos,this.column,null),s=this.userHeaderClasses;this.userHeaderClasses=new Set(i);for(const n of i)s.has(n)?s.delete(n):this.comp.toggleCss(n,!0);for(const n of s)this.comp.toggleCss(n,!1)};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){var t;this.dragSourceElement=e,this.removeDragSource(),!(!e||!this.draggable)&&(this.dragSource=((t=this.beans.colMoves)==null?void 0:t.setDragSourceForHeader(e,this.column,this.displayName))??null)}updateState(){const{menuSvc:e}=this.beans;this.menuEnabled=!!(e!=null&&e.isColumnMenuInHeaderEnabled(this.column)),this.openFilterEnabled=!!(e!=null&&e.isFilterMenuInHeaderEnabled(this.column)),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria();for(const e of Object.values(this.refreshFunctions))e()}refreshHeaderComp(){const e=this.lookupUserCompDetails();if(!e)return;(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==e.componentClass?this.attemptHeaderCompRefresh(e.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();return!t||!t.refresh?!1:t.refresh(e)}calculateDisplayName(){return this.beans.colNames.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){const t=()=>{const i=this.column.getActualWidth();this.comp.setWidth(`${i}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){const t=()=>{this.comp.toggleCss("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){const t=()=>{var i;(i=this.comp)==null||i.toggleCss("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){const t=()=>{this.comp.toggleCss("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){const t=()=>{const i=this.column.isFilterActive();this.comp.toggleCss("ag-header-cell-filtered",i),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){const e=()=>{const t=!!this.column.getColDef().wrapHeaderText;this.comp.toggleCss("ag-header-cell-wrap-text",t)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){const e=this.column.getHighlighted(),t=e===0,i=e===1;this.comp.toggleCss("ag-header-highlight-before",t),this.comp.toggleCss("ag-header-highlight-after",i)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){var u;const{eGui:e,column:t,comp:i,beans:s}=this,n=MS(this.beans),o=n.reduce((f,p)=>f+p,0)===0;if(i.toggleCss("ag-header-parent-hidden",o),!t.isSpanHeaderHeight()){e.style.removeProperty("top"),e.style.removeProperty("height"),i.toggleCss("ag-header-span-height",!1),i.toggleCss("ag-header-span-total",!1);return}const{numberOfParents:r,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();i.toggleCss("ag-header-span-height",r>0);const l=IS(s);if(r===0){i.toggleCss("ag-header-span-total",!1),e.style.setProperty("top","0px"),e.style.setProperty("height",`${l}px`);return}i.toggleCss("ag-header-span-total",a);const c=(((u=this.column.getFirstRealParent())==null?void 0:u.getLevel())??-1)+1,d=n.length-c;let h=0;for(let f=0;f<d;f++)h+=n[n.length-1-f];e.style.setProperty("top",`${-h}px`),e.style.setProperty("height",`${l+h}px`)}refreshAriaSort(){var e;if(this.sortable){const t=this.getLocaleTextFunc(),i=((e=this.beans.sortSvc)==null?void 0:e.getDisplaySortForColumn(this.column))||null;this.comp.setAriaSort(JN(i)),this.setAriaDescriptionProperty("sort",t("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!_s(this.gos)){const e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const e=this.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){t!=null?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){var t;if(!this.eGui.contains(Dt(this.beans)))return;const e=Array.from(this.ariaDescriptionProperties.keys()).sort((i,s)=>i==="filter"?-1:s.charCodeAt(0)-i.charCodeAt(0)).map(i=>this.ariaDescriptionProperties.get(i)).join(". ");(t=this.beans.ariaAnnounce)==null||t.announceValue(e,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(e){var t;(t=this.beans.colHover)==null||t.addHeaderColumnHoverListener(e,this.comp,this.column)}addActiveHeaderMouseListeners(e){const t=n=>this.handleMouseOverChange(n.type==="mouseenter"),i=()=>{this.setActiveHeader(!0),this.dispatchColumnMouseEvent("columnHeaderClicked",this.column)},s=n=>this.handleContextMenuMouseEvent(n,void 0,this.column);e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:i,contextmenu:s})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.toggleCss("ag-header-active",e)}getAnchorElementForMenu(e){const t=this.comp.getUserCompInstance();return DR(t)?t.getAnchorElementForMenu(e):this.eGui}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function DR(e){return typeof(e==null?void 0:e.getAnchorElementForMenu)=="function"&&typeof e.onMenuKeyboardShortcut=="function"}var nz=0,LC=class extends V{constructor(e,t,i){super(),this.rowIndex=e,this.pinned=t,this.type=i,this.instanceId=nz++,this.comp=null,this.allCtrls=[];let s="ag-header-row-column";i==="group"?s="ag-header-row-group":i==="filter"&&(s="ag-header-row-filter"),this.headerRowClass=`ag-header-row ${s}`}setRowIndex(e){var t;this.rowIndex=e,(t=this.comp)==null||t.setRowIndex(this.getAriaRowIndex()),this.onRowHeightChanged()}postConstruct(){this.isPrintLayout=Ii(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return this.comp?this.allCtrls.every(e=>e.eGui!=null):!1}setComp(e,t,i=!0){this.comp=e,t=Qf(this,this.beans.context,t),i&&(this.setRowIndex(this.rowIndex),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){const t=this.onRowHeightChanged.bind(this),i=this.onDisplayedColumnsChanged.bind(this);e.addManagedEventListeners({columnResized:this.setWidth.bind(this),displayedColumnsChanged:i,virtualColumnsChanged:s=>this.onVirtualColumnsChanged(s.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,gridStylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",i),e.addManagedPropertyListener("ensureDomOrder",s=>this.isEnsureDomOrder=s.currentValue),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}onDisplayedColumnsChanged(){this.isPrintLayout=Ii(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}setWidth(){if(!this.comp)return;const e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){const{visibleCols:e}=this.beans;return this.isPrintLayout?this.pinned!=null?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){if(!this.comp)return;const{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){let e=0;const t=MS(this.beans);for(let n=0;n<t.length;n++){if(n===this.rowIndex&&this.type==="group")return{topOffset:e,rowHeight:t[n]};e+=t[n]}const i=IS(this.beans);if(this.type==="column")return{topOffset:e,rowHeight:i};e+=i;const s=UT(this.beans);return{topOffset:e,rowHeight:s}}onVirtualColumnsChanged(e=!1){if(!this.comp)return;const t=this.getUpdatedHeaderCtrls(),i=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,i,e)}getUpdatedHeaderCtrls(){const e=this.ctrlsById;this.ctrlsById=new Map;const t=this.getColumnsInViewport();for(const s of t)this.recycleAndCreateHeaderCtrls(s,this.ctrlsById,e);const i=s=>{const{focusSvc:n,visibleCols:o}=this.beans;return n.isHeaderWrapperFocused(s)?o.isVisible(s.column):!1};if(e)for(const[s,n]of e)i(n)?this.ctrlsById.set(s,n):this.destroyBean(n);return this.allCtrls=Array.from(this.ctrlsById.values()),this.allCtrls}getHeaderCellCtrls(){return this.allCtrls}recycleAndCreateHeaderCtrls(e,t,i){if(e.isEmptyGroup())return;const s=e.getUniqueId();let n;if(i&&(n=i.get(s),i.delete(s)),n&&n.column!=e&&(this.destroyBean(n),n=void 0),n==null)switch(this.type){case"filter":{n=this.createBean(this.beans.registry.createDynamicBean("headerFilterCellCtrl",!0,e,this));break}case"group":n=this.createBean(this.beans.registry.createDynamicBean("headerGroupCellCtrl",!0,e,this));break;default:n=this.createBean(new sz(e,this));break}t.set(s,n)}getColumnsInViewport(){if(!this.isPrintLayout)return this.getComponentsToRender();if(this.pinned)return[];const e=[];for(const t of["left",null,"right"])e.push(...this.getComponentsToRender(t));return e}getComponentsToRender(e=this.pinned){return this.type==="group"?this.beans.colViewport.getHeadersToRender(e,this.rowIndex):this.beans.colViewport.getColumnHeadersToRender(e)}focusHeader(e,t){const i=this.allCtrls.find(n=>n.column==e);return i?i.focus(t):!1}destroy(){this.allCtrls=this.destroyBeans(this.allCtrls),this.ctrlsById=void 0,this.comp=null,super.destroy()}},oz=class extends V{constructor(e){super(),this.pinned=e,this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[]}setComp(e,t){this.comp=e,this.eViewport=t;const{pinnedCols:i,ctrlsSvc:s,colModel:n,colMoves:o}=this.beans;this.setupCenterWidth(),i==null||i.setupHeaderPinnedWidth(this),this.setupDragAndDrop(o,this.eViewport);const r=this.refresh.bind(this,!0);this.addManagedEventListeners({displayedColumnsChanged:r,advancedFilterEnabledChanged:r});const a=`${typeof this.pinned=="string"?this.pinned:"center"}Header`;s.register(a,this),n.ready&&this.refresh()}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(e=!1){const{focusSvc:t,filterManager:i,visibleCols:s}=this.beans;let n=0;const o=t.getFocusHeaderToUseAfterRefresh(),r=()=>{const h=s.headerGroupRowCount;n=h,e||(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls));const u=this.groupsRowCtrls.length;if(u!==h){if(u>h){for(let f=h;f<u;f++)this.destroyBean(this.groupsRowCtrls[f]);this.groupsRowCtrls.length=h;return}for(let f=u;f<h;f++){const p=this.createBean(new LC(f,this.pinned,"group"));this.groupsRowCtrls.push(p)}}},a=()=>{const h=n++;if(this.hidden){this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl);return}this.columnsRowCtrl==null||!e?(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.columnsRowCtrl=this.createBean(new LC(h,this.pinned,"column"))):this.columnsRowCtrl.rowIndex!==h&&this.columnsRowCtrl.setRowIndex(h)},l=()=>{this.includeFloatingFilter=!!(i!=null&&i.hasFloatingFilters())&&!this.hidden;const h=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){h();return}e||h();const u=n++;this.filtersRowCtrl?this.filtersRowCtrl.rowIndex!==u&&this.filtersRowCtrl.setRowIndex(u):this.filtersRowCtrl=this.createBean(new LC(u,this.pinned,"filter"))},c=this.getAllCtrls();r(),a(),l();const d=this.getAllCtrls();this.comp.setCtrls(d),this.restoreFocusOnHeader(t,o),c.length!==d.length&&this.beans.eventSvc.dispatchEvent({type:"headerRowsChanged"})}getHeaderCtrlForColumn(e){const t=i=>i==null?void 0:i.getHeaderCellCtrls().find(s=>s.column===e);if(Va(e))return t(this.columnsRowCtrl);if(this.groupsRowCtrls.length!==0)for(let i=0;i<this.groupsRowCtrls.length;i++){const s=t(this.groupsRowCtrls[i]);if(s)return s}}getHtmlElementForColumnHeader(e){var t;return((t=this.getHeaderCtrlForColumn(e))==null?void 0:t.eGui)??null}getRowType(e){var t;return(t=this.getAllCtrls()[e])==null?void 0:t.type}focusHeader(e,t,i){const n=this.getAllCtrls()[e];return n?n.focusHeader(t,i):!1}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}destroy(){this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl),this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls),super.destroy()}setupDragAndDrop(e,t){const i=e==null?void 0:e.createBodyDropTarget(this.pinned,t);i&&this.createManagedBean(i)}restoreFocusOnHeader(e,t){if(!t)return;const{column:i}=t;i.getPinned()==this.pinned&&e.focusHeaderPosition({headerPosition:t,scroll:!1})}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new TS(e=>this.comp.setCenterWidth(`${e}px`),!0))}},rz=class extends V{constructor(){super(...arguments),this.beanName="menuSvc"}postConstruct(){const{enterpriseMenuFactory:e,filterMenuFactory:t}=this.beans;this.activeMenuFactory=e??t}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){this.showColumnMenuCommon(IR(this.beans),e,e.containerType,!0)}showHeaderContextMenu(e,t,i){var s;(s=this.activeMenuFactory)==null||s.showMenuAfterContextMenuEvent(e,t,i)}hidePopupMenu(){var e,t;(e=this.beans.contextMenuSvc)==null||e.hideActiveMenu(),(t=this.activeMenuFactory)==null||t.hideActiveMenu()}hideFilterMenu(){var e;(e=IR(this.beans))==null||e.hideActiveMenu()}isColumnMenuInHeaderEnabled(e){var i;const{suppressHeaderMenuButton:t}=e.getColDef();return!t&&!!((i=this.activeMenuFactory)!=null&&i.isMenuEnabled(e))&&(_s(this.gos)||!!this.beans.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){var t;return!e.getColDef().suppressHeaderFilterButton&&!!((t=this.beans.filterManager)!=null&&t.isFilterAllowed(e))}isHeaderContextMenuEnabled(e){const t=e&&Va(e)?e.getColDef():e==null?void 0:e.getColGroupDef();return!(t!=null&&t.suppressHeaderContextMenu)&&this.gos.get("columnMenu")==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const e=!this.isSuppressMenuHide();return!(Sc()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!_s(this.gos)&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){var t;return!!((t=this.beans.filterManager)!=null&&t.isFilterAllowed(e))&&!_s(this.gos)&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isFloatingFilterButtonEnabled(e){return!e.getColDef().suppressFloatingFilterButton}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){const e=this.gos,t=e.get("suppressMenuHide");return _s(e)?e.exists("suppressMenuHide")?t:!1:t}showColumnMenuCommon(e,t,i,s){const{positionBy:n,onClosedCallback:o}=t,r=t.column;if(n==="button"){const{buttonElement:a}=t;e==null||e.showMenuAfterButtonClick(r,a,i,o,s)}else if(n==="mouse"){const{mouseEvent:a}=t;e==null||e.showMenuAfterMouseEvent(r,a,i,o,s)}else if(r){const a=this.beans,l=a.ctrlsSvc;l.getScrollFeature().ensureColumnVisible(r,"auto"),Lr(a,()=>{var d;const c=(d=l.getHeaderRowContainerCtrl(r.getPinned()))==null?void 0:d.getHeaderCtrlForColumn(r);c&&(e==null||e.showMenuAfterButtonClick(r,c.getAnchorElementForMenu(s),i,o,s))})}}};function MR(e,t,i){e.menuVisible!==t&&(e.menuVisible=t,e.dispatchColEvent("menuVisibleChanged",i))}function IR(e){const{enterpriseMenuFactory:t,filterMenuFactory:i,gos:s}=e;return t&&_s(s)?t:i}var Uv=class extends vS{constructor(){super(...arguments),this.errorMessages=null}init(e){this.params=e,this.initialiseEditor(e),this.eEditor.onValueChange(()=>e.validate())}destroy(){this.errorMessages=null}},qT=class extends ct{constructor(){super()}},az={tag:"span",cls:"ag-overlay-loading-center"},lz=class extends qT{init(){var t;const e=br((t=this.gos.get("overlayLoadingTemplate"))==null?void 0:t.trim());if(this.setTemplate(e??az),!e){const s=this.getLocaleTextFunc()("loadingOoo","Loading...");this.getGui().textContent=s,this.beans.ariaAnnounce.announceValue(s,"overlay")}}},cz={tag:"span",cls:"ag-overlay-no-rows-center"},dz=class extends qT{init(){var t;const e=br((t=this.gos.get("overlayNoRowsTemplate"))==null?void 0:t.trim());if(this.setTemplate(e??cz),!e){const s=this.getLocaleTextFunc()("noRowsToShow","No Rows To Show");this.getGui().textContent=s,this.beans.ariaAnnounce.announceValue(s,"overlay")}}};function hz(e,t,i){const s=tn(e,t,i);if(s){const{className:o}=s;if(typeof o=="string"&&o.includes("ag-icon")||typeof o=="object"&&o["ag-icon"])return s}const n=jt({tag:"span"});return n.appendChild(s),n}function tn(e,t,i){var o;let s=null;e==="smallDown"?j(262):e==="smallLeft"?j(263):e==="smallRight"&&j(264);const n=i==null?void 0:i.getColDef().icons;if(n&&(s=n[e]),t.gos&&!s){const r=t.gos.get("icons");r&&(s=r[e])}if(s){let r;if(typeof s=="function")r=s();else if(typeof s=="string")r=s;else{j(38,{iconName:e});return}if(typeof r=="string")return oS(r);if(lS(r))return r;j(133,{iconName:e});return}else{const r=t.registry.getIcon(e);return r||(o=t.validation)==null||o.validateIcon(e),jt({tag:"span",cls:`ag-icon ag-icon-${r??e}`,role:"presentation",attrs:{unselectable:"on"}})}}var uz=".ag-dnd-ghost{align-items:center;background-color:var(--ag-drag-and-drop-image-background-color);border:var(--ag-drag-and-drop-image-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-drag-and-drop-image-shadow);color:var(--ag-text-color);cursor:move;display:flex;font-weight:500;gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);text-overflow:ellipsis;transform:translateY(calc(var(--ag-spacing)*2));white-space:nowrap}.ag-dnd-ghost-not-allowed{border:var(--ag-drag-and-drop-image-not-allowed-border)}",gz={tag:"div",children:[{tag:"div",ref:"eGhost",cls:"ag-dnd-ghost ag-unselectable",children:[{tag:"span",ref:"eIcon",cls:"ag-dnd-ghost-icon ag-shake-left-to-right"},{tag:"div",ref:"eLabel",cls:"ag-dnd-ghost-label"}]}]},fz=class extends ct{constructor(){super(),this.dragSource=null,this.eIcon=se,this.eLabel=se,this.eGhost=se,this.registerCSS(uz)}postConstruct(){const e=t=>hz(t,this.beans,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate(gz),this.beans.environment.applyThemeClasses(this.eGhost)}destroy(){this.dragSource=null,super.destroy()}setIcon(e,t){const{eGhost:i,eIcon:s,dragSource:n,dropIconMap:o,gos:r}=this;Mi(s);let a=null;e||(e=n!=null&&n.getDefaultIconName?n.getDefaultIconName():"notAllowed"),a=o[e],i.classList.toggle("ag-dnd-ghost-not-allowed",e==="notAllowed"),s.classList.toggle("ag-shake-left-to-right",t),!(a===o.hide&&r.get("suppressDragLeaveHidesColumns"))&&a&&s.appendChild(a)}setLabel(e){this.eLabel.textContent=e}},pz=".ag-checkbox-cell{height:100%}",mz={tag:"div",cls:"ag-cell-wrapper ag-checkbox-cell",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},vz=class extends ct{constructor(){super(mz,[bS]),this.eCheckbox=se,this.registerCSS(pz)}init(e){this.refresh(e);const{eCheckbox:t,beans:i}=this,s=t.getInputElement();s.setAttribute("tabindex","-1"),uP(s,"polite"),this.addManagedListeners(s,{click:n=>{if(_c(n),t.isDisabled())return;const o=t.getValue();this.onCheckboxChanged(o)},dblclick:n=>{_c(n)}}),this.addManagedElementListeners(e.eGridCell,{keydown:n=>{if(n.key===H.SPACE&&!t.isDisabled()){e.eGridCell===Dt(i)&&t.toggle();const o=t.getValue();this.onCheckboxChanged(o),n.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){let t,i=!0;const{value:s,column:n,node:o}=e;if(o.group&&n)if(typeof s=="boolean")t=s;else{const h=n.getColId();h.startsWith(Bv)?t=s==null||s===""?void 0:s==="true":o.aggData&&o.aggData[h]!==void 0||o.sourceRowIndex>=0?t=s??void 0:i=!1}else t=s??void 0;const{eCheckbox:r}=this;if(!i){r.setDisplayed(!1);return}r.setValue(t);const a=e.disabled??!(n!=null&&n.isCellEditable(o));r.setDisabled(a);const l=this.getLocaleTextFunc(),c=Gv(l,t),d=a?c:`${l("ariaToggleCellValue","Press SPACE to toggle cell value")} (${c})`;r.setInputAriaLabel(d)}onCheckboxChanged(e){var r,a,l,c;const{params:t}=this,{column:i,node:s,value:n}=t;(a=(r=this.beans)==null?void 0:r.editSvc)==null||a.setEditingCells([{column:i,colId:i.getColId(),rowIndex:s.rowIndex,rowPinned:s.rowPinned,state:"changed",oldValue:n,newValue:n}],{update:!0,forceRefreshOfEditCellsOnly:!0});const o=s.setDataValue(i,e,"renderer");(c=this.beans.editSvc)==null||c.stopEditing({rowNode:s,column:i},{source:(l=this.beans.editSvc)!=null&&l.isBatchEditing()?"ui":"api"}),o||this.updateCheckbox(t)}},kR=class{constructor(e,t){this.beans=e,this.floating=t,this.all=new Set,this.visible=new Set,this.order=[],this.queued=new Set}size(){return this.visible.size}add(e){const{all:t,visible:i,order:s}=this;t.has(e)||(t.add(e),i.add(e),s.push(e),this.sort())}delete(e){this.all.delete(e),this.visible.delete(e),this.queued.delete(e.id),_n(this.order,e)}has(e){return this.visible.has(e)}forEach(e){this.order.forEach(e)}getByIndex(e){return this.order[e]}getById(e){for(const t of this.visible)if(t.id==e)return t}clear(){const{all:e,visible:t,order:i,queued:s}=this;e.clear(),s.clear(),t.clear(),i.length=0}sort(){const{sortSvc:e,rowNodeSorter:t,gos:i}=this.beans,s=(e==null?void 0:e.getSortOptions())??[],n=bz(this.order);if(this.order.sort((r,a)=>{var l,c;return(((l=r.pinnedSibling)==null?void 0:l.rowIndex)??0)-(((c=a.pinnedSibling)==null?void 0:c.rowIndex)??0)}),this.order=(t==null?void 0:t.doFullSort(this.order,s))??this.order,!n)return;const o=GP(i);o==="bottom"||o==="pinnedBottom"?this.order.push(n):this.order.unshift(n)}hide(e){const{all:t,visible:i}=this;t.forEach(s=>e(s)?i.delete(s):i.add(s)),this.order=Array.from(i),this.sort()}queue(e){this.queued.add(e)}unqueue(e){this.queued.delete(e)}forEachQueued(e){this.queued.forEach(e)}};function YT(e){var i;if(e.level===-1)return!0;const t=e.parent;return(i=t==null?void 0:t.childrenAfterSort)!=null&&i.some(s=>s==e)?YT(t):!1}function OC(e,t){const{gos:i,rowModel:s,filterManager:n}=e;return iu(i)?!s.getRowNode(t.id):n!=null&&n.isAnyFilterPresent()?!YT(t):i.get("pivotMode")?!t.group:!1}function Cz(e){return!!e.footer&&e.level===-1}function wz(e){return!!e.pinnedSibling&&Cz(e.pinnedSibling)}function bz(e){var i;const t=e.findIndex(wz);if(t>-1)return(i=e.splice(t,1))==null?void 0:i[0]}var _R=class extends V{postConstruct(){const{gos:e,beans:t}=this;this.top=new kR(t,"top"),this.bottom=new kR(t,"bottom");const i=n=>OC(t,n.pinnedSibling),s=()=>{const n=e.get("isRowPinned");n&&e.get("enableRowPinning")&&t.rowModel.forEachNode(o=>this.pinRow(o,n(o)),!0),this.refreshRowPositions(),this.dispatchRowPinnedEvents()};this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this),modelUpdated:({keepRenderedRows:n})=>{this.tryToEmptyQueues(),this.pinGrandTotalRow(),this.forContainers(r=>r.hide(i));const o=this.refreshRowPositions();(!n||o)&&this.dispatchRowPinnedEvents()},columnRowGroupChanged:()=>{this.forContainers(Sz),this.refreshRowPositions()},rowNodeDataChanged:({node:n})=>{const o=e.get("isRowPinnable");((o==null?void 0:o(n))??!0)||this.pinRow(n,null)},firstDataRendered:s}),this.addManagedPropertyListener("pivotMode",()=>{this.forContainers(n=>n.hide(i)),this.dispatchRowPinnedEvents()}),this.addManagedPropertyListener("grandTotalRow",({currentValue:n})=>{this._grandTotalPinned=n==="pinnedBottom"?"bottom":n==="pinnedTop"?"top":null}),this.addManagedPropertyListener("isRowPinned",s)}destroy(){this.reset(!1),super.destroy()}reset(e=!0){this.forContainers(t=>{const i=[];t.forEach(s=>i.push(s)),i.forEach(s=>this.pinRow(s,null)),t.clear()}),e&&this.dispatchRowPinnedEvents()}pinRow(e,t,i){var r;if(e.footer&&e.level>-1)return;if(e.footer&&e.level===-1){this._grandTotalPinned=t,xz(this.beans);return}const s=e.rowPinned??((r=e.pinnedSibling)==null?void 0:r.rowPinned);if(s!=null&&t!=null&&t!=s){const a=e.rowPinned?e:e.pinnedSibling,l=e.rowPinned?e.pinnedSibling:e;this.pinRow(a,null,i),this.pinRow(l,t,i);return}const o=i&&Rz(this.beans,e,i);if(o){o.forEach(a=>this.pinRow(a,t));return}if(t==null){const a=e.rowPinned?e:e.pinnedSibling,l=this.findPinnedRowNode(a);if(!l)return;l.delete(a);const c=a.pinnedSibling;NC(a),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(c)}else{const a=LR(this.beans,e,t),l=this.getContainer(t);l.add(a),OC(this.beans,e)&&l.hide(c=>OC(this.beans,c.pinnedSibling)),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(e)}}isManual(){return!0}isEmpty(e){return this.getContainer(e).size()===0}isRowsToRender(e){return!this.isEmpty(e)}ensureRowHeightsValid(){let e=!1,t=0;const i=s=>{if(s.rowHeightEstimated){const n=Ba(this.beans,s);s.setRowTop(t),s.setRowHeight(n.height),t+=n.height,e=!0}};return this.bottom.forEach(i),t=0,this.top.forEach(i),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}getPinnedTopTotalHeight(){return OR(this.top)}getPinnedBottomTotalHeight(){return OR(this.bottom)}getPinnedTopRowCount(){return this.top.size()}getPinnedBottomRowCount(){return this.bottom.size()}getPinnedTopRow(e){return this.top.getByIndex(e)}getPinnedBottomRow(e){return this.bottom.getByIndex(e)}getPinnedRowById(e,t){return this.getContainer(t).getById(e)}forEachPinnedRow(e,t){this.getContainer(e).forEach(t)}getPinnedState(){const e=t=>{const i=[];return this.forEachPinnedRow(t,s=>i.push(s.pinnedSibling.id)),i};return{top:e("top"),bottom:e("bottom")}}setPinnedState(e){this.forContainers((t,i)=>{for(const s of e[i]){const n=this.beans.rowModel.getRowNode(s);n?this.pinRow(n,i):t.queue(s)}})}getGrandTotalPinned(){return this._grandTotalPinned}setGrandTotalPinned(e){this._grandTotalPinned=e}tryToEmptyQueues(){this.forContainers((e,t)=>{const i=new Set;e.forEachQueued(s=>{const n=this.beans.rowModel.getRowNode(s);n&&i.add(n)});for(const s of i)e.unqueue(s.id),this.pinRow(s,t)})}pinGrandTotalRow(){var a;const{gos:e,beans:t,_grandTotalPinned:i}=this,s=t.rowModel;if(!Ut(e))return;const n=(a=s.rootNode)==null?void 0:a.sibling;if(!n)return;const o=n.pinnedSibling,r=o&&this.findPinnedRowNode(o);if(i){if(r&&r.floating!==i&&(r.delete(o),NC(o)),!r||r.floating!==i){const l=LR(t,n,i);this.getContainer(i).add(l)}}else{if(!r)return;r.delete(o),NC(o)}}onGridStylesChanges(e){e.rowHeightChanged&&this.forContainers(t=>t.forEach(i=>i.setRowHeight(i.rowHeight,!0)))}getContainer(e){return e==="top"?this.top:this.bottom}findPinnedRowNode(e){if(this.top.has(e))return this.top;if(this.bottom.has(e))return this.bottom}refreshRowPositions(e){const t=s=>yz(this.beans,s);if(e)return t(this.getContainer(e));let i=!1;return this.forContainers(s=>{const n=t(s);i||(i=n)}),i}forContainers(e){e(this.top,"top"),e(this.bottom,"bottom")}dispatchRowPinnedEvents(e){this.eventSvc.dispatchEvent({type:"pinnedRowsChanged"}),e==null||e.dispatchRowEvent("rowPinned")}};function yz(e,t){let i=0,s=!1;return t.forEach((n,o)=>{if(s||(s=n.rowTop!==i),n.setRowTop(i),n.rowHeightEstimated||n.rowHeight==null){const r=Ba(e,n).height;s||(s=n.rowHeight!==r),n.setRowHeight(r)}n.setRowIndex(o),i+=n.rowHeight}),s}function LR(e,t,i){if(t.pinnedSibling)return t.pinnedSibling;const s=HB(t,e);s.setRowTop(null),s.setRowIndex(null),s.rowPinned=i;const n=i==="top"?ES:AS;return s.id=`${n}${i}-${t.id}`,s.pinnedSibling=t,t.pinnedSibling=s,s}function NC(e){if(!e.pinnedSibling)return;e.rowPinned=null,e.setRowTop(null),e.setRowIndex(null);const t=e.pinnedSibling;e.pinnedSibling=void 0,t&&(t.pinnedSibling=void 0,t.rowPinned=null)}function Sz(e){const t=new Set;e.forEach(i=>{i.group&&t.add(i)}),t.forEach(i=>e.delete(i))}function Rz(e,t,i){var o;const{rowSpanSvc:s}=e,n=(i&&(s==null?void 0:s.isCellSpanning(i,t)))??!1;if(i&&n)return(o=s==null?void 0:s.getCellSpan(i,t))==null?void 0:o.spannedNodes}function OR(e){const t=e.size();if(t===0)return 0;const i=e.getByIndex(t-1);return i===void 0?0:i.rowTop+i.rowHeight}function xz({gos:e,rowModel:t}){Ut(e)&&t.refreshModel({step:"map"})}var NR=class extends V{constructor(){super(...arguments),this.nextId=0,this.pinnedTopRows={cache:{},order:[]},this.pinnedBottomRows={cache:{},order:[]}}postConstruct(){const e=this.gos;this.setPinnedRowData(e.get("pinnedTopRowData"),"top"),this.setPinnedRowData(e.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",t=>this.setPinnedRowData(t.currentValue,"top")),this.addManagedPropertyListener("pinnedBottomRowData",t=>this.setPinnedRowData(t.currentValue,"bottom")),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this)})}reset(){}isEmpty(e){return this.getCache(e).order.length===0}isRowsToRender(e){return!this.isEmpty(e)}isManual(){return!1}pinRow(e,t){}onGridStylesChanges(e){if(e.rowHeightChanged){const t=i=>{i.setRowHeight(i.rowHeight,!0)};du(this.pinnedBottomRows,t),du(this.pinnedTopRows,t)}}ensureRowHeightsValid(){let e=!1,t=0;const i=s=>{if(s.rowHeightEstimated){const n=Ba(this.beans,s);s.setRowTop(t),s.setRowHeight(n.height),t+=n.height,e=!0}};return du(this.pinnedBottomRows,i),t=0,du(this.pinnedTopRows,i),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}setPinnedRowData(e,t){this.updateNodesFromRowData(e,t),this.eventSvc.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(e,t){var d;const i=this.getCache(t);if(e===void 0){i.order.length=0,i.cache={};return}const s=Wh(this.gos),n=t==="top"?ES:AS,o=new Set(i.order),r=[],a=new Set;let l=0,c=-1;for(const h of e){const u=(s==null?void 0:s({data:h,level:0,rowPinned:t}))??n+this.nextId++;if(a.has(u)){j(96,{id:u,data:h});continue}c++,a.add(u),r.push(u);const f=Ku(i,u);if(f!==void 0)f.data!==h&&f.updateData(h),l+=this.setRowTopAndRowIndex(f,l,c),o.delete(u);else{const p=new za(this.beans);p.id=u,p.data=h,p.rowPinned=t,l+=this.setRowTopAndRowIndex(p,l,c),i.cache[u]=p,i.order.push(u)}}for(const h of o)(d=Ku(i,h))==null||d.clearRowTopAndRowIndex(),delete i.cache[h];i.order=r}setRowTopAndRowIndex(e,t,i){return e.setRowTop(t),e.setRowHeight(Ba(this.beans,e).height),e.setRowIndex(i),e.rowHeight}getPinnedTopTotalHeight(){return HR(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return HR(this.pinnedBottomRows)}getPinnedTopRowCount(){return ry(this.pinnedTopRows)}getPinnedBottomRowCount(){return ry(this.pinnedBottomRows)}getPinnedTopRow(e){return oy(this.pinnedTopRows,e)}getPinnedBottomRow(e){return oy(this.pinnedBottomRows,e)}getPinnedRowById(e,t){return Ku(this.getCache(t),e)}forEachPinnedRow(e,t){return du(this.getCache(e),t)}getCache(e){return e==="top"?this.pinnedTopRows:this.pinnedBottomRows}getPinnedState(){return{top:[],bottom:[]}}setPinnedState(){}getGrandTotalPinned(){}setGrandTotalPinned(){}};function HR(e){const t=ry(e);if(t===0)return 0;const i=oy(e,t-1);return i===void 0?0:i.rowTop+i.rowHeight}function Ku(e,t){return e.cache[t]}function oy(e,t){return Ku(e,e.order[t])}function du(e,t){e.order.forEach((i,s)=>{const n=Ku(e,i);n&&t(n,s)})}function ry(e){return e.order.length}var Ez=class extends V{constructor(){super(...arguments),this.beanName="pinnedRowModel"}postConstruct(){const{gos:e}=this,t=()=>{const i=e.get("enableRowPinning"),s=GP(e),o=!!i||(s==="pinnedBottom"||s==="pinnedTop"),r=o?this.inner instanceof NR:this.inner instanceof _R;this.inner&&r&&this.destroyBean(this.inner),(r||!this.inner)&&(this.inner=this.createManagedBean(o?new _R:new NR))};this.addManagedPropertyListeners(["enableRowPinning","grandTotalRow"],t),t()}reset(){return this.inner.reset()}isEmpty(e){return this.inner.isEmpty(e)}isManual(){return this.inner.isManual()}isRowsToRender(e){return this.inner.isRowsToRender(e)}pinRow(e,t,i){return this.inner.pinRow(e,t,i)}ensureRowHeightsValid(){return this.inner.ensureRowHeightsValid()}getPinnedRowById(e,t){return this.inner.getPinnedRowById(e,t)}getPinnedTopTotalHeight(){return this.inner.getPinnedTopTotalHeight()}getPinnedBottomTotalHeight(){return this.inner.getPinnedBottomTotalHeight()}getPinnedTopRowCount(){return this.inner.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.inner.getPinnedBottomRowCount()}getPinnedTopRow(e){return this.inner.getPinnedTopRow(e)}getPinnedBottomRow(e){return this.inner.getPinnedBottomRow(e)}forEachPinnedRow(e,t){return this.inner.forEachPinnedRow(e,t)}getPinnedState(){return this.inner.getPinnedState()}setPinnedState(e){return this.inner.setPinnedState(e)}setGrandTotalPinned(e){return this.inner.setGrandTotalPinned(e)}getGrandTotalPinned(){return this.inner.getGrandTotalPinned()}};function tp(e){return!!(e.rowPinned&&e.pinnedSibling)}function zs(e,t,i,s){const n=t==="top";if(!i)return zs(e,t,n?e.getPinnedTopRow(0):e.getPinnedBottomRow(0),s);if(!s){const l=n?e.getPinnedTopRowCount():e.getPinnedBottomRowCount();return zs(e,t,i,n?e.getPinnedTopRow(l-1):e.getPinnedBottomRow(l-1))}let o=!1,r=!1;const a=[];return e.forEachPinnedRow(t,l=>{if(l===i&&!o){o=!0,a.push(l);return}if(o&&l===s){r=!0,a.push(l);return}o&&!r&&a.push(l)}),a}var Az={tag:"div",cls:"ag-selection-checkbox",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},Fz=class extends ct{constructor(){super(Az,[bS]),this.eCheckbox=se}postConstruct(){this.eCheckbox.setPassive(!0)}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const e=this.getLocaleTextFunc(),{rowNode:t,eCheckbox:i}=this,s=t.isSelected(),n=Gv(e,s),[o,r]=t.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],a=e(o,r);i.setValue(s,!0),i.setInputAriaLabel(`${a} (${n})`)}init(e){if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getInputElement(),{dblclick:_c,click:s=>{var n;_c(s),(n=this.beans.selectionSvc)==null||n.handleSelectionEvent(s,this.rowNode,"checkboxSelected")}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)}),this.addManagedPropertyListener("rowSelection",({currentValue:s,previousValue:n})=>{const o=typeof s=="object"?wC(s):void 0,r=typeof n=="object"?wC(n):void 0;o!==r&&this.onSelectableChanged()}),jb(this.gos)||typeof this.getIsVisible()=="function"){const s=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:s}),this.addManagedListeners(this.rowNode,{dataChanged:s,cellChanged:s}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}showOrHideSelect(){const{column:e,rowNode:t,overrides:i,gos:s}=this,n=t.selectable,o=this.getIsVisible();let r;if(typeof o=="function"){const h=i==null?void 0:i.callbackParams;if(!e)r=o({...h,node:t,data:t.data});else{const u=e.createColumnFunctionCallbackParams(t);r=o({...h,...u})}}else r=o??!1;const a=n&&!r||!n&&r,l=n||r,c=s.get("rowSelection"),d=c&&typeof c!="string"?!wC(c):!!(e!=null&&e.getColDef().showDisabledCheckboxes);this.setVisible(l&&(a?d:!0)),this.setDisplayed(l&&(a?d:!0)),l&&this.eCheckbox.setDisabled(a),i!=null&&i.removeHidden&&this.setDisplayed(l)}getIsVisible(){var i,s;const e=this.overrides;if(e)return e.isVisible;const t=this.gos.get("rowSelection");return t&&typeof t!="string"?Ed(t):(s=(i=this.column)==null?void 0:i.getColDef())==null?void 0:s.checkboxSelection}},Pz=class{constructor(e,t){this.rowModel=e,this.pinnedRowModel=t,this.selectAll=!1,this.rootId=null,this.endId=null,this.cachedRange=[]}reset(){this.rootId=null,this.endId=null,this.cachedRange.length=0}setRoot(e){this.rootId=e.id,this.endId=null,this.cachedRange.length=0}setEndRange(e){this.endId=e.id,this.cachedRange.length=0}getRange(){if(this.cachedRange.length===0){const e=this.getRoot(),t=this.getEnd();if(e==null||t==null)return this.cachedRange;this.cachedRange=this.getNodesInRange(e,t)??[]}return this.cachedRange}isInRange(e){return this.rootId===null?!1:this.getRange().some(t=>t.id===e.id)}getRoot(e){if(this.rootId)return this.getRowNode(this.rootId);if(e)return this.setRoot(e),e}getEnd(){if(this.endId)return this.getRowNode(this.endId)}getRowNode(e){let t;const{rowModel:i,pinnedRowModel:s}=this;return t??(t=i.getRowNode(e)),s!=null&&s.isManual()&&(t??(t=s.getPinnedRowById(e,"top")),t??(t=s.getPinnedRowById(e,"bottom"))),t}truncate(e){const t=this.getRange();if(t.length===0)return{keep:[],discard:[]};const i=t[0].id===this.rootId,s=t.findIndex(n=>n.id===e.id);if(s>-1){const n=t.slice(0,s),o=t.slice(s+1);return this.setEndRange(e),i?{keep:n,discard:o}:{keep:o,discard:n}}else return{keep:t,discard:[]}}extend(e,t=!1){const i=this.getRoot();if(i==null){const n=this.getRange().slice();return t&&e.depthFirstSearch(o=>!o.group&&n.push(o)),n.push(e),this.setRoot(e),{keep:n,discard:[]}}const s=this.getNodesInRange(i,e);if(!s)return this.setRoot(e),{keep:[e],discard:[]};if(s.find(n=>n.id===this.endId))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{const n=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:n}}}getNodesInRange(e,t){const{pinnedRowModel:i,rowModel:s}=this;if(!(i!=null&&i.isManual()))return s.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&!t.rowPinned)return zs(i,"top",e,void 0).concat(s.getNodesInRangeForSelection(s.getRow(0),t)??[]);if(e.rowPinned==="bottom"&&!t.rowPinned){const n=zs(i,"bottom",void 0,e),o=s.getRowCount(),r=s.getRow(o-1);return(s.getNodesInRangeForSelection(t,r)??[]).concat(n)}if(!e.rowPinned&&!t.rowPinned)return s.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&t.rowPinned==="top")return zs(i,"top",e,t);if(e.rowPinned==="bottom"&&t.rowPinned==="top"){const n=zs(i,"top",t,void 0),o=zs(i,"bottom",void 0,e),r=s.getRow(0),a=s.getRow(s.getRowCount()-1);return n.concat(s.getNodesInRangeForSelection(r,a)??[]).concat(o)}if(!e.rowPinned&&t.rowPinned==="top")return zs(i,"top",t,void 0).concat(s.getNodesInRangeForSelection(s.getRow(0),e)??[]);if(e.rowPinned==="top"&&t.rowPinned==="bottom"){const n=zs(i,"top",e,void 0),o=zs(i,"bottom",void 0,t),r=s.getRow(0),a=s.getRow(s.getRowCount()-1);return n.concat(s.getNodesInRangeForSelection(r,a)??[]).concat(o)}if(e.rowPinned==="bottom"&&t.rowPinned==="bottom")return zs(i,"bottom",e,t);if(!e.rowPinned&&t.rowPinned==="bottom"){const n=zs(i,"bottom",void 0,t),o=s.getRow(s.getRowCount());return(s.getNodesInRangeForSelection(e,o)??[]).concat(n)}return null}},Tz=class extends V{constructor(e){super(),this.column=e,this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1}onSpaceKeyDown(e){const t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(Dt(this.beans))&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e;const t=this.createManagedBean(new wS);this.cbSelectAll=t,t.addCss("ag-header-select-all"),Ha(t.getGui(),"presentation"),this.showOrHideSelectAll();const i=this.updateStateOfCheckbox.bind(this);this.addManagedEventListeners({newColumnsLoaded:()=>this.showOrHideSelectAll(),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:i,paginationChanged:i,modelUpdated:i}),this.addManagedPropertyListener("rowSelection",({currentValue:s,previousValue:n})=>{const o=r=>typeof r=="string"||!r||r.mode==="singleRow"?void 0:r.selectAll;o(s)!==o(n)&&this.showOrHideSelectAll(),this.updateStateOfCheckbox()}),this.addManagedListeners(t,{fieldValueChanged:this.onCbSelectAll.bind(this)}),t.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onDisplayedColumnsChanged(e){this.isAlive()&&this.showOrHideSelectAll(e.source==="uiColumnMoved")}showOrHideSelectAll(e=!1){const t=this.isCheckboxSelection();this.cbSelectAllVisible=t,this.cbSelectAll.setDisplayed(t),t&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel(e)}updateStateOfCheckbox(){if(!this.cbSelectAllVisible||this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const e=this.getSelectAllMode(),t=this.beans.selectionSvc,i=this.cbSelectAll,s=t.getSelectAllState(e);i.setValue(s);const n=t.hasNodesToSelect(e);i.setDisabled(!n),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(e=!1){const t=this.getLocaleTextFunc(),{headerCellCtrl:i,cbSelectAll:s,cbSelectAllVisible:n}=this,o=s.getValue(),r=Gv(t,o),a=t("ariaRowSelectAll","Press Space to toggle all rows selection");i.setAriaDescriptionProperty("selectAll",n?`${a} (${r})`:null),s.setInputAriaLabel(t("ariaHeaderSelection","Column with Header Selection")),e||i.announceAriaDescription()}checkSelectionType(e){return ug(this.gos)?!0:(j(128,{feature:e}),!1)}checkRightRowModelType(e){const{gos:t,rowModel:i}=this.beans;return Ut(t)||iu(t)?!0:(j(129,{feature:e,rowModel:i.getType()}),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;const e=this.cbSelectAll.getValue(),t=this.getSelectAllMode();let i="uiSelectAll";t==="currentPage"?i="uiSelectAllCurrentPage":t==="filtered"&&(i="uiSelectAllFiltered");const s={source:i,selectAll:t},n=this.beans.selectionSvc;e?n.selectAllRowNodes(s):n.deselectAllRowNodes(s)}isCheckboxSelection(){const{column:e,gos:t,beans:i}=this,o=typeof t.get("rowSelection")=="object"?"headerCheckbox":"headerCheckboxSelection";return XT(i,e)&&this.checkRightRowModelType(o)&&this.checkSelectionType(o)}getSelectAllMode(){const e=WP(this.gos,!1);if(e)return e;const{headerCheckboxSelectionCurrentPageOnly:t,headerCheckboxSelectionFilteredOnly:i}=this.column.getColDef();return t?"currentPage":i?"filtered":"all"}destroy(){super.destroy(),this.cbSelectAll=void 0,this.headerCellCtrl=void 0}};function XT({gos:e,selectionColSvc:t},i){const s=e.get("rowSelection"),n=i.getColDef(),{headerCheckboxSelection:o}=n;let r=!1;if(typeof s=="object"){const l=Or(i),c=pS(i);(Nm(s)==="autoGroupColumn"&&c||l&&(t!=null&&t.isSelectionColumnEnabled()))&&(r=dm(s))}else typeof o=="function"?r=o(Fe(e,{column:i,colDef:n})):r=!!o;return r}var Dz=class extends V{postConstruct(){const{gos:e,beans:t}=this;this.selectionCtx=new Pz(t.rowModel,t.pinnedRowModel),this.addManagedPropertyListeners(["isRowSelectable","rowSelection"],()=>{const i=jb(e);i!==this.isRowSelectable&&(this.isRowSelectable=i,this.updateSelectable())}),this.isRowSelectable=jb(e),this.addManagedEventListeners({cellValueChanged:i=>this.updateRowSelectable(i.node),rowNodeDataChanged:i=>this.updateRowSelectable(i.node)})}destroy(){super.destroy(),this.selectionCtx.reset()}createCheckboxSelectionComponent(){return new Fz}createSelectAllFeature(e){if(XT(this.beans,e))return new Tz(e)}isMultiSelect(){return ug(this.gos)}onRowCtrlSelected(e,t,i){const s=!!e.rowNode.isSelected();e.forEachGui(i,n=>{n.rowComp.toggleCss("ag-row-selected",s);const o=n.element;pP(o,s),o.contains(Dt(this.beans))&&t(n)})}announceAriaRowSelection(e){var o,r;if(this.isRowSelectionBlocked(e))return;const t=e.isSelected(),i=(o=this.beans.editSvc)==null?void 0:o.isEditing({rowNode:e});if(!e.selectable||i)return;const n=this.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${t?"deselect":"select"} this row`);(r=this.beans.ariaAnnounce)==null||r.announceValue(n,"rowSelection")}isRowSelectionBlocked(e){return!e.selectable||e.rowPinned&&!tp(e)||!bc(this.gos)}updateRowSelectable(e,t){var s;const i=e.rowPinned&&e.pinnedSibling?e.pinnedSibling.selectable:((s=this.isRowSelectable)==null?void 0:s.call(this,e))??!0;return this.setRowSelectable(e,i,t),i}setRowSelectable(e,t,i){if(e.selectable!==t){if(e.selectable=t,e.dispatchRowEvent("selectableChanged"),i)return;if(gg(this.gos)){const n=this.calculateSelectedFromChildren(e);this.setNodesSelected({nodes:[e],newValue:n??!1,source:"selectableChanged"});return}e.isSelected()&&!e.selectable&&this.setNodesSelected({nodes:[e],newValue:!1,source:"selectableChanged"})}}calculateSelectedFromChildren(e){var s;let t=!1,i=!1;if(!((s=e.childrenAfterGroup)!=null&&s.length))return e.selectable?e.__selected:null;for(let n=0;n<e.childrenAfterGroup.length;n++){const o=e.childrenAfterGroup[n];let r=o.isSelected();if(!o.selectable){const a=this.calculateSelectedFromChildren(o);if(a===null)continue;r=a}switch(r){case!0:t=!0;break;case!1:i=!0;break;default:return}}if(!(t&&i))return t?!0:i?!1:e.selectable?e.__selected:null}selectRowNode(e,t,i,s="api"){const n=!e.selectable&&t,o=e.__selected===t;if(n||o)return!1;e.__selected=t,e.dispatchRowEvent("rowSelected");const r=e.sibling;r&&r.footer&&r.__localEventService&&r.dispatchRowEvent("rowSelected");const a=e.pinnedSibling;return a!=null&&a.rowPinned&&a.__localEventService&&a.dispatchRowEvent("rowSelected"),this.eventSvc.dispatchEvent({...OB(e,this.gos,"rowSelected"),event:i||null,source:s}),!0}isCellCheckboxSelection(e,t){const i=this.gos.get("rowSelection");if(i&&typeof i!="string"){const s=Or(e)&&Ed(i);return e.isColumnFunc(t,s)}else return e.isColumnFunc(t,e.colDef.checkboxSelection)}inferNodeSelections(e,t,i,s){const{gos:n,selectionCtx:o}=this,r=e.isSelected(),a=gg(n),l=oG(n),c=rG(n),d=this.isMultiSelect(),h=s==="rowClicked";if(h&&!(l||c))return null;if(t&&i&&d){const u=o.getRoot();if(u)if(u.isSelected()){const f=o.isInRange(e)?o.truncate(e):o.extend(e,a);return{deselect:f.discard,select:f.keep,reset:!1}}else{const f=o.extend(e,a);return{select:[],deselect:f.keep,reset:!1}}else return null}else if(t&&d){const u=o.selectAll?this.beans.rowModel.getRow(0):void 0,f=o.getRoot(u),p=o.isInRange(e)?o.truncate(e):o.extend(e,a);return{select:p.keep,deselect:p.discard,reset:o.selectAll||!!(f&&!f.isSelected())}}else if(i){if(h){const u=!r;return u&&!l||!u&&!c?null:(o.setRoot(e),{node:e,newValue:u,clearSelection:!1})}return o.setRoot(e),{node:e,newValue:!r,clearSelection:!d}}else{o.setRoot(e);const u=aG(n),f=Gm(n)==="filteredDescendants",p=h&&(!u||!l);if(f&&r===void 0&&Ut(n))return{node:e,newValue:!1,checkFilteredNodes:!0,clearSelection:!d||p};if(h){const m=r?!u:l;return m===r&&!p||m&&!l||!m&&!c?null:{node:e,newValue:m,clearSelection:!d||p,keepDescendants:e.group&&a}}return{node:e,newValue:!r,clearSelection:!d||p}}}},HC={TAB_GUARD:"ag-tab-guard",TAB_GUARD_TOP:"ag-tab-guard-top",TAB_GUARD_BOTTOM:"ag-tab-guard-bottom"},Mz=class extends V{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;const{comp:t,eTopGuard:i,eBottomGuard:s,focusTrapActive:n,forceFocusOutWhenTabGuardsAreEmpty:o,isFocusableContainer:r,focusInnerElement:a,onFocusIn:l,onFocusOut:c,shouldStopEventPropagation:d,onTabKeyDown:h,handleKeyDown:u,isEmpty:f,eFocusableElement:p}=e;this.comp=t,this.eTopGuard=i,this.eBottomGuard=s,this.providedFocusInnerElement=a,this.eFocusableElement=p,this.focusTrapActive=!!n,this.forceFocusOutWhenTabGuardsAreEmpty=!!o,this.isFocusableContainer=!!r,this.providedFocusIn=l,this.providedFocusOut=c,this.providedShouldStopEventPropagation=d,this.providedOnTabKeyDown=h,this.providedHandleKeyDown=u,this.providedIsEmpty=f}postConstruct(){this.createManagedBean(new su(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards();for(const e of[this.eTopGuard,this.eBottomGuard])this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)})}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;const e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&(this.providedIsEmpty?this.providedIsEmpty():Fd(this.eFocusableElement,".ag-tab-guard").length===0)){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;const t=e.target===this.eBottomGuard;!(this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t))&&this.forceFocusOutWhenTabGuardsAreEmpty&&this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}findNextElementOutsideAndFocus(e){var l;const t=pi(this.beans),i=Fd(t.body,null,!0),s=i.indexOf(e?this.eTopGuard:this.eBottomGuard);if(s===-1)return;let n,o;e?(n=0,o=s):(n=s+1,o=i.length);const r=i.slice(n,o),a=this.gos.get("tabIndex");r.sort((c,d)=>{const h=Number.parseInt(c.getAttribute("tabindex")||"0"),u=Number.parseInt(d.getAttribute("tabindex")||"0");return u===a?1:h===a?-1:h===0?1:u===0?-1:h-u}),(l=r[e?r.length-1:0])==null||l.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const i=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),i&&(i.focus(),e.preventDefault())}focusInnerElement(e=!1){const t=Fd(this.eFocusableElement);return this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length?(t[e?t.length-1:0].focus({preventScroll:!0}),!0):!1}getNextFocusableElement(e){return Kc(this.beans,this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},Iz=class extends V{constructor(e){super(),this.comp=e}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();const{eTopGuard:t,eBottomGuard:i,eFocusableElement:s}=this,n=[t,i],o={setTabIndex:v=>{for(const C of n)v!=null?C.setAttribute("tabindex",v):C.removeAttribute("tabindex")}};this.addTabGuards(t,i);const{focusTrapActive:r=!1,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:d,onTabKeyDown:h,shouldStopEventPropagation:u,isEmpty:f,forceFocusOutWhenTabGuardsAreEmpty:p,isFocusableContainer:m}=e;this.tabGuardCtrl=this.createManagedBean(new Mz({comp:o,focusTrapActive:r,eTopGuard:t,eBottomGuard:i,eFocusableElement:s,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:d,onTabKeyDown:h,shouldStopEventPropagation:u,isEmpty:f,forceFocusOutWhenTabGuardsAreEmpty:p,isFocusableContainer:m}))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){const t=pi(this.beans).createElement("div"),i=e==="top"?HC.TAB_GUARD_TOP:HC.TAB_GUARD_BOTTOM;return t.classList.add(HC.TAB_GUARD,i),Ha(t,"presentation"),t}addTabGuards(e,t){const i=this.eFocusableElement;i.insertAdjacentElement("afterbegin",e),i.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){const e=[this.eTopGuard,this.eBottomGuard];Mi(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(e=!1){this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,i){lS(t)||(t=t.getGui());const{eBottomGuard:s}=this;s?s.insertAdjacentElement("beforebegin",t):e(t,i)}destroy(){const{eTopGuard:e,eBottomGuard:t}=this;Dn(e),Dn(t),super.destroy()}},QT=class extends ct{initialiseTabGuard(e){this.tabGuardFeature=this.createManagedBean(new Iz(this)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(e=!1){this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}},kz=500,_z=550,xp,Lz=e=>{if(!xp)xp=new WeakSet;else if(xp.has(e))return!1;return xp.add(e),!0},rl=class{constructor(e,t=!1){this.eElement=e,this.preventClick=t,this.startListener=null,this.handlers=[],this.eventSvc=void 0,this.touchStart=null,this.lastTapTime=null,this.longPressTimer=0,this.moved=!1}addEventListener(e,t){let i=this.eventSvc;if(!i){if(i===null)return;this.eventSvc=i=new Mc;const s=this.onTouchStart.bind(this);this.startListener=s,this.eElement.addEventListener("touchstart",s,{passive:!0})}i.addEventListener(e,t)}removeEventListener(e,t){var i;(i=this.eventSvc)==null||i.removeEventListener(e,t)}onTouchStart(e){if(this.touchStart||!Lz(e))return;const t=e.touches[0];this.touchStart=t;const i=this.handlers;if(!i.length){const s=this.eElement,n=s.ownerDocument,o=this.onTouchMove.bind(this),r=this.onTouchEnd.bind(this),a=this.onTouchCancel.bind(this),l={passive:!0},c={passive:!1};am(i,[s,"touchmove",o,l],[n,"touchcancel",a,l],[n,"touchend",r,c],[n,"contextmenu",Ur,c])}this.clearLongPress(),this.longPressTimer=window.setTimeout(()=>{var s;this.longPressTimer=0,this.touchStart===t&&!this.moved&&(this.moved=!0,(s=this.eventSvc)==null||s.dispatchEvent({type:"longTap",touchStart:t,touchEvent:e}))},_z)}onTouchMove(e){const{moved:t,touchStart:i}=this;if(!t&&i){const s=$u(i,e.touches);s&&!EP(s,i,4)&&(this.clearLongPress(),this.moved=!0)}}onTouchEnd(e){var i;const t=this.touchStart;!t||!$u(t,e.changedTouches)||(this.moved||((i=this.eventSvc)==null||i.dispatchEvent({type:"tap",touchStart:t}),this.checkDoubleTap(t)),this.preventClick&&Ur(e),this.cancel())}onTouchCancel(e){const t=this.touchStart;!t||!$u(t,e.changedTouches)||(this.lastTapTime=null,this.cancel())}checkDoubleTap(e){var s;let t=Date.now();const i=this.lastTapTime;i&&t-i>kz&&((s=this.eventSvc)==null||s.dispatchEvent({type:"doubleTap",touchStart:e}),t=null),this.lastTapTime=t}cancel(){this.clearLongPress(),cS(this.handlers),this.touchStart=null}clearLongPress(){window.clearTimeout(this.longPressTimer),this.longPressTimer=0,this.moved=!1}destroy(){const e=this.startListener;e&&(this.startListener=null,this.eElement.removeEventListener("touchstart",e)),this.cancel(),this.eElement=null,this.eventSvc=null}},Oz=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=e.scrollAxis.includes("x"),this.scrollVertically=e.scrollAxis.includes("y"),this.scrollByTick=e.scrollByTick!=null?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}get scrolling(){return this.tickingInterval!==null}check(e,t=!1){const i=t||this.shouldSkipVerticalScroll();if(i&&this.shouldSkipHorizontalScroll())return;const s=this.scrollContainer.getBoundingClientRect(),n=this.scrollByTick;this.tickLeft=e.clientX<s.left+n,this.tickRight=e.clientX>s.right-n,this.tickUp=e.clientY<s.top+n&&!i,this.tickDown=e.clientY>s.bottom-n&&!i,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;const e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){const t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){const t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},Nz=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.batchFrameworkComps=!1,this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t(),this.baseDocLink=`${PP}/${this.frameworkName}-data-grid`,qH(this.baseDocLink)}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return this.baseDocLink+(e?"/"+e:"")}};function Hz(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionSvc").api}}var Gz=["licenseManager","environment","eventSvc","gos","paginationAutoPageSizeSvc","apiFunctionSvc","gridApi","registry","agCompUtils","userCompFactory","rowContainerHeight","horizontalResizeSvc","localeSvc","pinnedRowModel","dragSvc","colGroupSvc","visibleCols","popupSvc","selectionSvc","colFilter","quickFilter","filterManager","colModel","headerNavigation","pageBounds","pagination","pageBoundsListener","rowSpanSvc","stickyRowSvc","rowRenderer","expressionSvc","alignedGridsSvc","navigation","valueCache","valueSvc","autoWidthCalc","filterMenuFactory","dragAndDrop","focusSvc","cellNavigation","cellStyles","scrollVisibleSvc","sortSvc","colHover","colAnimation","autoColSvc","selectionColSvc","changeDetectionSvc","animationFrameSvc","undoRedo","colDefFactory","rowStyleSvc","rowNodeBlockLoader","rowNodeSorter","ctrlsSvc","pinnedCols","dataTypeSvc","syncSvc","overlays","stateSvc","expansionSvc","apiEventSvc","ariaAnnounce","menuSvc","colMoves","colAutosize","colFlex","colResize","pivotColsSvc","valueColsSvc","rowGroupColsSvc","colNames","colViewport","pivotResultCols","showRowGroupCols","validation"],GR=Object.fromEntries(Gz.map((e,t)=>[e,t]));function Bz(e,t){const i=(e.beanName?GR[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER,s=(t.beanName?GR[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER;return i-s}function Vz(e,t){return(e==null?void 0:e.beanName)==="gridDestroySvc"?-1:(t==null?void 0:t.beanName)==="gridDestroySvc"?1:0}var zz={tag:"div",cls:"ag-pinned-left-header",role:"rowgroup"},Wz={tag:"div",cls:"ag-pinned-right-header",role:"rowgroup"},$z={tag:"div",cls:"ag-header-viewport",role:"rowgroup",attrs:{tabindex:"-1"},children:[{tag:"div",ref:"eCenterContainer",cls:"ag-header-container",role:"presentation"}]},GC=class extends ct{constructor(e){super(),this.eCenterContainer=se,this.headerRowComps={},this.rowCompsList=[],this.pinned=e}postConstruct(){this.selectAndSetTemplate();const e={setDisplayed:i=>this.setDisplayed(i),setCtrls:i=>this.setCtrls(i),setCenterWidth:i=>this.eCenterContainer.style.width=i,setViewportScrollLeft:i=>this.getGui().scrollLeft=i,setPinnedContainerWidth:i=>{const s=this.getGui();s.style.width=i,s.style.maxWidth=i,s.style.minWidth=i}};this.createManagedBean(new oz(this.pinned)).setComp(e,this.getGui())}selectAndSetTemplate(){const e=this.pinned=="left",t=this.pinned=="right",i=e?zz:t?Wz:$z;this.setTemplate(i),this.eRowContainer=this.eCenterContainer!==se?this.eCenterContainer:this.getGui()}destroy(){this.setCtrls([]),super.destroy()}destroyRowComp(e){this.destroyBean(e),e.getGui().remove()}setCtrls(e){const t=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];let i;const s=n=>{const o=n.getGui();o.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(o),i&&bP(this.eRowContainer,o,i),i=o};for(const n of e){const o=n.instanceId,r=t[o];delete t[o];const a=r||this.createBean(new tz(n));this.headerRowComps[o]=a,this.rowCompsList.push(a),s(a)}for(const n of Object.values(t))this.destroyRowComp(n)}},Uz={tag:"div",cls:"ag-header",role:"presentation"},jz=class extends ct{constructor(){super(Uz)}postConstruct(){const e={toggleCss:(s,n)=>this.toggleCss(s,n),setHeightAndMinHeight:s=>{this.getGui().style.height=s,this.getGui().style.minHeight=s}};this.createManagedBean(new qV).setComp(e,this.getGui(),this.getFocusableElement());const i=s=>{this.createManagedBean(s),this.appendChild(s)};i(new GC("left")),i(new GC(null)),i(new GC("right"))}},Kz={selector:"AG-HEADER-ROOT",component:jz},qz=class extends ct{constructor(e,t,i,s,n){super(),this.cellCtrl=t,this.rendererVersion=0,this.editorVersion=0,this.beans=e,this.gos=e.gos,this.column=t.column,this.rowNode=t.rowNode,this.eRow=s;const o=jt({tag:"div",role:t.getCellAriaRole(),attrs:{"comp-id":`${this.getCompId()}`,"col-id":t.column.colIdSanitised}});this.eCell=o;let r;t.isCellSpanning()?(r=jt({tag:"div",cls:"ag-spanned-cell-wrapper",role:"presentation"}),r.appendChild(o),this.setTemplateFromElement(r)):this.setTemplateFromElement(o),this.cellCssManager=new sT(()=>o),this.forceWrapper=t.isForceWrapper(),this.refreshWrapper(!1);const a={toggleCss:(l,c)=>this.cellCssManager.toggleCss(l,c),setUserStyles:l=>Yf(o,l),getFocusableElement:()=>o,setIncludeSelection:l=>this.includeSelection=l,setIncludeRowDrag:l=>this.includeRowDrag=l,setIncludeDndSource:l=>this.includeDndSource=l,setRenderDetails:(l,c,d)=>this.setRenderDetails(l,c,d),setEditDetails:(l,c,d)=>this.setEditDetails(l,c,d),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue(),refreshEditStyles:(l,c)=>this.refreshEditStyles(l,c)};t.setComp(a,o,r,this.eCellWrapper,i,n,void 0)}getParentOfValue(){return this.eCellValue??this.eCellWrapper??this.eCell}setRenderDetails(e,t,i){var o;if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=this.firstRender==null;const n=this.refreshWrapper(!1);this.refreshEditStyles(!1),e?!(i||n)&&this.refreshCellRenderer(e)||(this.destroyRenderer(),this.createCellRendererInstance(e)):(this.destroyRenderer(),this.insertValueWithoutCellRenderer(t)),(o=this.rowDraggingComp)==null||o.refreshVisibility()}setEditDetails(e,t,i){e?this.createCellEditorInstance(e,t,i):this.destroyEditor()}removeControls(){const e=this.beans.context;this.checkboxSelectionComp=e.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=e.destroyBean(this.dndSourceComp),this.rowDraggingComp=e.destroyBean(this.rowDraggingComp)}refreshWrapper(e){const t=this.includeRowDrag||this.includeDndSource||this.includeSelection,i=t||this.forceWrapper,s=i&&this.eCellWrapper==null;s&&(this.eCellWrapper=jt({tag:"div",cls:"ag-cell-wrapper",role:"presentation"}),this.eCell.appendChild(this.eCellWrapper));const n=!i&&this.eCellWrapper!=null;n&&(Dn(this.eCellWrapper),this.eCellWrapper=void 0),this.cellCssManager.toggleCss("ag-cell-value",!i);const o=!e&&i,r=o&&this.eCellValue==null;if(r){const c=this.cellCtrl.getCellValueClass();this.eCellValue=jt({tag:"span",cls:c,role:"presentation"}),this.eCellWrapper.appendChild(this.eCellValue)}const a=!o&&this.eCellValue!=null;a&&(Dn(this.eCellValue),this.eCellValue=void 0);const l=s||n||r||a;return l&&this.removeControls(),!e&&t&&this.addControls(),l}addControls(){const{cellCtrl:e,eCellWrapper:t,eCellValue:i,includeRowDrag:s,includeDndSource:n,includeSelection:o}=this,r=a=>{a&&t.insertBefore(a.getGui(),i)};s&&this.rowDraggingComp==null&&(this.rowDraggingComp=e.createRowDragComp(),r(this.rowDraggingComp)),n&&this.dndSourceComp==null&&(this.dndSourceComp=e.createDndSource(),r(this.dndSourceComp)),o&&this.checkboxSelectionComp==null&&(this.checkboxSelectionComp=e.createSelectionCheckbox(),r(this.checkboxSelectionComp))}createCellEditorInstance(e,t,i){const s=this.editorVersion,n=e.newAgStackInstance(),{params:o}=e;n.then(a=>this.afterCellEditorCreated(s,a,o,t,i)),At(this.cellEditor)&&o.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(e){const t=this.getParentOfValue();Mi(t);const i=tu(e);i!=null&&(t.textContent=i)}destroyRenderer(){const{context:e}=this.beans;this.cellRenderer=e.destroyBean(this.cellRenderer),Dn(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){var i,s;const{context:e}=this.beans;(((i=this.cellEditorPopupWrapper)==null?void 0:i.getGui().contains(Dt(this.beans)))||this.cellCtrl.hasBrowserFocus())&&this.eCell.focus({preventScroll:!0}),(s=this.hideEditorPopup)==null||s.call(this),this.hideEditorPopup=void 0,this.cellEditor=e.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=e.destroyBean(this.cellEditorPopupWrapper),Dn(this.cellEditorGui),this.cellCtrl.disableEditorTooltipFeature(),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(e){var i;if(((i=this.cellRenderer)==null?void 0:i.refresh)==null||this.cellRendererClass!==e.componentClass)return!1;const t=this.cellRenderer.refresh(e.params);return t===!0||t===void 0}createCellRendererInstance(e){var o;const t=this.rendererVersion,i=r=>a=>{if(this.rendererVersion!==t||!this.isAlive())return;const c=r.newAgStackInstance(),d=this.afterCellRendererCreated.bind(this,t,r.componentClass);c==null||c.then(d)},{animationFrameSvc:s}=this.beans;let n;if(s!=null&&s.active&&this.firstRender?n=(r,a=!1)=>{s.createTask(i(r),this.rowNode.rowIndex,"p2",r.componentFromFramework,a)}:n=r=>i(r)(),(o=e.params)!=null&&o.deferRender&&!this.cellCtrl.rowNode.group){const{loadingComp:r,onReady:a}=this.cellCtrl.getDeferLoadingCellRenderer();r&&(n(r),a.then(()=>n(e,!0)))}else n(e)}afterCellRendererCreated(e,t,i){if(!this.isAlive()||e!==this.rendererVersion){this.beans.context.destroyBean(i);return}this.cellRenderer=i,this.cellRendererClass=t;const n=i.getGui();if(this.cellRendererGui=n,n!=null){const o=this.getParentOfValue();Mi(o),o.appendChild(n)}}afterCellEditorCreated(e,t,i,s,n){var c,d,h;const o=e!==this.editorVersion,{context:r}=this.beans;if(o){r.destroyBean(t);return}if((c=t.isCancelBeforeStart)==null?void 0:c.call(t)){r.destroyBean(t),this.cellCtrl.stopEditing(!0);return}if(!t.getGui){j(97,{colId:this.column.getId()}),r.destroyBean(t);return}this.cellEditor=t,this.cellEditorGui=t.getGui();const l=s||((d=t.isPopup)==null?void 0:d.call(t));l?this.addPopupCellEditor(i,n):this.addInCellEditor(),this.refreshEditStyles(!0,l),(h=t.afterGuiAttached)==null||h.call(t),this.cellCtrl.enableEditorTooltipFeature(t),this.cellCtrl.cellEditorAttached()}refreshEditStyles(e,t){const{cellCssManager:i}=this;i.toggleCss("ag-cell-inline-editing",e&&!t),i.toggleCss("ag-cell-popup-editing",e&&!!t),i.toggleCss("ag-cell-not-inline-editing",!e||!!t)}addInCellEditor(){const{eCell:e}=this;e.contains(Dt(this.beans))&&e.focus(),this.destroyRenderer(),this.refreshWrapper(!0),Mi(this.getParentOfValue()),this.cellEditorGui&&this.getParentOfValue().appendChild(this.cellEditorGui)}addPopupCellEditor(e,t){var b;const{gos:i,context:s,popupSvc:n,editSvc:o}=this.beans;i.get("editType")==="fullRow"&&j(98);const r=this.cellEditorPopupWrapper=s.createBean(o.createPopupEditorWrapper(e)),{cellEditor:a,cellEditorGui:l,eCell:c,rowNode:d,column:h,cellCtrl:u}=this,f=r.getGui();l&&f.appendChild(l);const p=i.get("stopEditingWhenCellsLoseFocus"),m=t??((b=a.getPopupPosition)==null?void 0:b.call(a))??"over",v=i.get("enableRtl"),C={ePopup:f,column:h,rowNode:d,type:"popupCellEditor",eventSource:c,position:m,alignSide:v?"right":"left",keepWithinBounds:!0},w=n.positionPopupByComponent.bind(n,C),S=n.addPopup({modal:p,eChild:f,closeOnEsc:!0,closedCallback:()=>{u.onPopupEditorClosed()},anchorToElement:c,positionCallback:w,ariaOwns:c});S&&(this.hideEditorPopup=S.hideFunc)}detach(){this.getGui().remove()}destroy(){this.destroyRenderer(),this.destroyEditor(),this.removeControls(),super.destroy()}},Yz=class extends ct{constructor(e,t,i){super(),this.cellComps=new Map,this.beans=t,this.rowCtrl=e;const s=jt({tag:"div",role:"row",attrs:{"comp-id":`${this.getCompId()}`}});this.setInitialStyle(s,i),this.setTemplateFromElement(s);const n=s.style;this.domOrder=this.rowCtrl.getDomOrder();const o={setDomOrder:r=>this.domOrder=r,setCellCtrls:r=>this.setCellCtrls(r),showFullWidth:r=>this.showFullWidth(r),getFullWidthCellRenderer:()=>this.fullWidthCellRenderer,getFullWidthCellRendererParams:()=>this.fullWidthCellRendererParams,toggleCss:(r,a)=>this.toggleCss(r,a),setUserStyles:r=>Yf(s,r),setTop:r=>n.top=r,setTransform:r=>n.transform=r,setRowIndex:r=>s.setAttribute("row-index",r),setRowId:r=>s.setAttribute("row-id",r),setRowBusinessKey:r=>s.setAttribute("row-business-key",r),refreshFullWidth:r=>{var l,c;const a=r();return this.fullWidthCellRendererParams=a,((c=(l=this.fullWidthCellRenderer)==null?void 0:l.refresh)==null?void 0:c.call(l,a))??!1}};e.setComp(o,this.getGui(),i,void 0),this.addDestroyFunc(()=>{e.unsetComp(i)})}setInitialStyle(e,t){const i=this.rowCtrl.getInitialTransform(t);if(i)e.style.setProperty("transform",i);else{const s=this.rowCtrl.getInitialRowTop(t);s&&e.style.setProperty("top",s)}}showFullWidth(e){const t=s=>{if(this.isAlive()){const n=s.getGui();this.getGui().appendChild(n),this.rowCtrl.setupDetailRowAutoHeight(n),this.setFullWidthRowComp(s,e.params)}else this.beans.context.destroyBean(s)};e.newAgStackInstance().then(t)}setCellCtrls(e){const t=new Map(this.cellComps);for(const i of e){const s=i.instanceId;this.cellComps.has(s)?t.delete(s):this.newCellComp(i)}this.destroyCells(t),this.ensureDomOrder(e)}ensureDomOrder(e){if(!this.domOrder)return;const t=[];for(const i of e){const s=this.cellComps.get(i.instanceId);s&&t.push(s.getGui())}yP(this.getGui(),t)}newCellComp(e){var s;const t=((s=this.beans.editSvc)==null?void 0:s.isEditing(e,{withOpenEditor:!0}))??!1,i=new qz(this.beans,e,this.rowCtrl.printLayout,this.getGui(),t);this.cellComps.set(e.instanceId,i),this.getGui().appendChild(i.getGui())}destroy(){super.destroy(),this.destroyCells(this.cellComps)}setFullWidthRowComp(e,t){this.fullWidthCellRenderer=e,this.fullWidthCellRendererParams=t,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer),this.fullWidthCellRendererParams=void 0})}destroyCells(e){for(const t of e.values()){if(!t)return;const i=t.cellCtrl.instanceId;if(this.cellComps.get(i)!==t)return;t.detach(),t.destroy(),this.cellComps.delete(i)}}};function Xz(e,t,i){const s=!!i.gos.get("enableCellSpan")&&!!t.getSpannedRowCtrls,n={tag:"div",ref:"eContainer",cls:fm(e),role:"rowgroup"};if(t.type==="center"||s){const o={tag:"div",ref:"eSpannedContainer",cls:`ag-spanning-container ${vV(e)}`,role:"presentation"};return n.role="presentation",{tag:"div",ref:"eViewport",cls:`ag-viewport ${HT(e)}`,role:"rowgroup",children:[n,s?o:null]}}return n}var Qz=class extends ct{constructor(e){super(),this.eViewport=se,this.eContainer=se,this.eSpannedContainer=se,this.rowCompsNoSpan={},this.rowCompsWithSpan={},this.name=e==null?void 0:e.name,this.options=Zf(this.name)}postConstruct(){this.setTemplate(Xz(this.name,this.options,this.beans));const e={setHorizontalScroll:i=>this.eViewport.scrollLeft=i,setViewportHeight:i=>this.eViewport.style.height=i,setRowCtrls:({rowCtrls:i})=>this.setRowCtrls(i),setSpannedRowCtrls:i=>this.setRowCtrls(i,!0),setDomOrder:i=>{this.domOrder=i},setContainerWidth:i=>{this.eContainer.style.width=i,this.eSpannedContainer&&(this.eSpannedContainer.style.width=i)},setOffsetTop:i=>{const s=`translateY(${i})`;this.eContainer.style.transform=s,this.eSpannedContainer&&(this.eSpannedContainer.style.transform=s)}};this.createManagedBean(new FV(this.name)).setComp(e,this.eContainer,this.eSpannedContainer,this.eViewport)}destroy(){this.setRowCtrls([]),this.setRowCtrls([],!0),super.destroy(),this.lastPlacedElement=null}setRowCtrls(e,t){const{beans:i,options:s}=this,n=t?this.eSpannedContainer:this.eContainer,o=t?{...this.rowCompsWithSpan}:{...this.rowCompsNoSpan},r={};t?this.rowCompsWithSpan=r:this.rowCompsNoSpan=r,this.lastPlacedElement=null;const a=[];for(const l of e){const c=l.instanceId,d=o[c];let h;if(d)h=d,delete o[c];else{if(!l.rowNode.displayed)continue;h=new Yz(l,i,s.type)}r[c]=h,a.push([h,!d])}this.removeOldRows(Object.values(o)),this.addRowNodes(a,n)}addRowNodes(e,t){const{domOrder:i}=this;for(const[s,n]of e){const o=s.getGui();i?this.ensureDomOrder(o,t):n&&t.appendChild(o)}}removeOldRows(e){for(const t of e)t.getGui().remove(),t.destroy()}ensureDomOrder(e,t){bP(t,e,this.lastPlacedElement),this.lastPlacedElement=e}},Jz={selector:"AG-ROW-CONTAINER",component:Qz};function hu(e,t){return t.map(i=>{const s=`e${i[0].toUpperCase()+i.substring(1)}RowContainer`;return e[s]={name:i},{tag:"ag-row-container",ref:s,attrs:{name:i}}})}function Zz(e){const t={},i={tag:"div",ref:"eGridRoot",cls:"ag-root ag-unselectable",children:[{tag:"ag-header-root"},{tag:"div",ref:"eTop",cls:"ag-floating-top",role:"presentation",children:hu(t,["topLeft","topCenter","topRight","topFullWidth"])},{tag:"div",ref:"eBody",cls:"ag-body",role:"presentation",children:[{tag:"div",ref:"eBodyViewport",cls:"ag-body-viewport",role:"presentation",children:hu(t,["left","center","right","fullWidth"])},{tag:"ag-fake-vertical-scroll"}]},{tag:"div",ref:"eStickyTop",cls:"ag-sticky-top",role:"presentation",children:hu(t,["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"])},{tag:"div",ref:"eStickyBottom",cls:"ag-sticky-bottom",role:"presentation",children:hu(t,["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"])},{tag:"div",ref:"eBottom",cls:"ag-floating-bottom",role:"presentation",children:hu(t,["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"])},{tag:"ag-fake-horizontal-scroll"},e?{tag:"ag-overlay-wrapper"}:null]};return{paramsMap:t,elementParams:i}}var eW=class extends ct{constructor(){super(...arguments),this.eGridRoot=se,this.eBodyViewport=se,this.eStickyTop=se,this.eStickyBottom=se,this.eTop=se,this.eBottom=se,this.eBody=se}postConstruct(){const{overlays:e,rangeSvc:t}=this.beans,i=e==null?void 0:e.getOverlayWrapperSelector(),{paramsMap:s,elementParams:n}=Zz(!!i);this.setTemplate(n,[...i?[i]:[],_V,NV,Kz,Jz],s);const o=(a,l)=>{const c=`${a}px`;l.style.minHeight=c,l.style.height=c},r={setRowAnimationCssOnBodyViewport:(a,l)=>this.setRowAnimationCssOnBodyViewport(a,l),setColumnCount:a=>cH(this.getGui(),a),setRowCount:a=>aH(this.getGui(),a),setTopHeight:a=>o(a,this.eTop),setBottomHeight:a=>o(a,this.eBottom),setTopInvisible:a=>this.eTop.classList.toggle("ag-invisible",a),setBottomInvisible:a=>this.eBottom.classList.toggle("ag-invisible",a),setStickyTopHeight:a=>this.eStickyTop.style.height=a,setStickyTopTop:a=>this.eStickyTop.style.top=a,setStickyTopWidth:a=>this.eStickyTop.style.width=a,setStickyBottomHeight:a=>{this.eStickyBottom.style.height=a,this.eStickyBottom.classList.toggle("ag-invisible",a==="0px")},setStickyBottomBottom:a=>this.eStickyBottom.style.bottom=a,setStickyBottomWidth:a=>this.eStickyBottom.style.width=a,setColumnMovingCss:(a,l)=>this.toggleCss(a,l),updateLayoutClasses:(a,l)=>{const c=[this.eBodyViewport.classList,this.eBody.classList];for(const d of c)d.toggle(An.AUTO_HEIGHT,l.autoHeight),d.toggle(An.NORMAL,l.normal),d.toggle(An.PRINT,l.print);this.toggleCss(An.AUTO_HEIGHT,l.autoHeight),this.toggleCss(An.NORMAL,l.normal),this.toggleCss(An.PRINT,l.print)},setAlwaysVerticalScrollClass:(a,l)=>this.eBodyViewport.classList.toggle(VT,l),registerBodyViewportResizeListener:a=>{const l=qa(this.beans,this.eBodyViewport,a);this.addDestroyFunc(()=>l())},setPinnedTopBottomOverflowY:a=>this.eTop.style.overflowY=this.eBottom.style.overflowY=a,setCellSelectableCss:(a,l)=>{for(const c of[this.eTop,this.eBodyViewport,this.eBottom])c.classList.toggle(a,l)},setBodyViewportWidth:a=>this.eBodyViewport.style.width=a,setGridRootRole:a=>Ha(this.eGridRoot,a)};this.ctrl=this.createManagedBean(new DV),this.ctrl.setComp(r,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop,this.eStickyBottom),(t&&Tr(this.gos)||ug(this.gos))&&rH(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(e,t){const i=this.eBodyViewport.classList;i.toggle("ag-row-animation",t),i.toggle("ag-row-no-animation",!t)}},tW={selector:"AG-GRID-BODY",component:eW},iW=class extends V{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}setComp(e,t,i){this.view=e,this.eGridHostDiv=t,this.eGui=i,this.eGui.setAttribute("grid-id",this.beans.context.getId());const{dragAndDrop:s,ctrlsSvc:n}=this.beans;s==null||s.registerGridDropTarget(()=>this.eGui,this),this.createManagedBean(new PS(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr");const o=qa(this.beans,this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>o()),n.register("gridCtrl",this)}isDetailGrid(){var t;const e=gT(this.getGui());return((t=e==null?void 0:e.getAttribute("row-id"))==null?void 0:t.startsWith("detail"))||!1}getOptionalSelectors(){var t,i,s,n,o;const e=this.beans;return{paginationSelector:(t=e.pagination)==null?void 0:t.getPaginationSelector(),gridHeaderDropZonesSelector:(i=e.registry)==null?void 0:i.getSelector("AG-GRID-HEADER-DROP-ZONES"),sideBarSelector:(s=e.sideBar)==null?void 0:s.getSelector(),statusBarSelector:(n=e.registry)==null?void 0:n.getSelector("AG-STATUS-BAR"),watermarkSelector:(o=e.licenseManager)==null?void 0:o.getWatermarkSelector()}}onGridSizeChanged(){this.eventSvc.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){const{view:t}=this;if(e===!1)t.setCursor(null);else{const i=e===1?"ew-resize":"ns-resize";t.setCursor(i)}}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.getFocusableContainers(),{indexWithFocus:i,nextIndex:s}=this.getNextFocusableIndex(t,e);if(s<0||s>=t.length)return!1;if(s===0){if(i>0){const{visibleCols:n,focusSvc:o}=this.beans,r=n.allCols,a=Ct(r);if(o.focusGridView({column:a,backwards:!0}))return!0}return!1}return this.focusContainer(t[s],e)}focusInnerElement(e){const t=this.gos.getCallback("focusGridInnerElement");if(t!=null&&t({fromBottom:!!e}))return!0;const i=this.getFocusableContainers(),{focusSvc:s,visibleCols:n}=this.beans,o=n.allCols;if(e){if(i.length>1)return this.focusContainer(Ct(i),e);const r=Ct(o);if(s.focusGridView({column:r,backwards:e}))return!0}if(this.gos.get("headerHeight")===0||Rc(this.beans)){if(s.focusGridView({column:o[0],backwards:e}))return!0;for(let r=1;r<i.length;r++)if(kc(i[r].getGui(),e))return!0;return!1}return s.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){var o;const t=this.view.getFocusableContainers(),{nextIndex:i,indexWithFocus:s}=this.getNextFocusableIndex(t,e);if(s===-1||i<0||i>=t.length)return;const n=t[i];(o=n.setAllowFocus)==null||o.call(n,!0),setTimeout(()=>{var r;(r=n.setAllowFocus)==null||r.call(n,!1)})}isFocusable(){var t,i;const e=this.beans;return!$v(e)||!Rc(e)||!!((i=(t=e.sideBar)==null?void 0:t.comp)!=null&&i.isDisplayed())}getNextFocusableIndex(e,t){const i=Dt(this.beans),s=e.findIndex(o=>o.getGui().contains(i)),n=s+(t?-1:1);return{indexWithFocus:s,nextIndex:n}}focusContainer(e,t){var s,n;(s=e.setAllowFocus)==null||s.call(e,!0);const i=kc(e.getGui(),t,!1,!0);return(n=e.setAllowFocus)==null||n.call(e,!1),i}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},sW=class extends QT{constructor(e){super(),this.gridBody=se,this.sideBar=se,this.pagination=se,this.rootWrapperBody=se,this.eGridDiv=e}postConstruct(){const e={destroyGridUi:()=>this.destroyBean(this),setRtlClass:o=>this.addCss(o),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:o=>{this.getGui().style.userSelect=o??"",this.getGui().style.webkitUserSelect=o??""},setCursor:o=>{this.getGui().style.cursor=o??""}},t=this.createManagedBean(new iW),i=t.getOptionalSelectors(),s=this.createTemplate(i),n=[tW,...Object.values(i).filter(o=>!!o)];this.setTemplate(s,n),t.setComp(e,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:o=>t.focusInnerElement(o),forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:()=>!t.isFocusable()})}insertGridIntoDom(){const e=this.getGui();this.eGridDiv.appendChild(e),this.addDestroyFunc(()=>{e.remove(),Ga(this.gos,"Grid removed from DOM")})}updateLayoutClasses(e,t){const i=this.rootWrapperBody.classList,{AUTO_HEIGHT:s,NORMAL:n,PRINT:o}=An,{autoHeight:r,normal:a,print:l}=t;i.toggle(s,r),i.toggle(n,a),i.toggle(o,l),this.toggleCss(s,r),this.toggleCss(n,a),this.toggleCss(o,l)}createTemplate(e){const t=e.gridHeaderDropZonesSelector?{tag:"ag-grid-header-drop-zones"}:null,i=e.sideBarSelector?{tag:"ag-side-bar",ref:"sideBar"}:null,s=e.statusBarSelector?{tag:"ag-status-bar"}:null,n=e.watermarkSelector?{tag:"ag-watermark"}:null,o=e.paginationSelector?{tag:"ag-pagination",ref:"pagination"}:null;return{tag:"div",cls:"ag-root-wrapper",role:"presentation",children:[t,{tag:"div",ref:"rootWrapperBody",cls:"ag-root-wrapper-body",role:"presentation",children:[{tag:"ag-grid-body",ref:"gridBody"},i]},s,o,n]}}getFocusableElement(){return this.rootWrapperBody}forceFocusOutOfContainer(e=!1){var t;if(!e&&((t=this.pagination)!=null&&t.isDisplayed())){this.pagination.forceFocusOutOfContainer(e);return}super.forceFocusOutOfContainer(e)}getFocusableContainers(){const e=[this.gridBody];for(const t of[this.sideBar,this.pagination])t&&e.push(t);return e.filter(t=>To(t.getGui()))}},ke=(e,t)=>{for(const i of Object.keys(t))t[i]=e;return t},BR={dispatchEvent:"CommunityCore",...ke("CommunityCore",{destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0,isModuleRegistered:0}),...ke("GridState",{getState:0,setState:0}),...ke("SharedRowSelection",{setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0}),...ke("RowApi",{redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRowIndex:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0}),...ke("ScrollApi",{getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0}),...ke("KeyboardNavigation",{getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0}),...ke("EventApi",{addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0}),...ke("ValueCache",{expireValueCache:0}),...ke("CellApi",{getCellValue:0}),...ke("SharedMenu",{showColumnMenu:0,hidePopupMenu:0}),...ke("Sort",{onSortChanged:0}),...ke("PinnedRow",{getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0,forEachPinnedRow:0}),...ke("Overlay",{showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0}),...ke("RenderApi",{setGridAriaProperty:0,refreshCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0}),...ke("HighlightChanges",{flashCells:0}),...ke("RowDrag",{addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0,getRowDropPositionIndicator:0,setRowDropPositionIndicator:0}),...ke("ColumnApi",{getColumnDefs:0,getColumnDef:0,getDisplayNameForColumn:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnsVisible:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0}),...ke("ColumnAutoSize",{sizeColumnsToFit:0,autoSizeColumns:0,autoSizeAllColumns:0}),...ke("ColumnGroup",{setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumnGroup:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0}),...ke("ColumnMove",{moveColumnByIndex:0,moveColumns:0}),...ke("ColumnResize",{setColumnWidths:0}),...ke("ColumnHover",{isColumnHovered:0}),...ke("EditCore",{getCellEditorInstances:0,getEditingCells:0,getEditRowValues:0,stopEditing:0,startEditingCell:0,isEditing:0,validateEdit:0}),...ke("BatchEdit",{startBatchEdit:0,cancelBatchEdit:0,commitBatchEdit:0,isBatchEditing:0}),...ke("UndoRedoEdit",{undoCellEditing:0,redoCellEditing:0,getCurrentUndoSize:0,getCurrentRedoSize:0}),...ke("FilterCore",{isAnyFilterPresent:0,onFilterChanged:0}),...ke("ColumnFilter",{isColumnFilterPresent:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0,hideColumnFilter:0,getColumnFilterHandler:0,doFilterAction:0}),...ke("QuickFilter",{isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0}),...ke("Find",{findGetActiveMatch:0,findGetTotalMatches:0,findGoTo:0,findNext:0,findPrevious:0,findGetNumMatches:0,findGetParts:0,findClearActive:0,findRefresh:0}),...ke("Pagination",{paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0}),...ke("CsrmSsrmSharedApi",{expandAll:0,collapseAll:0}),...ke("SsrmInfiniteSharedApi",{setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0}),...ke("ClientSideRowModelApi",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0,onRowHeightChanged:0,resetRowHeights:0}),...ke("CsvExport",{getDataAsCsv:0,exportDataAsCsv:0}),...ke("InfiniteRowModel",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0}),...ke("AdvancedFilter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0}),...ke("IntegratedCharts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0}),...ke("Clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0}),...ke("ExcelExport",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0}),...ke("SharedMasterDetail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0}),...ke("ContextMenu",{showContextMenu:0}),...ke("ColumnMenu",{showColumnChooser:0,hideColumnChooser:0}),...ke("CellSelection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0}),...ke("SharedRowGrouping",{setRowGroupColumns:0,removeRowGroupColumns:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0}),...ke("SharedAggregation",{addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0}),...ke("SharedPivot",{isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumns:0,addValueColumns:0,setPivotColumns:0,removePivotColumns:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0}),...ke("ServerSideRowModelApi",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0,onRowHeightChanged:0,resetRowHeights:0}),...ke("SideBar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0}),...ke("StatusBar",{getStatusPanel:0}),...ke("AiToolkit",{getStructuredSchema:0})},BC={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},nW=(e,t)=>e.eventSvc.dispatchEvent(t),JT=class{};Reflect.defineProperty(JT,"name",{value:"GridApi"});var oW=class extends V{constructor(){super(),this.beanName="apiFunctionSvc",this.api=new JT,this.fns={...BC,dispatchEvent:nW},this.preDestroyLink="";const{api:e}=this;for(const t of Object.keys(BR))e[t]=this.makeApi(t)[t]}postConstruct(){this.preDestroyLink=this.beans.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){var n;const{fns:i,beans:s}=this;i!==BC&&(i[e]=((n=s==null?void 0:s.validation)==null?void 0:n.validateApiFunction(e,t))??t)}makeApi(e){return{[e]:(...t)=>{const{beans:i,fns:{[e]:s}}=this;return s?s(i,...t):this.apiNotFound(e)}}}apiNotFound(e){const{beans:t,gos:i,preDestroyLink:s}=this;if(!t)j(26,{fnName:e,preDestroyLink:s});else{const n=BR[e];i.assertModuleRegistered(n,`api.${e}`)&&j(27,{fnName:e,module:n})}}destroy(){super.destroy(),this.fns=BC,this.beans=null}};function rW(e){return e.context.getId()}function aW(e){e.gridDestroySvc.destroy()}function lW(e){return e.gridDestroySvc.destroyCalled}function cW(e,t){return e.gos.get(t)}function dW(e,t,i){ZT(e,{[t]:i})}function ZT(e,t){e.gos.updateGridOptions({options:t})}function hW(e,t){const i=t.replace(/Module$/,"");return e.gos.isModuleRegistered(i)}var uW={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{draggable:"true"}},gW=class extends ct{constructor(e,t,i){super(uW),this.rowNode=e,this.column=t,this.eCell=i}postConstruct(){this.getGui().appendChild(tn("rowDrag",this.beans,null)),this.addGuiEventListener("mousedown",t=>{t.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){const{rowNode:t,column:i,eCell:s,gos:n}=this,o=i.getColDef().dndSourceOnRowDrag,r=e.dataTransfer;if(r.setDragImage(s,0,0),o){const a=Fe(n,{rowNode:t,dragEvent:e});o(a)}else try{const a=JSON.stringify(t.data);r.setData("application/json",a),r.setData("text/plain",a)}catch{}}checkVisibility(){const e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}};function fW(e,t){var i,s;(s=(i=e.rowDragSvc)==null?void 0:i.rowDragFeature)==null||s.addRowDropZone(t)}function pW(e,t){var s,n;const i=(s=e.dragAndDrop)==null?void 0:s.findExternalZone(t.getContainer());i&&((n=e.dragAndDrop)==null||n.removeDropTarget(i))}function mW(e,t){var i,s;return(s=(i=e.rowDragSvc)==null?void 0:i.rowDragFeature)==null?void 0:s.getRowDropZone(t)}function vW(e){const t=e.rowDropHighlightSvc;return t?{row:t.row,dropIndicatorPosition:t.position}:{row:null,dropIndicatorPosition:"none"}}function CW(e,t){const i=e.rowDropHighlightSvc;if(!i)return;const s=t==null?void 0:t.row;let n=t==null?void 0:t.dropIndicatorPosition;n!=="above"&&n!=="below"&&n!=="inside"&&(n="none");const o=s==null?void 0:s.rowIndex;o==null||n==="none"?i.clear():i.set(s,n)}var wW=class extends IB{shouldPreventMouseEvent(e){return this.gos.get("enableCellTextSelection")&&super.shouldPreventMouseEvent(e)}},bW=class extends V{constructor(){super(...arguments),this.beanName="horizontalResizeSvc"}addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0},{dragSvc:i}=this.beans;return i.addDragSource(t),()=>i.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const i=t instanceof MouseEvent&&t.shiftKey===!0;e.onResizeStart(i)}setResizeIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(1),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},yW={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{"aria-hidden":"true"}},SW=class extends ct{constructor(e,t,i,s,n,o=!1){super(),this.cellValueFn=e,this.rowNode=t,this.column=i,this.customGui=s,this.dragStartPixels=n,this.alwaysVisible=o,this.dragSource=null}isCustomGui(){return this.customGui!=null}postConstruct(){const{beans:e,customGui:t}=this;t?this.setDragElement(t,this.dragStartPixels):(this.setTemplate(yW),this.getGui().appendChild(tn("rowDrag",e,null)),this.addDragSource()),this.alwaysVisible||this.initCellDrag()}initCellDrag(){const{beans:e,gos:t,rowNode:i}=this,s=this.refreshVisibility.bind(this);this.addManagedPropertyListener("suppressRowDrag",s),this.addManagedListeners(i,{dataChanged:s,cellChanged:s}),this.addManagedListeners(e.eventSvc,t.get("rowDragManaged")?{sortChanged:s,filterChanged:s,columnRowGroupChanged:s,newColumnsLoaded:s}:{newColumnsLoaded:s})}setDragElement(e,t){this.setTemplateFromElement(e,void 0,void 0,!0),this.addDragSource(t)}refreshVisibility(){if(this.alwaysVisible)return;const e={skipAriaHidden:!0};if(this.isNeverDisplayed()){this.setDisplayed(!1,e);return}const t=this.column;let i=typeof(t==null?void 0:t.getColDef().rowDrag)=="function",s=!t||this.isCustomGui()||t.isRowDrag(this.rowNode);s&&this.rowNode.footer&&this.gos.get("rowDragManaged")&&(s=!1,i=!0),this.setDisplayed(i||s,e),this.setVisible(s,e)}isNeverDisplayed(){var i,s;const{gos:e,beans:t}=this;return!!(e.get("suppressRowDrag")||e.get("rowDragManaged")&&((i=t.rowDragSvc.rowDragFeature)!=null&&i.shouldPreventRowMove())&&!((s=t.dragAndDrop)!=null&&s.hasExternalDropZones()))}getSelectedNodes(){var s;const e=this.rowNode;if(!this.gos.get("rowDragMultiRow"))return[e];const i=((s=this.beans.selectionSvc)==null?void 0:s.getSelectedNodes())??[];return i.indexOf(e)!==-1?i:[e]}getDragItem(){const{column:e,rowNode:t}=this;return{rowNode:t,rowNodes:this.getSelectedNodes(),columns:e?[e]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(e){if(e){const t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gos.get("rowDragText")}addDragSource(e=4){if(this.dragSource&&this.removeDragSource(),this.gos.get("rowDragManaged")&&this.rowNode.footer)return;const t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:s=>{s==null||s.preventDefault()}})[0]);const i=this.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:s=>{var a,l;const n=(s==null?void 0:s.dragItem)||this.getDragItem(),o=(((a=s==null?void 0:s.dropTarget)==null?void 0:a.rows.length)??((l=n.rowNodes)==null?void 0:l.length))||1,r=this.getRowDragText(this.column);return r?r(n,o):o===1?this.cellValueFn():`${o} ${i("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDrop.addDragSource(this.dragSource,!0)}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},pm=class{constructor(){this.reordered=!1,this.removals=new Set,this.updates=new Set,this.adds=new Set}};function RW(e){const{rowIndex:t,rowPinned:i,column:s}=e;return`${t}.${i??"null"}.${s.getId()}`}function eD(e,t){const i=e.column===t.column,s=e.rowPinned===t.rowPinned,n=e.rowIndex===t.rowIndex;return i&&s&&n}function xW(e,t){switch(e.rowPinned){case"top":if(t.rowPinned!=="top")return!0;break;case"bottom":if(t.rowPinned!=="bottom")return!1;break;default:if(ae(t.rowPinned))return t.rowPinned!=="top";break}return e.rowIndex<t.rowIndex}function EW(e,t){return!e&&!t?!0:e&&!t||!e&&t?!1:e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned}function AW(e){let t=0,i;const{pinnedRowModel:s,rowModel:n,pageBounds:o}=e;return s!=null&&s.getPinnedTopRowCount()?i="top":n.getRowCount()?(i=null,t=o.getFirstRow()):s!=null&&s.getPinnedBottomRowCount()&&(i="bottom"),i===void 0?null:{rowIndex:t,rowPinned:i}}function FW(e){let t,i=null;const{pinnedRowModel:s,pageBounds:n}=e,o=s==null?void 0:s.getPinnedBottomRowCount(),r=s==null?void 0:s.getPinnedTopRowCount();return o?(i="bottom",t=o-1):e.rowModel.getRowCount()?t=n.getLastRow():r&&(i="top",t=r-1),t===void 0?null:{rowIndex:t,rowPinned:i}}function Dr(e,t){var i,s;switch(t.rowPinned){case"top":return(i=e.pinnedRowModel)==null?void 0:i.getPinnedTopRow(t.rowIndex);case"bottom":return(s=e.pinnedRowModel)==null?void 0:s.getPinnedBottomRow(t.rowIndex);default:return e.rowModel.getRow(t.rowIndex)}}function pd(e,t){var n;const i=(n=e.spannedRowRenderer)==null?void 0:n.getCellByPosition(t);if(i)return i;const s=e.rowRenderer.getRowByPosition(t);return s?s.getCellCtrl(t.column):null}function PW(e,t,i){const{rowModel:s,pinnedRowModel:n}=e;let o;return o??(o=s==null?void 0:s.getRowNode(t)),i?o??(o=n==null?void 0:n.getPinnedRowById(t,i)):(o??(o=n==null?void 0:n.getPinnedRowById(t,"top")),o??(o=n==null?void 0:n.getPinnedRowById(t,"bottom"))),o}function qm(e,t,i=!1){const{rowIndex:s,rowPinned:n}=t,{pageBounds:o,pinnedRowModel:r,rowModel:a}=e;if(s===0)return n==="top"?null:n==="bottom"&&a.isRowsToRender()?{rowIndex:o.getLastRow(),rowPinned:null}:r!=null&&r.isRowsToRender("top")?{rowIndex:r.getPinnedTopRowCount()-1,rowPinned:"top"}:null;if(i){const l=n?void 0:a.getRow(s);return tD(e,l,!0)??{rowIndex:s-1,rowPinned:n}}return{rowIndex:s-1,rowPinned:n}}function VR(e,t,i=!1){const{rowIndex:s,rowPinned:n}=t,{pageBounds:o,pinnedRowModel:r,rowModel:a}=e;if(TW(e,t))return n==="bottom"?null:n==="top"&&a.isRowsToRender()?{rowIndex:o.getFirstRow(),rowPinned:null}:r!=null&&r.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;if(i){const l=n?void 0:a.getRow(s);return tD(e,l)??{rowIndex:s+1,rowPinned:n}}return{rowIndex:s+1,rowPinned:n}}function tD(e,t,i=!1){const{gos:s,rowRenderer:n}=e;if(!(t!=null&&t.sticky)||!HP(s))return;const o=n.getStickyTopRowCtrls(),r=n.getStickyBottomRowCtrls(),a=!r.some(h=>h.rowNode.rowIndex===t.rowIndex),l=a?o:r,c=(i?-1:1)*(a?-1:1);let d;for(let h=0;h<l.length;h++)if(l[h].rowNode.rowIndex===t.rowIndex){d=l[h+c];break}return d?{rowIndex:d.rowNode.rowIndex,rowPinned:null}:void 0}function TW(e,t){const{rowPinned:i,rowIndex:s}=t,{pinnedRowModel:n,pageBounds:o}=e;return i==="top"?((n==null?void 0:n.getPinnedTopRowCount())??0)-1<=s:i==="bottom"?((n==null?void 0:n.getPinnedBottomRowCount())??0)-1<=s:o.getLastRow()<=s}var mg=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}depthFirstSearchChangedPath(e,t){const{rowNode:i,children:s}=e;if(s)for(let n=0;n<s.length;++n)this.depthFirstSearchChangedPath(s[n],t);t(i)}depthFirstSearchEverything(e,t,i){const s=e.childrenAfterGroup;if(s)for(let n=0,o=s.length;n<o;++n){const r=s[n];r.childrenAfterGroup?this.depthFirstSearchEverything(r,t,i):i&&t(r)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,i=!1){this.active&&!i?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,i=0;for(;!this.mapToItems[t.id];){const s={rowNode:t,children:null};this.mapToItems[t.id]=s,i++,t=t.parent}return i}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let i=e;for(;i;){this.nodeIdsToColumns[i.id]||(this.nodeIdsToColumns[i.id]={});for(const s of t)this.nodeIdsToColumns[i.id][s.getId()]=!0;i=i.parent}}linkPathItems(e,t){let i=e;for(let s=0;s<t;s++){const n=this.mapToItems[i.id],o=this.mapToItems[i.parent.id];o.children||(o.children=[]),o.children.push(n),i=i.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const i=this.createPathItems(e);this.linkPathItems(e,i),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const i=this.nodeIdsToColumns[e.id];return t.filter(n=>i[n.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const i=this.nodeIdsToColumns[e.id];return t.filter(n=>!i[n.getId()])}},DW=class{constructor(e,t){this.beans=e,this.groupThrottled=!1,this.scrollChanged=!1,this.scrollChanging=!1,this.oldVScroll=null,this.groupTimer=null,this.groupTarget=null,this.onGroupThrottle=()=>{var s;this.groupTimer=null,this.groupThrottled=!0,(s=this.beans.dragAndDrop)==null||s.nudge()};const i=()=>t.scrollFeature.getVScrollPosition().top;this.autoScroll=new Oz({scrollContainer:t.eBodyViewport,scrollAxis:"y",getVerticalPosition:i,setVerticalPosition:s=>t.scrollFeature.setVerticalScrollPosition(s),onScrollCallback:()=>{var o;const s=i();if(this.oldVScroll!==s){this.oldVScroll=s,this.scrollChanging=!0;return}const n=this.scrollChanging;this.scrollChanged=n,this.scrollChanging=!1,n&&((o=this.beans.dragAndDrop)==null||o.nudge(),this.scrollChanged=!1)}})}updateGroup(e,t){var i,s;this.groupTarget&&this.groupTarget!==e&&this.clearGroup(),e&&(t&&this.groupThrottled&&!e.expanded&&((i=e.childrenAfterSort)!=null&&i.length)&&e.isExpandable()&&e.setExpanded(!0,void 0,!0),e.expanded&&((s=e.childrenAfterSort)!=null&&s.length)&&(this.groupThrottled=!0,this.groupTarget=e))}startGroup(e){this.groupTarget=e,this.groupTimer===null&&(this.groupTimer=window.setTimeout(this.onGroupThrottle,this.beans.gos.get("rowDragInsertDelay")))}clearGroup(){this.groupThrottled=!1,this.groupTarget=null;const e=this.groupTimer;e!==null&&(this.groupTimer=null,window.clearTimeout(e))}clear(){this.clearGroup(),this.autoScroll.ensureCleared(),this.oldVScroll=null,this.scrollChanged=!1,this.scrollChanging=!1}},MW=class extends V{constructor(e){super(),this.eContainer=e,this.lastDraggingEvent=null,this.nudger=null}postConstruct(){const e=this.beans;e.ctrlsSvc.whenReady(this,t=>{this.nudger=new DW(e,t.gridBodyCtrl)})}destroy(){var e;super.destroy(),(e=this.nudger)==null||e.clear(),this.nudger=null,this.lastDraggingEvent=null,this.eContainer=null}getContainer(){return this.eContainer}isInterestedIn(e){return e===2}getIconName(e){var t;return((t=e==null?void 0:e.dropTarget)==null?void 0:t.allowed)===!1||this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?"notAllowed":"move"}shouldPreventRowMove(){const{rowGroupColsSvc:e,filterManager:t,sortSvc:i}=this.beans;return!!(((e==null?void 0:e.columns)??[]).length||(t==null?void 0:t.isAnyFilterPresent())||(i==null?void 0:i.isSortActive()))}getRowNodes(e){var i;if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];const t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){const s=(i=this.beans.selectionSvc)==null?void 0:i.getSelectedNodes();if(s&&s.indexOf(t)>=0)return s.slice().sort(_W)}return[t]}onDragEnter(e){this.dragging(e,!0)}onDragging(e){this.dragging(e,!1)}dragging(e,t){var r,a,l,c;const{lastDraggingEvent:i,beans:s}=this;if(t){const d=this.getRowNodes(e);e.dragItem.rowNodes=d,$R(d,!0)}this.lastDraggingEvent=e;const n=e.fromNudge,o=this.makeRowsDrop(i,e,n,!1);(r=s.rowDropHighlightSvc)==null||r.fromDrag(e),t&&this.dispatchGridEvent("rowDragEnter",e),this.dispatchGridEvent("rowDragMove",e),o!=null&&o.rowDragManaged&&o.moved&&o.allowed&&o.sameGrid&&!o.suppressMoveWhenRowDragging&&(!n&&!((a=this.nudger)!=null&&a.autoScroll.scrolling)||(l=this.nudger)!=null&&l.scrollChanged)&&this.dropRows(o),(c=this.nudger)==null||c.autoScroll.check(e.event)}isFromThisGrid(e){return e.dragSource.dragSourceDomDataKey===this.gos.getDomDataKey()}makeRowsDrop(e,t,i,s){var S,b;const{beans:n,gos:o}=this,r=this.newRowsDrop(t,s),a=n.rowModel;if(t.dropTarget=r,t.changed=!1,!r)return null;let{sameGrid:l,rootNode:c,source:d,target:h,rows:u}=r;h??(h=a.getRow(a.getRowCount()-1)??null);const f=!!((S=this.beans.groupStage)!=null&&S.treeData)&&l;let p=null;if(h!=null&&h.footer){const E=mm(a,-1,h)??mm(a,1,h);p=h.sibling??c,h=E??null}h!=null&&h.detail&&(h=h.parent),r.moved&&(r.moved=d!==h);let m=.5;if(h&&(l&&r.moved&&(p||!f)?m=d.rowIndex>h.rowIndex?-.5:.5:m=(r.y-h.rowTop-h.rowHeight/2)/h.rowHeight||0),!f&&l&&h&&r.moved&&Ut(o)){const E=LW(a,r);E&&(m=d.rowIndex>E.rowIndex?-.5:.5,h=E,r.moved&&(r.moved=d!==h))}const v=this.nudger;v==null||v.updateGroup(h,i),f&&!p&&v&&(!h||m>=.5&&h.rowIndex===n.pageBounds.getLastRow()?p=c:r.moved&&this.targetShouldBeParent(h,m,u)&&(v.groupThrottled&&(p=h),!i&&(!p||h&&!h.expanded&&((b=h.childrenAfterSort)!=null&&b.length))&&v.startGroup(h)),p??(p=(h==null?void 0:h.parent)??c));let C=!1;if(p){if(p===h&&p!==c){const E=p.expanded?mm(a,1,h):null;(E==null?void 0:E.parent)===p?(h=E,m=-.5):C=!0}if(h&&!C){let E=h;for(;E&&E!==c&&E!==p;)h=E,E=E.parent}}r.target=h,r.newParent=p,r.moved&&(r.moved=d!==h);const w=m<0?"above":"below";return r.position=r.moved?C?"inside":w:"none",this.validateRowsDrop(r,f,w,s),t.changed||(t.changed=kW(e==null?void 0:e.dropTarget,r)),r}newRowsDrop(e,t){const{beans:i,gos:s}=this,n=i.rowModel.rootNode,o=Ut(s)?s.get("rowDragManaged"):!1,r=s.get("suppressMoveWhenRowDragging"),a=this.isFromThisGrid(e);let{rowNode:l,rowNodes:c}=e.dragItem;if(c||(c=l?[l]:[]),l||(l=c[0]),!l||!n)return null;const d=this.beans.dragAndDrop.isDropZoneWithinThisGrid(e);let h=!0;o&&(!c.length||this.shouldPreventRowMove()||(r||!a)&&!d)&&(h=!1);const u=TR(i,e).y,f=this.getOverNode(u);return{api:i.gridApi,context:i.gridOptions.context,draggingEvent:e,rowDragManaged:o,suppressMoveWhenRowDragging:r,sameGrid:a,withinGrid:d,rootNode:n,moved:l!==f,y:u,overNode:f,overIndex:(f==null?void 0:f.rowIndex)??-1,position:"none",source:l,target:f??null,newParent:null,rows:c,allowed:h,highlight:!t&&o&&r&&(d||!a)}}validateRowsDrop(e,t,i,s){const{rowDragManaged:n,suppressMoveWhenRowDragging:o}=e;t||(e.newParent=null),o&&!e.moved&&(e.allowed=!1);const r=(!n||e.allowed)&&this.gos.get("isRowValidDropPosition");if(r){t&&e.newParent&&zR(e.rows,e.newParent)&&(e.newParent=null);const a=r(e);if(!a)e.allowed=!1;else if(typeof a=="object"){a.rows!==void 0&&(e.rows=a.rows??[]),t&&a.newParent!==void 0&&(e.newParent=a.newParent),a.target!==void 0&&(e.target=a.target),a.position&&(e.position=a.position),a.allowed!==void 0?e.allowed=a.allowed:n||(e.allowed=!0);const l=e.draggingEvent;a.changed&&l&&(l.changed=!0),!s&&a.highlight!==void 0&&(e.highlight=a.highlight)}}n&&(e.rows=this.filterRows(e)),t&&e.newParent&&zR(e.rows,e.newParent)&&(e.newParent=null),o&&(!e.rows.length||e.position==="none")&&(e.allowed=!1),(!e.allowed||!e.newParent)&&e.position==="inside"&&(e.position=i)}targetShouldBeParent(e,t,i){const s=e.rowIndex,n=.25;if(t<-.5+n)return!1;if(t<.5-n)return!0;let o,r=s+1;const a=this.beans.rowModel;do o=a.getRow(r++);while(o!=null&&o.footer);const l=e.childrenAfterGroup;if(o&&o.parent===e&&(l!=null&&l.length)){const c=new Set(i);for(const d of l)if(d.rowIndex!==null&&!c.has(d))return!0}return!1}addRowDropZone(e){if(!e.getContainer()){j(55);return}const t=this.beans.dragAndDrop;if(t.findExternalZone(e.getContainer())){j(56);return}const i=e.fromGrid?e:{getContainer:e.getContainer,onDragEnter:e.onDragEnter&&(n=>e.onDragEnter(this.rowDragEvent("rowDragEnter",n))),onDragLeave:e.onDragLeave&&(n=>e.onDragLeave(this.rowDragEvent("rowDragLeave",n))),onDragging:e.onDragging&&(n=>e.onDragging(this.rowDragEvent("rowDragMove",n))),onDragStop:e.onDragStop&&(n=>e.onDragStop(this.rowDragEvent("rowDragEnd",n))),onDragCancel:e.onDragCancel&&(n=>e.onDragCancel(this.rowDragEvent("rowDragCancel",n)))},s={isInterestedIn:n=>n===2,getIconName:()=>"move",external:!0,...i};t.addDropTarget(s),this.addDestroyFunc(()=>t.removeDropTarget(s))}getRowDropZone(e){return{getContainer:this.getContainer.bind(this),onDragEnter:i=>{var s;this.onDragEnter(i),(s=e==null?void 0:e.onDragEnter)==null||s.call(e,this.rowDragEvent("rowDragEnter",i))},onDragLeave:i=>{var s;this.onDragLeave(i),(s=e==null?void 0:e.onDragLeave)==null||s.call(e,this.rowDragEvent("rowDragLeave",i))},onDragging:i=>{var s;this.onDragging(i),(s=e==null?void 0:e.onDragging)==null||s.call(e,this.rowDragEvent("rowDragMove",i))},onDragStop:i=>{var s;this.onDragStop(i),(s=e==null?void 0:e.onDragStop)==null||s.call(e,this.rowDragEvent("rowDragEnd",i))},onDragCancel:i=>{var s;this.onDragCancel(i),(s=e==null?void 0:e.onDragCancel)==null||s.call(e,this.rowDragEvent("rowDragCancel",i))},fromGrid:!0}}getOverNode(e){const{pageBounds:t,rowModel:i}=this.beans,n=e>t.getCurrentPagePixelRange().pageLastPixel?-1:i.getRowIndexAtPixel(e);return n>=0?i.getRow(n):void 0}rowDragEvent(e,t){const i=this.beans,{dragItem:s,dropTarget:n,event:o,vDirection:r}=t,a=(n==null?void 0:n.rootNode)===i.rowModel.rootNode,l=a?n.y:TR(i,t).y,c=a?n.overNode:this.getOverNode(l),d=a?n.overIndex:(c==null?void 0:c.rowIndex)??-1;return{api:i.gridApi,context:i.gridOptions.context,type:e,event:o,node:s.rowNode,nodes:s.rowNodes,overIndex:d,overNode:c,y:l,vDirection:r,rowsDrop:n}}dispatchGridEvent(e,t){const i=this.rowDragEvent(e,t);this.eventSvc.dispatchEvent(i)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e)}onDragStop(e){var i;const t=this.makeRowsDrop(this.lastDraggingEvent,e,!1,!0);this.dispatchGridEvent("rowDragEnd",e),t!=null&&t.allowed&&t.rowDragManaged&&(t.suppressMoveWhenRowDragging||!t.sameGrid||(i=this.nudger)!=null&&i.autoScroll.scrolling)&&this.dropRows(t),this.stopDragging(e)}onDragCancel(e){this.dispatchGridEvent("rowDragCancel",e),this.stopDragging(e)}stopDragging(e){var t,i;(t=this.nudger)==null||t.clear(),(i=this.beans.rowDropHighlightSvc)==null||i.fromDrag(null),$R(e.dragItem.rowNodes,!1)}dropRows(e){return e.sameGrid?this.csrmMoveRows(e):this.csrmAddRows(e)}csrmAddRows({position:e,target:t,rows:i}){const s=Wh(this.gos),n=this.beans.rowModel,o=i.filter(({data:a,rowPinned:l})=>!n.getRowNode((s==null?void 0:s({data:a,level:0,rowPinned:l}))??a.id)).map(({data:a})=>a);if(o.length===0)return!1;const r=t?WR(t)+(e==="above"?0:1):void 0;return n.updateRowData({add:o,addIndex:r}),!0}filterRows({newParent:e,rows:t}){let i;for(let s=0,n=t.length;s<n;++s){let o=!0;const r=t[s];(!r||r.footer||r.rowTop===null&&r!==this.beans.rowModel.getRowNode(r.id)||e&&r.parent!==e&&IW(r,e)||!ay(r))&&(o=!1),o?i==null||i.push(r):i??(i=t.slice(0,s))}return i??t}csrmMoveRows({position:e,target:t,rows:i,newParent:s,rootNode:n}){let o=!1;const r=new Set;for(const u of i){s&&u.parent!==s&&(u.treeParent=s,o=!0);const f=ay(u);f&&r.add(f)}if(!o&&r.size===0)return!1;const a=this.beans.focusSvc,l=a.getFocusedCell(),c=l&&pd(this.beans,l);if(r.size&&this.reorderLeafChildren(r,...this.getMoveRowsBounds(r,t,e==="above"))&&(o=!0),!o)return!1;const d=this.beans.rowModel,h=new pm;return h.reordered=!0,d.refreshModel({step:"group",keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedPath:new mg(!1,n),changedRowNodes:h}),c?c.focusCell():a.clearFocusedCell(),!0}getMoveRowsBounds(e,t,i){var a,l;const s=((l=(a=this.beans.rowModel.rootNode)==null?void 0:a._leafs)==null?void 0:l.length)??0;let n=t?WR(t):-1;n<0||n>=s?n=s:i||++n;let o=n,r=Math.min(n,s-1);for(const c of e){const d=c.sourceRowIndex;d<o&&(o=d),d>r&&(r=d)}return[o,n,r]}reorderLeafChildren(e,t,i,s){var l;let n=!1;const o=(l=this.beans.rowModel.rootNode)==null?void 0:l._leafs;if(!e.size||!o)return!1;let r=t;for(let c=t;c<i;++c){const d=o[c];e.has(d)||(d.sourceRowIndex!==r&&(d.sourceRowIndex=r,o[r]=d,n=!0),++r)}let a=s;for(let c=s;c>=i;--c){const d=o[c];e.has(d)||(d.sourceRowIndex!==a&&(d.sourceRowIndex=a,o[a]=d,n=!0),--a)}for(const c of e)c.sourceRowIndex!==r&&(c.sourceRowIndex=r,o[r]=c,n=!0),++r;return n}},mm=(e,t,i)=>{if(i){const s=e.getRowCount();let n=i.rowIndex+t;for(;n>=0&&n<s;){const o=e.getRow(n);if(!o||!o.footer&&!o.detail)return o;n+=t}}},IW=(e,t)=>{let i=t;for(;i;){if(i===e)return!0;i=i.parent}return!1},zR=(e,t)=>{for(let i=0,s=e.length;i<s;++i)if(e[i].parent!==t)return!1;return!0},WR=e=>{const t=ay(e);return t!==void 0?t.sourceRowIndex:-1},ay=e=>e.data?e:PT(e.childrenAfterGroup),kW=(e,t)=>e!==t&&(!e||e.sameGrid!==t.sameGrid||e.allowed!==t.allowed||e.position!==t.position||e.target!==t.target||e.source!==t.source||e.newParent!==t.newParent||!Ya(e.rows,t.rows)),_W=({rowIndex:e},{rowIndex:t})=>e!==null&&t!==null?e-t:0,$R=(e,t)=>{for(let i=0,s=(e==null?void 0:e.length)||0;i<s;++i){const n=e[i];n.dragging!==t&&(n.dragging=t,n.dispatchRowEvent("draggingChanged"))}},LW=(e,t)=>{let i=null,s=t.target;if(s&&t.rows.indexOf(s)<0)return null;const n=t.source;if(!s||!n)return null;let o=s.rowIndex-n.rowIndex;const r=o<0?-1:1;o=t.suppressMoveWhenRowDragging?Math.abs(o):1;const a=new Set(t.rows);do{const l=mm(e,r,s);if(!l)break;a.has(l)||(i=l,--o),s=l}while(o>0);return i},OW=class extends V{constructor(){super(...arguments),this.beanName="rowDragSvc"}setupRowDrag(e,t){const i=t.createManagedBean(new MW(e)),s=this.beans.dragAndDrop;s.addDropTarget(i),t.addDestroyFunc(()=>s.removeDropTarget(i)),this.rowDragFeature=i}createRowDragComp(e,t,i,s,n,o){return new SW(e,t,i,s,n,o)}createRowDragCompForRow(e,t){if(Tr(this.gos))return;const i=this.getLocaleTextFunc();return this.createRowDragComp(()=>`1 ${i("rowDragRow","row")}`,e,void 0,t,void 0,!0)}createRowDragCompForCell(e,t,i,s,n,o){const r=this.gos;return r.get("rowDragManaged")&&(!Ut(r)||r.get("pagination"))?void 0:this.createRowDragComp(i,e,t,s,n,o)}},NW=class extends V{constructor(){super(...arguments),this.beanName="rowDropHighlightSvc",this.uiLevel=0,this.dragging=!1,this.row=null,this.position="none"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this)})}onModelUpdated(){const e=this.row,t=this.dragging;!e||(e==null?void 0:e.rowIndex)===null||this.position==="none"?this.clear():this.set(e,this.position),this.dragging=t}destroy(){this.clear(),super.destroy()}clear(){const e=this.row;this.dragging=!1,e&&(this.uiLevel=0,this.position="none",this.row=null,e.dispatchRowEvent("rowHighlightChanged"))}set(e,t){const i=e!==this.row,s=e.uiLevel,n=t!==this.position,o=s!==this.uiLevel;this.dragging=!1,(i||n||o)&&(i&&this.clear(),this.uiLevel=s,this.position=t,this.row=e,e.dispatchRowEvent("rowHighlightChanged"))}fromDrag(e){const t=e==null?void 0:e.dropTarget;if(t){const{highlight:i,target:s,position:n}=t;if(i&&s&&n!=="none"){this.set(s,n),this.dragging=!0;return}}this.dragging&&this.clear()}},iD={moduleName:"Drag",version:ne,beans:[wW]},HW={moduleName:"DragAndDrop",version:ne,dynamicBeans:{dndSourceComp:gW},icons:{rowDrag:"grip"}},sD={moduleName:"SharedDragAndDrop",version:ne,beans:[_B],dependsOn:[iD],userComponents:{agDragAndDropImage:fz},icons:{columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",rowDrag:"grip"}},GW={moduleName:"RowDrag",version:ne,beans:[NW,OW],apiFunctions:{addRowDropZone:fW,removeRowDropZone:pW,getRowDropZoneParams:mW,getRowDropPositionIndicator:vW,setRowDropPositionIndicator:CW},dependsOn:[sD]},BW={moduleName:"HorizontalResize",version:ne,beans:[bW],dependsOn:[iD]},VW=":where(.ag-ltr) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:left .2s}.ag-header-group-cell{transition:left .2s,width .2s}}:where(.ag-rtl) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:right .2s}.ag-header-group-cell{transition:right .2s,width .2s}}",zW=class extends V{constructor(){super(...arguments),this.beanName="colAnimation",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){if(this.active)return;const{gos:e}=this;e.get("suppressColumnMoveAnimation")||e.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush(()=>this.activeNext=!1,()=>this.active=!1)}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount,{gridBodyCtrl:t}=this;t.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&t.setColumnMovingCss(!1)})}flush(e,t){const{executeNextFuncs:i,executeLaterFuncs:s}=this;if(i.length===0&&s.length===0){e(),t();return}const n=o=>{for(;o.length;){const r=o.pop();r&&r()}};this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e(),n(i)},0),window.setTimeout(()=>{t(),n(s)},200)})}};function WW(e,t,i){var s;(s=e.colMoves)==null||s.moveColumnByIndex(t,i,"api")}function $W(e,t,i){var s;(s=e.colMoves)==null||s.moveColumns(t,i,"api")}var UW=class extends V{constructor(e){super(),this.pinned=e,this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[]}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const t=e.dragItem.columns;if(t)for(const i of t)i.isPrimary()&&(i.isAnyFunctionActive()||(i.isAllowValue()?this.columnsToAggregate.push(i):i.isAllowRowGroup()?this.columnsToGroup.push(i):i.isAllowPivot()&&this.columnsToPivot.push(i)))}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){const{valueColsSvc:t,rowGroupColsSvc:i,pivotColsSvc:s}=this.beans;this.columnsToAggregate.length>0&&(t==null||t.addColumns(this.columnsToAggregate,"toolPanelDragAndDrop")),this.columnsToGroup.length>0&&(i==null||i.addColumns(this.columnsToGroup,"toolPanelDragAndDrop")),this.columnsToPivot.length>0&&(s==null||s.addColumns(this.columnsToPivot,"toolPanelDragAndDrop"))}onDragCancel(){this.clearColumnsList()}};function jW(e,t){!t||t.length<=1||t.filter(s=>e.indexOf(s)<0).length>0||t.sort((s,n)=>{const o=e.indexOf(s),r=e.indexOf(n);return o-r})}function KW(e){var i;const t=[...e];for(const s of e){let n=null,o=s.getParent();for(;o!=null&&o.getDisplayedLeafColumns().length===1;)n=o,o=o.getParent();if(n!=null){const a=!!((i=n.getColGroupDef())!=null&&i.marryChildren)?n.getProvidedColumnGroup().getLeafColumns():n.getLeafColumns();for(const l of a)t.includes(l)||t.push(l)}}return t}function qW(e,t,i,s){const n=s.allCols;let o=null,r=null;for(let a=0;a<e.length;a++){const l=e[a],c=i.getProposedColumnOrder(t,l);if(!i.doesOrderPassRules(c))continue;const d=c.filter(u=>n.includes(u));if(r===null)r=d;else if(!Ya(d,r))break;const h=XW(c);(o===null||h<o.fragCount)&&(o={move:l,fragCount:h})}return o}function nD(e){const{isFromHeader:t,fromLeft:i,xPosition:s,fromEnter:n,fakeEvent:o,pinned:r,gos:a,colModel:l,colMoves:c,visibleCols:d}=e;let{allMovingColumns:h}=e;t&&(h=KW(h));const u=h.slice();jW(l.getCols(),u);const f=JW({movingCols:u,draggingRight:i,xPosition:s,pinned:r,gos:a,colModel:l,visibleCols:d}),p=YW(u,l);if(f.length===0)return;const m=f[0];if(p!==null&&(t||!n)&&!o&&(!i&&m>=p||i&&m<=p))return;const C=qW(f,u,c,d);if(!C)return;const w=C.move;if(!(w>l.getCols().length-u.length))return{columns:u,toIndex:w}}function oD(e){const{columns:t,toIndex:i}=nD(e)||{},{finished:s,colMoves:n}=e;return!t||i==null?null:(n.moveColumns(t,i,"uiColumnMoved",s),s?null:{columns:t,toIndex:i})}function YW(e,t){const i=t.getCols(),s=e.map(l=>i.indexOf(l)).sort((l,c)=>l-c),n=s[0];return Ct(s)-n!==s.length-1?null:n}function XW(e){function t(s){const n=[];let o=s.getOriginalParent();for(;o!=null;)n.push(o),o=o.getOriginalParent();return n}let i=0;for(let s=0;s<e.length-1;s++){let n=t(e[s]),o=t(e[s+1]);[n,o]=n.length>o.length?[n,o]:[o,n];for(const r of n)o.indexOf(r)===-1&&i++}return i}function QW(e,t){switch(t){case"left":return e.leftCols;case"right":return e.rightCols;default:return e.centerCols}}function JW(e){const{movingCols:t,draggingRight:i,xPosition:s,pinned:n,gos:o,colModel:r,visibleCols:a}=e;if(o.get("suppressMovableColumns")||t.some(S=>S.getColDef().suppressMovable))return[];const c=QW(a,n),d=r.getCols(),h=c.filter(S=>t.includes(S)),u=c.filter(S=>!t.includes(S)),f=d.filter(S=>!t.includes(S));let p=0,m=s;if(i){let S=0;for(const b of h)S+=b.getActualWidth();m-=S}if(m>0){for(let S=0;S<u.length;S++){const b=u[S];if(m-=b.getActualWidth(),m<0)break;p++}i&&p++}let v;if(p>0){const S=u[p-1];v=f.indexOf(S)+1}else v=f.indexOf(u[0]),v===-1&&(v=0);const C=[v],w=(S,b)=>S-b;if(i){let S=v+1;const b=d.length-1;for(;S<=b;)C.push(S),S++;C.sort(w)}else{let S=v;const b=d.length-1;let E=d[S];for(;S<=b&&c.indexOf(E)<0;)S++,C.push(S),E=d[S];S=v-1;const A=0;for(;S>=A;)C.push(S),S--;C.sort(w).reverse()}return C}function ly(e){var c;const{pinned:t,fromKeyboard:i,gos:s,ctrlsSvc:n,useHeaderRow:o,skipScrollPadding:r}=e;let a=(c=n.getHeaderRowContainerCtrl(t))==null?void 0:c.eViewport,{x:l}=e;return a?(i&&(l-=a.getBoundingClientRect().left),s.get("enableRtl")&&(o&&(a=a.querySelector(".ag-header-row")),l=a.clientWidth-l),t==null&&!r&&(l+=n.get("center").getCenterViewportScrollLeft()),l):0}function VC(e,t){for(const i of e)i.moving=t,i.dispatchColEvent("movingChanged","uiColumnMoved")}var UR=7,cy=100,Ep=cy/2,ZW=5,e$=100,t$=class extends V{constructor(e){super(),this.pinned=e,this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.isCenterContainer=!ae(e)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){const{pinned:e,lastDraggingEvent:t}=this,{dragItem:i}=t||{},s=(i==null?void 0:i.columns)??[];for(const n of s){const o=n.getPinned();if(n.getColDef().lockPinned){if(o==e)return"move";continue}const r=i==null?void 0:i.containerType;if(r===e||!e)return"move";if(e&&(!o||r!==e))return"pinned"}return"notAllowed"}onDragEnter(e){const t=e.dragItem,i=t.columns;if(e.dragSource.type===0)this.setColumnsVisible(i,!0,"uiColumnDragged");else{const n=t.visibleState,o=(i||[]).filter(r=>n[r.getId()]&&!r.isVisible());this.setColumnsVisible(o,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(i,this.pinned),this.onDragging(e,!0,!0)}onDragging(e=this.lastDraggingEvent,t=!1,i=!1,s=!1){const{gos:n,ctrlsSvc:o}=this.beans,r=n.get("suppressMoveWhenColumnDragging");if(s&&!r){this.finishColumnMoving();return}if(this.lastDraggingEvent=e,!e||!s&&At(e.hDirection))return;const a=ly({x:e.x,pinned:this.pinned,gos:n,ctrlsSvc:o});t||this.checkCenterForScrolling(a),r?this.handleColumnDragWhileSuppressingMovement(e,t,i,a,s):this.handleColumnDragWhileAllowingMovement(e,t,i,a,s)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.updateDragItemContainerType(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,i){if(!(e!=null&&e.length))return;const s=e.filter(n=>!n.getColDef().lockVisible);s.length&&this.beans.colModel.setColsVisible(s,t,i)}finishColumnMoving(){this.clearHighlighted();const e=this.lastMovedInfo;if(!e)return;const{columns:t,toIndex:i}=e;this.beans.colMoves.moveColumns(t,i,"uiColumnMoved",!0)}updateDragItemContainerType(){const{lastDraggingEvent:e}=this;if(this.gos.get("suppressMoveWhenColumnDragging")||!e)return;const t=e.dragItem;t&&(t.containerType=this.pinned)}handleColumnDragWhileSuppressingMovement(e,t,i,s,n){const o=this.getAllMovingColumns(e,!0);if(n){const r=this.isAttemptingToPin(o);r&&this.attemptToPinColumns(o,void 0,!0);const{fromLeft:a,xPosition:l}=this.getNormalisedXPositionInfo(o,r)||{};if(a==null||l==null){this.finishColumnMoving();return}this.moveColumnsAfterHighlight({allMovingColumns:o,xPosition:l,fromEnter:t,fakeEvent:i,fromLeft:a})}else{if(!this.beans.dragAndDrop.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(o,s)}}handleColumnDragWhileAllowingMovement(e,t,i,s,n){const o=this.getAllMovingColumns(e),r=this.normaliseDirection(e.hDirection)==="right",a=e.dragSource.type===1,l=this.getMoveColumnParams({allMovingColumns:o,isFromHeader:a,xPosition:s,fromLeft:r,fromEnter:t,fakeEvent:i}),c=oD({...l,finished:n});c&&(this.lastMovedInfo=c)}getAllMovingColumns(e,t=!1){const i=e.dragSource.getDragItem();let s=null;t?(s=i.columnsInSplit,s||(s=i.columns)):s=i.columns;const n=o=>o.getColDef().lockPinned?o.getPinned()==this.pinned:!0;return s?s.filter(n):[]}getMoveColumnParams(e){const{allMovingColumns:t,isFromHeader:i,xPosition:s,fromLeft:n,fromEnter:o,fakeEvent:r}=e,{gos:a,colModel:l,colMoves:c,visibleCols:d}=this.beans;return{allMovingColumns:t,isFromHeader:i,fromLeft:n,xPosition:s,pinned:this.pinned,fromEnter:o,fakeEvent:r,gos:a,colModel:l,colMoves:c,visibleCols:d}}highlightHoveredColumn(e,t){var d;const{gos:i,colModel:s}=this.beans,n=i.get("enableRtl"),o=s.getCols().filter(h=>h.isVisible()&&h.getPinned()===this.pinned);let r=null,a=null,l=null;for(const h of o){if(a=h.getActualWidth(),r=this.getNormalisedColumnLeft(h,0,n),r!=null){const u=r+a;if(r<=t&&u>=t){l=h;break}}r=null,a=null}if(l)e.indexOf(l)!==-1&&(l=null);else{for(let h=o.length-1;h>=0;h--){const u=o[h],f=o[h].getParent();if(!f){l=u;break}const p=f==null?void 0:f.getDisplayedLeafColumns();if(p.length){l=Ct(p);break}}if(!l)return;r=this.getNormalisedColumnLeft(l,0,n),a=l.getActualWidth()}if(((d=this.lastHighlightedColumn)==null?void 0:d.column)!==l&&this.clearHighlighted(),l==null||r==null||a==null)return;let c;t-r<a/2!==n?c=0:c=1,jR(l,c),this.lastHighlightedColumn={column:l,position:c}}getNormalisedXPositionInfo(e,t){const{gos:i,visibleCols:s}=this.beans,n=i.get("enableRtl"),{firstMovingCol:o,column:r,position:a}=this.getColumnMoveAndTargetInfo(e,t,n);if(!o||!r||a==null)return;const l=s.allCols,c=l.indexOf(o),d=l.indexOf(r),h=a===0!==n,u=c<d||c===d&&!h;let f=0;if(h?u&&(f-=1):u||(f+=1),d+f===c)return;const p=l[d+f];if(!p)return;const m=this.getNormalisedColumnLeft(p,20,n);return{fromLeft:u,xPosition:m}}getColumnMoveAndTargetInfo(e,t,i){const s=this.lastHighlightedColumn||{},{firstMovingCol:n,lastMovingCol:o}=i$(e);if(!n||!o||s.column||!t)return{firstMovingCol:n,...s};const a=this.getPinDirection()==="left";return{firstMovingCol:n,position:a?1:0,column:a!==i?n:o}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case"left":return"right";case"right":return"left"}return e}getNormalisedColumnLeft(e,t,i){const{gos:s,ctrlsSvc:n}=this.beans,o=e.getLeft();if(o==null)return null;const r=e.getActualWidth();return ly({x:i?o+r-t:o+t,pinned:e.getPinned(),useHeaderRow:i,skipScrollPadding:!0,gos:s,ctrlsSvc:n})}isAttemptingToPin(e){const t=this.needToMoveLeft||this.needToMoveRight,i=this.failedMoveAttempts>UR;return t&&i||e.some(s=>s.getPinned()!==this.pinned)}moveColumnsAfterHighlight(e){const{allMovingColumns:t,xPosition:i,fromEnter:s,fakeEvent:n,fromLeft:o}=e,r=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:i,fromLeft:o,fromEnter:s,fakeEvent:n}),{columns:a,toIndex:l}=nD(r)||{};a&&l!=null&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){const{lastHighlightedColumn:e}=this;e&&(jR(e.column,null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;const t=this.beans.ctrlsSvc.get("center"),i=t.getCenterViewportScrollLeft(),s=i+t.getCenterWidth();let n,o;this.gos.get("enableRtl")?(n=e<i+Ep,o=e>s-Ep):(o=e<i+Ep,n=e>s-Ep),this.needToMoveRight=n,this.needToMoveLeft=o,o||n?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),e$),this.beans.dragAndDrop.setDragImageCompIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.beans.dragAndDrop.setDragImageCompIcon(this.getIconName()))}moveInterval(){var s;let e;this.intervalCount++,e=10+this.intervalCount*ZW,e>cy&&(e=cy);let t=null;const i=this.gridBodyCon.scrollFeature;if(this.needToMoveLeft?t=i.scrollHorizontally(-e):this.needToMoveRight&&(t=i.scrollHorizontally(e)),t!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const{pinnedCols:n,dragAndDrop:o,gos:r}=this.beans;if(this.failedMoveAttempts<=UR+1||!n)return;if(o.setDragImageCompIcon("pinned"),!r.get("suppressMoveWhenColumnDragging")){const a=(s=this.lastDraggingEvent)==null?void 0:s.dragItem.columns;this.attemptToPinColumns(a,void 0,!0)}}}getPinDirection(){if(this.needToMoveLeft||this.pinned==="left")return"left";if(this.needToMoveRight||this.pinned==="right")return"right"}attemptToPinColumns(e,t,i=!1){const s=(e||[]).filter(r=>!r.getColDef().lockPinned);if(!s.length)return 0;i&&(t=this.getPinDirection());const{pinnedCols:n,dragAndDrop:o}=this.beans;return n==null||n.setColsPinned(s,t,"uiColumnDragged"),i&&o.nudge(),s.length}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}};function jR(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchColEvent("headerHighlightChanged","uiColumnMoved"))}function i$(e){const t=e.length;let i,s;for(let n=0;n<t;n++){if(!i){const o=e[n];o.getLeft()!=null&&(i=o)}if(!s){const o=e[t-1-n];o.getLeft()!=null&&(s=o)}if(i&&s)break}return{firstMovingCol:i,lastMovingCol:s}}var s$=class extends V{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){const{ctrlsSvc:e,dragAndDrop:t}=this.beans,i=this.pinned;e.whenReady(this,s=>{let n;const o=s.gridBodyCtrl.eBodyViewport;switch(i){case"left":n=[[o,s.left.eContainer],[s.bottomLeft.eContainer],[s.topLeft.eContainer]];break;case"right":n=[[o,s.right.eContainer],[s.bottomRight.eContainer],[s.topRight.eContainer]];break;default:n=[[o,s.center.eViewport],[s.bottomCenter.eViewport],[s.topCenter.eViewport]];break}this.eSecondaryContainers=n}),this.moveColumnFeature=this.createManagedBean(new t$(i)),this.bodyDropPivotTarget=this.createManagedBean(new UW(i)),t.addDropTarget(this),this.addDestroyFunc(()=>t.removeDropTarget(this))}isInterestedIn(e){return e===1||e===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.beans.colModel.isPivotMode()&&e.dragSource.type===0}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},n$=class extends V{constructor(){super(...arguments),this.beanName="colMoves"}moveColumnByIndex(e,t,i){const s=this.beans.colModel.getCols();if(!s)return;const n=s[e];this.moveColumns([n],t,i)}moveColumns(e,t,i,s=!0){const{colModel:n,colAnimation:o,visibleCols:r,eventSvc:a}=this.beans,l=n.getCols();if(!l)return;if(t>l.length-e.length){j(30,{toIndex:t});return}o==null||o.start();const c=n.getColsForKeys(e);this.doesMovePassRules(c,t)&&(dR(n.getCols(),c,t),r.refresh(i),a.dispatchEvent({type:"columnMoved",columns:c,column:c.length===1?c[0]:null,toIndex:t,finished:s,source:i})),o==null||o.finish()}doesMovePassRules(e,t){const i=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(i)}doesOrderPassRules(e){const{colModel:t,gos:i}=this.beans;return!(!QP(e,t.getColTree())||!(n=>{const o=c=>c?c==="left"||c===!0?-1:1:0,r=i.get("enableRtl");let a=r?1:-1,l=!0;for(const c of n){const d=o(c.getColDef().lockPosition);r?d>a&&(l=!1):d<a&&(l=!1),a=d}return l})(e))}getProposedColumnOrder(e,t){const s=this.beans.colModel.getCols().slice();return dR(s,e,t),s}createBodyDropTarget(e,t){return new s$(e,t)}moveHeader(e,t,i,s,n){const{ctrlsSvc:o,gos:r,colModel:a,visibleCols:l,focusSvc:c}=this.beans,d=t.getBoundingClientRect(),h=d.left,u=$t(i),f=u?d.width:i.getActualWidth(),p=e==="left"!==r.get("enableRtl"),m=ly({x:p?h-20:h+f+20,pinned:s,fromKeyboard:!0,gos:r,ctrlsSvc:o}),v=c.focusedHeader;oD({allMovingColumns:u?i.getLeafColumns():[i],isFromHeader:!0,fromLeft:e==="right",xPosition:m,pinned:s,fromEnter:!1,fakeEvent:!1,gos:r,colModel:a,colMoves:this,visibleCols:l,finished:!0});let C;if(u){const w=i.getDisplayedLeafColumns();C=p?w[0]:Ct(w)}else C=i;if(o.getScrollFeature().ensureColumnVisible(C,"auto"),(!n.isAlive()||r.get("ensureDomOrder"))&&v){let w;if(u){const S=i.getGroupId(),b=i.getLeafColumns();if(!b.length)return;const E=b[0].getParent();if(!E)return;w=o$(E,S)}else w=i;w&&c.focusHeaderPosition({headerPosition:{...v,column:w}})}}setDragSourceForHeader(e,t,i){const{gos:s,colModel:n,dragAndDrop:o,visibleCols:r}=this.beans;let a=!s.get("suppressDragLeaveHidesColumns");const l=$t(t),c=l?t.getProvidedColumnGroup().getLeafColumns():[t],h={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:l?()=>a$(t,r.allCols):()=>r$(t),dragItemName:i,onDragStarted:()=>{a=!s.get("suppressDragLeaveHidesColumns"),VC(c,!0)},onDragStopped:()=>VC(c,!1),onDragCancelled:()=>VC(c,!1),onGridEnter:u=>{if(a){const{columns:f=[],visibleState:p}=u??{},m=l?C=>!p||p[C.getColId()]:()=>!0,v=f.filter(C=>!C.getColDef().lockVisible&&m(C));n.setColsVisible(v,!0,"uiColumnMoved")}},onGridExit:u=>{var f;if(a){const p=((f=u==null?void 0:u.columns)==null?void 0:f.filter(m=>!m.getColDef().lockVisible))||[];n.setColsVisible(p,!1,"uiColumnMoved")}}};return o.addDragSource(h,!0),h}};function o$(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}}function r$(e){const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t,containerType:e.pinned}}function a$(e,t){var a;const i=e.getProvidedColumnGroup().getLeafColumns(),s={};for(const l of i)s[l.getId()]=l.isVisible();const n=[];for(const l of t)i.indexOf(l)>=0&&(n.push(l),_n(i,l));for(const l of i)n.push(l);const o=[],r=e.getLeafColumns();for(const l of n)r.indexOf(l)!==-1&&o.push(l);return{columns:n,columnsInSplit:o,visibleState:s,containerType:(a=o[0])==null?void 0:a.pinned}}var l$={moduleName:"ColumnMove",version:ne,beans:[n$,zW],apiFunctions:{moveColumnByIndex:WW,moveColumns:$W},dependsOn:[sD],css:[VW]},c$=class extends V{constructor(){super(...arguments),this.beanName="autoWidthCalc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){const i=this.getHeaderCellForColumn(e);if(!i)return-1;const s=this.beans.rowRenderer.getAllCellsNotSpanningForColumn(e);return t||s.push(i),this.getPreferredWidthForElements(s)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.getPreferredWidthForElements([t]):-1}getPreferredWidthForElements(e,t){const i=document.createElement("form");i.style.position="fixed";const s=this.centerRowContainerCtrl.eContainer;for(const o of e)this.cloneItemIntoDummy(o,i);s.appendChild(i);const n=i.offsetWidth;return i.remove(),t=t??this.gos.get("autoSizePadding"),n+t}getHeaderCellForColumn(e){let t=null;for(const i of this.beans.ctrlsSvc.getHeaderRowContainerCtrls()){const s=i.getHtmlElementForColumnHeader(e);s!=null&&(t=s)}return t}cloneItemIntoDummy(e,t){const i=e.cloneNode(!0);i.style.width="",i.style.position="static",i.style.left="";const s=document.createElement("div"),n=s.classList;["ag-header-cell","ag-header-group-cell"].some(a=>i.classList.contains(a))?(n.add("ag-header","ag-header-row"),s.style.position="static"):n.add("ag-row");let r=e.parentElement;for(;r;){if(["ag-header-row","ag-row"].some(l=>r.classList.contains(l))){for(let l=0;l<r.classList.length;l++){const c=r.classList[l];c!="ag-row-position-absolute"&&n.add(c)}break}r=r.parentElement}s.appendChild(i),t.appendChild(s)}},rD={moduleName:"AutoWidth",version:ne,beans:[c$]};function d$(e,t,i=!0,s="api"){var n;(n=e.colResize)==null||n.setColumnWidths(t,!1,i,s)}var h$=class extends V{constructor(e,t,i,s){super(),this.comp=e,this.eResize=t,this.pinned=i,this.columnGroup=s}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}const{horizontalResizeSvc:e,gos:t,colAutosize:i}=this.beans,s=e.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});this.addDestroyFunc(s),!t.get("suppressAutoSize")&&i&&this.addDestroyFunc(i.addColumnGroupResize(this.eResize,this.columnGroup,()=>this.resizeLeafColumnsToFit("uiColumnResized")))}onResizeStart(e){const{columnsToResize:t,resizeStartWidth:i,resizeRatios:s,groupAfterColumns:n,groupAfterStartWidth:o,groupAfterRatios:r}=this.getInitialValues(e);this.resizeCols=t,this.resizeStartWidth=i,this.resizeRatios=s,this.resizeTakeFromCols=n,this.resizeTakeFromStartWidth=o,this.resizeTakeFromRatios=r,this.toggleColumnResizing(!0)}onResizing(e,t,i="uiColumnResized"){const s=this.normaliseDragChange(t),n=this.resizeStartWidth+s;this.resizeColumnsFromLocalValues(n,i,e)}getInitialValues(e){var l;const t=c=>c.reduce((d,h)=>d+h.getActualWidth(),0),i=(c,d)=>c.map(h=>h.getActualWidth()/d),s=this.getColumnsToResize(),n=t(s),o=i(s,n),r={columnsToResize:s,resizeStartWidth:n,resizeRatios:o};let a=null;if(e&&(a=((l=this.beans.colGroupSvc)==null?void 0:l.getGroupAtDirection(this.columnGroup,"After"))??null),a){const c=a.getDisplayedLeafColumns(),d=r.groupAfterColumns=c.filter(u=>u.isResizable()),h=r.groupAfterStartWidth=t(d);r.groupAfterRatios=i(d,h)}else r.groupAfterColumns=void 0,r.groupAfterStartWidth=void 0,r.groupAfterRatios=void 0;return r}resizeLeafColumnsToFit(e){const t=this.beans.autoWidthCalc.getPreferredWidthForColumnGroup(this.columnGroup),i=this.getInitialValues();t>i.resizeStartWidth&&this.resizeColumns(i,t,e,!0)}resizeColumnsFromLocalValues(e,t,i=!0){if(!this.resizeCols||!this.resizeRatios)return;const s={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols,groupAfterStartWidth:this.resizeTakeFromStartWidth,groupAfterRatios:this.resizeTakeFromRatios};this.resizeColumns(s,e,t,i)}resizeColumns(e,t,i,s=!0){var h;const{columnsToResize:n,resizeStartWidth:o,resizeRatios:r,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:c}=e,d=[];if(d.push({columns:n,ratios:r,width:t}),a){const u=t-o;d.push({columns:a,ratios:c,width:l-u})}(h=this.beans.colResize)==null||h.resizeColumnSets({resizeSets:d,finished:s,source:i}),s&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.toggleCss("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?this.pinned!=="left"&&(t*=-1):this.pinned==="right"&&(t*=-1),t}destroy(){super.destroy(),this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}},u$=class extends V{constructor(e,t,i,s,n){super(),this.pinned=e,this.column=t,this.eResize=i,this.comp=s,this.ctrl=n}postConstruct(){const e=[];let t,i;const s=()=>{if(xt(this.eResize,t),!t)return;const{horizontalResizeSvc:r,colAutosize:a}=this.beans,l=r.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});e.push(l),i&&a&&e.push(a.addColumnAutosizeListeners(this.eResize,this.column))},n=()=>{for(const r of e)r();e.length=0},o=()=>{const r=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(r!==t||a!==i)&&(t=r,i=a,n(),s())};o(),this.addDestroyFunc(n),this.ctrl.setRefreshFunction("resize",o)}onResizing(e,t){const{column:i,lastResizeAmount:s,resizeStartWidth:n,beans:o}=this,r=this.normaliseResizeAmount(t),a=n+r,l=[{key:i,newWidth:a}],{pinnedCols:c,ctrlsSvc:d,colResize:h}=o;if(this.column.getPinned()){const u=(c==null?void 0:c.leftWidth)??0,f=(c==null?void 0:c.rightWidth)??0,p=cg(d.getGridBodyCtrl().eBodyViewport)-50;if(u+f+(r-s)>p)return}this.lastResizeAmount=r,h==null||h.setColumnWidths(l,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.column.resizing=e,this.comp.toggleCss("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e;const i=this.pinned!=="left",s=this.pinned==="right";return this.gos.get("enableRtl")?i&&(t*=-1):s&&(t*=-1),t}},g$=class extends V{constructor(){super(...arguments),this.beanName="colResize"}setColumnWidths(e,t,i,s){const n=[],{colModel:o,gos:r,visibleCols:a}=this.beans;for(const l of e){const c=o.getColDefCol(l.key)||o.getCol(l.key);if(!c)continue;if(n.push({width:l.newWidth,ratios:[1],columns:[c]}),r.get("colResizeDefault")==="shift"&&(t=!t),t){const h=a.getColAfter(c);if(!h)continue;const u=c.getActualWidth()-l.newWidth,f=h.getActualWidth()+u;n.push({width:f,ratios:[1],columns:[h]})}}n.length!==0&&this.resizeColumnSets({resizeSets:n,finished:i,source:s})}resizeColumnSets(e){const{resizeSets:t,finished:i,source:s}=e;if(!(!t||t.every(d=>f$(d)))){if(i){const d=t&&t.length>0?t[0].columns:null;$h(this.eventSvc,d,i,s)}return}const o=[],r=[];for(const d of t){const{width:h,columns:u,ratios:f}=d,p={},m={};for(const w of u)r.push(w);let v=!0,C=0;for(;v;){if(C++,C>1e3){ut(31);break}v=!1;const w=[];let S=0,b=h;u.forEach((A,P)=>{if(m[A.getId()])b-=p[A.getId()];else{w.push(A);const D=f[P];S+=D}});const E=1/S;w.forEach((A,P)=>{const T=P===w.length-1;let D;T?D=b:(D=Math.round(f[P]*h*E),b-=D);const N=A.getMinWidth(),M=A.getMaxWidth();D<N?(D=N,m[A.getId()]=!0,v=!0):M>0&&D>M&&(D=M,m[A.getId()]=!0,v=!0),p[A.getId()]=D})}for(const w of u){const S=p[w.getId()];w.getActualWidth()!==S&&(w.setActualWidth(S,s),o.push(w))}}const a=o.length>0;let l=[];if(a){const{colFlex:d,visibleCols:h,colViewport:u}=this.beans;l=(d==null?void 0:d.refreshFlexedColumns({resizingCols:r,skipSetLeft:!0}))??[],h.setLeftValues(s),h.updateBodyWidths(),u.checkViewportColumns()}const c=r.concat(l);(a||i)&&$h(this.eventSvc,c,i,s,l)}resizeHeader(e,t,i){if(!e.isResizable())return;const s=e.getActualWidth(),n=e.getMinWidth(),o=e.getMaxWidth(),r=Math.min(Math.max(s+t,n),o);this.setColumnWidths([{key:e,newWidth:r}],i,!0,"uiColumnResized")}createResizeFeature(e,t,i,s,n){return new u$(e,t,i,s,n)}createGroupResizeFeature(e,t,i,s){return new h$(e,t,i,s)}};function f$(e){const{columns:t,width:i}=e;let s=0,n=0,o=!0;for(const l of t){const c=l.getMinWidth();s+=c||0;const d=l.getMaxWidth();d>0?n+=d:o=!1}const r=i>=s,a=!o||i<=n;return r&&a}var p$={moduleName:"ColumnResize",version:ne,beans:[g$],apiFunctions:{setColumnWidths:d$},dependsOn:[BW,rD]},m$=class extends V{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const e=this.onWidthChanged.bind(this);for(const t of this.columnGroup.getLeafColumns())t.__addEventListener("widthChanged",e),t.__addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.__removeEventListener("widthChanged",e),t.__removeEventListener("visibleChanged",e)})}removeListenersOnChildrenColumns(){for(const e of this.removeChildListenersFuncs)e();this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.toggleCss("ag-hidden",e===0)}},v$=class extends LS{constructor(){super(...arguments),this.onSuppressColMoveChange=()=>{!this.isAlive()||this.isSuppressMoving()?this.removeDragSource():this.dragSource||this.setDragSource(this.eGui)}}wireComp(e,t,i,s,n){const{column:o,beans:r}=this,{context:a,colNames:l,colHover:c,rangeSvc:d,colResize:h}=r;this.comp=e,n=Qf(this,a,n),this.setGui(t,n),this.displayName=l.getDisplayNameForColumnGroup(o,"header"),this.refreshHeaderStyles(),this.addClasses(),this.setupMovingCss(n),this.setupExpandable(n),this.setupTooltip(),this.setupAutoHeight({wrapperElement:s,compBean:n}),this.setupUserComp(),this.addHeaderMouseListeners(n),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();const u=this.rowCtrl.pinned,f=o.getProvidedColumnGroup().getLeafColumns();c==null||c.createHoverFeature(n,f,t),d==null||d.createRangeHighlightFeature(n,o,e),n.createManagedBean(new _S(o,t,r)),n.createManagedBean(new m$(e,o)),h?this.resizeFeature=n.createManagedBean(h.createGroupResizeFeature(e,i,u,o)):e.setResizableDisplayed(!1),n.createManagedBean(new su(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(n,f),n.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(n),n.addDestroyFunc(()=>this.clearComponent())}getHeaderClassParams(){const{column:e,beans:t}=this,i=e.getDefinition();return Fe(t.gos,{colDef:i,columnGroup:e,floatingFilter:!1})}refreshMaxHeaderHeight(){const{gos:e,comp:t}=this,i=e.get("groupHeaderHeight");i!=null?i===0?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(i):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(const i of t)e.addManagedListeners(i,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,i)})}onLeafColumnHighlightChanged(e){const t=this.column.getDisplayedLeafColumns(),i=t[0]===e,s=Ct(t)===e;if(!i&&!s)return;const n=e.getHighlighted(),o=!!this.rowCtrl.getHeaderCellCtrls().find(l=>l.column.isMoving());let r=!1,a=!1;if(o){const l=this.beans.gos.get("enableRtl"),c=n===1,d=n===0;i&&(l?a=c:r=d),s&&(l?r=d:a=c)}this.comp.toggleCss("ag-header-highlight-before",r),this.comp.toggleCss("ag-header-highlight-after",a)}resizeHeader(e,t){const{resizeFeature:i}=this;if(!i)return;const s=i.getInitialValues(t);i.resizeColumns(s,s.resizeStartWidth+e,"uiColumnResized",!0)}resizeLeafColumnsToFit(e){var t;(t=this.resizeFeature)==null||t.resizeLeafColumnsToFit(e)}setupUserComp(){const{colGroupSvc:e,userCompFactory:t,gos:i,enterpriseMenuFactory:s}=this.beans,n=this.column,o=n.getProvidedColumnGroup(),r=Fe(i,{displayName:this.displayName,columnGroup:n,setExpanded:l=>{e.setColumnGroupOpened(o,l,"gridInitializing")},setTooltip:(l,c)=>{i.assertModuleRegistered("Tooltip",3),this.setupTooltip(l,c)},showColumnMenu:(l,c)=>s==null?void 0:s.showMenuAfterButtonClick(o,l,"columnMenu",c),showColumnMenuAfterMouseClick:(l,c)=>s==null?void 0:s.showMenuAfterMouseEvent(o,l,"columnMenu",c),eGridHeader:this.eGui}),a=r2(t,r);a&&this.comp.setUserCompDetails(a)}addHeaderMouseListeners(e){const t=n=>this.handleMouseOverChange(n.type==="mouseenter"),i=()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),s=n=>this.handleContextMenuMouseEvent(n,void 0,this.column.getProvidedColumnGroup());e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:i,contextmenu:s})}handleMouseOverChange(e){this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t){var i;this.tooltipFeature=(i=this.beans.tooltipSvc)==null?void 0:i.setupHeaderGroupTooltip(this.tooltipFeature,this,e,t)}setupExpandable(e){const t=this.column.getProvidedColumnGroup();this.refreshExpanded();const i=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:i,expandableChanged:i})}refreshExpanded(){const{column:e}=this;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0),this.refreshHeaderStyles()}addClasses(){const{column:e}=this,t=e.getColGroupDef(),i=WT(t,this.gos,null,e);e.isPadding()?(i.push("ag-header-group-cell-no-group"),e.getLeafColumns().every(n=>n.isSpanHeaderHeight())&&i.push("ag-header-span-height")):(i.push("ag-header-group-cell-with-group"),t!=null&&t.wrapHeaderText&&i.push("ag-header-cell-wrap-text"));for(const s of i)this.comp.toggleCss(s,!0)}setupMovingCss(e){const{column:t}=this,s=t.getProvidedColumnGroup().getLeafColumns(),n=()=>this.comp.toggleCss("ag-header-cell-moving",t.isMoving());for(const o of s)e.addManagedListeners(o,{movingChanged:n});n()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||this.focusThis()}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();if(!(!this.expandable||!t)&&e.key===H.ENTER){const i=this.column,s=!i.isExpanded();this.beans.colGroupSvc.setColumnGroupOpened(i.getProvidedColumnGroup(),s,"uiColumnExpanded")}}setDragSource(e){var t;!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),e&&(this.dragSource=((t=this.beans.colMoves)==null?void 0:t.setDragSourceForHeader(e,this.column,this.displayName))??null))}isSuppressMoving(){return this.gos.get("suppressMovableColumns")||this.column.getLeafColumns().some(e=>e.getColDef().suppressMovable||e.getColDef().lockPosition)}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function C$(e,t,i){var s;(s=e.colGroupSvc)==null||s.setColumnGroupOpened(t,i,"api")}function w$(e,t,i){var s;return((s=e.colGroupSvc)==null?void 0:s.getColumnGroup(t,i))??null}function b$(e,t){var i;return((i=e.colGroupSvc)==null?void 0:i.getProvidedColGroup(t))??null}function y$(e,t,i){return e.colNames.getDisplayNameForColumnGroup(t,i)||""}function S$(e){var t;return((t=e.colGroupSvc)==null?void 0:t.getColumnGroupState())??[]}function R$(e,t){var i;(i=e.colGroupSvc)==null||i.setColumnGroupState(t,"api")}function x$(e){var t;(t=e.colGroupSvc)==null||t.resetColumnGroupState("api")}function E$(e){return e.visibleCols.treeLeft}function A$(e){return e.visibleCols.treeCenter}function F$(e){return e.visibleCols.treeRight}function P$(e){return e.visibleCols.getAllTrees()}function T$(e,t){for(let i=0;i<t.length;i++){const s=e.indexOf(t[i]);s>=0&&(e[s]=e[e.length-1],e.pop())}}var D$=class extends V{constructor(){super(...arguments),this.beanName="visibleCols",this.colsAndGroupsMap={},this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.headerGroupRowCount=0,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.isBodyWidthDirty=!0}refresh(e,t=!1){const{colFlex:i,colModel:s,colGroupSvc:n,colViewport:o,selectionColSvc:r}=this.beans;t||this.buildTrees(s,n),n==null||n.updateOpenClosedVisibility(),this.leftCols=zC(this.treeLeft),this.centerCols=zC(this.treeCenter),this.rightCols=zC(this.treeRight),r==null||r.refreshVisibility(this.leftCols,this.centerCols,this.rightCols),this.joinColsAriaOrder(s),this.joinCols(),this.headerGroupRowCount=this.getHeaderRowCount(),this.setLeftValues(e),this.autoHeightCols=this.allCols.filter(a=>a.isAutoHeight()),i==null||i.refreshFlexedColumns(),this.updateBodyWidths(),this.setFirstRightAndLastLeftPinned(s,this.leftCols,this.rightCols,e),o.checkViewportColumns(!1),this.eventSvc.dispatchEvent({type:"displayedColumnsChanged",source:e})}getHeaderRowCount(){if(!this.gos.get("hidePaddedHeaderRows"))return this.beans.colModel.cols.treeDepth;let e=0;for(const t of this.allCols){let i=t.getParent();for(;i;){if(!i.isPadding()){const s=i.getProvidedColumnGroup().getLevel()+1;s>e&&(e=s);break}i=i.getParent()}}return e}updateBodyWidths(){const e=Bo(this.centerCols),t=Bo(this.leftCols),i=Bo(this.rightCols);this.isBodyWidthDirty=this.bodyWidth!==e,(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==i)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=i,this.eventSvc.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventSvc.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e,t,i,s){let n,o;this.gos.get("enableRtl")?(n=t?t[0]:null,o=i?Ct(i):null):(n=t?Ct(t):null,o=i?i[0]:null);for(const r of e.getCols())r.setLastLeftPinned(r===n,s),r.setFirstRightPinned(r===o,s)}buildTrees(e,t){const i=e.getColsToShow(),s=i.filter(l=>l.getPinned()=="left"),n=i.filter(l=>l.getPinned()=="right"),o=i.filter(l=>l.getPinned()!="left"&&l.getPinned()!="right"),r=new iT,a=l=>t?t.createColumnGroups(l):l.columns;this.treeLeft=a({columns:s,idCreator:r,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=a({columns:n,idCreator:r,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=a({columns:o,idCreator:r,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.ariaOrderColumns=[]}joinColsAriaOrder(e){const t=e.getCols(),i=[],s=[],n=[];for(const o of t){const r=o.getPinned();r?r===!0||r==="left"?i.push(o):n.push(o):s.push(o)}this.ariaOrderColumns=i.concat(s).concat(n)}getAriaColIndex(e){let t;return $t(e)?t=e.getLeafColumns()[0]:t=e,this.ariaOrderColumns.indexOf(t)+1}setLeftValuesOfGroups(){for(const e of[this.treeLeft,this.treeRight,this.treeCenter])for(const t of e)$t(t)&&t.checkLeft()}setLeftValuesOfCols(e){const{colModel:t}=this.beans;if(!t.getColDefCols())return;const s=t.getCols().slice(0),n=this.gos.get("enableRtl");for(const o of[this.leftCols,this.rightCols,this.centerCols]){if(n){let r=Bo(o);for(const a of o)r-=a.getActualWidth(),a.setLeft(r,e)}else{let r=0;for(const a of o)a.setLeft(r,e),r+=a.getActualWidth()}T$(s,o)}for(const o of s)o.setLeft(null,e)}joinCols(){this.gos.get("enableRtl")?this.allCols=this.rightCols.concat(this.centerCols).concat(this.leftCols):this.allCols=this.leftCols.concat(this.centerCols).concat(this.rightCols)}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}isColDisplayed(e){return this.allCols.indexOf(e)>=0}getLeftColsForRow(e){const{leftCols:t,beans:{colModel:i}}=this;return i.colSpanActive?this.getColsForRow(e,t):t}getRightColsForRow(e){const{rightCols:t,beans:{colModel:i}}=this;return i.colSpanActive?this.getColsForRow(e,t):t}getColsForRow(e,t,i,s){const n=[];let o=null;for(let r=0;r<t.length;r++){const a=t[r],l=t.length-r,c=Math.min(a.getColSpan(e),l),d=[a];if(c>1){const u=c-1;for(let f=1;f<=u;f++)d.push(t[r+f]);r+=u}let h;if(i){h=!1;for(const u of d)i(u)&&(h=!0)}else h=!0;h&&(n.length===0&&o&&(s&&s(a))&&n.push(o),n.push(a)),o=a}return n}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getColBefore(e){const t=this.allCols,i=t.indexOf(e);return i>0?t[i-1]:null}isPinningLeft(){return this.leftCols.length>0}isPinningRight(){return this.rightCols.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};const e=t=>{this.colsAndGroupsMap[t.getUniqueId()]=t};xc(this.treeCenter,!1,e),xc(this.treeLeft,!1,e),xc(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}getFirstColumn(){const e=this.gos.get("enableRtl"),t=["leftCols","centerCols","rightCols"];e&&t.reverse();for(let i=0;i<t.length;i++){const s=this[t[i]];if(s.length)return e?Ct(s):s[0]}return null}getColAfter(e){const t=this.allCols,i=t.indexOf(e);return i<t.length-1?t[i+1]:null}getColsLeftWidth(){return Bo(this.leftCols)}getDisplayedColumnsRightWidth(){return Bo(this.rightCols)}isColAtEdge(e,t){const i=this.allCols;if(!i.length)return!1;const s=t==="first";let n;if($t(e)){const o=e.getDisplayedLeafColumns();if(!o.length)return!1;n=s?o[0]:Ct(o)}else n=e;return(s?i[0]:Ct(i))===n}};function xc(e,t,i){if(e)for(let s=0;s<e.length;s++){const n=e[s];if($t(n)){const o=t?n.getDisplayedChildren():n.getChildren();xc(o,t,i)}i(n)}}function zC(e){const t=[];return xc(e,!0,i=>{Va(i)&&t.push(i)}),t}var M$=class extends V{constructor(){super(...arguments),this.beanName="colGroupSvc"}getColumnGroupState(){const e=[],t=this.beans.colModel.getColTree();return Sr(null,t,i=>{Vi(i)&&e.push({groupId:i.getGroupId(),open:i.isExpanded()})}),e}resetColumnGroupState(e){const t=this.beans.colModel.getColDefColTree();if(!t)return;const i=[];Sr(null,t,s=>{if(Vi(s)){const n=s.getColGroupDef(),o={groupId:s.getGroupId(),open:n?n.openByDefault:void 0};i.push(o)}}),this.setColumnGroupState(i,e)}setColumnGroupState(e,t){const{colModel:i,colAnimation:s,visibleCols:n,eventSvc:o}=this.beans;if(!i.getColTree().length)return;s==null||s.start();const a=[];for(const l of e){const c=l.groupId,d=l.open,h=this.getProvidedColGroup(c);h&&h.isExpanded()!==d&&(h.setExpanded(d),a.push(h))}n.refresh(t,!0),a.length&&o.dispatchEvent({type:"columnGroupOpened",columnGroup:a.length===1?a[0]:void 0,columnGroups:a}),s==null||s.finish()}setColumnGroupOpened(e,t,i){let s;Vi(e)?s=e.getId():s=e||"",this.setColumnGroupState([{groupId:s,open:t}],i)}getProvidedColGroup(e){let t=null;return Sr(null,this.beans.colModel.getColTree(),i=>{Vi(i)&&i.getId()===e&&(t=i)}),t}getGroupAtDirection(e,t){const i=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),s=e.getDisplayedLeafColumns(),n=t==="After"?Ct(s):s[0],o=`getCol${t}`;for(;;){const r=this.beans.visibleCols[o](n);if(!r)return null;const a=this.getColGroupAtLevel(r,i);if(a!==e)return a}}getColGroupAtLevel(e,t){let i=e.getParent(),s,n;for(;s=i.getProvidedColumnGroup().getLevel(),n=i.getPaddingLevel(),!(s+n<=t);)i=i.getParent();return i}updateOpenClosedVisibility(){const e=this.beans.visibleCols.getAllTrees();xc(e,!1,t=>{$t(t)&&t.calculateDisplayedColumns()})}getColumnGroup(e,t){if(!e)return null;if($t(e))return e;const i=this.beans.visibleCols.getAllTrees(),s=typeof t=="number";let n=null;return xc(i,!1,o=>{if($t(o)){const r=o;let a;s?a=e===r.getGroupId()&&t===r.getPartId():a=e===r.getGroupId(),a&&(n=r)}}),n}createColumnGroups(e){const{columns:t,idCreator:i,pinned:s,oldDisplayedGroups:n,isStandaloneStructure:o}=e,r=this.mapOldGroupsById(n),a=[];let l=t;for(;l.length;){const c=l;l=[];let d=0;const h=u=>{const f=d;d=u;const p=c[f],v=($t(p)?p.getProvidedColumnGroup():p).getOriginalParent();if(v==null){for(let w=f;w<u;w++)a.push(c[w]);return}const C=this.createColumnGroup(v,i,r,s,o);for(let w=f;w<u;w++)C.addChild(c[w]);l.push(C)};for(let u=1;u<c.length;u++){const f=c[u],m=($t(f)?f.getProvidedColumnGroup():f).getOriginalParent(),v=c[d],w=($t(v)?v.getProvidedColumnGroup():v).getOriginalParent();m!==w&&h(u)}d<c.length&&h(c.length)}return o||this.setupParentsIntoCols(a,null),a}createProvidedColumnGroup(e,t,i,s,n,o,r){const a=n.getUniqueKey(t.groupId||null,null),l=cR(this.beans,t,a),c=new hm(l,a,!1,i);this.createBean(c);const d=this.findExistingGroup(t,o);d&&o.splice(d.idx,1);const h=d==null?void 0:d.group;h&&c.setExpanded(h.isExpanded());const u=qP(this.beans,l.children,i+1,e,s,n,o,r);return c.setChildren(u),c}balanceColumnTree(e,t,i,s){const n=[];for(let o=0;o<e.length;o++){const r=e[o];if(Vi(r)){const a=r,l=this.balanceColumnTree(a.getChildren(),t+1,i,s);a.setChildren(l),n.push(a)}else{let a,l;for(let c=t;c<i;c++){const d=s.getUniqueKey(null,null),h=cR(this.beans,null,d),u=new hm(h,d,!0,c);this.createBean(u),l&&l.setChildren([u]),l=u,a||(a=l)}if(a&&l)if(n.push(a),e.some(d=>Vi(d))){l.setChildren([r]);continue}else{l.setChildren(e);break}n.push(r)}}return n}findDepth(e){let t=0,i=e;for(;i!=null&&i[0]&&Vi(i[0]);)t++,i=i[0].getChildren();return t}findMaxDepth(e,t){let i=t;for(let s=0;s<e.length;s++){const n=e[s];if(Vi(n)){const o=n,r=this.findMaxDepth(o.getChildren(),t+1);i<r&&(i=r)}}return i}balanceTreeForAutoCols(e,t){const i=[];for(const s of e){let n=s;for(let o=t-1;o>=0;o--){const r=new hm(null,`FAKE_PATH_${s.getId()}}_${o}`,!0,o);this.createBean(r),r.setChildren([n]),n.originalParent=r,n=r}t===0&&(s.originalParent=null),i.push(n)}return i}findExistingGroup(e,t){if(e.groupId!=null)for(let s=0;s<t.length;s++){const n=t[s];if(n.getColGroupDef()&&n.getId()===e.groupId)return{idx:s,group:n}}}createColumnGroup(e,t,i,s,n){const o=e.getGroupId(),r=t.getInstanceIdForKey(o),a=FT(o,r);let l=i[a];return l&&l.getProvidedColumnGroup()!==e&&(l=null),ae(l)?l.reset():(l=new pg(e,o,r,s),n||this.createBean(l)),l}mapOldGroupsById(e){const t={},i=s=>{for(const n of s)if($t(n)){const o=n;t[n.getUniqueId()]=o,i(o.getChildren())}};return e&&i(e),t}setupParentsIntoCols(e,t){for(const i of e??[])if(i.parent!==t&&(this.beans.colViewport.colsWithinViewportHash=""),i.parent=t,$t(i)){const s=i;this.setupParentsIntoCols(s.getChildren(),s)}}},I$={moduleName:"ColumnGroup",version:ne,dynamicBeans:{headerGroupCellCtrl:v$},beans:[M$],apiFunctions:{getAllDisplayedColumnGroups:P$,getCenterDisplayedColumnGroups:A$,getColumnGroup:w$,getColumnGroupState:S$,getDisplayNameForColumnGroup:y$,getLeftDisplayedColumnGroups:E$,getProvidedColumnGroup:b$,getRightDisplayedColumnGroups:F$,resetColumnGroupState:x$,setColumnGroupOpened:C$,setColumnGroupState:R$}},k$={tag:"div",cls:"ag-skeleton-container"},_$=class extends ct{constructor(){super(k$)}init(e){const t=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",t),this.addDestroyFunc(()=>ag(e.eParentOfValue)),ag(e.eParentOfValue,t),e.deferRender?this.setupLoading(e):e.node.failedLoad?this.setupFailed():this.setupLoading(e)}setupFailed(){const e=this.getLocaleTextFunc();this.getGui().textContent=e("loadingError","ERR");const t=e("ariaSkeletonCellLoadingFailed","Row failed to load");zh(this.getGui(),t)}setupLoading(e){const t=jt({tag:"div",cls:"ag-skeleton-effect"}),i=e.node.rowIndex;if(i!=null){const o=75+25*(i%2===0?Math.sin(i):Math.cos(i));t.style.width=`${o}%`}this.getGui().appendChild(t);const s=this.getLocaleTextFunc(),n=e.deferRender?s("ariaDeferSkeletonCellLoading","Cell is loading"):s("ariaSkeletonCellLoading","Row data is loading");zh(this.getGui(),n)}refresh(e){return!1}},L$={moduleName:"CheckboxCellRenderer",version:ne,userComponents:{agCheckboxCellRenderer:vz}},O$={moduleName:"SkeletonCellRenderer",version:ne,userComponents:{agSkeletonCellRenderer:_$}};function N$(e,t){const i=e.colModel.getColDefCol(t);return i?i.getColDef():null}function H$(e){return e.colModel.getColumnDefs(!0)}function G$(e,t,i){return e.colNames.getDisplayNameForColumn(t,i)||""}function B$(e,t){return e.colModel.getColDefCol(t)}function V$(e){return e.colModel.getColDefCols()}function z$(e,t){return In(e,t,"api")}function W$(e){return zm(e)}function $$(e){MG(e,"api")}function U$(e){return e.visibleCols.isPinningLeft()||e.visibleCols.isPinningRight()}function j$(e){return e.visibleCols.isPinningLeft()}function K$(e){return e.visibleCols.isPinningRight()}function q$(e,t){return e.visibleCols.getColAfter(t)}function Y$(e,t){return e.visibleCols.getColBefore(t)}function X$(e,t,i){e.colModel.setColsVisible(t,i,"api")}function Q$(e,t,i){var s;(s=e.pinnedCols)==null||s.setColsPinned(t,i,"api")}function J$(e){return e.colModel.getCols()}function Z$(e){return e.visibleCols.leftCols}function e3(e){return e.visibleCols.centerCols}function t3(e){return e.visibleCols.rightCols}function i3(e){return e.visibleCols.allCols}function s3(e){return e.colViewport.getViewportColumns()}function dy(e,t){if(!e)return;const i=e,s={};for(const n of Object.keys(i)){if(t&&t.indexOf(n)>=0||FP.has(n))continue;const o=i[n];typeof o=="object"&&o!==null&&o.constructor===Object?s[n]=dy(o):s[n]=o}return s}var n3=class extends V{constructor(){super(...arguments),this.beanName="colDefFactory"}wireBeans(e){this.rowGroupColsSvc=e.rowGroupColsSvc,this.pivotColsSvc=e.pivotColsSvc}getColumnDefs(e,t,i,s,n=!1){var l,c;const o=e.slice();t?o.sort((d,h)=>i.indexOf(d)-i.indexOf(h)):(i||n)&&o.sort((d,h)=>s.indexOf(d)-s.indexOf(h));const r=(l=this.rowGroupColsSvc)==null?void 0:l.columns,a=(c=this.pivotColsSvc)==null?void 0:c.columns;return this.buildColumnDefs(o,r,a)}buildColumnDefs(e,t=[],i=[]){const s=[],n={};for(const o of e){const r=this.createDefFromColumn(o,t,i);let a=!0,l=r,c=o.getOriginalParent(),d=null;for(;c;){let h=null;if(c.isPadding()){c=c.getOriginalParent();continue}const u=n[c.getGroupId()];if(u){u.children.push(l),a=!1;break}if(h=this.createDefFromGroup(c),h&&(h.children=[l],n[h.groupId]=h,l=h,c=c.getOriginalParent()),c!=null&&d===c){a=!1;break}d=c}a&&s.push(l)}return s}createDefFromGroup(e){const t=dy(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,i){const s=dy(e.getColDef());return s.colId=e.getColId(),s.width=e.getActualWidth(),s.rowGroup=e.isRowGroupActive(),s.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,s.pivot=e.isPivotActive(),s.pivotIndex=e.isPivotActive()?i.indexOf(e):null,s.aggFunc=e.isValueActive()?e.getAggFunc():null,s.hide=e.isVisible()?void 0:!0,s.pinned=e.isPinned()?e.getPinned():null,s.sort=e.getSort()?e.getSort():null,s.sortIndex=e.getSortIndex()!=null?e.getSortIndex():null,s}},o3=class extends V{constructor(){super(...arguments),this.beanName="colFlex",this.columnsHidden=!1}refreshFlexedColumns(e={}){const t=e.source??"flex";e.viewportWidth!=null&&(this.flexViewportWidth=e.viewportWidth);const i=this.flexViewportWidth,{visibleCols:s,colDelayRenderSvc:n}=this.beans,o=s.centerCols;let r=-1;if(e.resizingCols){const m=new Set(e.resizingCols);for(let v=o.length-1;v>=0;v--)if(m.has(o[v])){r=v;break}}let a=!1;const l=o.map((m,v)=>{const C=m.getFlex(),w=C!=null&&C>0&&v>r;return a||(a=w),{col:m,isFlex:w,flex:Math.max(0,C??0),initialSize:m.getActualWidth(),min:m.getMinWidth(),max:m.getMaxWidth(),targetSize:0}});if(a?(n==null||n.hideColumns("colFlex"),this.columnsHidden=!0):this.columnsHidden&&this.revealColumns(n),!i||!a)return[];let c=l.length,d=l.reduce((m,v)=>m+v.flex,0),h=i;const u=(m,v)=>{m.frozenSize=v,m.col.setActualWidth(v,t),h-=v,d-=m.flex,c-=1},f=m=>m.frozenSize!=null;for(const m of l)m.isFlex||u(m,m.initialSize);for(;c>0;){const m=Math.round(d<1?h*d:h);let v,C=0,w=0;for(const E of l){if(f(E))continue;v=E,w+=m*(E.flex/d);const A=w-C,P=Math.round(A);E.targetSize=P,C+=P}v&&(v.targetSize+=m-C);let S=0;for(const E of l){if(f(E))continue;const A=E.targetSize,P=Math.min(Math.max(A,E.min),E.max);S+=P-A,E.violationType=P===A?void 0:P<A?"max":"min",E.targetSize=P}const b=S===0?"all":S>0?"min":"max";for(const E of l)f(E)||(b==="all"||E.violationType===b)&&u(E,E.targetSize)}e.skipSetLeft||s.setLeftValues(t),e.updateBodyWidths&&s.updateBodyWidths();const p=l.filter(m=>m.isFlex&&!m.violationType).map(m=>m.col);if(e.fireResizedEvent){const m=l.filter(C=>C.initialSize!==C.frozenSize).map(C=>C.col),v=l.filter(C=>C.flex).map(C=>C.col);$h(this.eventSvc,m,!0,t,v)}return this.revealColumns(n),p}revealColumns(e){this.columnsHidden&&(e==null||e.revealColumns("colFlex"),this.columnsHidden=!1)}initCol(e){const{flex:t,initialFlex:i}=e.colDef;t!==void 0?e.flex=t:i!==void 0&&(e.flex=i)}setColFlex(e,t){e.flex=t??null,e.dispatchStateUpdatedEvent("flex")}};function qu(e,t,i){if(!t||!e)return;if(!i)return e[t];const s=t.split(".");let n=e;for(let o=0;o<s.length;o++){if(n==null)return;n=n[s[o]]}return n}var r3=["dateTimeString","dateString","text","number","boolean","date"],a3=class extends V{constructor(){super(...arguments),this.beanName="dataTypeSvc",this.dataTypeDefinitions={},this.isPendingInference=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[],this.columnDefinitionPropsPerDataType={number(){return{cellEditor:"agNumberCellEditor"}},boolean(){return{cellEditor:"agCheckboxCellEditor",cellRenderer:"agCheckboxCellRenderer",getFindText:()=>null,suppressKeyboardEvent:e=>!!e.colDef.editable&&e.event.key===H.SPACE}},date({formatValue:e}){return{cellEditor:"agDateCellEditor",keyCreator:e}},dateString({formatValue:e}){return{cellEditor:"agDateStringCellEditor",keyCreator:e}},dateTime(e){return this.date(e)},dateTimeString(e){return this.dateString(e)},object({formatValue:e,colModel:t,colId:i}){return{cellEditorParams:{useFormatter:!0},comparator:(s,n)=>{const o=t.getColDefCol(i),r=o==null?void 0:o.getColDef();if(!o||!r)return 0;const a=s==null?"":e({column:o,node:null,value:s}),l=n==null?"":e({column:o,node:null,value:n});return a===l?0:a>l?1:-1},keyCreator:e}},text(){return{}}}}wireBeans(e){this.colModel=e.colModel}postConstruct(){this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.colModel.recreateColumnDefs(e)})}processDataTypeDefinitions(){const e=this.getDefaultDataTypes(),t={},i={},s=d=>h=>{const{column:u,node:f,value:p}=h;let m=u.getColDef().valueFormatter;return m===d.groupSafeValueFormatter&&(m=d.valueFormatter),this.beans.valueSvc.formatValue(u,f,p,m)};for(const d of Object.keys(e)){const h=e[d],u={...h,groupSafeValueFormatter:YR(h,this.gos)};t[d]=u,i[d]=s(u)}const n=this.gos.get("dataTypeDefinitions")??{},o={};for(const d of Object.keys(n)){const h=n[d],u=this.processDataTypeDefinition(h,n,[d],e);u&&(t[d]=u,h.dataTypeMatcher&&(o[d]=h.dataTypeMatcher),i[d]=s(u))}const{valueParser:r,valueFormatter:a}=e.object,{valueParser:l,valueFormatter:c}=t.object;this.hasObjectValueParser=l!==r,this.hasObjectValueFormatter=c!==a,this.formatValueFuncs=i,this.dataTypeDefinitions=t,this.dataTypeMatchers=this.sortKeysInMatchers(o,e)}sortKeysInMatchers(e,t){const i={...e};for(const s of r3)delete i[s],i[s]=e[s]??t[s].dataTypeMatcher;return i}processDataTypeDefinition(e,t,i,s){let n;const o=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let r=s[o];const a=t[o];if(r&&a&&(r=a),!qR(e,r,o))return;n=KR(r,e)}else{if(i.includes(o)){j(44);return}const r=t[o];if(!qR(e,r,o))return;const a=this.processDataTypeDefinition(r,t,[...i,o],s);if(!a)return;n=KR(a,e)}return{...n,groupSafeValueFormatter:YR(n,this.gos)}}updateColDefAndGetColumnType(e,t,i){let{cellDataType:s}=t;const{field:n}=t;if(s===void 0&&(s=e.cellDataType),(s==null||s===!0)&&(s=this.canInferCellDataType(e,t)?this.inferCellDataType(n,i):!1),!s){e.cellDataType=!1;return}const o=this.dataTypeDefinitions[s];if(!o){j(47,{cellDataType:s});return}return e.cellDataType=s,o.groupSafeValueFormatter&&(e.valueFormatter=o.groupSafeValueFormatter),o.valueParser&&(e.valueParser=o.valueParser),o.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,s,o,i),o.columnTypes}addColumnListeners(e){if(!this.isPendingInference)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const i=s=>{t.add(s.key)};e.__addEventListener("columnStateUpdated",i),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.__removeEventListener("columnStateUpdated",i))}canInferCellDataType(e,t){const{gos:i}=this;if(!Ut(i))return!1;const s={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(WC(t,s))return!1;const n=t.type===null?e.type:t.type;if(n){const o=i.get("columnTypes")??{};if(Vm(n).some(a=>{const l=o[a.trim()];return l&&WC(l,s)}))return!1}return!WC(e,s)}inferCellDataType(e,t){if(!e)return;let i;const s=this.getInitialData();if(s){const o=e.includes(".")&&!this.gos.get("suppressFieldDotNotation");i=qu(s,e,o)}else this.initWaitForRowData(t);return i==null?void 0:Object.keys(this.dataTypeMatchers).find(o=>this.dataTypeMatchers[o](i))??"object"}getInitialData(){var t;const e=this.gos.get("rowData");if(e!=null&&e.length)return e[0];if(this.initialData)return this.initialData;{const i=(t=this.beans.rowModel.rootNode)==null?void 0:t._leafs;if(i!=null&&i.length)return i[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isPendingInference)return;this.isPendingInference=!0;const t=this.isColumnTypeOverrideInDataTypeDefinitions,{colAutosize:i,eventSvc:s}=this.beans;t&&i&&(i.shouldQueueResizeOperations=!0);const[n]=this.addManagedEventListeners({rowDataUpdateStarted:o=>{const{firstRowData:r}=o;r&&(n==null||n(),this.isPendingInference=!1,this.processColumnsPendingInference(r,t),this.columnStateUpdatesPendingInference={},t&&(i==null||i.processResizeOperations()),s.dispatchEvent({type:"dataTypesInferred"}))}})}processColumnsPendingInference(e,t){this.initialData=e;const i=[];this.destroyColumnStateUpdateListeners();const s={},n={};for(const o of Object.keys(this.columnStateUpdatesPendingInference)){const r=this.columnStateUpdatesPendingInference[o],a=this.colModel.getCol(o);if(!a)return;const l=a.getColDef();if(!this.resetColDefIntoCol(a,"cellDataTypeInferred"))return;const c=a.getColDef();if(t&&c.type&&c.type!==l.type){const d=c3(a,r);d.rowGroup&&d.rowGroupIndex==null&&(s[o]=d),d.pivot&&d.pivotIndex==null&&(n[o]=d),i.push(d)}}t&&i.push(...this.generateColumnStateForRowGroupAndPivotIndexes(s,n)),i.length&&In(this.beans,{state:i},"cellDataTypeInferred"),this.initialData=null}generateColumnStateForRowGroupAndPivotIndexes(e,t){const i={},{rowGroupColsSvc:s,pivotColsSvc:n}=this.beans;return s==null||s.restoreColumnOrder(i,e),n==null||n.restoreColumnOrder(i,t),Object.values(i)}resetColDefIntoCol(e,t){const i=e.getUserProvidedColDef();if(!i)return!1;const s=Kb(this.beans,i,e.getColId());return e.setColDef(s,i,t),!0}getDateStringTypeDefinition(e){const{dateString:t}=this.dataTypeDefinitions;return e?this.getDataTypeDefinition(e)??t:t}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDateIncludesTimeFlag(e){return e==="dateTime"||e==="dateTimeString"}getDataTypeDefinition(e){const t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){var t;return(t=this.getDataTypeDefinition(e))==null?void 0:t.baseDataType}checkType(e,t){var s;if(t==null)return!0;const i=(s=this.getDataTypeDefinition(e))==null?void 0:s.dataTypeMatcher;return i?i(t):!0}validateColDef(e){const t=i=>j(48,{property:i});if(e.cellDataType==="object"){const{object:i}=this.dataTypeDefinitions;e.valueFormatter===i.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&t("Formatter"),e.editable&&e.valueParser===i.valueParser&&!this.hasObjectValueParser&&t("Parser")}}postProcess(e){var r;const t=e.cellDataType;if(!t||typeof t!="string")return;const{dataTypeDefinitions:i,beans:s,formatValueFuncs:n}=this,o=i[t];o&&((r=s.colFilter)==null||r.setColDefPropsForDataType(e,o,n[t]))}getFormatValue(e){return this.formatValueFuncs[e]}isColPendingInference(e){return this.isPendingInference&&!!this.columnStateUpdatesPendingInference[e]}setColDefPropertiesForBaseDataType(e,t,i,s){const n=this.formatValueFuncs[t],o=this.columnDefinitionPropsPerDataType[i.baseDataType]({colDef:e,cellDataType:t,colModel:this.colModel,dataTypeDefinition:i,colId:s,formatValue:n});Object.assign(e,o)}getDateObjectTypeDef(e){const t=this.getLocaleTextFunc(),i=this.getDateIncludesTimeFlag(e);return{baseDataType:e,valueParser:s=>vs(s.newValue&&String(s.newValue)),valueFormatter:s=>s.value==null?"":!(s.value instanceof Date)||isNaN(s.value.getTime())?t("invalidDate","Invalid Date"):Os(s.value,i)??"",dataTypeMatcher:s=>s instanceof Date}}getDateStringTypeDef(e){const t=this.getDateIncludesTimeFlag(e);return{baseDataType:e,dateParser:i=>vs(i)??void 0,dateFormatter:i=>Os(i??null,t)??void 0,valueParser:i=>um(String(i.newValue))?i.newValue:null,valueFormatter:i=>um(String(i.value))?String(i.value):"",dataTypeMatcher:i=>typeof i=="string"&&um(i)}}getDefaultDataTypes(){const e=this.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:t=>{var i,s;return((s=(i=t.newValue)==null?void 0:i.trim)==null?void 0:s.call(i))===""?null:Number(t.newValue)},valueFormatter:t=>t.value==null?"":typeof t.value!="number"||isNaN(t.value)?e("invalidNumber","Invalid Number"):String(t.value),dataTypeMatcher:t=>typeof t=="number"},text:{baseDataType:"text",valueParser:t=>t.newValue===""?null:Gb(t.newValue),dataTypeMatcher:t=>typeof t=="string"},boolean:{baseDataType:"boolean",valueParser:t=>{var i,s;return t.newValue==null?t.newValue:((s=(i=t.newValue)==null?void 0:i.trim)==null?void 0:s.call(i))===""?null:String(t.newValue).toLowerCase()==="true"},valueFormatter:t=>t.value==null?"":String(t.value),dataTypeMatcher:t=>typeof t=="boolean"},date:this.getDateObjectTypeDef("date"),dateString:this.getDateStringTypeDef("dateString"),dateTime:this.getDateObjectTypeDef("dateTime"),dateTimeString:{...this.getDateStringTypeDef("dateTimeString"),dataTypeMatcher:t=>typeof t=="string"&&R2(t)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:t=>Gb(t.value)??""}}}destroyColumnStateUpdateListeners(){for(const e of this.columnStateUpdateListenerDestroyFuncs)e();this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}};function KR(e,t){const i={...e,...t};return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(i.columnTypes=[...Vm(e.columnTypes),...Vm(t.columnTypes)]),i}function qR(e,t,i){return t?t.baseDataType!==e.baseDataType?(j(46),!1):!0:(j(45,{parentCellDataType:i}),!1)}function YR(e,t){if(e.valueFormatter)return i=>{var s,n;if((s=i.node)!=null&&s.group){const o=(i.colDef.pivotValueColumn??i.column).getAggFunc();if(o){if(o==="first"||o==="last")return e.valueFormatter(i);if(e.baseDataType==="number"&&o!=="count"){if(typeof i.value=="number")return e.valueFormatter(i);if(typeof i.value=="object"){if(!i.value)return;if("toNumber"in i.value)return e.valueFormatter({...i,value:i.value.toNumber()});if("value"in i.value)return e.valueFormatter({...i,value:i.value.value})}}return}}else if(t.get("groupHideOpenParents")&&i.column.isRowGroupActive()&&typeof i.value=="string"&&!((n=e.dataTypeMatcher)!=null&&n.call(e,i.value)))return;return e.valueFormatter(i)}}function l3(e,t,i,s){if(!t[i])return!1;const n=e[i];return n===null?(t[i]=!1,!1):s===void 0?!!n:n===s}function WC(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([i,s])=>l3(e,t,i,s))}function c3(e,t){const i=tT(e);for(const s of t)delete i[s],s==="rowGroup"?delete i.rowGroupIndex:s==="pivot"&&delete i.pivotIndex;return i}var d3={moduleName:"DataType",version:ne,beans:[a3],dependsOn:[L$]},h3={moduleName:"ColumnFlex",version:ne,beans:[o3]},aD={moduleName:"ColumnApi",version:ne,beans:[n3],apiFunctions:{getColumnDef:N$,getDisplayNameForColumn:G$,getColumn:B$,getColumns:V$,applyColumnState:z$,getColumnState:W$,resetColumnState:$$,isPinning:U$,isPinningLeft:j$,isPinningRight:K$,getDisplayedColAfter:q$,getDisplayedColBefore:Y$,setColumnsVisible:X$,setColumnsPinned:Q$,getAllGridColumns:J$,getDisplayedLeftColumns:Z$,getDisplayedCenterColumns:e3,getDisplayedRightColumns:t3,getAllDisplayedColumns:i3,getAllDisplayedVirtualColumns:s3,getColumnDefs:H$}};function u3(e){if(!e||e==null)return null;const t=/([a-z])([A-Z])/g,i=/([A-Z]+)([A-Z])([a-z])/g;return e.replace(t,"$1 $2").replace(i,"$1 $2$3").replace(/\./g," ").split(" ").map(n=>n.substring(0,1).toUpperCase()+(n.length>1?n.substring(1,n.length):"")).join(" ")}var g3=class extends V{constructor(){super(...arguments),this.beanName="colNames"}getDisplayNameForColumn(e,t,i=!1){if(!e)return null;const s=this.getHeaderName(e.getColDef(),e,null,null,t),{aggColNameSvc:n}=this.beans;return i&&n?n.getHeaderName(e,s):s}getDisplayNameForProvidedColumnGroup(e,t,i){const s=t==null?void 0:t.getColGroupDef();return s?this.getHeaderName(s,null,e,t,i):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,i,s,n){var r;const o=e.headerValueGetter;if(o){const a=Fe(this.gos,{colDef:e,column:t,columnGroup:i,providedColumnGroup:s,location:n});return typeof o=="function"?o(a):typeof o=="string"?((r=this.beans.expressionSvc)==null?void 0:r.evaluate(o,a))??null:""}else{if(e.headerName!=null)return e.headerName;if(e.field)return u3(e.field)}return""}},f3=class extends V{constructor(){super(...arguments),this.beanName="colViewport",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.columnsToRenderLeft=[],this.columnsToRenderRight=[],this.columnsToRenderCenter=[]}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t,i=!1){const{visibleCols:s}=this,n=s.isBodyWidthDirty;if(!(e===this.scrollWidth&&t===this.scrollPosition&&!n)){if(this.scrollWidth=e,this.scrollPosition=t,s.isBodyWidthDirty=!0,this.gos.get("enableRtl")){const r=s.bodyWidth;this.viewportLeft=r-t-e,this.viewportRight=r-t}else this.viewportLeft=t,this.viewportRight=e+t;this.colModel.ready&&this.checkViewportColumns(i)}}getColumnHeadersToRender(e){switch(e){case"left":return this.columnsToRenderLeft;case"right":return this.columnsToRenderRight;default:return this.columnsToRenderCenter}}getHeadersToRender(e,t){let i;switch(e){case"left":i=this.rowsOfHeadersToRenderLeft[t];break;case"right":i=this.rowsOfHeadersToRenderRight[t];break;default:i=this.rowsOfHeadersToRenderCenter[t];break}return i??[]}extractViewportColumns(){const e=this.visibleCols.centerCols;this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(e){return e.isAutoHeaderHeight()||p3(e)?!0:this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,i=t+e.getActualWidth(),s=this.viewportLeft-200,n=this.viewportRight+200,o=t<s&&i<s,r=t>n&&i>n;return!o&&!r}getViewportColumns(){const{leftCols:e,rightCols:t}=this.visibleCols;return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.colModel.colSpanActive)return this.colsWithinViewport;const t=o=>{const r=o.getLeft();return ae(r)&&r>this.viewportLeft},i=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),{visibleCols:s}=this,n=s.centerCols;return s.getColsForRow(e,n,i,t)}checkViewportColumns(e=!1){this.extractViewport()&&this.eventSvc.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}calculateHeaderRows(){const{leftCols:e,rightCols:t}=this.visibleCols;this.columnsToRenderLeft=e,this.columnsToRenderRight=t,this.columnsToRenderCenter=this.colsWithinViewport;const i=s=>{const n=new Set,o={};for(const r of s){let a=r.getParent();const l=r.isSpanHeaderHeight();for(;a&&!n.has(a);){if(l&&a.isPadding()){a=a.getParent();continue}const d=a.getProvidedColumnGroup().getLevel();o[d]??(o[d]=[]),o[d].push(a),n.add(a),a=a.getParent()}}return o};this.rowsOfHeadersToRenderLeft=i(e),this.rowsOfHeadersToRenderRight=i(t),this.rowsOfHeadersToRenderCenter=i(this.headerColsWithinViewport)}extractViewport(){const e=s=>`${s.getId()}-${s.getPinned()||"normal"}`;this.extractViewportColumns();const t=this.getViewportColumns().map(e).join("#"),i=this.colsWithinViewportHash!==t;return i&&(this.colsWithinViewportHash=t,this.calculateHeaderRows()),i}};function p3(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}var m3=class extends V{constructor(){super(...arguments),this.beanName="agCompUtils"}adaptFunction(e,t){if(!e.cellRenderer)return null;class i{refresh(){return!1}getGui(){return this.eGui}init(n){const o=t(n),r=typeof o;if(r==="string"||r==="number"||r==="boolean"){this.eGui=oS("<span>"+o+"</span>");return}if(o==null){this.eGui=jt({tag:"span"});return}this.eGui=o}}return i}},v3={moduleName:"CellRendererFunction",version:ne,beans:[m3]},C3=class extends bB{constructor(){super(...arguments),this.agGridDefaults={},this.agGridDefaultOverrides={},this.jsComps={},this.selectors={},this.icons={}}postConstruct(){const e=this.gos.get("components");if(e!=null)for(const t of Object.keys(e))this.jsComps[t]=e[t]}registerModule(e){const{icons:t,userComponents:i,dynamicBeans:s,selectors:n}=e;if(i){const o=(r,a,l,c)=>{this.agGridDefaults[r]=a,(l||c)&&(this.agGridDefaultOverrides[r]={params:l,processParams:c})};for(const r of Object.keys(i)){let a=i[r];if(C2(a)&&(a=a.getComp(this.beans)),typeof a=="object"){const{classImp:l,params:c,processParams:d}=a;o(r,l,c,d)}else o(r,a)}}this.registerDynamicBeans(s);for(const o of n??[])this.selectors[o.selector]=o;if(t)for(const o of Object.keys(t))this.icons[o]=t[o]}getUserComponent(e,t){var a;const i=(l,c,d,h)=>({componentFromFramework:c,component:l,params:d,processParams:h}),{frameworkOverrides:s}=this.beans,n=s.frameworkComponent(t,this.gos.get("components"));if(n!=null)return i(n,!0);const o=this.jsComps[t];if(o){const l=s.isFrameworkComponent(o);return i(o,l)}const r=this.agGridDefaults[t];if(r){const l=this.agGridDefaultOverrides[t];return i(r,!1,l==null?void 0:l.params,l==null?void 0:l.processParams)}return(a=this.beans.validation)==null||a.missingUserComponent(e,t,this.agGridDefaults,this.jsComps),null}getSelector(e){return this.selectors[e]}getIcon(e){return this.icons[e]}getDynamicError(e,t){var i;return t?So(279,{name:e}):((i=this.beans.validation)==null?void 0:i.missingDynamicBean(e))??So(256)}},w3=23,b3=class extends V{constructor(){super(...arguments),this.beanName="ctrlsSvc",this.params={},this.ready=!1,this.readyCallbacks=[]}postConstruct(){var e,t;this.addEventListener("ready",()=>{if(this.updateReady(),this.ready){for(const i of this.readyCallbacks)i(this.params);this.readyCallbacks.length=0}},((t=(e=this.beans.frameworkOverrides).runWhenReadyAsync)==null?void 0:t.call(e))??!1)}updateReady(){const e=Object.values(this.params);this.ready=e.length===w3&&e.every(t=>(t==null?void 0:t.isAlive())??!1)}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc(()=>{const i=this.readyCallbacks.indexOf(t);i>=0&&this.readyCallbacks.splice(i,1)})}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc(()=>{this.updateReady()})}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){const{leftHeader:e,centerHeader:t,rightHeader:i}=this.params;return[e,i,t]}getHeaderRowContainerCtrl(e){const t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}getScrollFeature(){return this.getGridBodyCtrl().scrollFeature}},y3='.ag-aria-description-container{border:0;z-index:9999;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.ag-unselectable{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text}.ag-tab-guard{display:block;height:0;position:absolute;width:0}:where(.ag-virtual-list-viewport) .ag-tab-guard{position:sticky}.ag-tab-guard-top{top:1px}.ag-tab-guard-bottom{bottom:1px}.ag-shake-left-to-right{animation-direction:alternate;animation-duration:.2s;animation-iteration-count:infinite;animation-name:ag-shake-left-to-right}@keyframes ag-shake-left-to-right{0%{padding-left:6px;padding-right:2px}to{padding-left:2px;padding-right:6px}}.ag-body-horizontal-scroll-viewport,.ag-body-vertical-scroll-viewport,.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport,.ag-virtual-list-viewport{flex:1 1 auto;height:100%;min-width:0;overflow:hidden;position:relative}.ag-viewport{position:relative}.ag-spanning-container{position:absolute;top:0;z-index:1}.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{overflow-x:auto;-ms-overflow-style:none!important;scrollbar-width:none!important;&::-webkit-scrollbar{display:none!important}}.ag-body-viewport{display:flex;overflow-x:hidden;&:where(.ag-layout-normal){overflow-y:auto;-webkit-overflow-scrolling:touch}}.ag-floating-bottom-container,.ag-floating-top-container,.ag-sticky-bottom-container,.ag-sticky-top-container{min-height:1px}.ag-center-cols-viewport{min-height:100%;width:100%}.ag-body-horizontal-scroll-viewport{overflow-x:scroll}.ag-body-vertical-scroll-viewport{overflow-y:scroll}.ag-virtual-list-viewport{overflow:auto;width:100%}.ag-body-container,.ag-body-horizontal-scroll-container,.ag-body-vertical-scroll-container,.ag-center-cols-container,.ag-floating-bottom-container,.ag-floating-bottom-full-width-container,.ag-floating-top-container,.ag-full-width-container,.ag-header-container,.ag-pinned-left-cols-container,.ag-pinned-right-cols-container,.ag-sticky-bottom-container,.ag-sticky-top-container,.ag-virtual-list-container{position:relative}.ag-floating-bottom-container,.ag-floating-top-container,.ag-header-container,.ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top,.ag-sticky-bottom-container,.ag-sticky-top-container{height:100%;white-space:nowrap}.ag-center-cols-container,.ag-pinned-right-cols-container{display:block}.ag-body-horizontal-scroll-container{height:100%}.ag-body-vertical-scroll-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container,.ag-full-width-container,.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{pointer-events:none;position:absolute;top:0}:where(.ag-ltr) .ag-floating-bottom-full-width-container,:where(.ag-ltr) .ag-floating-top-full-width-container,:where(.ag-ltr) .ag-full-width-container,:where(.ag-ltr) .ag-sticky-bottom-full-width-container,:where(.ag-ltr) .ag-sticky-top-full-width-container{left:0}:where(.ag-rtl) .ag-floating-bottom-full-width-container,:where(.ag-rtl) .ag-floating-top-full-width-container,:where(.ag-rtl) .ag-full-width-container,:where(.ag-rtl) .ag-sticky-bottom-full-width-container,:where(.ag-rtl) .ag-sticky-top-full-width-container{right:0}.ag-full-width-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container{display:inline-block;height:100%;overflow:hidden;width:100%}.ag-virtual-list-container{overflow:hidden}.ag-body{display:flex;flex:1 1 auto;flex-direction:row!important;min-height:0;position:relative}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:flex;min-height:0;min-width:0;position:relative;&:where(.ag-scrollbar-invisible){bottom:0;position:absolute;&:where(.ag-apple-scrollbar){opacity:0;transition:opacity .4s;visibility:hidden;&:where(.ag-scrollbar-scrolling,.ag-scrollbar-active){opacity:1;visibility:visible}}}}.ag-body-horizontal-scroll{width:100%;&:where(.ag-scrollbar-invisible){left:0;right:0}}.ag-body-vertical-scroll{height:100%;&:where(.ag-scrollbar-invisible){top:0;z-index:10}}:where(.ag-ltr) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){right:0}}:where(.ag-rtl) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){left:0}}.ag-force-vertical-scroll{overflow-y:scroll!important}.ag-horizontal-left-spacer,.ag-horizontal-right-spacer{height:100%;min-width:0;overflow-x:scroll;&:where(.ag-scroller-corner){overflow-x:hidden}}:where(.ag-row-animation) .ag-row{transition:transform .4s,top .4s,opacity .2s;&:where(.ag-after-created){transition:transform .4s,top .4s,height .4s,opacity .2s}}:where(.ag-row-animation.ag-prevent-animation) .ag-row{transition:none!important;&:where(.ag-row.ag-after-created){transition:none!important}}:where(.ag-row-no-animation) .ag-row{transition:none}.ag-row-loading{align-items:center;display:flex}.ag-row-position-absolute{position:absolute}.ag-row-position-relative{position:relative}.ag-full-width-row{overflow:hidden;pointer-events:all}.ag-row-inline-editing{z-index:1}.ag-row-dragging{z-index:2}.ag-stub-cell{align-items:center;display:flex}.ag-cell{display:inline-block;height:100%;position:absolute;white-space:nowrap;&:focus-visible{box-shadow:none}}.ag-cell-value{flex:1 1 auto}.ag-cell-value:not(.ag-allow-overflow),.ag-group-value{overflow:hidden;text-overflow:ellipsis}.ag-cell-wrap-text{white-space:normal;word-break:break-word}:where(.ag-cell) .ag-icon{display:inline-block;vertical-align:middle}.ag-floating-top{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-top:not(.ag-invisible)){border-bottom:var(--ag-pinned-row-border)}.ag-floating-bottom{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-bottom:not(.ag-invisible)){border-top:var(--ag-pinned-row-border)}.ag-sticky-bottom,.ag-sticky-top{background-color:var(--ag-data-background-color);display:flex;height:0;overflow:hidden;position:absolute;width:100%;z-index:1}.ag-opacity-zero{opacity:0!important}.ag-cell-label-container{align-items:center;display:flex;flex-direction:row-reverse;height:100%;justify-content:space-between;width:100%}:where(.ag-right-aligned-header){.ag-cell-label-container{flex-direction:row}.ag-header-cell-text{text-align:end}}.ag-column-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr){direction:ltr;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row}}:where(.ag-rtl){direction:rtl;text-align:right;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row-reverse}.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{display:block}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(180deg)}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(-180deg)}}.ag-measurement-container{height:0;overflow:hidden;visibility:hidden;width:0}.ag-measurement-element-border{display:inline-block;&:before{border-left:var(--ag-internal-measurement-border);content:"";display:block}}.ag-group{position:relative;width:100%}.ag-group-title-bar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-title{display:inline;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-group-title-bar) .ag-group-title{cursor:default}.ag-group-toolbar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-container{display:flex}.ag-disabled .ag-group-container{pointer-events:none}.ag-disabled-group-container,.ag-disabled-group-title-bar{opacity:.5}.ag-group-container-horizontal{flex-flow:row wrap}.ag-group-container-vertical{flex-direction:column}.ag-group-title-bar-icon{cursor:pointer;flex:none}:where(.ag-ltr) .ag-group-title-bar-icon{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-group-title-bar-icon{margin-left:var(--ag-spacing)}:where(.ag-group-item-alignment-stretch) .ag-group-item{align-items:stretch}:where(.ag-group-item-alignment-start) .ag-group-item{align-items:flex-start}:where(.ag-group-item-alignment-end) .ag-group-item{align-items:flex-end}:where(.ag-ltr) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-left:var(--ag-row-group-indent-size)}:where(.ag-rtl) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-right:var(--ag-row-group-indent-size)}:where(.ag-ltr) .ag-row-group-leaf-indent{margin-left:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}:where(.ag-rtl) .ag-row-group-leaf-indent{margin-right:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-value-change-delta{padding:0 2px}.ag-value-change-delta-up{color:var(--ag-value-change-delta-up-color)}.ag-value-change-delta-down{color:var(--ag-value-change-delta-down-color)}.ag-value-change-value{background-color:transparent;border-radius:1px;padding-left:1px;padding-right:1px;transition:background-color 1s}.ag-value-change-value-highlight{background-color:var(--ag-value-change-value-highlight-background-color);transition:background-color .1s}.ag-cell-data-changed{background-color:var(--ag-value-change-value-highlight-background-color)!important}.ag-cell-data-changed-animation{background-color:transparent}.ag-cell-highlight{background-color:var(--ag-range-selection-highlight-color)!important}.ag-row,.ag-spanned-row{color:var(--ag-cell-text-color);font-family:var(--ag-cell-font-family);font-size:var(--ag-data-font-size);white-space:nowrap;--ag-internal-content-line-height:calc(min(var(--ag-row-height), var(--ag-line-height, 1000px)) - var(--ag-internal-row-border-width, 1px) - 2px)}.ag-row{background-color:var(--ag-data-background-color);border-bottom:var(--ag-row-border);height:var(--ag-row-height);width:100%;&.ag-row-editing-invalid{background-color:var(--ag-full-row-edit-invalid-background-color)}}:where(.ag-body-vertical-content-no-gap>div>div>div,.ag-body-vertical-content-no-gap>div>div>div>div)>.ag-row-last{border-bottom-color:transparent}.ag-sticky-bottom{border-top:var(--ag-row-border);box-sizing:content-box!important}.ag-group-contracted,.ag-group-expanded{cursor:pointer}.ag-cell,.ag-full-width-row .ag-cell-wrapper.ag-row-group{border:1px solid transparent;line-height:var(--ag-internal-content-line-height);-webkit-font-smoothing:subpixel-antialiased}:where(.ag-ltr) .ag-cell{border-right:var(--ag-column-border)}:where(.ag-rtl) .ag-cell{border-left:var(--ag-column-border)}.ag-spanned-cell-wrapper{background-color:var(--ag-data-background-color);position:absolute}.ag-spanned-cell-wrapper>.ag-spanned-cell{display:block;position:relative}:where(.ag-ltr) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-right-color:transparent}:where(.ag-rtl) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-left-color:transparent}.ag-cell-wrapper{align-items:center;display:flex;>:where(:not(.ag-cell-value,.ag-group-value)){align-items:center;display:flex;height:var(--ag-internal-content-line-height)}&:where(.ag-row-group){align-items:flex-start}:where(.ag-full-width-row) &:where(.ag-row-group){align-items:center;height:100%}}:where(.ag-ltr) .ag-cell-wrapper{padding-left:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-rtl) .ag-cell-wrapper{padding-right:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-cell-wrap-text:not(.ag-cell-auto-height)) .ag-cell-wrapper{align-items:normal;height:100%;:where(.ag-cell-value){height:100%}}:where(.ag-ltr) .ag-row>.ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}:where(.ag-rtl) .ag-row>.ag-cell-wrapper.ag-row-group{padding-right:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-cell-focus:not(.ag-cell-range-selected):focus-within,.ag-cell-range-single-cell,.ag-cell-range-single-cell.ag-cell-range-handle,.ag-context-menu-open .ag-cell-focus:not(.ag-cell-range-selected),.ag-context-menu-open .ag-full-width-row.ag-row-focus .ag-cell-wrapper.ag-row-group,.ag-full-width-row.ag-row-focus:focus .ag-cell-wrapper.ag-row-group{border:1px solid;border-color:var(--ag-range-selection-border-color);border-style:var(--ag-range-selection-border-style);outline:initial}.ag-full-width-row.ag-row-focus:focus{box-shadow:none}:where(.ag-ltr) .ag-group-contracted,:where(.ag-ltr) .ag-group-expanded,:where(.ag-ltr) .ag-row-drag,:where(.ag-ltr) .ag-selection-checkbox{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-contracted,:where(.ag-rtl) .ag-group-expanded,:where(.ag-rtl) .ag-row-drag,:where(.ag-rtl) .ag-selection-checkbox{margin-left:var(--ag-cell-widget-spacing)}:where(.ag-ltr) .ag-group-child-count{margin-left:3px}:where(.ag-rtl) .ag-group-child-count{margin-right:3px}.ag-row-highlight-above:after,.ag-row-highlight-below:after,.ag-row-highlight-inside:after{background-color:var(--ag-range-selection-border-color);content:"";height:1px;pointer-events:none;position:absolute;width:calc(100% - 1px)}:where(.ag-ltr) .ag-row-highlight-above:after,:where(.ag-ltr) .ag-row-highlight-below:after,:where(.ag-ltr) .ag-row-highlight-inside:after{left:1px}:where(.ag-rtl) .ag-row-highlight-above:after,:where(.ag-rtl) .ag-row-highlight-below:after,:where(.ag-rtl) .ag-row-highlight-inside:after{right:1px}.ag-row-highlight-above:after{top:0}.ag-row-highlight-below:after{bottom:0}.ag-row-highlight-indent:after{display:block;width:auto}:where(.ag-ltr) .ag-row-highlight-indent:after{left:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size));right:1px}:where(.ag-rtl) .ag-row-highlight-indent:after{left:1px;right:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size))}.ag-row-highlight-inside:after{background-color:var(--ag-selected-row-background-color);border:1px solid var(--ag-range-selection-border-color);display:block;height:auto;inset:0;width:auto}.ag-body,.ag-floating-bottom,.ag-floating-top{background-color:var(--ag-data-background-color)}.ag-row-odd{background-color:var(--ag-odd-row-background-color)}.ag-row-selected:before{background-color:var(--ag-selected-row-background-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-full-width-row.ag-row-group:before,.ag-row-hover:not(.ag-full-width-row):before{background-color:var(--ag-row-hover-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-row-selected:before{background-color:var(--ag-row-hover-color);background-image:linear-gradient(var(--ag-selected-row-background-color),var(--ag-selected-row-background-color))}.ag-row.ag-full-width-row.ag-row-group>*{position:relative}.ag-column-hover{background-color:var(--ag-column-hover-color)}.ag-header-range-highlight{background-color:var(--ag-range-header-highlight-color)}.ag-right-aligned-cell{font-variant-numeric:tabular-nums}:where(.ag-ltr) .ag-right-aligned-cell{text-align:right}:where(.ag-rtl) .ag-right-aligned-cell{text-align:left}.ag-right-aligned-cell .ag-cell-value,.ag-right-aligned-cell .ag-group-value{margin-left:auto}:where(.ag-ltr) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-ltr) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level));padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}:where(.ag-rtl) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-rtl) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-row>.ag-cell-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-row-dragging{cursor:move;opacity:.5}.ag-details-row{background-color:var(--ag-data-background-color);padding:calc(var(--ag-spacing)*3.75)}.ag-layout-auto-height,.ag-layout-print{.ag-center-cols-container,.ag-center-cols-viewport{min-height:150px}}.ag-overlay-loading-wrapper{background-color:var(--ag-modal-overlay-background-color)}.ag-skeleton-container{align-content:center;height:100%;width:100%}.ag-skeleton-effect{animation:ag-skeleton-loading 1.5s ease-in-out .5s infinite;background-color:var(--ag-row-loading-skeleton-effect-color);border-radius:.25rem;height:1em;width:100%}:where(.ag-ltr) .ag-right-aligned-cell .ag-skeleton-effect{margin-left:auto}:where(.ag-rtl) .ag-right-aligned-cell .ag-skeleton-effect{margin-right:auto}@keyframes ag-skeleton-loading{0%{background-color:var(--ag-row-loading-skeleton-effect-color)}50%{background-color:color-mix(in srgb,transparent,var(--ag-row-loading-skeleton-effect-color) 40%)}to{background-color:var(--ag-row-loading-skeleton-effect-color)}}.ag-loading{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-loading{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-loading{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-ltr) .ag-loading-icon{padding-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-loading-icon{padding-left:var(--ag-cell-widget-spacing)}.ag-icon-loading{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ag-header{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);color:var(--ag-header-text-color);display:flex;font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);overflow:hidden;white-space:nowrap;width:100%}.ag-header-row{height:var(--ag-header-height);position:absolute}.ag-floating-filter-button-button,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,:where(.ag-header-cell-sortable) .ag-header-cell-label{cursor:pointer}:where(.ag-ltr) .ag-header-expand-icon{margin-left:4px}:where(.ag-rtl) .ag-header-expand-icon{margin-right:4px}.ag-header-row:where(:not(:first-child)){:where(.ag-header-cell:not(.ag-header-span-height.ag-header-span-total,.ag-header-parent-hidden),.ag-header-group-cell.ag-header-group-cell-with-group){border-top:var(--ag-header-row-border)}}.ag-header-row:where(:not(.ag-header-row-column-group)){overflow:hidden}:where(.ag-header.ag-header-allow-overflow) .ag-header-row{overflow:visible}.ag-header-cell{display:inline-flex;overflow:hidden}.ag-header-group-cell{contain:paint;display:flex}.ag-header-cell,.ag-header-group-cell{align-items:center;gap:var(--ag-cell-widget-spacing);height:100%;padding:0 var(--ag-cell-horizontal-padding);position:absolute}@property --ag-internal-moving-color{syntax:"<color>";inherits:false;initial-value:transparent}@property --ag-internal-hover-color{syntax:"<color>";inherits:false;initial-value:transparent}.ag-header-cell:where(:not(.ag-floating-filter)),.ag-header-group-cell{&:before{background-image:linear-gradient(var(--ag-internal-hover-color),var(--ag-internal-hover-color)),linear-gradient(var(--ag-internal-moving-color),var(--ag-internal-moving-color));content:"";inset:0;position:absolute;--ag-internal-moving-color:transparent;--ag-internal-hover-color:transparent;transition:--ag-internal-moving-color var(--ag-header-cell-background-transition-duration),--ag-internal-hover-color var(--ag-header-cell-background-transition-duration)}&:where(:hover):before{--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}&:where(.ag-header-cell-moving):before{--ag-internal-moving-color:var(--ag-header-cell-moving-background-color);--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}}:where(.ag-header-cell:not(.ag-floating-filter) *,.ag-header-group-cell *){position:relative;z-index:1}.ag-header-cell-menu-button:where(:not(.ag-header-menu-always-show)){opacity:0;transition:opacity .2s}.ag-header-cell-filter-button,:where(.ag-header-cell.ag-header-active) .ag-header-cell-menu-button{opacity:1}.ag-header-cell-label,.ag-header-group-cell-label{align-items:center;align-self:stretch;display:flex;flex:1 1 auto;overflow:hidden;padding:5px 0}:where(.ag-ltr) .ag-sort-indicator-icon{padding-left:var(--ag-spacing)}:where(.ag-rtl) .ag-sort-indicator-icon{padding-right:var(--ag-spacing)}.ag-header-cell-label{text-overflow:ellipsis}.ag-header-group-cell-label.ag-sticky-label{flex:none;max-width:100%;overflow:visible;position:sticky}:where(.ag-ltr) .ag-header-group-cell-label.ag-sticky-label{left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-header-group-cell-label.ag-sticky-label{right:var(--ag-cell-horizontal-padding)}.ag-header-cell-text,.ag-header-group-text{overflow:hidden;text-overflow:ellipsis}.ag-header-cell-text{word-break:break-word}.ag-header-cell-comp-wrapper{width:100%}:where(.ag-header-group-cell) .ag-header-cell-comp-wrapper{display:flex}:where(.ag-header-cell:not(.ag-header-cell-auto-height)) .ag-header-cell-comp-wrapper{align-items:center;display:flex;height:100%}.ag-header-cell-wrap-text .ag-header-cell-comp-wrapper{white-space:normal}.ag-header-cell-comp-wrapper-limited-height>*{overflow:hidden}:where(.ag-right-aligned-header) .ag-header-cell-label{flex-direction:row-reverse}:where(.ag-ltr) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-ltr) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-header-cell:after,.ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{content:"";height:var(--ag-header-column-border-height);position:absolute;top:calc(50% - var(--ag-header-column-border-height)*.5);z-index:1}:where(.ag-ltr) .ag-header-cell:after,:where(.ag-ltr) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-right:var(--ag-header-column-border);right:0}:where(.ag-rtl) .ag-header-cell:after,:where(.ag-rtl) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-left:var(--ag-header-column-border);left:0}.ag-header-highlight-after:after,.ag-header-highlight-before:after{background-color:var(--ag-accent-color);content:"";height:100%;position:absolute;width:1px}:where(.ag-ltr) .ag-header-highlight-before:after{left:0}:where(.ag-rtl) .ag-header-highlight-before:after{right:0}:where(.ag-ltr) .ag-header-highlight-after:after{right:0;:where(.ag-pinned-left-header) &{right:1px}}:where(.ag-rtl) .ag-header-highlight-after:after{left:0;:where(.ag-pinned-left-header) &{left:1px}}.ag-header-cell-resize{align-items:center;cursor:ew-resize;display:flex;height:100%;position:absolute;top:0;width:8px;z-index:2;&:after{background-color:var(--ag-header-column-resize-handle-color);content:"";height:var(--ag-header-column-resize-handle-height);position:absolute;top:calc(50% - var(--ag-header-column-resize-handle-height)*.5);width:var(--ag-header-column-resize-handle-width);z-index:1}}:where(.ag-ltr) .ag-header-cell-resize{right:-3px;&:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-rtl) .ag-header-cell-resize{left:-3px;&:after{right:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-header-cell.ag-header-span-height) .ag-header-cell-resize:after{height:calc(100% - var(--ag-spacing)*4);top:calc(var(--ag-spacing)*2)}.ag-header-group-cell-no-group:where(.ag-header-span-height){display:none}.ag-sort-indicator-container{display:flex;gap:var(--ag-spacing)}.ag-layout-print{&.ag-body{display:block;height:unset}&.ag-root-wrapper{display:inline-block}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:none}&.ag-force-vertical-scroll{overflow-y:visible!important}}@media print{.ag-root-wrapper.ag-layout-print{display:table;.ag-body-horizontal-scroll-viewport,.ag-body-viewport,.ag-center-cols-container,.ag-center-cols-viewport,.ag-root,.ag-root-wrapper-body,.ag-virtual-list-viewport{display:block!important;height:auto!important;overflow:hidden!important}.ag-cell,.ag-row{-moz-column-break-inside:avoid;break-inside:avoid}}}ag-grid,ag-grid-angular{display:block}.ag-root-wrapper{border:var(--ag-wrapper-border);border-radius:var(--ag-wrapper-border-radius);display:flex;flex-direction:column;overflow:hidden;position:relative;&.ag-layout-normal{height:100%}}.ag-root-wrapper-body{display:flex;flex-direction:row;&.ag-layout-normal{flex:1 1 auto;height:0;min-height:0}}.ag-root{display:flex;flex-direction:column;position:relative;&.ag-layout-auto-height,&.ag-layout-normal{flex:1 1 auto;overflow:hidden;width:0}&.ag-layout-normal{height:100%}}.ag-virtual-list-item{height:var(--ag-list-item-height);position:absolute;width:100%}.ag-list-item-hovered:after{background-color:var(--ag-accent-color);content:"";height:1px;left:0;position:absolute;right:0}.ag-item-highlight-top:after{top:0}.ag-item-highlight-bottom:after{bottom:0}.ag-drag-handle{color:var(--ag-drag-handle-color);cursor:grab;:where(.ag-icon){color:var(--ag-drag-handle-color)}}.ag-chart-menu-icon,.ag-chart-settings-next,.ag-chart-settings-prev,.ag-column-group-icons,.ag-column-select-header-icon,.ag-filter-toolpanel-expand,.ag-floating-filter-button-button,.ag-group-title-bar-icon,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,.ag-panel-title-bar-button-icon,.ag-set-filter-group-icons,:where(.ag-group-contracted) .ag-icon,:where(.ag-group-expanded) .ag-icon{background-color:var(--ag-icon-button-background-color);border-radius:var(--ag-icon-button-border-radius);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-background-color);color:var(--ag-icon-button-color);&:hover{background-color:var(--ag-icon-button-hover-background-color);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-hover-background-color);color:var(--ag-icon-button-hover-color)}}.ag-filter-active{background-image:linear-gradient(var(--ag-icon-button-active-background-color),var(--ag-icon-button-active-background-color));border-radius:1px;outline:solid var(--ag-icon-button-background-spread) var(--ag-icon-button-active-background-color);position:relative;&:after{background-color:var(--ag-icon-button-active-indicator-color);border-radius:50%;content:"";height:6px;position:absolute;top:-1px;width:6px}:where(.ag-icon-filter){clip-path:path("M8,0C8,4.415 11.585,8 16,8L16,16L0,16L0,0L8,0Z");color:var(--ag-icon-button-active-color)}}:where(.ag-ltr) .ag-filter-active{&:after{right:-1px}}:where(.ag-rtl) .ag-filter-active{&:after{left:-1px}}.ag-menu{background-color:var(--ag-menu-background-color);border:var(--ag-menu-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-menu-shadow);color:var(--ag-menu-text-color);max-height:100%;overflow-y:auto;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}',S3={wrapperBorder:!0,rowBorder:!0,headerRowBorder:!0,footerRowBorder:{ref:"rowBorder"},columnBorder:{style:"solid",width:1,color:"transparent"},headerColumnBorder:!1,headerColumnBorderHeight:"100%",pinnedColumnBorder:!0,pinnedRowBorder:!0,sidePanelBorder:!0,sideBarPanelWidth:250,sideBarBackgroundColor:{ref:"chromeBackgroundColor"},sideButtonBarBackgroundColor:{ref:"sideBarBackgroundColor"},sideButtonBarTopPadding:0,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineColor:"transparent",sideButtonSelectedUnderlineTransitionDuration:0,sideButtonBackgroundColor:"transparent",sideButtonTextColor:{ref:"textColor"},sideButtonHoverBackgroundColor:{ref:"sideButtonBackgroundColor"},sideButtonHoverTextColor:{ref:"sideButtonTextColor"},sideButtonSelectedBackgroundColor:fs,sideButtonSelectedTextColor:{ref:"sideButtonTextColor"},sideButtonBorder:"solid 1px transparent",sideButtonSelectedBorder:!0,sideButtonLeftPadding:{ref:"spacing"},sideButtonRightPadding:{ref:"spacing"},sideButtonVerticalPadding:{calc:"spacing * 3"},headerBackgroundColor:{ref:"chromeBackgroundColor"},headerFontFamily:{ref:"fontFamily"},cellFontFamily:{ref:"fontFamily"},headerFontWeight:500,headerFontSize:{ref:"fontSize"},dataFontSize:{ref:"fontSize"},headerTextColor:{ref:"textColor"},headerCellHoverBackgroundColor:"transparent",headerCellMovingBackgroundColor:{ref:"headerCellHoverBackgroundColor"},headerCellBackgroundTransitionDuration:"0.2s",cellTextColor:{ref:"textColor"},rangeSelectionBorderStyle:"solid",rangeSelectionBorderColor:pr,rangeSelectionBackgroundColor:$n(.2),rangeSelectionChartBackgroundColor:"#0058FF1A",rangeSelectionChartCategoryBackgroundColor:"#00FF841A",rangeSelectionHighlightColor:$n(.5),rangeHeaderHighlightColor:eB(.08),rowNumbersSelectedColor:$n(.5),rowHoverColor:$n(.08),columnHoverColor:$n(.05),selectedRowBackgroundColor:$n(.12),modalOverlayBackgroundColor:{ref:"backgroundColor",mix:.66},dataBackgroundColor:fs,oddRowBackgroundColor:{ref:"dataBackgroundColor"},wrapperBorderRadius:8,cellHorizontalPadding:{calc:"spacing * 2 * cellHorizontalPaddingScale"},cellWidgetSpacing:{calc:"spacing * 1.5"},cellHorizontalPaddingScale:1,rowGroupIndentSize:{calc:"cellWidgetSpacing + iconSize"},valueChangeDeltaUpColor:"#43a047",valueChangeDeltaDownColor:"#e53935",valueChangeValueHighlightBackgroundColor:"#16a08580",rowHeight:{calc:"max(iconSize, dataFontSize) + spacing * 3.25 * rowVerticalPaddingScale"},rowVerticalPaddingScale:1,headerHeight:{calc:"max(iconSize, dataFontSize) + spacing * 4 * headerVerticalPaddingScale"},headerVerticalPaddingScale:1,paginationPanelHeight:{ref:"rowHeight",calc:"max(rowHeight, 22px)"},dragHandleColor:Vs(.7),headerColumnResizeHandleHeight:"30%",headerColumnResizeHandleWidth:2,headerColumnResizeHandleColor:{ref:"borderColor"},widgetContainerHorizontalPadding:{calc:"spacing * 1.5"},widgetContainerVerticalPadding:{calc:"spacing * 1.5"},widgetHorizontalSpacing:{calc:"spacing * 1.5"},widgetVerticalSpacing:{ref:"spacing"},iconButtonColor:{ref:"iconColor"},iconButtonBackgroundColor:"transparent",iconButtonBackgroundSpread:4,iconButtonBorderRadius:1,iconButtonHoverColor:{ref:"iconButtonColor"},iconButtonHoverBackgroundColor:Vs(.1),iconButtonActiveColor:pr,iconButtonActiveBackgroundColor:$n(.28),iconButtonActiveIndicatorColor:pr,menuBorder:{color:Vs(.2)},menuBackgroundColor:Js(.03),menuTextColor:Js(.95),menuShadow:{ref:"popupShadow"},menuSeparatorColor:{ref:"borderColor"},setFilterIndentSize:{ref:"iconSize"},chartMenuPanelWidth:260,chartMenuLabelColor:Vs(.8),dialogShadow:{ref:"popupShadow"},cellEditingBorder:{color:pr},cellEditingShadow:{ref:"cardShadow"},fullRowEditInvalidBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.25},dialogBorder:{color:Vs(.2)},panelBackgroundColor:fs,panelTitleBarHeight:{ref:"headerHeight"},panelTitleBarBackgroundColor:{ref:"headerBackgroundColor"},panelTitleBarIconColor:{ref:"headerTextColor"},panelTitleBarTextColor:{ref:"headerTextColor"},panelTitleBarFontWeight:{ref:"headerFontWeight"},panelTitleBarBorder:!0,columnSelectIndentSize:{ref:"iconSize"},toolPanelSeparatorBorder:!0,columnDropCellBackgroundColor:Vs(.07),columnDropCellTextColor:{ref:"textColor"},columnDropCellDragHandleColor:{ref:"textColor"},columnDropCellBorder:{color:Vs(.13)},selectCellBackgroundColor:Vs(.07),selectCellBorder:{color:Vs(.13)},advancedFilterBuilderButtonBarBorder:!0,advancedFilterBuilderIndentSize:{calc:"spacing * 2 + iconSize"},advancedFilterBuilderJoinPillColor:"#f08e8d",advancedFilterBuilderColumnPillColor:"#a6e194",advancedFilterBuilderOptionPillColor:"#f3c08b",advancedFilterBuilderValuePillColor:"#85c0e4",filterPanelApplyButtonColor:fs,filterPanelApplyButtonBackgroundColor:pr,filterPanelCardSubtleColor:{ref:"textColor",mix:.7},filterPanelCardSubtleHoverColor:{ref:"textColor"},findMatchColor:gd,findMatchBackgroundColor:"#ffff00",findActiveMatchColor:gd,findActiveMatchBackgroundColor:"#ffa500",filterToolPanelGroupIndent:{ref:"spacing"},rowLoadingSkeletonEffectColor:Vs(.15),statusBarLabelColor:gd,statusBarLabelFontWeight:500,statusBarValueColor:gd,statusBarValueFontWeight:500,pinnedSourceRowTextColor:{ref:"textColor"},pinnedSourceRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedSourceRowFontWeight:600,pinnedRowFontWeight:600,pinnedRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedRowTextColor:{ref:"textColor"}},R3=".ag-cell-batch-edit{background-color:var(--ag-cell-batch-edit-background-color);color:var(--ag-cell-batch-edit-text-color);display:inherit}.ag-row-batch-edit{background-color:var(--ag-row-batch-edit-background-color);color:var(--ag-row-batch-edit-text-color)}",lD={cellBatchEditBackgroundColor:"rgba(220 181 139 / 16%)",cellBatchEditTextColor:"#422f00",rowBatchEditBackgroundColor:{ref:"cellBatchEditBackgroundColor"},rowBatchEditTextColor:{ref:"cellBatchEditTextColor"}},x3={...lD,cellBatchEditTextColor:"#f3d0b3"},E3=()=>Ro({feature:"batchEditStyle",params:lD,css:R3}),A3=E3(),F3=":where(.ag-button){background:none;border:none;color:inherit;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0;text-indent:inherit;text-shadow:inherit;text-transform:inherit;word-spacing:inherit;&:disabled{cursor:default}&:focus-visible{box-shadow:var(--ag-focus-shadow);outline:none}}.ag-standard-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--ag-button-background-color);border:var(--ag-button-border);border-radius:var(--ag-button-border-radius);color:var(--ag-button-text-color);cursor:pointer;font-weight:var(--ag-button-font-weight);padding:var(--ag-button-vertical-padding) var(--ag-button-horizontal-padding);&:hover{background-color:var(--ag-button-hover-background-color);border:var(--ag-button-hover-border);color:var(--ag-button-hover-text-color)}&:active{background-color:var(--ag-button-active-background-color);border:var(--ag-button-active-border);color:var(--ag-button-active-text-color)}&:disabled{background-color:var(--ag-button-disabled-background-color);border:var(--ag-button-disabled-border);color:var(--ag-button-disabled-text-color)}}",P3={buttonTextColor:"inherit",buttonFontWeight:"normal",buttonBackgroundColor:"transparent",buttonBorder:!1,buttonBorderRadius:{ref:"borderRadius"},buttonHorizontalPadding:{calc:"spacing * 2"},buttonVerticalPadding:{ref:"spacing"},buttonHoverTextColor:{ref:"buttonTextColor"},buttonHoverBackgroundColor:{ref:"buttonBackgroundColor"},buttonHoverBorder:{ref:"buttonBorder"},buttonActiveTextColor:{ref:"buttonHoverTextColor"},buttonActiveBackgroundColor:{ref:"buttonHoverBackgroundColor"},buttonActiveBorder:{ref:"buttonHoverBorder"},buttonDisabledTextColor:{ref:"inputDisabledTextColor"},buttonDisabledBackgroundColor:{ref:"inputDisabledBackgroundColor"},buttonDisabledBorder:{ref:"inputDisabledBorder"}},T3=()=>Ro({feature:"buttonStyle",params:{...P3,buttonBackgroundColor:fs,buttonBorder:!0,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBorder:{color:pr}},css:F3}),D3=T3(),M3=".ag-column-drop-vertical-empty-message{align-items:center;border:dashed var(--ag-border-width);border-color:var(--ag-border-color);display:flex;inset:0;justify-content:center;margin:calc(var(--ag-spacing)*1.5) calc(var(--ag-spacing)*2);overflow:hidden;padding:calc(var(--ag-spacing)*2);position:absolute}",I3=()=>Ro({feature:"columnDropStyle",css:M3}),cD=I3(),k3={warn:(...e)=>{j(e[0],e[1])},error:(...e)=>{ut(e[0],e[1])},preInitErr:(...e)=>{Iu(e[0],e[2],e[1])}},_3=()=>hB(k3).withParams(S3).withPart(D3).withPart(cD).withPart(A3),L3='.ag-checkbox-input-wrapper,.ag-radio-button-input-wrapper{background-color:var(--ag-checkbox-unchecked-background-color);border:solid var(--ag-checkbox-border-width) var(--ag-checkbox-unchecked-border-color);flex:none;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);:where(input){-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:block;height:var(--ag-icon-size);margin:0;opacity:0;width:var(--ag-icon-size)}&:after{content:"";display:block;inset:0;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;pointer-events:none;position:absolute}&:where(.ag-checked){background-color:var(--ag-checkbox-checked-background-color);border-color:var(--ag-checkbox-checked-border-color);&:after{background-color:var(--ag-checkbox-checked-shape-color)}}&:where(:focus-within,:active){box-shadow:var(--ag-focus-shadow)}&:where(.ag-disabled){filter:grayscale();opacity:.5}}.ag-checkbox-input-wrapper{border-radius:var(--ag-checkbox-border-radius);&:where(.ag-checked):after{-webkit-mask-image:var(--ag-checkbox-checked-shape-image);mask-image:var(--ag-checkbox-checked-shape-image)}&:where(.ag-indeterminate){background-color:var(--ag-checkbox-indeterminate-background-color);border-color:var(--ag-checkbox-indeterminate-border-color);&:after{background-color:var(--ag-checkbox-indeterminate-shape-color);-webkit-mask-image:var(--ag-checkbox-indeterminate-shape-image);mask-image:var(--ag-checkbox-indeterminate-shape-image)}}}.ag-cell-editing-error .ag-checkbox-input-wrapper:focus-within{box-shadow:var(--ag-focus-error-shadow)}.ag-radio-button-input-wrapper{border-radius:100%;&:where(.ag-checked):after{-webkit-mask-image:var(--ag-radio-checked-shape-image);mask-image:var(--ag-radio-checked-shape-image)}}',O3=()=>Ro({feature:"checkboxStyle",params:{checkboxBorderWidth:1,checkboxBorderRadius:{ref:"borderRadius"},checkboxUncheckedBackgroundColor:fs,checkboxUncheckedBorderColor:Js(.3),checkboxCheckedBackgroundColor:pr,checkboxCheckedBorderColor:{ref:"checkboxCheckedBackgroundColor"},checkboxCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="7" fill="none"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M1 3.5 3.5 6l5-5"/></svg>'},checkboxCheckedShapeColor:fs,checkboxIndeterminateBackgroundColor:Js(.3),checkboxIndeterminateBorderColor:{ref:"checkboxIndeterminateBackgroundColor"},checkboxIndeterminateShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="2" fill="none"><rect width="10" height="2" fill="#000" rx="1"/></svg>'},checkboxIndeterminateShapeColor:fs,radioCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" fill="none"><circle cx="3" cy="3" r="3" fill="#000"/></svg>'}},css:L3}),N3=O3(),dD=()=>({...Um,...x3,backgroundColor:"hsl(217, 0%, 17%)",foregroundColor:"#FFF",chromeBackgroundColor:Js(.05),rowHoverColor:$n(.15),selectedRowBackgroundColor:$n(.2),menuBackgroundColor:Js(.1),browserColorScheme:"dark",popupShadow:"0 0px 20px #000A",cardShadow:"0 1px 4px 1px #000A",advancedFilterBuilderJoinPillColor:"#7a3a37",advancedFilterBuilderColumnPillColor:"#355f2d",advancedFilterBuilderOptionPillColor:"#5a3168",advancedFilterBuilderValuePillColor:"#374c86",filterPanelApplyButtonColor:gd,findMatchColor:fs,findActiveMatchColor:fs,checkboxUncheckedBorderColor:Js(.4),toggleButtonOffBackgroundColor:Js(.4),rowBatchEditBackgroundColor:Js(.1)}),H3=()=>({...dD(),backgroundColor:"#1f2836"}),G3=()=>Ro({feature:"colorScheme",params:Um,modeParams:{light:Um,dark:dD(),"dark-blue":H3()}}),B3=G3(),hD={aggregation:'<path d="M18 7V4H6l6 8-6 8h12v-3"/>',arrows:'<polyline points="5 9 2 12 5 15"/><polyline points="9 5 12 2 15 5"/><polyline points="15 19 12 22 9 19"/><polyline points="19 9 22 12 19 15"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/>',asc:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',cancel:'<path d="m18 6-12 12"/><path d="m6 6 12 12"/>',chart:'<line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/>',"color-picker":'<path d="m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z"/><path d="m5 2 5 5"/><path d="M2 13h15"/><path d="M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z"/>',columns:'<path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>',contracted:'<path d="m9 18 6-6-6-6"/>',copy:'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>',cross:'<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',csv:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',cut:'<circle cx="6" cy="6" r="3"/><path d="M8.12 8.12 12 12"/><path d="M20 4 8.12 15.88"/><circle cx="6" cy="18" r="3"/><path d="M14.8 14.8 20 20"/>',desc:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',down:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',excel:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',expanded:'<path d="m15 18-6-6 6-6"/>',"eye-slash":'<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>',eye:'<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',filter:'<path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/>',first:'<path d="m17 18-6-6 6-6"/><path d="M7 6v12"/>',group:'<path d="M16 12H3"/><path d="M16 18H3"/><path d="M10 6H3"/><path d="M21 18V8a2 2 0 0 0-2-2h-5"/><path d="m16 8-2-2 2-2"/>',last:'<path d="m7 18 6-6-6-6"/><path d="M17 6v12"/>',left:'<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>',linked:'<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>',loading:'<line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/>',maximize:'<polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/>',menu:'<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',"menu-alt":'<circle cx="12" cy="5" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="12" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="19" r="0.75" fill="#D9D9D9"/>',minimize:'<polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" x2="21" y1="10" y2="3"/><line x1="3" x2="10" y1="21" y2="14"/>',minus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/>',next:'<path d="m9 18 6-6-6-6"/>',none:'<path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/>',"not-allowed":'<circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/>',paste:'<path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/><path d="m17 10 4 4-4 4"/>',pin:'<line x1="12" x2="12" y1="17" y2="22"/><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"/>',pivot:'<path d="M15 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M21 9H3"/><path d="M21 15H3"/>',plus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/>',previous:'<path d="m15 18-6-6 6-6"/>',right:'<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',save:'<path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/>',"small-left":'<path d="m15 18-6-6 6-6"/>',"small-right":'<path d="m9 18 6-6-6-6"/>',tick:'<path d="M20 6 9 17l-5-5"/>',"tree-closed":'<path d="m9 18 6-6-6-6"/>',"tree-indeterminate":'<path d="M5 12h14"/>',"tree-open":'<path d="m6 9 6 6 6-6"/>',unlinked:'<path d="M9 17H7A5 5 0 0 1 7 7"/><path d="M15 7h2a5 5 0 0 1 4 8"/><line x1="8" x2="12" y1="12" y2="12"/><line x1="2" x2="22" y1="2" y2="22"/>',up:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',grip:'<circle cx="5" cy="8" r="0.5"/><circle cx="12" cy="8" r="0.5"/><circle cx="19" cy="8" r="0.5"/><circle cx="5" cy="16" r="0.5"/><circle cx="12" cy="16" r="0.5"/><circle cx="19" cy="16" r="0.5"/><g stroke="none" fill="currentColor"><circle cx="5" cy="8" r="1"/><circle cx="12" cy="8" r="1"/><circle cx="19" cy="8" r="1"/><circle cx="5" cy="16" r="1"/><circle cx="12" cy="16" r="1"/><circle cx="19" cy="16" r="1"/></g>',settings:'<path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/>'},uD={"column-arrow":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 32 32"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 26C0 28.2092 1.79086 30 4 30H14C16.2091 30 18 28.2092 18 26V15H25.8786L24.4394 16.4393C23.8536 17.0251 23.8536 17.9749 24.4394 18.5607C25.0252 19.1464 25.9748 19.1464 26.5606 18.5607L30.5606 14.5607C31.1464 13.9749 31.1464 13.0251 30.5606 12.4393L26.5606 8.43934C25.9748 7.85356 25.0252 7.85356 24.4394 8.43934C23.8536 9.02512 23.8536 9.97488 24.4394 10.5607L25.8786 12H18V6C18 3.79086 16.2091 2 14 2H4C1.79086 2 0 3.79086 0 6V26ZM14 5H10.5V12H15V6C15 5.44772 14.5523 5 14 5ZM4 5H7.5V12H3V6C3 5.44772 3.44772 5 4 5ZM10.5 15H15V26C15 26.5522 14.5523 27 14 27H10.5V15ZM4 27H7.5V15H3V26C3 26.5522 3.44772 27 4 27Z" fill="currentColor"/></svg>',"small-down":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 10.667 16 21.334l8.667-10.667H7.334Z"/></svg>',"small-up":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 21.333 16 10.666l8.667 10.667H7.334Z"/></svg>',"pinned-top":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.53 3.72A.75.75 0 0 1 12 5H4a.75.75 0 0 1 0-1.5h8a.75.75 0 0 1 .53.22ZM3.269 10.744a.75.75 0 0 1 .2-.524l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 1 1-1.06 1.06L8.75 8.56V14a.75.75 0 0 1-1.5 0V8.56l-2.72 2.72a.75.75 0 0 1-1.26-.536Z"/></svg>',"pinned-bottom":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M3.47 12.28A.75.75 0 0 1 4 11h8a.75.75 0 0 1 0 1.5H4a.75.75 0 0 1-.53-.22ZM12.731 5.256a.75.75 0 0 1-.2.524l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 1 1 1.06-1.06l2.72 2.72V2a.75.75 0 0 1 1.5 0v5.44l2.72-2.72a.75.75 0 0 1 1.26.536Z"/></svg>',"un-pin":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M8 11a.75.75 0 0 0-.75.75v3.333a.75.75 0 1 0 1.5 0V11.75A.75.75 0 0 0 8 11Z"/><path fill="currentColor" d="M13.11 1.436a.75.75 0 0 0-1.22-.872l-10 14a.75.75 0 1 0 1.22.872L5.207 12.5h7.376a.75.75 0 0 0 .75-.75v-1.174a2.08 2.08 0 0 0-1.153-1.863l-1.185-.599-.005-.002a.58.58 0 0 1-.323-.522V5.165a2.083 2.083 0 0 0 1.854-2.904l.589-.825Zm-3.943 5.52v.634a2.08 2.08 0 0 0 1.153 1.863l1.185.6.005.002a.58.58 0 0 1 .323.522V11H6.28l2.887-4.044ZM9.277 1H5.25a2.084 2.084 0 0 0-.083 4.165v1.676l1.5-2.132v-.292a.75.75 0 0 0-.75-.75H5.25a.584.584 0 0 1 0-1.167h2.972L9.277 1Z"/></svg>',"chevron-down":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 6L8 10L4 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-up":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 10L8 6L12 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-left":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-right":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"filter-add":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.12126 7.75L10.8517 7.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M6.65934 11.748L9.32778 11.748" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M12.2943 1.04872V6.19184M14.9886 3.74341H9.68478" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M8.25488 3C8.04799 3.18323 7.91706 3.45099 7.91699 3.74902C7.91713 4.04868 8.04988 4.31681 8.25879 4.5H2C1.58579 4.5 1.25 4.16421 1.25 3.75C1.25 3.33579 1.58579 3 2 3H8.25488Z" fill="currentColor"/></svg>',edit:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 10.6262V12.5012H5.375L10.905 6.97122L9.03 5.09622L3.5 10.6262ZM12.355 5.52122C12.4014 5.47497 12.4381 5.42002 12.4632 5.35953C12.4883 5.29905 12.5012 5.23421 12.5012 5.16872C12.5012 5.10324 12.4883 5.0384 12.4632 4.97791C12.4381 4.91742 12.4014 4.86248 12.355 4.81622L11.185 3.64622C11.1387 3.59987 11.0838 3.5631 11.0233 3.53801C10.9628 3.51291 10.898 3.5 10.8325 3.5C10.767 3.5 10.7022 3.51291 10.6417 3.53801C10.5812 3.5631 10.5263 3.59987 10.48 3.64622L9.565 4.56122L11.44 6.43622L12.355 5.52122Z" fill="currentColor"/></svg>'},V3=(e={})=>{let t="";for(const i of[...Object.keys(hD),...Object.keys(uD)]){const s=z3(i,e.strokeWidth);t+=`.ag-icon-${i}::before { mask-image: url('data:image/svg+xml,${encodeURIComponent(s)}'); }
`}return t},z3=(e,t=1.5)=>{const i=uD[e];if(i)return i;const s=hD[e];if(!s)throw new Error(`Missing icon data for ${e}`);return`<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="black" stroke-width="${t}" viewBox="0 0 24 24"><style>* { vector-effect: non-scaling-stroke; }</style>`+s+"</svg>"},W3=(e={})=>Ro({feature:"iconSet",css:()=>V3(e)}),$3=W3(),U3=':where(.ag-input-field-input[type=number]:not(.ag-number-field-input-stepper)){-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}}.ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);color:var(--ag-input-text-color);font-family:inherit;font-size:inherit;line-height:inherit;margin:0;min-height:var(--ag-input-height);padding:0;&:where(:disabled){background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}&:where(:focus){background-color:var(--ag-input-focus-background-color);border:var(--ag-input-focus-border);box-shadow:var(--ag-input-focus-shadow);color:var(--ag-input-focus-text-color);outline:none}&:where(:invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&::-moz-placeholder{color:var(--ag-input-placeholder-text-color)}&::placeholder{color:var(--ag-input-placeholder-text-color)}}:where(.ag-ltr) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-left:var(--ag-input-padding-start)}:where(.ag-rtl) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-right:var(--ag-input-padding-start)}:where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{background-color:currentcolor;color:var(--ag-input-icon-color);content:"";display:block;height:12px;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;opacity:.5;position:absolute;width:12px}}:where(.ag-ltr) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-left:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-left:calc(var(--ag-spacing)*1.5 + 12px)}}:where(.ag-rtl) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-right:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-right:calc(var(--ag-spacing)*1.5 + 12px)}}',j3=".ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){&:focus{box-shadow:var(--ag-focus-shadow);&:where(.invalid),&:where(:invalid){box-shadow:var(--ag-focus-error-shadow)}}}",K3={inputBackgroundColor:"transparent",inputBorder:!1,inputBorderRadius:0,inputTextColor:{ref:"textColor"},inputPlaceholderTextColor:{ref:"inputTextColor",mix:.5},inputPaddingStart:0,inputHeight:{calc:"max(iconSize, fontSize) + spacing * 2"},inputFocusBackgroundColor:{ref:"inputBackgroundColor"},inputFocusBorder:{ref:"inputBorder"},inputFocusShadow:"none",inputFocusTextColor:{ref:"inputTextColor"},inputDisabledBackgroundColor:{ref:"inputBackgroundColor"},inputDisabledBorder:{ref:"inputBorder"},inputDisabledTextColor:{ref:"inputTextColor"},inputInvalidBackgroundColor:{ref:"inputBackgroundColor"},inputInvalidBorder:{ref:"inputBorder"},inputInvalidTextColor:{ref:"inputTextColor"},inputIconColor:{ref:"inputTextColor"},pickerButtonBorder:!1,pickerButtonFocusBorder:{ref:"inputFocusBorder"},pickerButtonBackgroundColor:{ref:"backgroundColor"},pickerButtonFocusBackgroundColor:{ref:"backgroundColor"},pickerListBorder:!1,pickerListBackgroundColor:{ref:"backgroundColor"},colorPickerThumbSize:18,colorPickerTrackSize:12,colorPickerThumbBorderWidth:3,colorPickerTrackBorderRadius:12,colorPickerColorBorderRadius:4},q3=()=>Ro({feature:"inputStyle",params:{...K3,inputBackgroundColor:fs,inputBorder:!0,inputBorderRadius:{ref:"borderRadius"},inputPaddingStart:{ref:"spacing"},inputFocusBorder:{color:pr},inputFocusShadow:{ref:"focusShadow"},inputDisabledBackgroundColor:Js(.06),inputDisabledTextColor:{ref:"textColor",mix:.5},inputInvalidBorder:{color:{ref:"invalidColor"}},pickerButtonBorder:!0,pickerListBorder:!0},css:()=>U3+j3}),Y3=q3(),X3='.ag-tabs-header{background-color:var(--ag-tab-bar-background-color);border-bottom:var(--ag-tab-bar-border);display:flex;flex:1;gap:var(--ag-tab-spacing);padding:var(--ag-tab-bar-top-padding) var(--ag-tab-bar-horizontal-padding) 0}.ag-tabs-header-wrapper{display:flex}.ag-tabs-close-button-wrapper{align-items:center;border:0;display:flex;padding:var(--ag-spacing)}:where(.ag-ltr) .ag-tabs-close-button-wrapper{border-right:solid var(--ag-border-width) var(--ag-border-color)}:where(.ag-rtl) .ag-tabs-close-button-wrapper{border-left:solid var(--ag-border-width) var(--ag-border-color)}.ag-tabs-close-button{background-color:unset;border:0;cursor:pointer;padding:0}.ag-tab{align-items:center;background-color:var(--ag-tab-background-color);border-left:var(--ag-tab-selected-border-width) solid transparent;border-right:var(--ag-tab-selected-border-width) solid transparent;color:var(--ag-tab-text-color);cursor:pointer;display:flex;flex:1;justify-content:center;padding:var(--ag-tab-top-padding) var(--ag-tab-horizontal-padding) var(--ag-tab-bottom-padding);position:relative;&:hover{background-color:var(--ag-tab-hover-background-color);color:var(--ag-tab-hover-text-color)}&.ag-tab-selected{background-color:var(--ag-tab-selected-background-color);color:var(--ag-tab-selected-text-color)}&:after{background-color:var(--ag-tab-selected-underline-color);bottom:0;content:"";display:block;height:var(--ag-tab-selected-underline-width);left:0;opacity:0;position:absolute;right:0;transition:opacity var(--ag-tab-selected-underline-transition-duration)}&.ag-tab-selected:after{opacity:1}}:where(.ag-ltr) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-left-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-right-color:var(--ag-tab-selected-border-color)}}}:where(.ag-rtl) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-right-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-left-color:var(--ag-tab-selected-border-color)}}}',Q3={tabBarBackgroundColor:"transparent",tabBarHorizontalPadding:0,tabBarTopPadding:0,tabBackgroundColor:"transparent",tabTextColor:{ref:"textColor"},tabHorizontalPadding:{ref:"spacing"},tabTopPadding:{ref:"spacing"},tabBottomPadding:{ref:"spacing"},tabSpacing:"0",tabHoverBackgroundColor:{ref:"tabBackgroundColor"},tabHoverTextColor:{ref:"tabTextColor"},tabSelectedBackgroundColor:{ref:"tabBackgroundColor"},tabSelectedTextColor:{ref:"tabTextColor"},tabSelectedBorderWidth:{ref:"borderWidth"},tabSelectedBorderColor:"transparent",tabSelectedUnderlineColor:"transparent",tabSelectedUnderlineWidth:0,tabSelectedUnderlineTransitionDuration:0,tabBarBorder:!1},J3=()=>Ro({feature:"tabStyle",params:{...Q3,tabBarBorder:!0,tabBarBackgroundColor:Vs(.05),tabTextColor:{ref:"textColor",mix:.7},tabSelectedTextColor:{ref:"textColor"},tabHoverTextColor:{ref:"textColor"},tabSelectedBorderColor:{ref:"borderColor"},tabSelectedBackgroundColor:fs},css:X3}),Z3=J3(),eU=()=>_3().withPart(N3).withPart(B3).withPart($3).withPart(Z3).withPart(Y3).withPart(cD).withParams({fontFamily:[{googleFont:"IBM Plex Sans"},"-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu"]}),tU=eU(),iU={cssName:"--ag-cell-horizontal-padding",changeKey:"cellHorizontalPaddingChanged",defaultValue:16},sU={cssName:"--ag-indentation-level",changeKey:"indentationLevelChanged",defaultValue:0,noWarn:!0,cacheDefault:!0},nU={cssName:"--ag-row-group-indent-size",changeKey:"rowGroupIndentSizeChanged",defaultValue:0},XR={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},QR={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},JR={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},$C={cssName:"--ag-row-border",changeKey:"rowBorderWidthChanged",defaultValue:1,border:!0},ZR={cssName:"--ag-pinned-row-border",changeKey:"pinnedRowBorderWidthChanged",defaultValue:1,border:!0};function oU(e,t){for(const i of t.sort((s,n)=>s.moduleName.localeCompare(n.moduleName))){const s=i.css;s&&e.set(`module-${i.moduleName}`,s)}}var rU=class extends wB{constructor(){super(...arguments),this.sizeEls=new Map,this.lastKnownValues=new Map,this.sizesMeasured=!1}initVariables(){this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.getSizeEl(XR),this.getSizeEl(QR),this.getSizeEl(JR),this.getSizeEl($C),this.getSizeEl(ZR),this.refreshRowBorderWidthVariable()}getPinnedRowBorderWidth(){return this.getCSSVariablePixelValue(ZR)}getRowBorderWidth(){return this.getCSSVariablePixelValue($C)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(XR)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(QR)}getDefaultCellHorizontalPadding(){return this.getCSSVariablePixelValue(iU)}getCellPaddingLeft(){const e=this.getDefaultCellHorizontalPadding(),t=this.getCSSVariablePixelValue(sU),i=this.getCSSVariablePixelValue(nU);return e-1+i*t}getCellPadding(){const e=this.getDefaultCellHorizontalPadding()-1;return this.getCellPaddingLeft()+e}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(JR)}refreshRowHeightVariable(){const{eRootDiv:e}=this,t=e.style.getPropertyValue("--ag-line-height").trim(),i=this.gos.get("rowHeight");if(i==null||isNaN(i)||!isFinite(i))return t!==null&&e.style.setProperty("--ag-line-height",null),-1;const s=`${i}px`;return t!=s?(e.style.setProperty("--ag-line-height",s),i):t!=""?Number.parseFloat(t):-1}getCSSVariablePixelValue(e){const t=this.lastKnownValues.get(e);if(t!=null)return t;const i=this.measureSizeEl(e);return i==="detached"||i==="no-styles"?(e.cacheDefault&&this.lastKnownValues.set(e,e.defaultValue),e.defaultValue):(this.lastKnownValues.set(e,i),i)}measureSizeEl(e){const t=this.getSizeEl(e);if(t.offsetParent==null)return"detached";const i=t.offsetWidth;return i===UC?"no-styles":(this.sizesMeasured=!0,i)}getMeasurementContainer(){let e=this.eMeasurementContainer;return e||(e=this.eMeasurementContainer=jt({tag:"div",cls:"ag-measurement-container"}),this.eRootDiv.appendChild(e)),e}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;const i=this.getMeasurementContainer();t=jt({tag:"div"});const{border:s,noWarn:n}=e;s?(t.className="ag-measurement-element-border",t.style.setProperty("--ag-internal-measurement-border",`var(${e.cssName}, solid ${UC}px)`)):t.style.width=`var(${e.cssName}, ${UC}px)`,i.appendChild(t),this.sizeEls.set(e,t);let o=this.measureSizeEl(e);o==="no-styles"&&!n&&j(9,{variable:e});const r=qa(this.beans,t,()=>{const a=this.measureSizeEl(e);a==="detached"||a==="no-styles"||(this.lastKnownValues.set(e,a),a!==o&&(o=a,this.fireStylesChangedEvent(e.changeKey)))});return this.addDestroyFunc(()=>r()),t}fireStylesChangedEvent(e){e==="rowBorderWidthChanged"&&this.refreshRowBorderWidthVariable(),this.eventSvc.dispatchEvent({type:"gridStylesChanged",[e]:!0})}refreshRowBorderWidthVariable(){const e=this.getCSSVariablePixelValue($C);this.eRootDiv.style.setProperty("--ag-internal-row-border-width",`${e}px`)}postProcessThemeChange(e,t){e&&getComputedStyle(this.getMeasurementContainer()).getPropertyValue("--ag-legacy-styles-loaded")&&ut(t?106:239)}getAdditionalCss(){const e=new Map;return e.set("core",[y3]),oU(e,Array.from(WH())),e}getDefaultTheme(){return tU}themeError(e){ut(240,{theme:e})}},UC=15538,aU=class extends yB{postConstruct(){const{globalListener:e,globalSyncListener:t}=this.beans;e&&this.addGlobalListener(e,!0),t&&this.addGlobalListener(t,!1)}};function gD(e,t,i){const s=e.visibleCols.headerGroupRowCount;if(i>=s)return{column:t,headerRowIndex:i};let n=t.getParent();for(;n&&n.getProvidedColumnGroup().getLevel()>i;)n=n.getParent();const o=t.isSpanHeaderHeight();return!n||o&&n.isPadding()?{column:t,headerRowIndex:s}:{column:n,headerRowIndex:n.getProvidedColumnGroup().getLevel()}}var lU=class extends V{constructor(){super(...arguments),this.beanName="headerNavigation",this.currentHeaderRowWithoutSpan=-1}postConstruct(){const e=this.beans;e.ctrlsSvc.whenReady(this,i=>{this.gridBodyCon=i.gridBodyCtrl});const t=pi(e);this.addManagedElementListeners(t,{mousedown:()=>{this.currentHeaderRowWithoutSpan=-1}})}getHeaderPositionForColumn(e,t){let i;const{colModel:s,colGroupSvc:n,ctrlsSvc:o}=this.beans;if(typeof e=="string"?(i=s.getCol(e),i||(i=(n==null?void 0:n.getColumnGroup(e))??null)):i=e,!i)return null;const r=o.getHeaderRowContainerCtrl(),a=r==null?void 0:r.getAllCtrls(),l=Ct(a||[]).type==="filter",c=wo(this.beans)-1;let d=-1,h=i;for(;h;)d++,h=h.getParent();let u=d;return t&&l&&u===c-1&&u++,u===-1?null:{headerRowIndex:u,column:i}}navigateVertically(e,t){const{focusSvc:i,visibleCols:s}=this.beans,{focusedHeader:n}=i;if(!n)return!1;const{headerRowIndex:o}=n,r=n.column,a=wo(this.beans),l=this.getHeaderRowType(o),c=s.headerGroupRowCount;let{headerRowIndex:d,column:h,headerRowIndexWithoutSpan:u}=e==="UP"?cU(l,r,o):dU(r,o,c),f=!1;return d<0&&(d=0,h=r,f=!0),d>=a?(d=-1,this.currentHeaderRowWithoutSpan=-1):u!==void 0&&(this.currentHeaderRowWithoutSpan=u),!f&&!h?!1:i.focusHeaderPosition({headerPosition:{headerRowIndex:d,column:h},allowUserOverride:!0,event:t})}navigateHorizontally(e,t=!1,i){const{focusSvc:s,gos:n}=this.beans,o={...s.focusedHeader};let r,a;this.currentHeaderRowWithoutSpan!==-1?o.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=o.headerRowIndex,e==="LEFT"!==n.get("enableRtl")?(a="Before",r=this.findHeader(o,a)):(a="After",r=this.findHeader(o,a));const l=n.getCallback("tabToNextHeader");if(t&&l){const c=s.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:r,direction:a});if(c){const{headerRowIndex:d}=s.focusedHeader||{};d!=null&&d!=o.headerRowIndex&&(this.currentHeaderRowWithoutSpan=d)}return c}return r||!t?s.focusHeaderPosition({headerPosition:r,direction:a,fromTab:t,allowUserOverride:!0,event:i}):this.focusNextHeaderRow(o,a,i)}focusNextHeaderRow(e,t,i){const s=this.beans,n=e.headerRowIndex;let o=null,r;const a=wo(s),l=this.beans.visibleCols.allCols;if(t==="Before"){if(n<=0)return!1;o=Ct(l),r=n-1,this.currentHeaderRowWithoutSpan-=1}else o=l[0],r=n+1,this.currentHeaderRowWithoutSpan<a?this.currentHeaderRowWithoutSpan+=1:this.currentHeaderRowWithoutSpan=-1;let{column:c,headerRowIndex:d}=gD(this.beans,o,r);return d>=a&&(d=-1),s.focusSvc.focusHeaderPosition({headerPosition:{column:c,headerRowIndex:d},direction:t,fromTab:!0,allowUserOverride:!0,event:i})}scrollToColumn(e,t="After"){if(e.getPinned())return;let i;if($t(e)){const s=e.getDisplayedLeafColumns();i=t==="Before"?Ct(s):s[0]}else i=e;this.gridBodyCon.scrollFeature.ensureColumnVisible(i)}findHeader(e,t){const{colGroupSvc:i,visibleCols:s}=this.beans;let n=e.column;if(n instanceof pg){const l=n.getDisplayedLeafColumns();n=t==="Before"?l[0]:l[l.length-1]}const o=t==="Before"?s.getColBefore(n):s.getColAfter(n);if(!o)return;const r=s.headerGroupRowCount;if(e.headerRowIndex>=r)return{headerRowIndex:e.headerRowIndex,column:o};const a=i==null?void 0:i.getColGroupAtLevel(o,e.headerRowIndex);return a?a.isPadding()&&o.isSpanHeaderHeight()?{headerRowIndex:s.headerGroupRowCount,column:o}:{headerRowIndex:e.headerRowIndex,column:a??o}:{headerRowIndex:o instanceof jc&&o.isSpanHeaderHeight()?s.headerGroupRowCount:e.headerRowIndex,column:o}}getHeaderRowType(e){const t=this.beans.ctrlsSvc.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}};function cU(e,t,i){const s=i-1;if(e!=="filter"){const n=t instanceof jc&&t.isSpanHeaderHeight();let o=t.getParent();for(;o&&(o.getProvidedColumnGroup().getLevel()>s||n&&o.isPadding());)o=o.getParent();if(o)return n?{column:o,headerRowIndex:o.getProvidedColumnGroup().getLevel(),headerRowIndexWithoutSpan:s}:{column:o,headerRowIndex:s,headerRowIndexWithoutSpan:s}}return{column:t,headerRowIndex:s,headerRowIndexWithoutSpan:s}}function dU(e,t,i){const s=t+1,n={column:e,headerRowIndex:s,headerRowIndexWithoutSpan:s};if(e instanceof pg){if(s>=i)return{column:e.getDisplayedLeafColumns()[0],headerRowIndex:i,headerRowIndexWithoutSpan:s};let r=e.getDisplayedChildren()[0];if(r instanceof pg&&r.isPadding()){const l=r.getDisplayedLeafColumns()[0];l.isSpanHeaderHeight()&&(r=l)}n.column=r,r instanceof jc&&r.isSpanHeaderHeight()&&(n.headerRowIndex=i,n.headerRowIndexWithoutSpan=s)}return n}var hU=class extends V{constructor(){super(...arguments),this.beanName="focusSvc",this.focusFallbackTimeout=null,this.needsFocusRestored=!1}wireBeans(e){this.colModel=e.colModel,this.visibleCols=e.visibleCols,this.rowRenderer=e.rowRenderer,this.navigation=e.navigation,this.filterManager=e.filterManager,this.overlays=e.overlays}postConstruct(){const e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.addDestroyFunc(F2(this.beans))}attemptToRecoverFocus(){this.needsFocusRestored=!0,this.focusFallbackTimeout!=null&&clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=window.setTimeout(this.setFocusRecovered.bind(this),100)}setFocusRecovered(){this.needsFocusRestored=!1,this.focusFallbackTimeout!=null&&(clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=null)}shouldTakeFocus(){return this.gos.get("suppressFocusAfterRefresh")?(this.setFocusRecovered(),!1):this.needsFocusRestored?(this.setFocusRecovered(),!0):this.doesRowOrCellHaveBrowserFocus()}onColumnEverythingChanged(){if(!this.focusedCell)return;const e=this.focusedCell.column,t=this.colModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}getFocusCellToUseAfterRefresh(){const{gos:e,focusedCell:t}=this;return e.get("suppressFocusAfterRefresh")||e.get("suppressCellFocus")||!t||!this.doesRowOrCellHaveBrowserFocus()?null:t}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeader||!this.isDomDataPresentInHierarchy(Dt(this.beans),KT)?null:this.focusedHeader}doesRowOrCellHaveBrowserFocus(){const e=Dt(this.beans);return this.isDomDataPresentInHierarchy(e,jm)?!0:this.isDomDataPresentInHierarchy(e,Km)}isDomDataPresentInHierarchy(e,t){let i=e;for(;i;){if(NP(this.gos,i,t))return!0;i=i.parentNode}return!1}getFocusedCell(){return this.focusedCell}getFocusEventParams(e){const{rowIndex:t,rowPinned:i,column:s}=e,n={rowIndex:t,rowPinned:i,column:s,isFullWidthCell:!1},o=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:i});return o&&(n.isFullWidthCell=o.isFullWidth()),n}clearFocusedCell(){if(this.focusedCell==null)return;const e=this.getFocusEventParams(this.focusedCell);this.focusedCell=null,this.eventSvc.dispatchEvent({type:"cellFocusCleared",...e})}setFocusedCell(e){this.setFocusRecovered();const{column:t,rowIndex:i,rowPinned:s,forceBrowserFocus:n=!1,preventScrollOnBrowserFocus:o=!1,sourceEvent:r}=e,a=this.colModel.getCol(t);if(!a){this.focusedCell=null;return}this.focusedCell={rowIndex:i,rowPinned:br(s),column:a};const l=this.getFocusEventParams(this.focusedCell);this.eventSvc.dispatchEvent({type:"cellFocused",...l,...this.previousCellFocusParams&&{previousParams:this.previousCellFocusParams},forceBrowserFocus:n,preventScrollOnBrowserFocus:o,sourceEvent:r}),this.previousCellFocusParams=l}isCellFocused(e){return this.focusedCell==null?!1:eD(e,this.focusedCell)}isHeaderWrapperFocused(e){if(this.focusedHeader==null)return!1;const{column:t,rowCtrl:{rowIndex:i,pinned:s}}=e,{column:n,headerRowIndex:o}=this.focusedHeader;return t===n&&i===o&&s==n.getPinned()}focusHeaderPosition(e){var c;if(this.setFocusRecovered(),Rc(this.beans))return!1;const{direction:t,fromTab:i,allowUserOverride:s,event:n,fromCell:o,rowWithoutSpanValue:r,scroll:a=!0}=e;let{headerPosition:l}=e;if(o&&((c=this.filterManager)!=null&&c.isAdvFilterHeaderActive()))return this.focusAdvancedFilter(l);if(s){const d=this.focusedHeader,h=wo(this.beans);if(i){const u=this.gos.getCallback("tabToNextHeader");u&&(l=this.getHeaderPositionFromUserFunc({userFunc:u,direction:t,currentPosition:d,headerPosition:l,headerRowCount:h}))}else{const u=this.gos.getCallback("navigateToNextHeader");if(u&&n){const f={key:n.key,previousHeaderPosition:d,nextHeaderPosition:l,headerRowCount:h,event:n};l=u(f)}}}return l?this.focusProvidedHeaderPosition({headerPosition:l,direction:t,event:n,fromCell:o,rowWithoutSpanValue:r,scroll:a}):!1}focusHeaderPositionFromUserFunc(e){if(Rc(this.beans))return!1;const{userFunc:t,headerPosition:i,direction:s,event:n}=e,o=this.focusedHeader,r=wo(this.beans),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:s,currentPosition:o,headerPosition:i,headerRowCount:r});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:s,event:n})}getHeaderPositionFromUserFunc(e){const{userFunc:t,direction:i,currentPosition:s,headerPosition:n,headerRowCount:o}=e,a=t({backwards:i==="Before",previousHeaderPosition:s,nextHeaderPosition:n,headerRowCount:o});return a===!0?s:a===!1?null:a}focusProvidedHeaderPosition(e){const{headerPosition:t,direction:i,fromCell:s,rowWithoutSpanValue:n,event:o,scroll:r=!0}=e,{column:a,headerRowIndex:l}=t,{filterManager:c,ctrlsSvc:d,headerNavigation:h}=this.beans;if(this.focusedHeader&&KV(e.headerPosition,this.focusedHeader))return!1;if(l===-1)return c!=null&&c.isAdvFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView({column:a,event:o});r&&(h==null||h.scrollToColumn(a,i));const u=d.getHeaderRowContainerCtrl(a.getPinned()),f=(u==null?void 0:u.focusHeader(t.headerRowIndex,a,o))||!1;return h&&f&&(n!=null||s)&&(h.currentHeaderRowWithoutSpan=n??-1),f}focusFirstHeader(){var i;if((i=this.overlays)!=null&&i.isExclusive()&&this.focusOverlay())return!0;const e=this.visibleCols.allCols[0];if(!e)return!1;const t=gD(this.beans,e,0);return this.focusHeaderPosition({headerPosition:t,rowWithoutSpanValue:0})}focusLastHeader(e){var s;if((s=this.overlays)!=null&&s.isExclusive()&&this.focusOverlay(!0))return!0;const t=wo(this.beans)-1,i=Ct(this.visibleCols.allCols);return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:i},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){var t;return(t=this.filterManager)!=null&&t.isAdvFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCell}isRowFocused(e,t){return this.focusedCell==null?!1:this.focusedCell.rowIndex===e&&this.focusedCell.rowPinned===br(t)}focusOverlay(e){var i,s;const t=((i=this.overlays)==null?void 0:i.isVisible())&&((s=this.overlays.eWrapper)==null?void 0:s.getGui());return!!t&&kc(t,e)}focusGridView(e){var o,r,a,l,c,d;const{backwards:t=!1,canFocusOverlay:i=!0,event:s}=e;if((o=this.overlays)!=null&&o.isExclusive())return i&&this.focusOverlay(t);if($v(this.beans))return t&&!Rc(this.beans)?this.focusLastHeader():i&&this.focusOverlay(t)?!0:t?!1:jh(this.beans,t);const n=t?FW(this.beans):AW(this.beans);if(n){const h=e.column??((r=this.focusedHeader)==null?void 0:r.column),{rowIndex:u,rowPinned:f}=n,p=Dr(this.beans,n);if(!h||!p||u==null)return!1;if(h.isSuppressNavigable(p)){const m=this.gos.get("enableRtl");let v;return!s||s.key===H.TAB?v=m?H.LEFT:H.RIGHT:v=s.key,(a=this.beans.navigation)==null||a.navigateToNextCell(null,v,{rowIndex:u,column:h,rowPinned:f||null},!0),!0}if((l=this.navigation)==null||l.ensureCellVisible({rowIndex:u,column:h,rowPinned:f}),t){const m=this.rowRenderer.getRowByPosition(n);if(m!=null&&m.isFullWidth()&&((c=this.navigation)!=null&&c.tryToFocusFullWidthRow(n,t)))return!0}return this.setFocusedCell({rowIndex:u,column:h,rowPinned:br(f),forceBrowserFocus:!0}),(d=this.beans.rangeSvc)==null||d.setRangeToCell({rowIndex:u,rowPinned:f,column:h}),!0}return!!(i&&this.focusOverlay(t)||t&&this.focusLastHeader())}focusAdvancedFilter(e){var t;return this.advFilterFocusColumn=e==null?void 0:e.column,((t=this.beans.advancedFilter)==null?void 0:t.getCtrl().focusHeaderComp())??!1}focusNextFromAdvancedFilter(e,t){var s;const i=(t?void 0:this.advFilterFocusColumn)??((s=this.visibleCols.allCols)==null?void 0:s[0]);return e?this.focusHeaderPosition({headerPosition:{column:i,headerRowIndex:wo(this.beans)-1}}):this.focusGridView({column:i})}clearAdvancedFilterColumn(){this.advFilterFocusColumn=void 0}},uU=class extends V{constructor(){super(...arguments),this.beanName="scrollVisibleSvc"}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colAnimation=e.colAnimation}postConstruct(){this.horizontalScrollShowing=this.gos.get("alwaysShowHorizontalScroll")===!0,this.verticalScrollShowing=this.gos.get("alwaysShowVerticalScroll")===!0,this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.updateScrollVisible.bind(this),displayedColumnsWidthChanged:this.updateScrollVisible.bind(this)})}updateScrollVisible(){const{colAnimation:e}=this;e!=null&&e.isActive()?e.executeLaterVMTurn(()=>{e.executeLaterVMTurn(()=>this.updateScrollVisibleImpl())}):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){var i;const e=this.ctrlsSvc.get("center");if(!e||(i=this.colAnimation)!=null&&i.isActive())return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.verticalScrollShowing};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){const e=this.ctrlsSvc.get("center"),t=e.hasHorizontalScrollGap(),i=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==i)&&(this.horizontalScrollGap=t,this.verticalScrollGap=i,this.eventSvc.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventSvc.dispatchEvent({type:"scrollVisibilityChanged"}))}getScrollbarWidth(){if(this.scrollbarWidth==null){const e=this.gos.get("scrollbarWidth"),i=typeof e=="number"&&e>=0?e:b2();i!=null&&(this.scrollbarWidth=i,this.eventSvc.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},gU=class extends V{constructor(){super(...arguments),this.beanName="gridDestroySvc",this.destroyCalled=!1}destroy(){var s;if(this.destroyCalled)return;const{stateSvc:e,ctrlsSvc:t,context:i}=this.beans;this.eventSvc.dispatchEvent({type:"gridPreDestroyed",state:(e==null?void 0:e.getState())??{}}),this.destroyCalled=!0,(s=t.get("gridCtrl"))==null||s.destroyGridUi(),i.destroy(),super.destroy()}},vm=new Set(["gridPreDestroyed","fillStart","pasteStart"]),fU=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","pinnedRowsChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterUiChanged","filterOpened","floatingFilterUiChanged","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel","findChanged","rowResizeStarted","rowResizeEnded","columnsReset","bulkEditingStarted","bulkEditingStopped","batchEditingStarted","batchEditingStopped"],OS=fU.reduce((e,t)=>(e[t]=hG(t),e),{}),uu=(e,t)=>({tag:"span",ref:`eSort${e}`,cls:`ag-sort-indicator-icon ag-sort-${t} ag-hidden`,attrs:{"aria-hidden":"true"}}),pU={tag:"span",cls:"ag-sort-indicator-container",children:[uu("Order","order"),uu("Asc","ascending-icon"),uu("Desc","descending-icon"),uu("Mixed","mixed-icon"),uu("None","none-icon")]},NS=class extends ct{constructor(e){super(),this.eSortOrder=se,this.eSortAsc=se,this.eSortDesc=se,this.eSortMixed=se,this.eSortNone=se,e||this.setTemplate(pU)}attachCustomElements(e,t,i,s,n){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=i,this.eSortMixed=s,this.eSortNone=n}setupSort(e,t=!1){if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!e.isSortable()&&!e.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e);const i=this.updateIcons.bind(this),s=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",i),this.addManagedEventListeners({newColumnsLoaded:i,sortChanged:s,columnRowGroupChanged:s}),this.onSortChanged()}addInIcon(e,t,i){if(t==null)return;const s=tn(e,this.beans,i);s&&t.appendChild(s)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const{eSortAsc:e,eSortDesc:t,eSortNone:i,column:s,gos:n,beans:o}=this,r=o.sortSvc.getDisplaySortForColumn(s);if(e&&xt(e,r==="asc",{skipAriaHidden:!0}),t&&xt(t,r==="desc",{skipAriaHidden:!0}),i){const a=!s.getColDef().unSortIcon&&!n.get("unSortIcon"),l=r==null;xt(i,!a&&l,{skipAriaHidden:!0})}}setupMultiSortIndicator(){const{eSortMixed:e,column:t,gos:i}=this;this.addInIcon("sortUnSort",e,t);const s=t.getColDef().showRowGroup;mo(i)&&s&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){const{eSortMixed:e,beans:t,column:i}=this;if(e){const s=t.sortSvc.getDisplaySortForColumn(i)==="mixed";xt(e,s,{skipAriaHidden:!0})}}updateSortOrder(){const{eSortOrder:e,column:t,beans:{sortSvc:i}}=this;if(!e)return;const s=i.getColumnsWithSortingOrdered(),n=i.getDisplaySortIndexForColumn(t)??-1,o=s.some(a=>i.getDisplaySortIndexForColumn(a)??!1),r=n>=0&&o;xt(e,r,{skipAriaHidden:!0}),n>=0?e.textContent=(n+1).toString():Mi(e)}},mU={selector:"AG-SORT-INDICATOR",component:NS},vg=["asc","desc",null],vU=class extends V{constructor(){super(...arguments),this.beanName="sortSvc"}progressSort(e,t,i){const s=this.getNextSortDirection(e);this.setSortForColumn(e,s,t,i)}progressSortFromEvent(e,t){const s=this.gos.get("multiSortKey")==="ctrl"?t.ctrlKey||t.metaKey:t.shiftKey;this.progressSort(e,s,"uiColumnSorted")}setSortForColumn(e,t,i,s){var d;t!=="asc"&&t!=="desc"&&(t=null);const{gos:n,showRowGroupCols:o}=this.beans,r=mo(n);let a=[e];if(r&&e.getColDef().showRowGroup){const h=(d=o==null?void 0:o.getSourceColumnsForGroupColumn)==null?void 0:d.call(o,e),u=h==null?void 0:h.filter(f=>f.isSortable());u&&(a=[e,...u])}for(const h of a)this.setColSort(h,t,s);const l=(i||n.get("alwaysMultiSort"))&&!n.get("suppressMultiSort"),c=[];if(!l){const h=this.clearSortBarTheseColumns(a,s);c.push(...h)}this.updateSortIndex(e),c.push(...a),this.dispatchSortChangedEvents(s,c)}updateSortIndex(e){const{gos:t,colModel:i,showRowGroupCols:s}=this.beans,n=mo(t),o=s==null?void 0:s.getShowRowGroupCol(e.getId()),r=n&&o||e,a=this.getColumnsWithSortingOrdered();i.forAllCols(d=>this.setColSortIndex(d,null));const l=a.filter(d=>n&&d.getColDef().showRowGroup?!1:d!==r);(r.getSort()?[...l,r]:l).forEach((d,h)=>this.setColSortIndex(d,h))}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){let e=!1;return this.beans.colModel.forAllCols(t=>{t.getSort()&&(e=!0)}),e}dispatchSortChangedEvents(e,t){const i={type:"sortChanged",source:e};t&&(i.columns=t),this.eventSvc.dispatchEvent(i)}clearSortBarTheseColumns(e,t){const i=[];return this.beans.colModel.forAllCols(s=>{e.includes(s)||(s.getSort()&&i.push(s),this.setColSort(s,void 0,t))}),i}getNextSortDirection(e){const t=e.getColDef().sortingOrder??this.gos.get("sortingOrder")??vg,i=t.indexOf(e.getSort()),s=i<0,n=i==t.length-1;return s||n?t[0]:t[i+1]}getIndexedSortMap(){const{gos:e,colModel:t,showRowGroupCols:i,rowGroupColsSvc:s}=this.beans;let n=[];if(t.forAllCols(c=>{c.getSort()&&n.push(c)}),t.isPivotMode()){const c=mo(e);n=n.filter(d=>{const h=!!d.getAggFunc(),u=!d.isPrimary(),f=c?i==null?void 0:i.getShowRowGroupCol(d.getId()):d.getColDef().showRowGroup;return h||u||f})}const o=(s==null?void 0:s.columns.filter(c=>!!c.getSort()))??[],r={};n.forEach((c,d)=>r[c.getId()]=d),n.sort((c,d)=>{const h=c.getSortIndex(),u=d.getSortIndex();if(h!=null&&u!=null)return h-u;if(h==null&&u==null){const f=r[c.getId()],p=r[d.getId()];return f>p?1:-1}else return u==null?-1:1});const a=mo(e)&&!!o.length;a&&(n=[...new Set(n.map(c=>(i==null?void 0:i.getShowRowGroupCol(c.getId()))??c))]);const l=new Map;if(n.forEach((c,d)=>l.set(c,d)),a)for(const c of o){const d=i.getShowRowGroupCol(c.getId());l.set(c,l.get(d))}return l}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([,e],[,t])=>e-t).map(([e])=>e)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){const t=mo(this.gos),i=!!e.getColDef().showRowGroup;return t&&i}getDisplaySortForColumn(e){var r;const t=(r=this.beans.showRowGroupCols)==null?void 0:r.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!(t!=null&&t.length))return e.getSort();const s=e.getColDef().field!=null||!!e.getColDef().valueGetter?[e,...t]:t,n=s[0].getSort();return s.every(a=>a.getSort()==n)?n:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}setupHeader(e,t,i){let s=0;e.addManagedListeners(t,{movingChanged:()=>{s=Date.now()}}),i&&e.addManagedElementListeners(i,{click:o=>{const r=t.isMoving(),l=Date.now()-s<50;r||l||this.progressSortFromEvent(t,o)}});const n=()=>{var r;const o=t.getSort();if(e.toggleCss("ag-header-cell-sorted-asc",o==="asc"),e.toggleCss("ag-header-cell-sorted-desc",o==="desc"),e.toggleCss("ag-header-cell-sorted-none",!o),t.getColDef().showRowGroup){const a=(r=this.beans.showRowGroupCols)==null?void 0:r.getSourceColumnsForGroupColumn(t),c=!(a==null?void 0:a.every(d=>t.getSort()==d.getSort()));e.toggleCss("ag-header-cell-sorted-mixed",c)}};e.addManagedEventListeners({sortChanged:n,columnRowGroupChanged:n})}initCol(e){const{sort:t,initialSort:i,sortIndex:s,initialSortIndex:n}=e.colDef;t!==void 0?(t==="asc"||t==="desc")&&(e.sort=t):(i==="asc"||i==="desc")&&(e.sort=i),s!==void 0?s!==null&&(e.sortIndex=s):n!==null&&(e.sortIndex=n)}updateColSort(e,t,i){t!==void 0&&(t==="desc"||t==="asc"?this.setColSort(e,t,i):this.setColSort(e,void 0,i))}setColSort(e,t,i){e.sort!==t&&(e.sort=t,e.dispatchColEvent("sortChanged",i)),e.dispatchStateUpdatedEvent("sort")}setColSortIndex(e,t){e.sortIndex=t,e.dispatchStateUpdatedEvent("sortIndex")}createSortIndicator(e){return new NS(e)}getSortIndicatorSelector(){return mU}},Td={agSetColumnFilter:"SetFilter",agSetColumnFloatingFilter:"SetFilter",agMultiColumnFilter:"MultiFilter",agMultiColumnFloatingFilter:"MultiFilter",agGroupColumnFilter:"GroupFilter",agGroupColumnFloatingFilter:"GroupFilter",agGroupCellRenderer:"GroupCellRenderer",agGroupRowRenderer:"GroupCellRenderer",agRichSelect:"RichSelect",agRichSelectCellEditor:"RichSelect",agDetailCellRenderer:"SharedMasterDetail",agSparklineCellRenderer:"Sparklines",agDragAndDropImage:"SharedDragAndDrop",agColumnHeader:"ColumnHeaderComp",agColumnGroupHeader:"ColumnGroupHeaderComp",agSortIndicator:"Sort",agAnimateShowChangeCellRenderer:"HighlightChanges",agAnimateSlideCellRenderer:"HighlightChanges",agLoadingCellRenderer:"LoadingCellRenderer",agSkeletonCellRenderer:"SkeletonCellRenderer",agCheckboxCellRenderer:"CheckboxCellRenderer",agLoadingOverlay:"Overlay",agNoRowsOverlay:"Overlay",agTooltipComponent:"Tooltip",agReadOnlyFloatingFilter:"CustomFilter",agTextColumnFilter:"TextFilter",agNumberColumnFilter:"NumberFilter",agDateColumnFilter:"DateFilter",agDateInput:"DateFilter",agTextColumnFloatingFilter:"TextFilter",agNumberColumnFloatingFilter:"NumberFilter",agDateColumnFloatingFilter:"DateFilter",agCellEditor:"TextEditor",agSelectCellEditor:"SelectEditor",agTextCellEditor:"TextEditor",agNumberCellEditor:"NumberEditor",agDateCellEditor:"DateEditor",agDateStringCellEditor:"DateEditor",agCheckboxCellEditor:"CheckboxEditor",agLargeTextCellEditor:"LargeTextEditor",agMenuItem:"MenuItem",agColumnsToolPanel:"ColumnsToolPanel",agFiltersToolPanel:"FiltersToolPanel",agNewFiltersToolPanel:"NewFiltersToolPanel",agAggregationComponent:"StatusBar",agSelectedRowCountComponent:"StatusBar",agTotalRowCountComponent:"StatusBar",agFilteredRowCountComponent:"StatusBar",agTotalAndFilteredRowCountComponent:"StatusBar",agFindCellRenderer:"Find"};function ex(e){return`"${e}"`}var CU=()=>({checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."},rowGroupingHierarchy:{version:"34.3",message:"Use `colDef.groupHierarchy` instead."}}),wU={aggFunc:"SharedAggregation",autoHeight:"RowAutoHeight",cellClass:"CellStyle",cellClassRules:"CellStyle",cellEditor:({cellEditor:e,editable:t})=>t?typeof e=="string"?Td[e]??"CustomEditor":"CustomEditor":null,cellRenderer:({cellRenderer:e})=>typeof e!="string"?null:Td[e],cellStyle:"CellStyle",columnChooserParams:"ColumnMenu",contextMenuItems:"ContextMenu",dndSource:"DragAndDrop",dndSourceOnRowDrag:"DragAndDrop",editable:({editable:e,cellEditor:t})=>e&&!t?"TextEditor":null,enableCellChangeFlash:"HighlightChanges",enablePivot:"SharedPivot",enableRowGroup:"SharedRowGrouping",enableValue:"SharedAggregation",filter:({filter:e})=>e&&typeof e!="string"&&typeof e!="boolean"?"CustomFilter":typeof e=="string"?Td[e]??"ColumnFilter":"ColumnFilter",floatingFilter:"ColumnFilter",getQuickFilterText:"QuickFilter",headerTooltip:"Tooltip",headerTooltipValueGetter:"Tooltip",mainMenuItems:"ColumnMenu",menuTabs:e=>{var i;const t=["columnsMenuTab","generalMenuTab"];return(i=e.menuTabs)!=null&&i.some(s=>t.includes(s))?"ColumnMenu":null},pivot:"SharedPivot",pivotIndex:"SharedPivot",rowDrag:"RowDrag",rowGroup:"SharedRowGrouping",rowGroupIndex:"SharedRowGrouping",tooltipField:"Tooltip",tooltipValueGetter:"Tooltip",tooltipComponentSelector:"Tooltip",spanRows:"CellSpan",groupHierarchy:"SharedRowGrouping"},bU=()=>({autoHeight:{supportedRowModels:["clientSide","serverSide"],validate:(t,{paginationAutoPageSize:i})=>i?"colDef.autoHeight is not supported with paginationAutoPageSize.":null},cellRendererParams:{validate:t=>(t.rowGroup!=null||t.rowGroupIndex!=null||t.cellRenderer==="agGroupCellRenderer")&&"checkbox"in t.cellRendererParams?'Since v33.0, `cellRendererParams.checkbox` has been deprecated. Use `rowSelection.checkboxLocation = "autoGroupColumn"` instead.':null},flex:{validate:(t,i)=>i.autoSizeStrategy?"colDef.flex is not supported with gridOptions.autoSizeStrategy":null},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerValueGetter:{validate:t=>{const i=t.headerValueGetter;return typeof i=="function"||typeof i=="string"?null:"headerValueGetter must be a function or a valid string expression"}},icons:{validate:({icons:t})=>{if(t){if(t.smallDown)return So(262);if(t.smallLeft)return So(263);if(t.smallRight)return So(264)}return null}},sortingOrder:{validate:t=>{const i=t.sortingOrder;if(Array.isArray(i)&&i.length>0){const s=i.filter(n=>!vg.includes(n));if(s.length>0)return`sortingOrder must be an array with elements from [${vg.map(Om).join()}], currently it includes [${s.map(Om).join()}]`}else if(!Array.isArray(i)||i.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${i}`;return null}},type:{validate:t=>{const i=t.type;return i instanceof Array?i.some(n=>typeof n!="string")?"if colDef.type is supplied an array it should be of type 'string[]'":null:typeof i=="string"?null:"colDef.type should be of type 'string' | 'string[]'"}},rowSpan:{validate:(t,{suppressRowTransform:i})=>i?null:"colDef.rowSpan requires suppressRowTransform to be enabled."},spanRows:{dependencies:{editable:{required:[!1,void 0]},rowDrag:{required:[!1,void 0]},colSpan:{required:[void 0]},rowSpan:{required:[void 0]}},validate:(t,{rowSelection:i,cellSelection:s,suppressRowTransform:n,enableCellSpan:o,rowDragEntireRow:r,enableCellTextSelection:a})=>typeof i=="object"&&(i==null?void 0:i.mode)==="singleRow"&&i!=null&&i.enableClickSelection?"colDef.spanRows is not supported with rowSelection.clickSelection":s?"colDef.spanRows is not supported with cellSelection.":n?"colDef.spanRows is not supported with suppressRowTransform.":o?r?"colDef.spanRows is not supported with rowDragEntireRow.":a?"colDef.spanRows is not supported with enableCellTextSelection.":null:"colDef.spanRows requires enableCellSpan to be enabled."},groupHierarchy:{validate(t,{groupHierarchyConfig:i={}},s){var r;const n=new Set(["year","quarter","month","formattedMonth","day","hour","minute","second"]),o=[];for(const a of t.groupHierarchy??[]){if(typeof a=="object"){(r=s.validation)==null||r.validateColDef(a);continue}!n.has(a)&&!(a in i)&&o.push(ex(a))}if(o.length>0){const a=`The following parts of colDef.groupHierarchy are not recognised: ${o.join(", ")}.`,l=`Choose one of ${[...n].map(ex).join(", ")}, or define your own parts in gridOptions.groupHierarchyConfig.`;return`${a}
${l}`}return null}}}),yU={headerName:void 0,columnGroupShow:void 0,headerStyle:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,headerTooltipValueGetter:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,spanRows:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,tooltipComponentSelector:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0,dateComponent:void 0,dateComponentParams:void 0,getFindText:void 0,rowGroupingHierarchy:void 0,groupHierarchy:void 0},SU=()=>Object.keys(yU),RU=()=>({objectName:"colDef",allProperties:SU(),docsUrl:"column-properties/",deprecations:CU(),validations:bU()}),xU=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","treeDataChildrenField","treeDataParentIdField","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","invalidEditValueMode","grandTotalRow","themeCssLayer","findSearchValue","styleNonce","renderingMode"],EU=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","themeStyleContainer","statusBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterParent","advancedFilterBuilderParams","advancedFilterParams","initialState","autoSizeStrategy","selectionColumnDef","findOptions","filterHandlers","groupHierarchyConfig"],AU=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"],fD=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns","rowDragInsertDelay"],FU=["theme","rowSelection"],PU=["cellSelection","sideBar","rowNumbers","suppressGroupChangesColumnVisibility","groupAggFiltering","suppressStickyTotalRow","groupHideParentOfSingleChild","enableRowPinning"],pD=["loadThemeGoogleFonts","suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","allowContextMenuWithControlKey","suppressContextMenu","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","enableCellSpan","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault","enableFilterHandlers","suppressStartEditOnTab","hidePaddedHeaderRows","ssrmExpandAllAffectsAllRows"],TU=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getFullRowEditValidationErrors","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","chartMenuItems","groupTotalRow","alwaysPassFilter","isRowPinnable","isRowPinned","isRowValidDropPosition"],DU=()=>[...AU,...EU,...xU,...fD,...TU,...pD,...PU,...FU],MU=()=>({suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."},groupRemoveSingleChildren:{version:"33",message:"Use `groupHideParentOfSingleChild` instead."},groupRemoveLowestSingleChildren:{version:"33",message:'Use `groupHideParentOfSingleChild: "leafGroupsOnly"` instead.'},suppressRowGroupHidesColumns:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressHideOnGroup"` instead.'},suppressMakeColumnVisibleAfterUnGroup:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressShowOnUngroup"` instead.'},unSortIcon:{version:"33",message:"Use `defaultColDef.unSortIcon` instead."},sortingOrder:{version:"33",message:"Use `defaultColDef.sortingOrder` instead."},suppressPropertyNamesCheck:{version:"33",message:"`gridOptions` and `columnDefs` both have a `context` property that should be used for arbitrary user data. This means that column definitions and gridOptions should only contain valid properties making this property redundant."},suppressAdvancedFilterEval:{version:"34",message:"Advanced filter no longer uses function evaluation, so this option has no effect."}});function Vn(e,t,i){return typeof t=="number"||t==null?t==null||t>=i?null:`${e}: value should be greater than or equal to ${i}`:`${e}: value should be a number`}var IU={alignedGrids:"AlignedGrids",allowContextMenuWithControlKey:"ContextMenu",autoSizeStrategy:"ColumnAutoSize",cellSelection:"CellSelection",columnHoverHighlight:"ColumnHover",datasource:"InfiniteRowModel",doesExternalFilterPass:"ExternalFilter",editType:"EditCore",invalidEditValueMode:"EditCore",enableAdvancedFilter:"AdvancedFilter",enableCellSpan:"CellSpan",enableCharts:"IntegratedCharts",enableRangeSelection:"CellSelection",enableRowPinning:"PinnedRow",findSearchValue:"Find",getFullRowEditValidationErrors:"EditCore",getContextMenuItems:"ContextMenu",getLocaleText:"Locale",getMainMenuItems:"ColumnMenu",getRowClass:"RowStyle",getRowStyle:"RowStyle",groupTotalRow:"SharedRowGrouping",grandTotalRow:"ClientSideRowModelHierarchy",initialState:"GridState",isExternalFilterPresent:"ExternalFilter",isRowPinnable:"PinnedRow",isRowPinned:"PinnedRow",localeText:"Locale",masterDetail:"SharedMasterDetail",pagination:"Pagination",pinnedBottomRowData:"PinnedRow",pinnedTopRowData:"PinnedRow",pivotMode:"SharedPivot",pivotPanelShow:"RowGroupingPanel",quickFilterText:"QuickFilter",rowClass:"RowStyle",rowClassRules:"RowStyle",rowData:"ClientSideRowModel",rowDragManaged:"RowDrag",rowGroupPanelShow:"RowGroupingPanel",rowNumbers:"RowNumbers",rowSelection:"SharedRowSelection",rowStyle:"RowStyle",serverSideDatasource:"ServerSideRowModel",sideBar:"SideBar",statusBar:"StatusBar",treeData:"SharedTreeData",undoRedoCellEditing:"UndoRedoEdit",valueCache:"ValueCache",viewportDatasource:"ViewportRowModel"},kU=()=>{const e={autoSizePadding:{validate({autoSizePadding:i}){return Vn("autoSizePadding",i,0)}},cacheBlockSize:{supportedRowModels:["serverSide","infinite"],validate({cacheBlockSize:i}){return Vn("cacheBlockSize",i,1)}},cacheOverflowSize:{validate({cacheOverflowSize:i}){return Vn("cacheOverflowSize",i,1)}},datasource:{supportedRowModels:["infinite"]},domLayout:{validate:i=>{const s=i.domLayout,n=["autoHeight","normal","print"];return s&&!n.includes(s)?`domLayout must be one of [${n.join()}], currently it's ${s}`:null}},enableFillHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeSelection:{dependencies:{rowDragEntireRow:{required:[!1,void 0]}}},enableRowPinning:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,pinnedTopRowData:s,pinnedBottomRowData:n}){return i&&(s||n)?"Manual row pinning cannot be used together with pinned row data. Either set `enableRowPinning` to `false`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":null}},isRowPinnable:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,isRowPinnable:s,pinnedTopRowData:n,pinnedBottomRowData:o}){return s&&(n||o)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinnable`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!i&&s?"`isRowPinnable` requires `enableRowPinning` to be set.":null}},isRowPinned:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,isRowPinned:s,pinnedTopRowData:n,pinnedBottomRowData:o}){return s&&(n||o)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinned`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!i&&s?"`isRowPinned` requires `enableRowPinning` to be set.":null}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:{required:[void 0,"bottom"]},treeData:{required:[void 0,!1],reason:"Tree Data has values at the group level so it doesn't make sense to hide them."}}},groupHideParentOfSingleChild:{dependencies:{groupHideOpenParents:{required:[void 0,!1]}}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveSingleChildren:{required:[void 0,!1]}}},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveLowestSingleChildren:{required:[void 0,!1]}}},groupSelectsChildren:{dependencies:{rowSelection:{required:["multiple"]}}},groupHierarchyConfig:{validate({groupHierarchyConfig:i={}},s,n){var o;for(const r of Object.keys(i))(o=n.validation)==null||o.validateColDef(i[r]);return null}},icons:{validate:({icons:i})=>{if(i){if(i.smallDown)return So(262);if(i.smallLeft)return So(263);if(i.smallRight)return So(264)}return null}},infiniteInitialRowCount:{validate({infiniteInitialRowCount:i}){return Vn("infiniteInitialRowCount",i,1)}},initialGroupOrderComparator:{supportedRowModels:["clientSide"]},ssrmExpandAllAffectsAllRows:{validate:i=>{if(typeof i.ssrmExpandAllAffectsAllRows=="boolean"){if(i.rowModelType!=="serverSide")return"'ssrmExpandAllAffectsAllRows' is only supported with the Server Side Row Model.";if(i.ssrmExpandAllAffectsAllRows&&typeof i.getRowId!="function")return"'getRowId' callback must be provided for Server Side Row Model grouping to work correctly."}return null}},keepDetailRowsCount:{validate({keepDetailRowsCount:i}){return Vn("keepDetailRowsCount",i,1)}},paginationPageSize:{validate({paginationPageSize:i}){return Vn("paginationPageSize",i,1)}},paginationPageSizeSelector:{validate:i=>{const s=i.paginationPageSizeSelector;return typeof s=="boolean"||s==null||s.length?null:`'paginationPageSizeSelector' cannot be an empty array.
                    If you want to hide the page size selector, set paginationPageSizeSelector to false.`}},pivotMode:{dependencies:{treeData:{required:[!1,void 0],reason:"Pivot Mode is not supported with Tree Data."}}},quickFilterText:{supportedRowModels:["clientSide"]},rowBuffer:{validate({rowBuffer:i}){return Vn("rowBuffer",i,0)}},rowClass:{validate:i=>typeof i.rowClass=="function"?"rowClass should not be a function, please use getRowClass instead":null},rowData:{supportedRowModels:["clientSide"]},rowDragManaged:{supportedRowModels:["clientSide"],dependencies:{pagination:{required:[!1,void 0]}}},rowSelection:{validate({rowSelection:i}){return i&&typeof i=="string"?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':i&&typeof i!="object"?"Expected `RowSelectionOptions` object for the `rowSelection` property.":i&&i.mode!=="multiRow"&&i.mode!=="singleRow"?`Selection mode "${i.mode}" is invalid. Use one of 'singleRow' or 'multiRow'.`:null}},rowStyle:{validate:i=>{const s=i.rowStyle;return s&&typeof s=="function"?"rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead":null}},serverSideDatasource:{supportedRowModels:["serverSide"]},serverSideInitialRowCount:{supportedRowModels:["serverSide"],validate({serverSideInitialRowCount:i}){return Vn("serverSideInitialRowCount",i,1)}},serverSideOnlyRefreshFilteredGroups:{supportedRowModels:["serverSide"]},serverSideSortAllLevels:{supportedRowModels:["serverSide"]},sortingOrder:{validate:i=>{const s=i.sortingOrder;if(Array.isArray(s)&&s.length>0){const n=s.filter(o=>!vg.includes(o));if(n.length>0)return`sortingOrder must be an array with elements from [${vg.map(Om).join()}], currently it includes [${n.map(Om).join()}]`}else if(!Array.isArray(s)||s.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${s}`;return null}},tooltipHideDelay:{validate:i=>i.tooltipHideDelay&&i.tooltipHideDelay<0?"tooltipHideDelay should not be lower than 0":null},tooltipShowDelay:{validate:i=>i.tooltipShowDelay&&i.tooltipShowDelay<0?"tooltipShowDelay should not be lower than 0":null},treeData:{supportedRowModels:["clientSide","serverSide"],validate:i=>{const s=i.rowModelType??"clientSide";switch(s){case"clientSide":{const{treeDataChildrenField:n,treeDataParentIdField:o,getDataPath:r,getRowId:a}=i;if(!n&&!o&&!r)return"treeData requires either 'treeDataChildrenField' or 'treeDataParentIdField' or 'getDataPath' in the clientSide row model.";if(n){if(r)return"Cannot use both 'treeDataChildrenField' and 'getDataPath' at the same time.";if(o)return"Cannot use both 'treeDataChildrenField' and 'treeDataParentIdField' at the same time."}if(o){if(!a)return"getRowId callback not provided, tree data with parent id cannot be built.";if(r)return"Cannot use both 'treeDataParentIdField' and 'getDataPath' at the same time."}return null}case"serverSide":{const n=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${s} row model.`;return i.isServerSideGroup&&i.getServerSideGroupKey?null:n}}return null}},viewportDatasource:{supportedRowModels:["viewport"]},viewportRowModelBufferSize:{validate({viewportRowModelBufferSize:i}){return Vn("viewportRowModelBufferSize",i,0)}},viewportRowModelPageSize:{validate({viewportRowModelPageSize:i}){return Vn("viewportRowModelPageSize",i,1)}},rowDragEntireRow:{dependencies:{cellSelection:{required:[void 0]}}},autoGroupColumnDef:{validate({autoGroupColumnDef:i,showOpenedGroup:s}){return i!=null&&i.field&&s?"autoGroupColumnDef.field and showOpenedGroup are not supported when used together.":i!=null&&i.valueGetter&&s?"autoGroupColumnDef.valueGetter and showOpenedGroup are not supported when used together.":null}},renderingMode:{validate:i=>{const s=i.renderingMode,n=["default","legacy"];return s&&!n.includes(s)?`renderingMode must be one of [${n.join()}], currently it's ${s}`:null}},autoSizeStrategy:{validate:({autoSizeStrategy:i})=>{if(!i)return null;const s=["fitCellContents","fitGridWidth","fitProvidedWidth"],n=i.type;return n!=="fitCellContents"&&n!=="fitGridWidth"&&n!=="fitProvidedWidth"?`Invalid Auto-size strategy. \`autoSizeStrategy\` must be one of ${s.map(o=>'"'+o+'"').join(", ")}, currently it's ${n}`:n==="fitProvidedWidth"&&typeof i.width!="number"?`When using the 'fitProvidedWidth' auto-size strategy, must provide a numeric \`width\`. You provided ${i.width}`:null}}},t={};for(const i of pD)t[i]={expectedType:"boolean"};for(const i of fD)t[i]={expectedType:"number"};return ts(t,e),t},_U=()=>({objectName:"gridOptions",allProperties:[...DU(),...Object.values(OS)],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:MU(),validations:kU()}),LU=0,OU=0,tx="__ag_grid_instance",NU=class extends V{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.instanceId=OU++,this.gridReadyFired=!1,this.queueEvents=[],this.propEventSvc=new Mc,this.globalEventHandlerFactory=e=>(t,i)=>{if(!this.isAlive())return;const s=vm.has(t);if(s&&!e||!s&&e||!HU(t))return;const n=(o,r)=>{const a=OS[o],l=this.gridOptions[a];typeof l=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>l(r))};if(this.gridReadyFired)n(t,i);else if(t==="gridReady"){n(t,i),this.gridReadyFired=!0;for(const o of this.queueEvents)n(o.eventName,o.event);this.queueEvents=[]}else this.queueEvents.push({eventName:t,event:i})}}wireBeans(e){this.gridOptions=e.gridOptions,this.validation=e.validation,this.api=e.gridApi,this.gridId=e.context.getId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){this.validateGridOptions(this.gridOptions),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory().bind(this),!0),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propEventSvc.setFrameworkOverrides(this.beans.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:({options:e})=>{this.updateGridOptions({options:e,force:!0,source:"optionsUpdated"})}})}destroy(){super.destroy(),this.queueEvents=[]}get(e){return this.gridOptions[e]??NH[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return ae(this.gridOptions[e])}mergeGridCommonParams(e){return e&&(i=>e(this.addCommon(i)))}updateGridOptions({options:e,force:t,source:i="api"}){const s={id:LU++,properties:[]},n=[],{gridOptions:o,validation:r}=this;for(const a of Object.keys(e)){const l=uS.applyGlobalGridOption(a,e[a]);r==null||r.warnOnInitialPropertyUpdate(i,a);const c=t||typeof l=="object"&&i==="api",d=o[a];if(c||d!==l){o[a]=l;const h={type:a,currentValue:l,previousValue:d,changeSet:s,source:i};n.push(h)}}this.validateGridOptions(this.gridOptions),s.properties=n.map(a=>a.type);for(const a of n)Ga(this,`Updated property ${a.type} from`,a.previousValue," to ",a.currentValue),this.propEventSvc.dispatchEvent(a)}addPropertyEventListener(e,t){this.propEventSvc.addEventListener(e,t)}removePropertyEventListener(e,t){this.propEventSvc.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}addCommon(e){return e.api=this.api,e.context=this.gridOptionsContext,e}validateOptions(e,t){for(const i of Object.keys(e)){const s=e[i];if(s==null||s===!1)continue;let n=t[i];typeof n=="function"&&(n=n(e,this.gridOptions,this.beans)),n&&this.assertModuleRegistered(n,i)}}validateGridOptions(e){var t;this.validateOptions(e,IU),(t=this.validation)==null||t.processGridOptions(e)}validateColDef(e,t,i){var s,n;(i||!((s=this.beans.dataTypeSvc)!=null&&s.isColPendingInference(t)))&&(this.validateOptions(e,wU),(n=this.validation)==null||n.validateColDef(e))}assertModuleRegistered(e,t){const i=Array.isArray(e)?e.some(s=>this.isModuleRegistered(s)):this.isModuleRegistered(e);return i||ut(200,{...this.getModuleErrorParams(),moduleName:e,reasonOrId:t}),i}getModuleErrorParams(){return{gridId:this.gridId,gridScoped:gS(),rowModelType:this.get("rowModelType"),isUmd:UH()}}isModuleRegistered(e){return zb(e,this.gridId,this.get("rowModelType"))}setInstanceDomData(e){e[tx]=this.instanceId}isElementInThisInstance(e){let t=e;for(;t;){const i=t[tx];if(ae(i))return i===this.instanceId;t=t.parentElement}return!1}};function HU(e){return!!OS[e]}function mD(e){const t={"aria-hidden":"true"};return{tag:"div",cls:"ag-cell-label-container",role:"presentation",children:[{tag:"span",ref:"eMenu",cls:"ag-header-icon ag-header-cell-menu-button",attrs:t},{tag:"span",ref:"eFilterButton",cls:"ag-header-icon ag-header-cell-filter-button",attrs:t},{tag:"div",ref:"eLabel",cls:"ag-header-cell-label",role:"presentation",children:[{tag:"span",ref:"eText",cls:"ag-header-cell-text"},{tag:"span",ref:"eFilter",cls:"ag-header-icon ag-header-label-icon ag-filter-icon",attrs:t},e?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:null]}]}}var GU=mD(!0),BU=mD(!1),VU=class extends ct{constructor(){super(...arguments),this.eFilter=se,this.eFilterButton=se,this.eSortIndicator=se,this.eMenu=se,this.eLabel=se,this.eText=se,this.eSortOrder=se,this.eSortAsc=se,this.eSortDesc=se,this.eSortMixed=se,this.eSortNone=se,this.isLoadingInnerComponent=!1}refresh(e){var i,s,n;const t=this.params;if(this.params=e,this.workOutTemplate(e,!!((i=this.beans)!=null&&i.sortSvc))!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||e.enableSorting!=this.currentSort||this.currentSuppressMenuHide!=null&&this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||t.enableFilterButton!=e.enableFilterButton||t.enableFilterIcon!=e.enableFilterIcon)return!1;if(this.innerHeaderComponent){const o={...e};ts(o,e.innerHeaderComponentParams),(n=(s=this.innerHeaderComponent).refresh)==null||n.call(s,o)}else this.setDisplayName(e);return!0}workOutTemplate(e,t){const i=e.template;return i?i!=null&&i.trim?i.trim():i:t?GU:BU}init(e){this.params=e;const{sortSvc:t,touchSvc:i,rowNumbersSvc:s,userCompFactory:n}=this.beans,o=t==null?void 0:t.getSortIndicatorSelector();this.currentTemplate=this.workOutTemplate(e,!!o),this.setTemplate(this.currentTemplate,o?[o]:void 0),i==null||i.setupForHeader(this),this.setMenu(),this.setupSort(),s==null||s.setupForHeader(this),this.setupFilterIcon(),this.setupFilterButton(),this.workOutInnerHeaderComponent(n,e),this.setDisplayName(e)}workOutInnerHeaderComponent(e,t){const i=o2(e,t,t);i&&(this.isLoadingInnerComponent=!0,i.newAgStackInstance().then(s=>{this.isLoadingInnerComponent=!1,s&&(this.isAlive()?(this.innerHeaderComponent=s,this.eText&&this.eText.appendChild(s.getGui())):this.destroyBean(s))}))}setDisplayName(e){const{displayName:t}=e,i=this.currentDisplayName;this.currentDisplayName=t,!(!this.eText||i===t||this.innerHeaderComponent||this.isLoadingInnerComponent)&&(this.eText.textContent=tu(t))}addInIcon(e,t,i){const s=tn(e,this.beans,i);s&&t.appendChild(s)}workOutShowMenu(){var e;return this.params.enableMenu&&!!((e=this.beans.menuSvc)!=null&&e.isHeaderMenuButtonEnabled())}shouldSuppressMenuHide(){var e;return!!((e=this.beans.menuSvc)!=null&&e.isHeaderMenuButtonAlwaysShowEnabled())}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){Dn(this.eMenu),this.eMenu=void 0;return}const{gos:e,eMenu:t,params:i}=this,s=_s(e);this.addInIcon(s?"menu":"menuAlt",t,i.column),t.classList.toggle("ag-header-menu-icon",!s);const n=this.shouldSuppressMenuHide();this.currentSuppressMenuHide=n,this.addManagedElementListeners(t,{click:()=>this.showColumnMenu(this.eMenu)}),this.toggleMenuAlwaysShow(n)}toggleMenuAlwaysShow(e){var t;(t=this.eMenu)==null||t.classList.toggle("ag-header-menu-always-show",e)}showColumnMenu(e){const{currentSuppressMenuHide:t,params:i}=this;t||this.toggleMenuAlwaysShow(!0),i.showColumnMenu(e,()=>{t||this.toggleMenuAlwaysShow(!1)})}onMenuKeyboardShortcut(e){var l;const{params:t,gos:i,beans:s,eMenu:n,eFilterButton:o}=this,r=t.column,a=_s(i);if(e&&!a){if((l=s.menuSvc)!=null&&l.isFilterMenuInHeaderEnabled(r))return t.showFilter(o??n??this.getGui()),!0}else if(t.enableMenu)return this.showColumnMenu(n??o??this.getGui()),!0;return!1}setupSort(){const{sortSvc:e}=this.beans;if(!e)return;const{enableSorting:t,column:i}=this.params;if(this.currentSort=t,!this.eSortIndicator){this.eSortIndicator=this.createBean(e.createSortIndicator(!0));const{eSortIndicator:s,eSortOrder:n,eSortAsc:o,eSortDesc:r,eSortMixed:a,eSortNone:l}=this;s.attachCustomElements(n,o,r,a,l)}this.eSortIndicator.setupSort(i),this.currentSort&&e.setupHeader(this,i,this.eLabel)}setupFilterIcon(){const{eFilter:e,params:t}=this;if(!e)return;const i=()=>{const s=t.column.isFilterActive();xt(e,s,{skipAriaHidden:!0})};this.configureFilter(t.enableFilterIcon,e,i,"filterActive")}setupFilterButton(){const{eFilterButton:e,params:t}=this;if(!e)return;this.configureFilter(t.enableFilterButton,e,this.onFilterChangedButton.bind(this),"filter")?this.addManagedElementListeners(e,{click:()=>t.showFilter(e)}):this.eFilterButton=void 0}configureFilter(e,t,i,s){if(!e)return Dn(t),!1;const n=this.params.column;return this.addInIcon(s,t,n),this.addManagedListeners(n,{filterChanged:i}),i(),!0}onFilterChangedButton(){const e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){const{eFilterButton:t,eMenu:i}=this;return e?t??i??this.getGui():i??t??this.getGui()}destroy(){super.destroy(),this.innerHeaderComponent&&(this.destroyBean(this.innerHeaderComponent),this.innerHeaderComponent=void 0)}},zU={tag:"div",cls:"ag-header-group-cell-label",role:"presentation",children:[{tag:"span",ref:"agLabel",cls:"ag-header-group-text",role:"presentation"},{tag:"span",ref:"agOpened",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"},{tag:"span",ref:"agClosed",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"}]},WU=class extends ct{constructor(){super(zU),this.agOpened=se,this.agClosed=se,this.agLabel=se,this.isLoadingInnerComponent=!1}init(e){const{userCompFactory:t,touchSvc:i}=this.beans;this.params=e,this.checkWarnings(),this.workOutInnerHeaderGroupComponent(t,e),this.setupLabel(e),this.addGroupExpandIcon(e),this.setupExpandIcons(),i==null||i.setupForHeaderGroup(this)}checkWarnings(){this.params.template&&j(89)}workOutInnerHeaderGroupComponent(e,t){const i=a2(e,t,t);i&&(this.isLoadingInnerComponent=!0,i.newAgStackInstance().then(s=>{this.isLoadingInnerComponent=!1,s&&(this.isAlive()?(this.innerHeaderGroupComponent=s,this.agLabel.appendChild(s.getGui())):this.destroyBean(s))}))}setupExpandIcons(){const{agOpened:e,agClosed:t,params:{columnGroup:i},beans:s}=this;this.addInIcon("columnGroupOpened",e),this.addInIcon("columnGroupClosed",t);const n=l=>{if(Rr(l))return;const c=!i.isExpanded();s.colGroupSvc.setColumnGroupOpened(i.getProvidedColumnGroup(),c,"uiColumnExpanded")};this.addTouchAndClickListeners(s,t,n),this.addTouchAndClickListeners(s,e,n);const o=l=>{_c(l)};this.addManagedElementListeners(t,{dblclick:o}),this.addManagedElementListeners(e,{dblclick:o}),this.addManagedElementListeners(this.getGui(),{dblclick:n}),this.updateIconVisibility();const r=i.getProvidedColumnGroup(),a=this.updateIconVisibility.bind(this);this.addManagedListeners(r,{expandedChanged:a,expandableChanged:a})}addTouchAndClickListeners(e,t,i){var s;(s=e.touchSvc)==null||s.setupForHeaderGroupElement(this,t,i),this.addManagedElementListeners(t,{click:i})}updateIconVisibility(){const{agOpened:e,agClosed:t,params:{columnGroup:i}}=this;if(i.isExpandable()){const s=i.isExpanded();xt(e,s),xt(t,!s)}else xt(e,!1),xt(t,!1)}addInIcon(e,t){const i=tn(e,this.beans,null);i&&t.appendChild(i)}addGroupExpandIcon(e){if(!e.columnGroup.isExpandable()){const{agOpened:t,agClosed:i}=this;xt(t,!1),xt(i,!1)}}setupLabel(e){var n;const{displayName:t,columnGroup:i}=e,s=this.innerHeaderGroupComponent||this.isLoadingInnerComponent;ae(t)&&!s&&(this.agLabel.textContent=tu(t)),this.toggleCss("ag-sticky-label",!((n=i.getColGroupDef())!=null&&n.suppressStickyLabel))}destroy(){super.destroy(),this.innerHeaderGroupComponent&&(this.destroyBean(this.innerHeaderGroupComponent),this.innerHeaderGroupComponent=void 0)}},$U={moduleName:"ColumnHeaderComp",version:ne,userComponents:{agColumnHeader:VU},icons:{menu:"menu",menuAlt:"menu-alt"}},UU={moduleName:"ColumnGroupHeaderComp",version:ne,userComponents:{agColumnGroupHeader:WU},icons:{columnGroupOpened:"expanded",columnGroupClosed:"contracted"}},jU=class extends V{constructor(){super(...arguments),this.beanName="animationFrameSvc",this.p1={list:[],sorted:!1},this.p2={list:[],sorted:!1},this.f1={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastScrollTop=0,this.taskCount=0}setScrollTop(e){this.scrollGoingDown=e>=this.lastScrollTop,e===0&&(this.scrollGoingDown=!0),this.lastScrollTop=e}postConstruct(){this.active=!this.gos.get("suppressAnimationFrame"),this.batchFrameworkComps=this.beans.frameworkOverrides.batchFrameworkComps}verify(){this.active===!1&&j(92)}createTask(e,t,i,s,n=!1){this.verify();let o=i;s&&this.batchFrameworkComps&&(o="f1");const r={task:e,index:t,createOrder:++this.taskCount,deferred:n};this.addTaskToList(this[o],r),this.schedule()}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const t=this.scrollGoingDown?1:-1;e.list.sort((i,s)=>i.deferred!==s.deferred?i.deferred?-1:1:i.index!==s.index?t*(s.index-i.index):s.createOrder-i.createOrder),e.sorted=!0}addDestroyTask(e){this.verify(),this.destroyTasks.push(e),this.schedule()}executeFrame(e){const{p1:t,p2:i,f1:s,destroyTasks:n,beans:o}=this,{ctrlsSvc:r,frameworkOverrides:a}=o,l=t.list,c=i.list,d=s.list,h=Date.now();let u=0;const f=e<=0,p=r.getScrollFeature();for(;f||u<e;){if(!p.scrollGridIfNeeded()){let v;if(l.length)this.sortTaskList(t),v=l.pop().task;else if(c.length)this.sortTaskList(i),v=c.pop().task;else if(d.length)a.wrapOutgoing(()=>{for(;(f||u<e)&&!p.scrollGridIfNeeded();){if(d.length)this.sortTaskList(s),v=d.pop().task,v();else break;u=Date.now()-h}}),v=()=>{};else if(n.length)v=n.pop();else break;v()}u=Date.now()-h}l.length||c.length||d.length||n.length?this.requestFrame():this.ticking=!1}flushAllFrames(){this.active&&this.executeFrame(-1)}schedule(){this.active&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);Lr(this.beans,e)}isQueueEmpty(){return!this.ticking}},KU={moduleName:"AnimationFrame",version:ne,beans:[jU]},qU=class extends V{constructor(){super(...arguments),this.beanName="iconSvc"}createIconNoSpan(e,t){return tn(e,this.beans,t==null?void 0:t.column)}},YU=class extends V{constructor(){super(...arguments),this.beanName="touchSvc"}mockBodyContextMenu(e,t){this.mockContextMenu(e,e.eBodyViewport,t)}mockHeaderContextMenu(e,t){this.mockContextMenu(e,e.eGui,t)}mockRowContextMenu(e){if(!Sc())return;const t=(i,s,n)=>{var a;const{rowCtrl:o,cellCtrl:r}=e.getControlsForEventTarget((n==null?void 0:n.target)??null);r!=null&&r.column&&r.dispatchCellContextMenuEvent(n??null),(a=this.beans.contextMenuSvc)==null||a.handleContextMenuMouseEvent(void 0,n,o,r)};this.mockContextMenu(e,e.element,t)}handleCellDoubleClick(e,t){return(()=>{if(!Sc()||xP("dblclick"))return!1;const s=Date.now(),n=s-e.lastIPadMouseClickEvent<200;return e.lastIPadMouseClickEvent=s,n})()?(e.onCellDoubleClicked(t),t.preventDefault(),!0):!1}setupForHeader(e){const{gos:t,sortSvc:i,menuSvc:s}=this.beans;if(t.get("suppressTouch"))return;const{params:n,eMenu:o,eFilterButton:r}=e,a=new rl(e.getGui(),!0);e.addDestroyFunc(()=>a.destroy());const l=e.shouldSuppressMenuHide(),c=l&&ae(o)&&n.enableMenu;let d=a;if(c&&(d=new rl(o,!0),e.addDestroyFunc(()=>d.destroy())),n.enableMenu||s!=null&&s.isHeaderContextMenuEnabled(n.column)){const h=c?"tap":"longTap",u=f=>n.showColumnMenuAfterMouseClick(f.touchStart);e.addManagedListeners(d,{[h]:u}),e.addManagedListeners(a,{longTap:u})}if(n.enableSorting){const h=u=>{const f=u.touchStart.target;l&&(o!=null&&o.contains(f)||r!=null&&r.contains(f))||i==null||i.progressSort(n.column,!1,"uiColumnSorted")};e.addManagedListeners(a,{tap:h})}if(n.enableFilterButton&&r){const h=new rl(r,!0);e.addManagedListeners(h,{tap:()=>n.showFilter(r)}),e.addDestroyFunc(()=>h.destroy())}}setupForHeaderGroup(e){var i;const t=e.params;if((i=this.beans.menuSvc)!=null&&i.isHeaderContextMenuEnabled(t.columnGroup.getProvidedColumnGroup())){const s=new rl(t.eGridHeader,!0),n=o=>t.showColumnMenuAfterMouseClick(o.touchStart);e.addManagedListeners(s,{longTap:n}),e.addDestroyFunc(()=>s.destroy())}}setupForHeaderGroupElement(e,t,i){const s=new rl(t,!0);e.addManagedListeners(s,{tap:i}),e.addDestroyFunc(()=>s.destroy())}mockContextMenu(e,t,i){if(!Sc())return;const s=new rl(t),n=o=>{dg(this.beans,o.touchEvent)&&i(void 0,o.touchStart,o.touchEvent)};e.addManagedListeners(s,{longTap:n}),e.addDestroyFunc(()=>s.destroy())}},XU={moduleName:"Touch",version:ne,beans:[YU]},QU=class extends V{constructor(){super(...arguments),this.beanName="cellNavigation"}wireBeans(e){this.rowSpanSvc=e.rowSpanSvc}getNextCellToFocus(e,t,i=!1){return i?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const i=e===H.UP,s=e===H.DOWN,n=e===H.LEFT;let o,r;const{pageBounds:a,gos:l,visibleCols:c,pinnedRowModel:d}=this.beans,{rowPinned:h}=t;if(i||s)h&&d?i?r=0:r=h==="top"?d.getPinnedTopRowCount()-1:d.getPinnedBottomRowCount()-1:r=i?a.getFirstRow():a.getLastRow(),o=t.column;else{const u=l.get("enableRtl");r=t.rowIndex,o=(n!==u?c.allCols:[...c.allCols].reverse()).find(p=>this.isCellGoodToFocusOn({rowIndex:r,rowPinned:null,column:p}))}return o?{rowIndex:r,rowPinned:h,column:o}:null}getNextCellToFocusWithoutCtrlPressed(e,t){let i=t,s=!1;for(;!s;){switch(e){case H.UP:i=this.getCellAbove(i);break;case H.DOWN:i=this.getCellBelow(i);break;case H.RIGHT:i=this.gos.get("enableRtl")?this.getCellToLeft(i):this.getCellToRight(i);break;case H.LEFT:i=this.gos.get("enableRtl")?this.getCellToRight(i):this.getCellToLeft(i);break;default:i=null,j(8,{key:e});break}i?s=this.isCellGoodToFocusOn(i):s=!0}return i}isCellGoodToFocusOn(e){const t=e.column;let i;const{pinnedRowModel:s,rowModel:n}=this.beans;switch(e.rowPinned){case"top":i=s==null?void 0:s.getPinnedTopRow(e.rowIndex);break;case"bottom":i=s==null?void 0:s.getPinnedBottomRow(e.rowIndex);break;default:i=n.getRow(e.rowIndex);break}return i?!this.isSuppressNavigable(t,i):!1}getCellToLeft(e){if(!e)return null;const t=this.beans.visibleCols.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.beans.visibleCols.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellBelow(e){var s;if(!e)return null;const t=((s=this.rowSpanSvc)==null?void 0:s.getCellEnd(e))??e,i=VR(this.beans,t,!0);return i?{rowIndex:i.rowIndex,column:e.column,rowPinned:i.rowPinned}:null}getCellAbove(e){var s;if(!e)return null;const t=((s=this.rowSpanSvc)==null?void 0:s.getCellStart(e))??e,i=qm(this.beans,{rowIndex:t.rowIndex,rowPinned:t.rowPinned},!0);return i?{rowIndex:i.rowIndex,column:e.column,rowPinned:i.rowPinned}:null}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){const{visibleCols:t,pagination:i}=this.beans,s=t.allCols;let n=e.rowIndex,o=e.rowPinned,r=t.getColAfter(e.column);if(!r){r=s[0];const a=VR(this.beans,e,!0);if(At(a)||!a.rowPinned&&!((i==null?void 0:i.isRowInPage(a.rowIndex))??!0))return null;n=a?a.rowIndex:null,o=a?a.rowPinned:null}return{rowIndex:n,column:r,rowPinned:o}}getNextTabbedCellBackwards(e){const{beans:t}=this,{visibleCols:i,pagination:s}=t,n=i.allCols;let o=e.rowIndex,r=e.rowPinned,a=i.getColBefore(e.column);if(!a){a=Ct(n);const l=qm(t,{rowIndex:e.rowIndex,rowPinned:e.rowPinned},!0);if(At(l)||!l.rowPinned&&!((s==null?void 0:s.isRowInPage(l.rowIndex))??!0))return null;o=l?l.rowIndex:null,r=l?l.rowPinned:null}return{rowIndex:o,column:a,rowPinned:r}}isSuppressNavigable(e,t){const{suppressNavigable:i}=e.colDef;if(typeof i=="boolean")return i;if(typeof i=="function"){const s=e.createColumnFunctionCallbackParams(t);return i(s)}return!1}};function JU(e){return e.focusSvc.getFocusedCell()}function ZU(e){return e.focusSvc.clearFocusedCell()}function e5(e,t,i,s){e.focusSvc.setFocusedCell({rowIndex:t,column:i,rowPinned:s,forceBrowserFocus:!0})}function t5(e,t){var i;return((i=e.navigation)==null?void 0:i.tabToNextCell(!1,t))??!1}function i5(e,t){var i;return((i=e.navigation)==null?void 0:i.tabToNextCell(!0,t))??!1}function s5(e,t,i=!1){var n;const s=(n=e.headerNavigation)==null?void 0:n.getHeaderPositionForColumn(t,i);s&&e.focusSvc.focusHeaderPosition({headerPosition:s})}var n5=class extends V{constructor(){super(...arguments),this.beanName="editModelSvc",this.edits=new Map,this.cellValidations=new vD,this.rowValidations=new CD,this.suspendEdits=!1}suspend(e){this.suspendEdits=e}removeEdits({rowNode:e,column:t}){if(!this.hasEdits({rowNode:e})||!e)return;const i=this.getEditRow(e);t?i.delete(t):i.clear(),i.size===0&&this.edits.delete(e)}getEditRow(e,t={}){if(this.suspendEdits||this.edits.size===0)return;const i=e&&this.edits.get(e);if(i)return i;if(t.checkSiblings){const s=e.pinnedSibling;if(s)return this.getEditRow(s)}}getEditRowDataValue(e,{checkSiblings:t}={}){if(!e||this.edits.size===0)return;const i=this.getEditRow(e),s=e.pinnedSibling,n=t&&s&&this.getEditRow(s);if(!i&&!n)return;const o=Object.assign({},e.data),r=(a,l)=>a.forEach(({pendingValue:c},d)=>{c!==rn&&(l[d.getColId()]=c)});return i&&r(i,o),n&&r(n,o),o}getEdit(e,t){const i=this._getEdit(e);return t&&i?{...i}:i}_getEdit(e){var t;if(!this.suspendEdits&&this.edits.size!==0)return e.rowNode&&e.column&&((t=this.getEditRow(e.rowNode))==null?void 0:t.get(e.column))}getEditMap(e=!0){if(this.suspendEdits||this.edits.size===0)return new Map;if(!e)return this.edits;const t=new Map;return this.edits.forEach((i,s)=>{const n=new Map;i.forEach(({editorState:o,...r},a)=>n.set(a,{...r})),t.set(s,n)}),t}setEditMap(e){this.edits.clear(),e.forEach((t,i)=>{const s=new Map;t.forEach((n,o)=>s.set(o,{...n})),this.edits.set(i,s)})}setEdit(e,t){(this.edits.size===0||!this.edits.has(e.rowNode))&&this.edits.set(e.rowNode,new Map);const i=this._getEdit(e),s=Object.assign({editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0},...i,...t});return this.getEditRow(e.rowNode).set(e.column,s),s}clearEditValue(e){var s;const{rowNode:t,column:i}=e;if(t)if(i){const n=this._getEdit(e);n&&(n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed")}else(s=this.getEditRow(t))==null||s.forEach(n=>{n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed"})}getState(e){var t;if(!this.suspendEdits)return(t=this.getEdit(e))==null?void 0:t.state}getEditPositions(e){if(this.suspendEdits||(e??this.edits).size===0)return[];const t=[];return(e??this.edits).forEach((i,s)=>{for(const n of i.keys()){const{editorState:o,...r}=i.get(n);t.push({rowNode:s,column:n,...r})}}),t}hasRowEdits(e,t){return this.suspendEdits||this.edits.size===0?!1:!!this.getEditRow(e,t)}hasEdits(e={},t={}){var o;if(this.suspendEdits||this.edits.size===0)return!1;const{rowNode:i,column:s}=e,{withOpenEditor:n}=t;if(i){const r=this.getEditRow(i,t);return r?s?n?((o=this.getEdit(e))==null?void 0:o.state)==="editing":r.has(s)??!1:r.size!==0?n?Array.from(r.values()).some(({state:a})=>a==="editing"):!0:!1:!1}return n?this.getEditPositions().some(({state:r})=>r==="editing"):this.edits.size>0}start(e){const t=this.getEditRow(e.rowNode)??new Map,{rowNode:i,column:s}=e;s&&!t.has(s)&&t.set(s,{editorValue:void 0,pendingValue:rn,sourceValue:this.beans.valueSvc.getValue(s,i,!1,"api"),state:"editing",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}}),this.edits.set(i,t)}stop(e){this.hasEdits(e)&&(e?this.removeEdits(e):this.clear())}clear(){for(const e of this.edits.values())e.clear();this.edits.clear()}getCellValidationModel(){return this.cellValidations}getRowValidationModel(){return this.rowValidations}setCellValidationModel(e){this.cellValidations=e}setRowValidationModel(e){this.rowValidations=e}destroy(){super.destroy(),this.clear()}},vD=class{constructor(){this.cellValidations=new Map}getCellValidation(e){var s,n;const{rowNode:t,column:i}=e||{};return(n=(s=this.cellValidations)==null?void 0:s.get(t))==null?void 0:n.get(i)}hasCellValidation(e){return!(e!=null&&e.rowNode)||!e.column?this.cellValidations.size>0:!!this.getCellValidation(e)}setCellValidation(e,t){const{rowNode:i,column:s}=e;this.cellValidations.has(i)||this.cellValidations.set(i,new Map),this.cellValidations.get(i).set(s,t)}clearCellValidation(e){var s;const{rowNode:t,column:i}=e;(s=this.cellValidations.get(t))==null||s.delete(i)}setCellValidationMap(e){this.cellValidations=e}getCellValidationMap(){return this.cellValidations}clearCellValidationMap(){this.cellValidations.clear()}},CD=class{constructor(){this.rowValidations=new Map}getRowValidation(e){const{rowNode:t}=e||{};return this.rowValidations.get(t)}hasRowValidation(e){return e!=null&&e.rowNode?!!this.getRowValidation(e):this.rowValidations.size>0}setRowValidation({rowNode:e},t){this.rowValidations.set(e,t)}clearRowValidation({rowNode:e}){this.rowValidations.delete(e)}setRowValidationMap(e){this.rowValidations=e}getRowValidationMap(){return this.rowValidations}clearRowValidationMap(){this.rowValidations.clear()}};function HS(e,t={}){var c;const{rowIndex:i,rowId:s,rowCtrl:n,rowPinned:o}=t;if(n)return n;const{rowModel:r,rowRenderer:a}=e;let{rowNode:l}=t;return l||(s?l=PW(e,s,o):i!=null&&(l=r.getRow(i))),(c=a.getRowCtrls(l?[l]:[]))==null?void 0:c[0]}function Pt(e,t={}){var d;const{cellCtrl:i,colId:s,columnId:n,column:o}=t;if(i)return i;const r=e.colModel.getCol(s??n??hy(o)),a=t.rowCtrl??HS(e,t),l=(a==null?void 0:a.getCellCtrl(r))??void 0;if(l)return l;const c=t.rowNode??(a==null?void 0:a.rowNode);if(c)return(d=e.rowRenderer.getCellCtrls([c],[r]))==null?void 0:d[0]}function ix(e){const{editSvc:t}=e;t!=null&&t.isBatchEditing()?Dd(e):t==null||t.stopEditing(void 0,{source:"api"})}function o5(e,t,i){const{gos:s,popupSvc:n}=t;if(!s.get("stopEditingWhenCellsLoseFocus"))return;const o=r=>{const a=r.relatedTarget;if(Xb(a)===null){ix(t);return}let l=i.some(c=>c.contains(a))&&s.isElementInThisInstance(a);l||(l=!!n&&(n.getActivePopups().some(c=>c.contains(a))||n.isElementWithinCustomPopup(a))),l||ix(t)};for(const r of i)e.addManagedElementListeners(r,{focusout:o})}function hy(e){if(e)return typeof e=="string"?e:e.getColId()}var rn=Symbol("unedited");function wD(e,t={}){var n;const i=[],s=e.rowRenderer.getCellCtrls(t.rowNodes,t.columns);for(const o of s){const r=(n=o.comp)==null?void 0:n.getCellEditor();r&&i.push({ctrl:o,editor:fg(r)})}return i}var r5=(e,t={})=>wD(e,t).map(i=>i.editor);function a5(e,t,i,s,n,o){var h;t.length===0&&(i!=null&&i.rowNode)&&(i!=null&&i.column)&&Kh(e,i,{key:s,event:n,cellStartedEdit:o});const{valueSvc:r,editSvc:a,editModelSvc:l}=e,{rowNode:c,column:d}=i??{};for(const u of t){const{rowNode:f,column:p}=u,m=Pt(e,u);if(!m){if(f&&p){const C=r.getValue(p,f,void 0,"api"),b=((i==null?void 0:i.rowNode)===f&&(i==null?void 0:i.column)===p&&s||void 0)??(a==null?void 0:a.getCellDataValue(u,!1))??((h=r.getValueForDisplay(p,f))==null?void 0:h.value)??C??rn;l==null||l.setEdit(u,{pendingValue:b,sourceValue:C,state:"editing"})}continue}const v=o&&c===m.rowNode&&m.column===d;Kh(e,{rowNode:c,column:m.column},{key:v?s:null,event:v?n:null,cellStartedEdit:v&&o})}}function vr({pendingValue:e,sourceValue:t}){return e===rn&&(e=t),e!==t}function Kh(e,t,i){var C,w,S,b,E,A,P,T,D,N;const s=e.gos.get("enableGroupEdit"),{key:n,event:o,cellStartedEdit:r,silent:a}=i??{},l=Pt(e,t),c=(C=l==null?void 0:l.comp)==null?void 0:C.getCellEditor(),d=yD(e,t,n,r&&!a),h=(w=e.editModelSvc)==null?void 0:w.getEdit(t);let u=d.value;if(u===void 0&&(u=h==null?void 0:h.sourceValue),(S=e.editModelSvc)==null||S.setEdit(t,{editorValue:u,state:"editing"}),c){(b=c.refresh)==null||b.call(c,d);return}const f=t.column.getColDef(),p=rT(e.userCompFactory,f,d),m=(p==null?void 0:p.popupFromSelector)!=null?p.popupFromSelector:!!f.cellEditorPopup,v=(p==null?void 0:p.popupPositionFromSelector)!=null?p.popupPositionFromSelector:f.cellEditorPopupPosition;if(SD(p.params,o),l){l.editCompDetails=p,l.onEditorAttachedFuncs.push(()=>{var _;return(_=l.rangeFeature)==null?void 0:_.unsetComp()}),(E=l.comp)==null||E.setEditDetails(p,m,v,e.gos.get("reactiveCustomComponents")),(A=l==null?void 0:l.rowCtrl)==null||A.refreshRow({suppressFlash:!0});const M=(P=e.editModelSvc)==null?void 0:P.getEdit(t,!0);!a&&!((T=M==null?void 0:M.editorState)!=null&&T.cellStartedEditing)&&((D=e.editSvc)==null||D.dispatchCellEvent(t,o,"cellEditingStarted",s?{value:u}:{}),(N=e.editModelSvc)==null||N.setEdit(t,{editorState:{cellStartedEditing:!0}}))}}function bD(e,t,i){var o,r;const s={editorValueExists:!1};if(GS(e)){const a=(o=t.getValidationErrors)==null?void 0:o.call(t);if(((a==null?void 0:a.length)??0)>0)return s}if(i!=null&&i.isCancelling)return s;if(i!=null&&i.isStopping){const a=(r=t==null?void 0:t.isCancelAfterEnd)==null?void 0:r.call(t);if(a)return{...s,isCancelAfterEnd:a}}return{editorValue:t.getValue(),editorValueExists:!0}}function yD(e,t,i,s){var w,S,b,E;const{valueSvc:n,gos:o,editSvc:r}=e,a=e.gos.get("enableGroupEdit"),l=Pt(e,t),c=((w=t.rowNode)==null?void 0:w.rowIndex)??void 0,d=r==null?void 0:r.isBatchEditing(),h=e.colModel.getCol(t.column.getId()),{rowNode:u,column:f}=t,p=(S=l.comp)==null?void 0:S.getCellEditor(),m=r==null?void 0:r.getCellDataValue(t,!1),v=m===void 0?p?(b=bD(e,p))==null?void 0:b.editorValue:void 0:m,C=v===rn?(E=n.getValueForDisplay(h,u))==null?void 0:E.value:v;return Fe(o,{value:a?v:C,eventKey:i??null,column:f,colDef:f.getColDef(),rowIndex:c,node:u,data:u.data,cellStartedEdit:s??!1,onKeyDown:l==null?void 0:l.onKeyDown.bind(l),stopEditing:A=>{r.stopEditing(t,{source:d?"ui":"api",suppressNavigateAfterEdit:A}),Ym(e,t)},eGridCell:l==null?void 0:l.eGui,parseValue:A=>n.parseValue(h,u,A,l==null?void 0:l.value),formatValue:l==null?void 0:l.formatValue.bind(l),validate:()=>{r==null||r.validateEdit()}})}function uy(e,t){const{editModelSvc:i}=e;i==null||i.getEditMap().forEach((s,n)=>{s.forEach((o,r)=>{!t&&(o.state==="editing"||o.pendingValue===rn)||!vr(o)&&(o.state!=="editing"||t)&&(i==null||i.removeEdits({rowNode:n,column:r}))})})}function l5(e,t){var c;const i=(c=t.comp)==null?void 0:c.getCellEditor();if(!(i!=null&&i.refresh))return;const{eventKey:s,cellStartedEdit:n}=t.editCompDetails.params,{column:o}=t,r=yD(e,t,s,n),a=o.getColDef(),l=rT(e.userCompFactory,a,r);i.refresh(SD(l.params,s))}function SD(e,t){var i;return t instanceof KeyboardEvent&&e.column.getColDef().cellEditor==="agNumberCellEditor"?e.suppressPreventDefault=["-","+",".","e"].includes((t==null?void 0:t.key)??"")||e.suppressPreventDefault:(i=t==null?void 0:t.preventDefault)==null||i.call(t),e}function fl(e,t){var i,s,n;for(const o of((i=e.editModelSvc)==null?void 0:i.getEditPositions())??[]){const r=Pt(e,o);if(!r)continue;const a=(s=r.comp)==null?void 0:s.getCellEditor();if(!a)continue;const{editorValue:l,editorValueExists:c,isCancelAfterEnd:d}=bD(e,a,t);d&&((n=e.editModelSvc)==null||n.setEdit(o,{editorState:{isCancelAfterEnd:d}})),Cm(e,o,l,void 0,!c,t)}}function Cm(e,t,i,s,n,o){const{editModelSvc:r,valueSvc:a}=e;if(!r)return;const{rowNode:l,column:c}=t;if(!(l&&c))return;let d=r.getEdit(t,!0);d!=null&&d.sourceValue||(d=r.setEdit(t,{sourceValue:a.getValue(c,l,void 0,"api"),pendingValue:d?d.editorValue:rn})),r.setEdit(t,{editorValue:n?d.sourceValue:i}),o!=null&&o.persist&&c5(e,t)}function c5(e,t){const{editModelSvc:i}=e,s=i==null?void 0:i.getEdit(t,!0);i==null||i.setEdit(t,{pendingValue:s==null?void 0:s.editorValue})}function Dd(e,t,i){var s;t||(t=(s=e.editModelSvc)==null?void 0:s.getEditPositions());for(const n of t??[])Ym(e,n,i)}function Ym(e,t,i){var c,d;const s=e.gos.get("enableGroupEdit"),{editModelSvc:n}=e,o=Pt(e,t),r=n==null?void 0:n.getEdit(t,!0);if(!o){r&&(n==null||n.setEdit(t,{state:"changed"}));return}const{comp:a}=o;if(a&&!a.getCellEditor()){if(o==null||o.refreshCell(),r){n==null||n.setEdit(t,{state:"changed"});const h=s?sx(i,r):{valueChanged:!1,newValue:void 0,oldValue:r.sourceValue};nx(e,t,h,i)}return}if(GS(e)){const h=(d=(c=a==null?void 0:a.getCellEditor())==null?void 0:c.getValidationErrors)==null?void 0:d.call(c),u=n==null?void 0:n.getCellValidationModel();h!=null&&h.length?u==null||u.setCellValidation(t,{errorMessages:h}):u==null||u.clearCellValidation(t)}n==null||n.setEdit(t,{state:"changed"}),a==null||a.setEditDetails(),a==null||a.refreshEditStyles(!1,!1),o==null||o.refreshCell({force:!0,suppressFlash:!0});const l=n==null?void 0:n.getEdit(t);if(l&&l.state==="changed"){const h=s?sx(i,l):{valueChanged:vr(l)&&!(i!=null&&i.cancel),newValue:i!=null&&i.cancel||l.editorState.isCancelAfterEnd?void 0:(l==null?void 0:l.editorValue)??(r==null?void 0:r.pendingValue),oldValue:l==null?void 0:l.sourceValue};nx(e,t,h,i)}}function sx(e,t){return e!=null&&e.cancel?{valueChanged:!1,oldValue:t.sourceValue,newValue:void 0,value:t.sourceValue}:{valueChanged:!1,oldValue:t.sourceValue,newValue:t.pendingValue,value:t.sourceValue}}function nx(e,t,i,{silent:s,event:n}={}){const{editSvc:o,editModelSvc:r}=e,a=r==null?void 0:r.getEdit(t),{editorState:l}=a||{},{isCancelBeforeStart:c}=l||{};!s&&!c&&(o==null||o.dispatchCellEvent(t,n,"cellEditingStopped",i),r==null||r.setEdit(t,{editorState:{cellStoppedEditing:!0}}))}function GS(e){var r;const{gos:t,colModel:i}=e,s=!!t.get("getFullRowEditValidationErrors"),n=(r=i.getColumnDefs())==null?void 0:r.filter(a=>a.editable).some(({cellEditorParams:a})=>{const{minLength:l,maxLength:c,getValidationErrors:d,min:h,max:u}=a||{};return l!==void 0||c!==void 0||d!==void 0||h!==void 0||u!==void 0}),o=e.gridApi.getCellEditorInstances().some(a=>a.getValidationElement||a.getValidationErrors);return n||s||o}function Lc(e,t){var u,f,p,m,v,C,w,S;if(!(t||GS(e)))return;const i=wD(e),s=new vD,{ariaAnnounce:n,localeSvc:o,editModelSvc:r,gos:a}=e,l=a.get("editType")==="fullRow",d=AP(o)("ariaValidationErrorPrefix","Cell Editor Validation");for(const b of i){const{ctrl:E,editor:A}=b,{rowNode:P,column:T}=E,D=((u=A.getValidationErrors)==null?void 0:u.call(A))??[],N=((f=A.getValidationElement)==null?void 0:f.call(A,!1))||!((p=A.isPopup)!=null&&p.call(A))&&E.eGui;if(N){const M=D!=null&&D.length>0,_=M?D.join(". "):"";iH(N,M),M&&n.announceValue(`${d} ${D}`,"editorValidation"),N instanceof HTMLInputElement?N.setCustomValidity(_):N.classList.toggle("invalid",M)}(D==null?void 0:D.length)>0&&s.setCellValidation({rowNode:P,column:T},{errorMessages:D})}fl(e,{persist:!1}),r==null||r.setCellValidationModel(s);const h=new Set;for(const{ctrl:b}of i)h.add(b.rowCtrl);if(l){const b=d5(e);r==null||r.setRowValidationModel(b)}for(const b of h.values()){(m=b.rowEditStyleFeature)==null||m.applyRowStyles();for(const E of b.getAllCellCtrls())(v=E.tooltipFeature)==null||v.refreshTooltip(!0),(C=E.editorTooltipFeature)==null||C.refreshTooltip(!0),(S=(w=E.editStyleFeature)==null?void 0:w.applyCellStyles)==null||S.call(w)}}var d5=e=>{var n;const t=new CD,i=e.gos.get("getFullRowEditValidationErrors"),s=(n=e.editModelSvc)==null?void 0:n.getEditMap();if(!s)return t;for(const o of s.keys()){const r=s.get(o);if(!r)continue;const a=[],{rowIndex:l,rowPinned:c}=o;for(const h of r.keys()){const u=r.get(h);if(!u)continue;const{editorValue:f,pendingValue:p,sourceValue:m}=u,v=f??(p===rn?void 0:p)??m;a.push({column:h,colId:h.getColId(),rowIndex:l,rowPinned:c,oldValue:m,newValue:v})}const d=(i==null?void 0:i({editorsState:a}))??[];d.length>0&&t.setRowValidation({rowNode:o},{errorMessages:d})}return t};function h5(e){var s;Lc(e,!0);const t=(s=e.editModelSvc)==null?void 0:s.getCellValidationModel().getCellValidationMap();if(!t)return null;const i=[];return t.forEach((n,o)=>{n.forEach(({errorMessages:r},a)=>{i.push({column:a,rowIndex:o.rowIndex,rowPinned:o.rowPinned,messages:r??null})})}),i}function u5(e,t,i,{rowNode:s,column:n},o){return Fe(e.gos,{type:i,node:s,data:s.data,value:o,column:n,colDef:n.getColDef(),rowPinned:s.rowPinned,event:t,rowIndex:s.rowIndex})}function g5(e,t=!1){return e===H.DELETE?!0:!t&&e===H.BACKSPACE?cT():!1}var f5=class extends V{constructor(e,t,i,s){super(),this.cellCtrl=e,this.rowNode=i,this.rowCtrl=s,this.beans=t}init(){this.eGui=this.cellCtrl.eGui}onKeyDown(e){const t=e.key;switch(t){case H.ENTER:this.onEnterKeyDown(e);break;case H.F2:this.onF2KeyDown(e);break;case H.ESCAPE:this.onEscapeKeyDown(e);break;case H.TAB:this.onTabKeyDown(e);break;case H.BACKSPACE:case H.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case H.DOWN:case H.UP:case H.RIGHT:case H.LEFT:this.onNavigationKeyDown(e,t);break}}onNavigationKeyDown(e,t){var n,o;const{cellCtrl:i,beans:s}=this;if(!((n=s.editSvc)!=null&&n.isEditing(i,{withOpenEditor:!0}))){if(e.shiftKey&&i.isRangeSelectionEnabled())this.onShiftRangeSelect(e);else{const r=i.getFocusedCellPosition();(o=s.navigation)==null||o.navigateToNextCell(e,t,r,!0)}e.preventDefault()}}onShiftRangeSelect(e){const{rangeSvc:t,navigation:i}=this.beans;if(!t)return;const s=t.extendLatestRangeInDirection(e);s&&(e.key===H.LEFT||e.key===H.RIGHT?i==null||i.ensureColumnVisible(s.column):i==null||i.ensureRowVisible(s.rowIndex))}onTabKeyDown(e){var t;(t=this.beans.navigation)==null||t.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){var c;const{cellCtrl:i,beans:s,rowNode:n}=this,{gos:o,rangeSvc:r,eventSvc:a,editSvc:l}=s;if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),g5(e,o.get("enableCellEditingOnBackspace"))&&!(l!=null&&l.isEditing(i,{withOpenEditor:!0}))){if(r&&Tr(o))r.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(i.isCellEditable()){const{column:d}=i,h=this.beans.valueSvc.getDeleteValue(d,n);n.setDataValue(d,h,"cellClear")}}else l!=null&&l.isEditing(i,{withOpenEditor:!0})||(c=s.editSvc)==null||c.startEditing(i,{startedEdit:!0,event:t});a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}onEnterKeyDown(e){var c;const{cellCtrl:t,beans:i}=this,{editSvc:s,navigation:n}=i,o=s==null?void 0:s.isEditing(t,{withOpenEditor:!0}),r=t.rowNode,a=s==null?void 0:s.isRowEditing(r,{withOpenEditor:!0}),l=d=>{(s==null?void 0:s.startEditing(d,{startedEdit:!0,event:e,source:"edit"}))&&e.preventDefault()};if(o||a){if(this.isCtrlEnter(e)){s==null||s.applyBulkEdit(t,((c=i==null?void 0:i.rangeSvc)==null?void 0:c.getCellRanges())||[]);return}if(Lc(i),(s==null?void 0:s.checkNavWithValidation(void 0,e))==="block-stop")return;s!=null&&s.isEditing(t,{withOpenEditor:!0})?s==null||s.stopEditing(t,{event:e,source:"edit"}):a&&!t.isCellEditable()?s==null||s.stopEditing({rowNode:r},{event:e,source:"edit"}):l(t)}else if(i.gos.get("enterNavigatesVertically")){const d=e.shiftKey?H.UP:H.DOWN;n==null||n.navigateToNextCell(null,d,t.cellPosition,!1)}else{if(s!=null&&s.hasValidationErrors())return;s!=null&&s.hasValidationErrors(t)&&s.revertSingleCellEdit(t,!0),l(t)}}isCtrlEnter(e){return(e.ctrlKey||e.metaKey)&&e.key===H.ENTER}onF2KeyDown(e){const{cellCtrl:t,beans:{editSvc:i}}=this;i!=null&&i.isEditing()&&(Lc(this.beans),(i==null?void 0:i.checkNavWithValidation(void 0,e))==="block-stop")||i==null||i.startEditing(t,{startedEdit:!0,event:e})}onEscapeKeyDown(e){const{cellCtrl:t,beans:{editSvc:i}}=this;(i==null?void 0:i.checkNavWithValidation(t,e))==="block-stop"&&i.revertSingleCellEdit(t),i==null||i.stopEditing(t,{event:e,cancel:!0})}processCharacter(e){var r;const i=e.target!==this.eGui,{beans:{editSvc:s},cellCtrl:n}=this;if(i||s!=null&&s.isEditing(n,{withOpenEditor:!0}))return;if(e.key===H.SPACE)this.onSpaceKeyDown(e);else if(s!=null&&s.isCellEditable(n,"ui")){if(s!=null&&s.hasValidationErrors()&&!(s!=null&&s.hasValidationErrors(n)))return;s==null||s.startEditing(n,{startedEdit:!0,event:e,source:"api"});const a=n.editCompDetails;!((r=a==null?void 0:a.params)!=null&&r.suppressPreventDefault)&&e.preventDefault()}}onSpaceKeyDown(e){var n;const{gos:t,editSvc:i}=this.beans,{rowNode:s}=this.cellCtrl;!(i!=null&&i.isEditing(this.cellCtrl,{withOpenEditor:!0}))&&bc(t)&&((n=this.beans.selectionSvc)==null||n.handleSelectionEvent(e,s,"spaceKey")),e.preventDefault()}},p5=class extends V{constructor(e,t,i){super(),this.cellCtrl=e,this.column=i,this.beans=t}onMouseEvent(e,t){if(!Rr(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t);break}}onCellClicked(e){var m;if((m=this.beans.touchSvc)!=null&&m.handleCellDoubleClick(this,e))return;const{eventSvc:t,rangeSvc:i,editSvc:s,editModelSvc:n,frameworkOverrides:o,gos:r}=this.beans,a=e.ctrlKey||e.metaKey,{cellCtrl:l}=this,{column:c,cellPosition:d,rowNode:h}=l,u=gm(r,c,h,e);i&&a&&!u&&i.getCellRangeCount(d)>1&&i.intersectLastRange(!0);const f=l.createEvent(e,"cellClicked");f.isEventHandlingSuppressed=u,t.dispatchEvent(f);const p=c.getColDef();if(p.onCellClicked&&window.setTimeout(()=>{o.wrapOutgoing(()=>{p.onCellClicked(f)})},0),!u&&(n==null?void 0:n.getState(l))!=="editing"){const v=s==null?void 0:s.isEditing(),C=(n==null?void 0:n.getCellValidationModel().getCellValidationMap().size)??0,w=(n==null?void 0:n.getRowValidationModel().getRowValidationMap().size)??0;if(v&&(C>0||w>0))return;s!=null&&s.shouldStartEditing(l,e)?s==null||s.startEditing(l,{event:e}):s!=null&&s.shouldStopEditing(l,e)&&(this.beans.gos.get("editType")==="fullRow"?s==null||s.stopEditing(l,{event:e,source:"edit"}):s==null||s.stopEditing(void 0,{event:e,source:"edit"}))}}onCellDoubleClicked(e){const{column:t,beans:i,cellCtrl:s}=this,{eventSvc:n,frameworkOverrides:o,editSvc:r,editModelSvc:a,gos:l}=i,c=gm(l,s.column,s.rowNode,e),d=t.getColDef(),h=s.createEvent(e,"cellDoubleClicked");if(h.isEventHandlingSuppressed=c,n.dispatchEvent(h),typeof d.onCellDoubleClicked=="function"&&window.setTimeout(()=>{o.wrapOutgoing(()=>{d.onCellDoubleClicked(h)})},0),!c&&r!=null&&r.shouldStartEditing(s,e)&&(a==null?void 0:a.getState(s))!=="editing"){const u=r==null?void 0:r.isEditing(),f=(a==null?void 0:a.getCellValidationModel().getCellValidationMap().size)??0,p=(a==null?void 0:a.getRowValidationModel().getRowValidationMap().size)??0;if(u&&(f>0||p>0))return;r==null||r.startEditing(s,{event:e})}}onMouseDown(e){const{ctrlKey:t,metaKey:i,shiftKey:s}=e,n=e.target,{cellCtrl:o,beans:r}=this,{eventSvc:a,rangeSvc:l,rowNumbersSvc:c,focusSvc:d,gos:h,editSvc:u}=r,{column:f,rowNode:p,cellPosition:m}=o,v=gm(h,f,p,e),C=()=>{const E=o.createEvent(e,"cellMouseDown");E.isEventHandlingSuppressed=v,a.dispatchEvent(E)};if(v){C();return}if(this.isRightClickInExistingRange(e))return;const w=l&&!l.isEmpty(),S=this.containsWidget(n),b=yr(f);if(c&&b&&!c.handleMouseDownOnCell(m,e)){l&&e.preventDefault(),e.stopImmediatePropagation();return}if(!s||!w){const E=u==null?void 0:u.isEditing(o),P=h.get("enableCellTextSelection")&&e.defaultPrevented,T=(Xa()||P)&&!E&&!zu(n)&&!S;o.focusCell(T,e)}if(s&&w&&!d.isCellFocused(m)){e.preventDefault();const E=d.getFocusedCell();if(E){const{column:A,rowIndex:P,rowPinned:T}=E;u!=null&&u.isEditing(E)&&(u==null||u.stopEditing(E)),d.setFocusedCell({column:A,rowIndex:P,rowPinned:T,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,sourceEvent:e})}}if(!S){if(l){b&&e.preventDefault();const E=lR(r,e)&&b;if(s)l.extendLatestRangeToCell(m);else if(!E){const A=t||i;l.setRangeToCell(m,A)}}C()}}isRightClickInExistingRange(e){const{rangeSvc:t}=this.beans;if(t){const i=t.isCellInAnyRange(this.cellCtrl.cellPosition),s=lR(this.beans,e);if(i&&s)return!0}return!1}containsWidget(e){return wc(e,"ag-selection-checkbox",3)||wc(e,"ag-drag-handle",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:i}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),i==null||i.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:i}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),i==null||i.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.eGui,i=t.contains(e.target),s=t.contains(e.relatedTarget);return i&&s}},m5=class extends V{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.column,this.rowNode=e.rowNode}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}init(){this.eSetLeft=this.cellCtrl.getRootElement(),this.eContent=this.cellCtrl.eGui;const e=this.cellCtrl.getCellSpan();if(e||(this.setupColSpan(),this.setupRowSpan()),this.onLeftChanged(),this.onWidthChanged(),e||this._legacyApplyRowSpan(),e){const t=this.refreshSpanHeight.bind(this,e);t(),this.addManagedListeners(this.beans.eventSvc,{paginationChanged:t,recalculateRowBounds:t,pinnedHeightChanged:t})}}refreshSpanHeight(e){const t=e.getCellHeight();t!=null&&(this.eContent.style.height=`${t}px`)}onNewColumnsLoaded(){const e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this._legacyApplyRowSpan(!0))}onDisplayColumnsChanged(){const e=this.getColSpanningList();Ya(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eContent)return;const e=this.getCellWidth();this.eContent.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const{column:e,rowNode:t}=this,i=e.getColSpan(t),s=[];if(i===1)s.push(e);else{let n=e;const o=e.getPinned();for(let r=0;n&&r<i&&(s.push(n),n=this.beans.visibleCols.getColAfter(n),!(!n||At(n)||o!==n.getPinned()));r++);}return s}onLeftChanged(){if(!this.eSetLeft)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eSetLeft.style.left=e+"px"}getCellLeft(){let e;return this.beans.gos.get("enableRtl")&&this.colsSpanning?e=Ct(this.colsSpanning):e=this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.printLayout||this.column.getPinned()==="left")return e;const{visibleCols:t}=this.beans,i=t.getColsLeftWidth();if(this.column.getPinned()==="right"){const s=t.bodyWidth;return i+s+(e||0)}return i+(e||0)}_legacyApplyRowSpan(e){if(this.rowSpan===1&&!e)return;const i=yc(this.beans)*this.rowSpan;this.eContent.style.height=`${i}px`,this.eContent.style.zIndex="1"}destroy(){super.destroy()}},v5="ag-cell",C5="ag-cell-auto-height",w5="ag-cell-normal-height",b5="ag-cell-focus",y5="ag-cell-first-right-pinned",S5="ag-cell-last-left-pinned",R5="ag-cell-not-inline-editing",x5="ag-cell-wrap-text",E5=0,Md=class extends V{constructor(e,t,i,s){super(),this.column=e,this.rowNode=t,this.rowCtrl=s,this.rangeFeature=void 0,this.rowResizeFeature=void 0,this.positionFeature=void 0,this.customStyleFeature=void 0,this.editStyleFeature=void 0,this.mouseListener=void 0,this.keyboardListener=void 0,this.suppressRefreshCell=!1,this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.focusEventWhileNotReady=null,this.hasBeenFocused=!1,this.hasEdit=!1,this.tooltipFeature=void 0,this.editorTooltipFeature=void 0,this.beans=i,this.gos=i.gos,this.editSvc=i.editSvc,this.hasEdit=!!i.editSvc;const{colId:n}=e;this.instanceId=n+"-"+E5++,this.createCellPosition(),this.updateAndFormatValue(!1)}addFeatures(){var s,n;const{beans:e}=this;this.positionFeature=new m5(this,e),this.customStyleFeature=(s=e.cellStyles)==null?void 0:s.createCellCustomStyleFeature(this,e),this.editStyleFeature=(n=e.editSvc)==null?void 0:n.createCellStyleFeature(this,e),this.mouseListener=new p5(this,e,this.column),this.keyboardListener=new f5(this,e,this.rowNode,this.rowCtrl),this.enableTooltipFeature();const{rangeSvc:t}=e;t&&Tr(e.gos)&&(this.rangeFeature=t.createCellRangeFeature(e,this)),yr(this.column)&&(this.rowResizeFeature=this.beans.rowNumbersSvc.createRowNumbersRowResizerFeature(e,this))}isCellSpanning(){return!1}getCellSpan(){}removeFeatures(){const e=this.beans.context;this.positionFeature=e.destroyBean(this.positionFeature),this.editorTooltipFeature=e.destroyBean(this.editorTooltipFeature),this.customStyleFeature=e.destroyBean(this.customStyleFeature),this.editStyleFeature=e.destroyBean(this.editStyleFeature),this.mouseListener=e.destroyBean(this.mouseListener),this.keyboardListener=e.destroyBean(this.keyboardListener),this.rangeFeature=e.destroyBean(this.rangeFeature),this.rowResizeFeature=e.destroyBean(this.rowResizeFeature),this.disableTooltipFeature()}enableTooltipFeature(e,t){var i;this.tooltipFeature=(i=this.beans.tooltipSvc)==null?void 0:i.enableCellTooltipFeature(this,e,t)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}enableEditorTooltipFeature(e){var t;this.editorTooltipFeature&&this.disableEditorTooltipFeature(),this.editorTooltipFeature=(t=this.beans.tooltipSvc)==null?void 0:t.setupCellEditorTooltip(this,e),Lc(this.beans)}disableEditorTooltipFeature(){this.editorTooltipFeature=this.beans.context.destroyBean(this.editorTooltipFeature)}setComp(e,t,i,s,n,o,r){var a,l,c,d,h,u,f,p,m;if(this.comp=e,this.eGui=t,this.printLayout=n,r??(r=this),this.addDomData(r),this.addFeatures(),r.addDestroyFunc(()=>this.removeFeatures()),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.setupFocus(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(s,r),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),(a=this.positionFeature)==null||a.init(),(l=this.customStyleFeature)==null||l.setComp(e),(c=this.editStyleFeature)==null||c.setComp(e),(d=this.tooltipFeature)==null||d.refreshTooltip(),(h=this.keyboardListener)==null||h.init(),(u=this.rangeFeature)==null||u.setComp(e),(f=this.rowResizeFeature)==null||f.refreshRowResizer(),o&&this.isCellEditable()||this.hasEdit&&((p=this.editSvc)!=null&&p.isEditing(this,{withOpenEditor:!0}))?(m=this.editSvc)==null||m.startEditing(this,{startedEdit:!1,source:"api",silent:!0,continueEditing:!0}):this.showValue(!1,!0),this.onCompAttachedFuncs.length){for(const v of this.onCompAttachedFuncs)v();this.onCompAttachedFuncs=[]}}setupAutoHeight(e,t){var i;this.isAutoHeight=((i=this.beans.rowAutoHeight)==null?void 0:i.setupCellAutoHeight(this,e,t))??!1}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){const e=this.column.getColDef();return e.cellRenderer!=null||e.cellRendererSelector!=null}getValueToDisplay(){return this.valueFormatted??this.value}getDeferLoadingCellRenderer(){var l,c;const{beans:e,column:t}=this,{userCompFactory:i,ctrlsSvc:s,eventSvc:n}=e,o=t.getColDef(),r=this.createCellRendererParams();r.deferRender=!0;const a=fR(i,o,r);if((c=(l=s.getGridBodyCtrl())==null?void 0:l.scrollFeature)!=null&&c.isScrolling()){let d;const h=new Ot(f=>{d=f}),[u]=this.addManagedListeners(n,{bodyScrollEnd:()=>{d(),u()}});return{loadingComp:a,onReady:h}}return{loadingComp:a,onReady:Ot.resolve()}}showValue(e,t){var h,u,f,p;const{beans:i,column:s,rowNode:n,rangeFeature:o}=this,{userCompFactory:r}=i;let a=this.getValueToDisplay(),l;const c=n.stub&&((h=n.groupData)==null?void 0:h[s.getId()])==null,d=s.getColDef();if(c||this.isCellRenderer()){const m=this.createCellRendererParams();!c||yr(s)?l=gR(r,d,m):l=fR(r,d,m)}if(!l&&!c&&((u=i.findSvc)!=null&&u.isMatch(n,s))){const m=this.createCellRendererParams();l=gR(r,{...s.getColDef(),cellRenderer:"agFindCellRenderer"},m)}if(this.hasEdit&&this.editSvc.isBatchEditing()&&this.editSvc.isRowEditing(n,{checkSiblings:!0})){const m=this.editSvc.prepDetailsDuringBatch(this,{compDetails:l,valueToDisplay:a});m&&(m.compDetails?l=m.compDetails:m.valueToDisplay&&(a=m.valueToDisplay))}this.comp.setRenderDetails(l,a,e),(f=this.customRowDragComp)==null||f.refreshVisibility(),!t&&o&&Lr(i,()=>o==null?void 0:o.refreshHandle()),(p=this.rowResizeFeature)==null||p.refreshRowResizer()}setupControlComps(){const e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e),!0),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.comp.setIncludeSelection(this.includeSelection),this.comp.setIncludeDndSource(this.includeDndSource),this.comp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}getCellValueClass(){const e="ag-cell-value",t=this.column.getColDef().cellRenderer==="agCheckboxCellRenderer";let i="";return t&&(i=" ag-allow-overflow"),`${e}${i}`}isIncludeControl(e,t=!1){return(this.rowNode.rowPinned==null||t&&tp(this.rowNode))&&!!e}isCheckboxSelection(e){const{rowSelection:t,groupDisplayType:i}=this.beans.gridOptions,s=Nm(t),n=Or(this.column);return i==="custom"&&s!=="selectionColumn"&&n?!1:e.checkboxSelection||n&&typeof t=="object"&&Ed(t)}refreshShouldDestroy(){const e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e),!0),i=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),s=this.includeDndSource!=this.isIncludeControl(e.dndSource),n=this.isAutoHeight!=this.column.isAutoHeight();return t||i||s||n}onPopupEditorClosed(){const{editSvc:e}=this.beans;e!=null&&e.isEditing(this,{withOpenEditor:!0})&&(e==null||e.stopEditing(this,{source:e!=null&&e.isBatchEditing()?"ui":"api"}))}stopEditing(e=!1){const{editSvc:t}=this.beans;return(t==null?void 0:t.stopEditing(this,{cancel:e,source:t!=null&&t.isBatchEditing()?"ui":"api"}))??!1}createCellRendererParams(){const{value:e,valueFormatted:t,column:i,rowNode:s,comp:n,eGui:o,beans:{valueSvc:r,gos:a,editSvc:l}}=this;return Fe(a,{value:e,valueFormatted:t,getValue:()=>r.getValueForDisplay(i,s).value,setValue:d=>(l==null?void 0:l.setDataValue({rowNode:s,column:i},d))||s.setDataValue(i,d),formatValue:this.formatValue.bind(this),data:s.data,node:s,pinned:i.getPinned(),colDef:i.getColDef(),column:i,refreshCell:this.refreshCell.bind(this),eGridCell:o,eParentOfValue:n.getParentOfValue(),registerRowDragger:(d,h,u,f)=>this.registerRowDragger(d,h,f),setTooltip:(d,h)=>{var u;a.assertModuleRegistered("Tooltip",3),this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(d,h),(u=this.tooltipFeature)==null||u.refreshTooltip()}})}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){var t;if(this.refreshShouldDestroy()?(t=this.rowCtrl)==null||t.recreateCell(this):this.refreshCell(e),this.hasEdit&&this.editCompDetails){const{editSvc:i,comp:s}=this;!(s!=null&&s.getCellEditor())&&i.isEditing(this,{withOpenEditor:!0})&&i.startEditing(this,{startedEdit:!1,source:"api",silent:!0})}}refreshCell({force:e,suppressFlash:t,newData:i}={}){var E;const{editStyleFeature:s,customStyleFeature:n,rowCtrl:{rowEditStyleFeature:o},beans:{cellFlashSvc:r,filterManager:a},column:l,comp:c,suppressRefreshCell:d,tooltipFeature:h}=this;if(d)return;const{field:u,valueGetter:f,showRowGroup:p,enableCellChangeFlash:m}=l.getColDef(),v=u==null&&f==null&&p==null,C=e||v||i,w=!!c,S=this.updateAndFormatValue(w),b=C||S;if(w){if(b){this.showValue(!!i,!1);const A=a==null?void 0:a.isSuppressFlashingCellsBecauseFiltering();!t&&!A&&m&&(r==null||r.flashCell(this)),(E=s==null?void 0:s.applyCellStyles)==null||E.call(s),n==null||n.applyUserStyles(),n==null||n.applyClassesFromColDef(),o==null||o.applyRowStyles()}h==null||h.refreshTooltip(),n==null||n.applyCellClassRules()}}isCellEditable(){return this.column.isCellEditable(this.rowNode)}formatValue(e){return this.callValueFormatter(e)??e}callValueFormatter(e){return this.beans.valueSvc.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){const t=this.value,i=this.valueFormatted,{value:s,valueFormatted:n}=this.beans.valueSvc.getValueForDisplay(this.column,this.rowNode,!0);return this.value=s,this.valueFormatted=n,e?!this.valuesAreEqual(t,this.value)||this.valueFormatted!=i:!0}valuesAreEqual(e,t){const i=this.column.getColDef();return i.equals?i.equals(e,t):e===t}addDomData(e){const t=this.eGui;Ic(this.beans.gos,t,jm,this),e.addDestroyFunc(()=>Ic(this.beans.gos,t,jm,null))}createEvent(e,t){const{rowNode:i,column:s,value:n,beans:o}=this;return u5(o,e,t,{rowNode:i,column:s},n)}processCharacter(e){var t;(t=this.keyboardListener)==null||t.processCharacter(e)}onKeyDown(e){var t;(t=this.keyboardListener)==null||t.onKeyDown(e)}onMouseEvent(e,t){var i;(i=this.mouseListener)==null||i.onMouseEvent(e,t)}getColSpanningList(){var e;return((e=this.positionFeature)==null?void 0:e.getColSpanningList())??[]}onLeftChanged(){var e;this.comp&&((e=this.positionFeature)==null||e.onLeftChanged())}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{comp:e,column:t,beans:i}=this;$T(e,t,i.visibleCols)}refreshAriaColIndex(){const e=this.beans.visibleCols.getAriaColIndex(this.column);fP(this.eGui,e)}onWidthChanged(){var e;return(e=this.positionFeature)==null?void 0:e.onWidthChanged()}getRowPosition(){const{rowIndex:e,rowPinned:t}=this.cellPosition;return{rowIndex:e,rowPinned:t}}updateRangeBordersIfRangeCount(){var e;this.comp&&((e=this.rangeFeature)==null||e.updateRangeBordersIfRangeCount())}onCellSelectionChanged(){var e;this.comp&&((e=this.rangeFeature)==null||e.onCellSelectionChanged())}isRangeSelectionEnabled(){return this.rangeFeature!=null}focusCell(e=!1,t){var s;const i=(s=this.editSvc)==null?void 0:s.allowedFocusTargetOnValidation(this);i&&i!==this||this.beans.focusSvc.setFocusedCell({...this.getFocusedCellPosition(),forceBrowserFocus:e,sourceEvent:t})}restoreFocus(e=!1){const{beans:{editSvc:t,focusSvc:i},comp:s}=this;if(!s||t!=null&&t.isEditing(this)||!this.isCellFocused()||!i.shouldTakeFocus())return;const n=()=>{if(!this.isAlive())return;const o=s.getFocusableElement();this.isCellFocused()&&o.focus({preventScroll:!0})};if(e){setTimeout(n,0);return}n()}onRowIndexChanged(){var e,t;this.createCellPosition(),this.onCellFocused(),this.restoreFocus(),(e=this.rangeFeature)==null||e.onCellSelectionChanged(),(t=this.rowResizeFeature)==null||t.refreshRowResizer()}onSuppressCellFocusChanged(e){const t=this.eGui;t&&(yr(this.column)&&(e=!0),ks(t,"tabindex",e?void 0:-1))}onFirstRightPinnedChanged(){if(!this.comp)return;const e=this.column.isFirstRightPinned();this.comp.toggleCss(y5,e)}onLastLeftPinnedChanged(){if(!this.comp)return;const e=this.column.isLastLeftPinned();this.comp.toggleCss(S5,e)}checkCellFocused(){return this.beans.focusSvc.isCellFocused(this.cellPosition)}isCellFocused(){const e=this.checkCellFocused();return this.hasBeenFocused||(this.hasBeenFocused=e),e}setupFocus(){this.restoreFocus(!0),this.onCellFocused(this.focusEventWhileNotReady??void 0)}onCellFocused(e){var n;const{beans:t}=this;if($v(t))return;if(!this.comp){e&&(this.focusEventWhileNotReady=e);return}const i=this.isCellFocused(),s=((n=t.editSvc)==null?void 0:n.isEditing(this))??!1;if(this.comp.toggleCss(b5,i),i&&(e!=null&&e.forceBrowserFocus)){let o=this.comp.getFocusableElement();if(s){const r=Fd(o,null,!0);r.length&&(o=r[0])}o.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}i&&e&&this.rowCtrl.announceDescription()}createCellPosition(){const{rowIndex:e,rowPinned:t}=this.rowNode;this.cellPosition={rowIndex:e,rowPinned:br(t),column:this.column}}applyStaticCssClasses(){const{comp:e}=this;e.toggleCss(v5,!0),e.toggleCss(R5,!0);const t=this.column.isAutoHeight()==!0;e.toggleCss(C5,t),e.toggleCss(w5,!t)}onColumnHover(){var e;(e=this.beans.colHover)==null||e.onCellColumnHover(this.column,this.comp)}onColDefChanged(){var e,t;this.comp&&(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),(e=this.editSvc)!=null&&e.isEditing(this)?(t=this.editSvc)==null||t.handleColDefChanged(this):this.refreshOrDestroyCell({force:!0,suppressFlash:!0}))}setWrapText(){const e=this.column.getColDef().wrapText==!0;this.comp.toggleCss(x5,e)}dispatchCellContextMenuEvent(e){const t=this.column.getColDef(),i=this.createEvent(e,"cellContextMenu"),{beans:s}=this;s.eventSvc.dispatchEvent(i),t.onCellContextMenu&&window.setTimeout(()=>{s.frameworkOverrides.wrapOutgoing(()=>{t.onCellContextMenu(i)})},0)}getCellRenderer(){var e;return((e=this.comp)==null?void 0:e.getCellRenderer())??null}destroy(){this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.isCellFocused()&&this.hasBrowserFocus()&&this.beans.focusSvc.attemptToRecoverFocus(),super.destroy()}hasBrowserFocus(){var e;return((e=this.eGui)==null?void 0:e.contains(Dt(this.beans)))??!1}createSelectionCheckbox(){var t;const e=(t=this.beans.selectionSvc)==null?void 0:t.createCheckboxSelectionComponent();if(e)return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){const e=this.beans.registry.createDynamicBean("dndSourceComp",!1,this.rowNode,this.column,this.eGui);return e&&this.beans.context.createBean(e),e}registerRowDragger(e,t,i){if(this.customRowDragComp){this.customRowDragComp.setDragElement(e,t);return}const s=this.createRowDragComp(e,t,i);s&&(this.customRowDragComp=s,this.addDestroyFunc(()=>{this.beans.context.destroyBean(s),this.customRowDragComp=null}),s.refreshVisibility())}createRowDragComp(e,t,i){var n;const s=(n=this.beans.rowDragSvc)==null?void 0:n.createRowDragCompForCell(this.rowNode,this.column,()=>this.value,e,t,i);if(s)return this.beans.context.createBean(s),s}cellEditorAttached(){for(const e of this.onEditorAttachedFuncs)e();this.onEditorAttachedFuncs=[]}setFocusedCellPosition(e){}getFocusedCellPosition(){return this.cellPosition}refreshAriaRowIndex(){}getRootElement(){return this.eGui}};function BS(e,t,i,s,n,o){if(i==null&&t==null)return;const r={},a={},l=(c,d)=>{for(const h of c.split(" "))h.trim()!=""&&d(h)};if(i){const c=Object.keys(i);for(let d=0;d<c.length;d++){const h=c[d],u=i[h];let f;typeof u=="string"?f=e?e.evaluate(u,s):!0:typeof u=="function"&&(f=u(s)),l(h,p=>{f?r[p]=!0:a[p]=!0})}}if(t&&o)for(const c of Object.keys(t))l(c,d=>{r[d]||(a[d]=!0)});o&&Object.keys(a).forEach(o),Object.keys(r).forEach(n)}function ox(e){if(e.group)return e.level;const t=e.parent;return t?t.level+1:0}var A5=class extends V{constructor(){super(...arguments),this.beanName="rowStyleSvc"}processClassesFromGridOptions(e,t){const i=this.gos,s=r=>{if(typeof r=="string")e.push(r);else if(Array.isArray(r))for(const a of r)e.push(a)},n=i.get("rowClass");n&&s(n);const o=i.getCallback("getRowClass");if(o){const r={data:t.data,node:t,rowIndex:t.rowIndex},a=o(r);s(a)}}preProcessRowClassRules(e,t){this.processRowClassRules(t,i=>{e.push(i)},()=>{})}processRowClassRules(e,t,i){const{gos:s,expressionSvc:n}=this.beans,o=Fe(s,{data:e.data,node:e,rowIndex:e.rowIndex});BS(n,void 0,s.get("rowClassRules"),o,t,i)}processStylesFromGridOptions(e){const t=this.gos,i=t.get("rowStyle"),s=t.getCallback("getRowStyle");let n;if(s){const o={data:e.data,node:e,rowIndex:e.rowIndex};n=s(o)}if(n||i)return Object.assign({},i,n)}},F5=0,Xm=class extends V{constructor(e,t,i,s,n){var o,r;super(),this.rowNode=e,this.useAnimationFrameForCreate=s,this.printLayout=n,this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKey=null,this.beans=t,this.gos=t.gos,this.paginationPage=((o=t.pagination)==null?void 0:o.getCurrentPage())??0,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+F5++,this.rowId=Vu(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusSvc.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=ox(this.rowNode),this.setRowType(),this.setAnimateFlags(i),this.rowStyles=this.processStylesFromGridOptions(),this.rowEditStyleFeature=(r=t.editSvc)==null?void 0:r.createRowStyleFeature(this,t),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;const e=this.businessKeyForNodeFunc(this.rowNode);this.businessKey=Vu(e)}updateGui(e,t){e==="left"?this.leftGui=t:e==="right"?this.rightGui=t:e==="fullWidth"?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,i,s){var h,u;const{context:n,focusSvc:o}=this.beans;s=Qf(this,n,s);const r={rowComp:e,element:t,containerType:i,compBean:s};this.allRowGuis.push(r),this.updateGui(i,r),this.initialiseRowComp(r);const a=this.rowNode,l=this.rowType==="FullWidthLoading"||a.stub,c=!a.data&&this.beans.rowModel.getType()==="infinite";!l&&!c&&!a.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent();const d=(h=this.fullWidthGui)==null?void 0:h.element;d&&!((u=this.beans.editSvc)!=null&&u.isEditing(this))&&o.isRowFocused(a.rowIndex,a.rowPinned)&&o.shouldTakeFocus()&&setTimeout(()=>d.focus({preventScroll:!0}),0)}unsetComp(e){this.allRowGuis=this.allRowGuis.filter(t=>t.containerType!==e),this.updateGui(e,void 0)}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(e){const t=e?"none":"";for(const i of this.allRowGuis)i.element.style.display=t}initialiseRowComp(e){const t=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(!1,e),bc(t)&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);const i=e.rowComp,s=this.getInitialRowClasses(e.containerType);for(const n of s)i.toggleCss(n,!0);this.executeSlideAndFadeAnimations(e),this.rowNode.group&&Bb(e.element,this.rowNode.expanded==!0),this.setRowCompRowId(i),this.setRowCompRowBusinessKey(i),Ic(t,e.element,Km,this),e.compBean.addDestroyFunc(()=>Ic(t,e.element,Km,null)),this.useAnimationFrameForCreate?this.beans.animationFrameSvc.createTask(this.addHoverFunctionality.bind(this,e),this.rowNode.rowIndex,"p2",!1):this.addHoverFunctionality(e),this.isFullWidth()&&this.setupFullWidth(e),t.get("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameSvc.addDestroyTask(()=>{this.isAlive()&&e.rowComp.toggleCss("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){this.businessKey!=null&&e.setRowBusinessKey(this.businessKey)}setRowCompRowId(e){const t=Vu(this.rowNode.id);this.rowId=t,t!=null&&e.setRowId(t)}executeSlideAndFadeAnimations(e){const{containerType:t}=e;this.slideInAnimation[t]&&(Vb(()=>{this.onTopChanged()}),this.slideInAnimation[t]=!1),this.fadeInAnimation[t]&&(Vb(()=>{e.rowComp.toggleCss("ag-opacity-zero",!1)}),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){var s;const t=(s=this.beans.rowDragSvc)==null?void 0:s.createRowDragCompForRow(this.rowNode,e.element);if(!t)return;const i=this.createBean(t,this.beans.context);this.rowDragComps.push(i),e.compBean.addDestroyFunc(()=>{this.rowDragComps=this.rowDragComps.filter(n=>n!==i),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,this.beans.context),this.destroyBean(i,this.beans.context)})}setupFullWidth(e){const t=this.getPinnedForContainer(e.containerType),i=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(i)}getFullWidthCellRenderers(){var e,t;return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(i=>{var s;return(s=i==null?void 0:i.rowComp)==null?void 0:s.getFullWidthCellRenderer()}):[(t=(e=this.fullWidthGui)==null?void 0:e.rowComp)==null?void 0:t.getFullWidthCellRenderer()]}executeProcessRowPostCreateFunc(){const e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;const t={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};e(t)}areAllContainersReady(){const{leftGui:e,centerGui:t,rightGui:i,beans:{visibleCols:s}}=this,n=!!e||!s.isPinningLeft(),o=!!t,r=!!i||!s.isPinningRight();return n&&o&&r}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this.rowNode}):!1}setRowType(){const e=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow")&&!this.gos.get("groupHideOpenParents"),t=this.isNodeFullWidthCell(),i=this.gos.get("masterDetail")&&this.rowNode.detail,s=this.beans.colModel.isPivotMode(),n=VP(this.gos,this.rowNode,s);e?this.rowType="FullWidthLoading":i?this.rowType="FullWidthDetail":t?this.rowType="FullWidth":n?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(e=!1,t=!1){if(this.isFullWidth())return;const{animationFrameSvc:i}=this.beans;if(!(i!=null&&i.active)||e||this.printLayout){this.updateColumnListsImpl(t);return}this.updateColumnListsPending||(i.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"p1",!1),this.updateColumnListsPending=!0)}getNewCellCtrl(e){var i;if(!((i=this.beans.rowSpanSvc)!=null&&i.isCellSpanning(e,this.rowNode)))return new Md(e,this.rowNode,this.beans,this)}isCorrectCtrlForSpan(e){var t;return!((t=this.beans.rowSpanSvc)!=null&&t.isCellSpanning(e.column,this.rowNode))}createCellCtrls(e,t,i=null){const s={list:[],map:{}},n=(c,d,h)=>{h!=null?s.list.splice(h,0,d):s.list.push(d),s.map[c]=d},o=[];for(const c of t){const d=c.getInstanceId();let h=e.map[d];h&&!this.isCorrectCtrlForSpan(h)&&(h.destroy(),h=void 0),h||(h=this.getNewCellCtrl(c)),h&&n(d,h)}for(const c of e.list){const d=c.column.getInstanceId();if(s.map[d]!=null)continue;!this.isCellEligibleToBeRemoved(c,i)?o.push([d,c]):c.destroy()}if(o.length)for(const[c,d]of o){const h=s.list.findIndex(f=>f.column.getLeft()>d.column.getLeft()),u=h===-1?void 0:Math.max(h-1,0);n(c,d,u)}const{focusSvc:r,visibleCols:a}=this.beans,l=r.getFocusedCell();if(l&&l.column.getPinned()==i){const c=l.column.getInstanceId();if(!s.map[c]&&a.allCols.includes(l.column)){const h=this.createFocusedCellCtrl();if(h){const u=s.list.findIndex(p=>p.column.getLeft()>h.column.getLeft()),f=u===-1?void 0:Math.max(u-1,0);n(c,h,f)}}}return s}createFocusedCellCtrl(){const{focusSvc:e,rowSpanSvc:t}=this.beans,i=e.getFocusedCell();if(!i)return;const s=t==null?void 0:t.getCellSpan(i.column,this.rowNode);if(s){if(s.firstNode!==this.rowNode||!s.doesSpanContain(i))return}else if(!e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned))return;return this.getNewCellCtrl(i.column)}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){for(const t of this.allRowGuis){const i=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(i,e)}}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){const e=this.beans.colViewport,t=this.beans.visibleCols;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.allCols),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const i=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,i);const s=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,s,"left");const n=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,n,"right")}}isCellEligibleToBeRemoved(e,t){const{column:n}=e;if(n.getPinned()!=t||!this.isCorrectCtrlForSpan(e))return!0;const{visibleCols:o,editSvc:r}=this.beans,a=r==null?void 0:r.isEditing(e),l=e.isCellFocused();return a||l?!(o.allCols.indexOf(n)>=0):!0}getDomOrder(){return this.gos.get("ensureDomOrder")||Ii(this.gos,"print")}listenOnDomOrder(e){const t=()=>{e.rowComp.setDomOrder(this.getDomOrder())};e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],t)}setAnimateFlags(e){if(this.rowNode.sticky||!e)return;const t=ae(this.rowNode.oldRowTop),{visibleCols:i}=this.beans,s=i.isPinningLeft(),n=i.isPinningRight();if(t){const{slideInAnimation:o}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){o.fullWidth=!0;return}o.center=!0,o.left=s,o.right=n}else{const{fadeInAnimation:o}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){o.fullWidth=!0;return}o.center=!0,o.left=s,o.right=n}}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){const e=(r,a)=>r?r.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(r.element,a).params):!0,t=e(this.fullWidthGui,null),i=e(this.centerGui,null),s=e(this.leftGui,"left"),n=e(this.rightGui,"right");return t&&i&&s&&n}addListeners(){const{beans:e,gos:t,rowNode:i}=this,{expansionSvc:s,eventSvc:n,context:o,rowSpanSvc:r}=e;this.addManagedListeners(this.rowNode,{heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this),...(s==null?void 0:s.getRowExpandedListeners(this))??{}}),i.detail&&this.addManagedListeners(i.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(i,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this),rowPinned:this.onRowPinned.bind(this)}),this.addManagedListeners(n,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),r&&this.addManagedListeners(r,{spannedCellsUpdated:({pinned:a})=>{a&&!i.rowPinned||this.updateColumnLists()}}),this.addDestroyFunc(()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,o),this.tooltipFeature=this.destroyBean(this.tooltipFeature,o),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,o)}),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",()=>{if(t.get("rowDragEntireRow")){for(const l of this.allRowGuis)this.addRowDraggerToRow(l);return}this.rowDragComps=this.destroyBeans(this.rowDragComps,o)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{for(const e of this.getAllCellCtrls())e.onRowIndexChanged()},cellChanged:e=>{for(const t of this.getAllCellCtrls())t.onCellChanged(e)}})}onRowPinned(){for(const e of this.allRowGuis)e.rowComp.toggleCss("ag-row-pinned-source",!!this.rowNode.pinnedSibling)}onRowNodeDataChanged(e){this.refreshRow({suppressFlash:!e.update,newData:!e.update})}refreshRow(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}for(const i of this.getAllCellCtrls())i.refreshCell(e);for(const i of this.allRowGuis)this.setRowCompRowId(i.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(i.rowComp);this.onRowSelected(),this.postProcessCss()}postProcessCss(){var e;this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),(e=this.rowEditStyleFeature)==null||e.applyRowStyles(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const e=this.beans.rowDropHighlightSvc,t=(e==null?void 0:e.row)===this.rowNode?e.position:"none",i=t==="above",s=t==="inside",n=t==="below",r=this.gos.get("treeData")&&(n||i),a=this.rowNode.uiLevel.toString();for(const l of this.allRowGuis){const c=l.rowComp;c.toggleCss("ag-row-highlight-above",i),c.toggleCss("ag-row-highlight-inside",s),c.toggleCss("ag-row-highlight-below",n),c.toggleCss("ag-row-highlight-indent",r),r?l.element.style.setProperty("--ag-row-highlight-level",a):l.element.style.removeProperty("--ag-row-highlight-level")}}postProcessRowDragging(){const e=this.rowNode.dragging;for(const t of this.allRowGuis)t.rowComp.toggleCss("ag-row-dragging",e)}onDisplayedColumnsChanged(){var e;this.updateColumnLists(!0),(e=this.beans.rowAutoHeight)==null||e.requestCheckAutoHeight()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:br(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(e){const t=this.findFullWidthInfoForEvent(e);if(!t)return;const{rowGui:i,column:s}=t;if(!(i.element===e.target))return;const r=this.rowNode,{focusSvc:a,navigation:l}=this.beans,c=a.getFocusedCell(),d={rowIndex:r.rowIndex,rowPinned:r.rowPinned,column:(c==null?void 0:c.column)??s};l==null||l.navigateToNextCell(e,e.key,d,!0),e.preventDefault()}onTabKeyDown(e){var a;if(e.defaultPrevented||Rr(e))return;const t=this.allRowGuis.find(l=>l.element.contains(e.target)),i=t?t.element:null,s=i===e.target,n=Dt(this.beans);let o=!1;i&&n&&(o=i.contains(n)&&n.classList.contains("ag-cell"));let r=null;!s&&!o&&(r=Kc(this.beans,i,!1,e.shiftKey)),(this.isFullWidth()&&s||!r)&&((a=this.beans.navigation)==null||a.onTabKeyDown(this,e))}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){var t;const e=(t=this.allRowGuis.find(i=>To(i.element)))==null?void 0:t.element;return e?e.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){const t=this.isFullWidth()&&e?void 0:this.gos.get("tabIndex");for(const i of this.allRowGuis)ks(i.element,"tabindex",t)}onFullWidthRowFocused(e){var n,o,r;const t=this.rowNode,i=e?this.isFullWidth()&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned:!1;let s;if(this.fullWidthGui)s=this.fullWidthGui.element;else{const a=this.beans.colModel.getCol(e==null?void 0:e.column),l=a==null?void 0:a.pinned;l?s=l==="right"?(n=this.rightGui)==null?void 0:n.element:(o=this.leftGui)==null?void 0:o.element:s=(r=this.centerGui)==null?void 0:r.element}s&&(s.classList.toggle("ag-full-width-focus",i),i&&(e!=null&&e.forceBrowserFocus)&&s.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){const i={list:[],map:{}};for(const s of e.list)s!==t&&(i.list.push(s),i.map[s.column.getInstanceId()]=s);return i}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t);break}}createRowEvent(e,t){const{rowNode:i}=this;return Fe(this.gos,{type:e,node:i,data:i.data,rowIndex:i.rowIndex,rowPinned:i.rowPinned,event:t})}createRowEventWithSource(e,t){const i=this.createRowEvent(e,t);return i.source=this,i}onRowDblClick(e){if(Rr(e))return;const t=this.createRowEventWithSource("rowDoubleClicked",e);t.isEventHandlingSuppressed=this.isSuppressMouseEvent(e),this.beans.eventSvc.dispatchEvent(t)}findFullWidthInfoForEvent(e){if(!e)return;const t=this.findFullWidthRowGui(e.target),i=this.getColumnForFullWidth(t);if(!(!t||!i))return{rowGui:t,column:i}}findFullWidthRowGui(e){return this.allRowGuis.find(t=>t.element.contains(e))}getColumnForFullWidth(e){const{visibleCols:t}=this.beans;switch(e==null?void 0:e.containerType){case"center":return t.centerCols[0];case"left":return t.leftCols[0];case"right":return t.rightCols[0];default:return t.allCols[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=wc(e.target,"ag-row-drag",3),!this.isFullWidth()||this.isSuppressMouseEvent(e))return;const{rangeSvc:t,focusSvc:i}=this.beans;t==null||t.removeAllCellRanges();const s=this.findFullWidthInfoForEvent(e);if(!s)return;const{rowGui:n,column:o}=s,r=n.element,a=e.target,l=this.rowNode;let c=e.defaultPrevented||Xa();r&&r.contains(a)&&zu(a)&&(c=!1),i.setFocusedCell({rowIndex:l.rowIndex,column:o,rowPinned:l.rowPinned,forceBrowserFocus:c})}isSuppressMouseEvent(e){const{gos:t,rowNode:i}=this;if(this.isFullWidth()){const n=this.findFullWidthRowGui(e.target);return oV(t,n==null?void 0:n.rowComp.getFullWidthCellRendererParams(),i,e)}const s=DS(t,e.target);return s!=null&&gm(t,s.column,i,e)}onRowClick(e){if(Rr(e)||this.lastMouseDownOnDragger)return;const i=this.isSuppressMouseEvent(e),{eventSvc:s,selectionSvc:n}=this.beans,o=this.createRowEventWithSource("rowClicked",e);o.isEventHandlingSuppressed=i,s.dispatchEvent(o),!i&&(n==null||n.handleSelectionEvent(e,this.rowNode,"rowClicked"))}setupDetailRowAutoHeight(e){var t;this.rowType==="FullWidthDetail"&&((t=this.beans.masterDetailSvc)==null||t.setupDetailRowAutoHeight(this,e))}createFullWidthCompDetails(e,t){const{gos:i,rowNode:s}=this,n=Fe(i,{fullWidth:!0,data:s.data,node:s,value:s.key,valueFormatted:s.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(r,a,l,c)=>this.addFullWidthRowDragging(r,a,l,c),setTooltip:(r,a)=>{i.assertModuleRegistered("Tooltip",3),this.setupFullWidthRowTooltip(r,a)}}),o=this.beans.userCompFactory;switch(this.rowType){case"FullWidthDetail":return h2(o,n);case"FullWidthGroup":{const{value:r,valueFormatted:a}=this.beans.valueSvc.getValueForDisplay(void 0,this.rowNode,!0);return n.value=r,n.valueFormatted=a,d2(o,n)}case"FullWidthLoading":return c2(o,n);default:return l2(o,n)}}setupFullWidthRowTooltip(e,t){var i;this.fullWidthGui&&(this.tooltipFeature=(i=this.beans.tooltipSvc)==null?void 0:i.setupFullWidthRowTooltip(this.tooltipFeature,this,e,t))}addFullWidthRowDragging(e,t,i="",s){const{rowDragSvc:n,context:o}=this.beans;if(!n||!this.isFullWidth())return;const r=n.createRowDragComp(()=>i,this.rowNode,void 0,e,t,s);this.createBean(r,o),this.addDestroyFunc(()=>{this.destroyBean(r,o)})}onUiLevelChanged(){const e=ox(this.rowNode);if(this.rowLevel!=e){const t="ag-row-level-"+e,i="ag-row-level-"+this.rowLevel;for(const s of this.allRowGuis)s.rowComp.toggleCss(t,!0),s.rowComp.toggleCss(i,!1)}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getLastRow()}refreshFirstAndLastRowStyles(){const e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();if(this.firstRowOnPage!==e){this.firstRowOnPage=e;for(const i of this.allRowGuis)i.rowComp.toggleCss("ag-row-first",e)}if(this.lastRowOnPage!==t){this.lastRowOnPage=t;for(const i of this.allRowGuis)i.rowComp.toggleCss("ag-row-last",t)}}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){var t;const e=[];if((t=this.beans.rowStyleSvc)==null||t.processClassesFromGridOptions(e,this.rowNode),!!e.length)for(const i of e)for(const s of this.allRowGuis)s.rowComp.toggleCss(i,!0)}postProcessRowClassRules(){var e;(e=this.beans.rowStyleSvc)==null||e.processRowClassRules(this.rowNode,t=>{for(const i of this.allRowGuis)i.rowComp.toggleCss(t,!0)},t=>{for(const i of this.allRowGuis)i.rowComp.toggleCss(t,!1)})}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,i=>i.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(e){return e==="left"||e==="right"?e:null}getInitialRowClasses(e){var a,l;const t=this.getPinnedForContainer(e),i=this.isFullWidth(),{rowNode:s,beans:n}=this,o=[];o.push("ag-row"),o.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeInAnimation[e]&&o.push("ag-opacity-zero"),o.push(s.rowIndex%2===0?"ag-row-even":"ag-row-odd"),s.isRowPinned()&&(o.push("ag-row-pinned"),(a=n.pinnedRowModel)!=null&&a.isManual()&&o.push("ag-row-pinned-manual")),!s.isRowPinned()&&s.pinnedSibling&&o.push("ag-row-pinned-source"),s.isSelected()&&o.push("ag-row-selected"),s.footer&&o.push("ag-row-footer"),o.push("ag-row-level-"+this.rowLevel),s.stub&&o.push("ag-row-loading"),i&&o.push("ag-full-width-row"),(l=n.expansionSvc)==null||l.addExpandedCss(o,s),s.dragging&&o.push("ag-row-dragging");const{rowStyleSvc:r}=n;return r&&(r.processClassesFromGridOptions(o,s),r.preProcessRowClassRules(o,s)),o.push(this.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),this.isFirstRowOnPage()&&o.push("ag-row-first"),this.isLastRowOnPage()&&o.push("ag-row-last"),i&&(t==="left"&&o.push("ag-cell-last-left-pinned"),t==="right"&&o.push("ag-cell-first-right-pinned")),o}processStylesFromGridOptions(){var e;return((e=this.beans.rowStyleSvc)==null?void 0:e.processStylesFromGridOptions(this.rowNode))??this.emptyStyle}onRowSelected(e){var t;(t=this.beans.selectionSvc)==null||t.onRowCtrlSelected(this,i=>{(i===this.centerGui||i===this.fullWidthGui)&&this.announceDescription()},e)}announceDescription(){var e;(e=this.beans.selectionSvc)==null||e.announceAriaRowSelection(this.rowNode)}addHoverFunctionality(e){if(!this.active)return;const{element:t,compBean:i}=e,{rowNode:s,beans:n,gos:o}=this;i.addManagedListeners(t,{pointerenter:r=>{r.pointerType==="mouse"&&s.dispatchRowEvent("mouseEnter")},pointerleave:r=>{r.pointerType==="mouse"&&s.dispatchRowEvent("mouseLeave")}}),i.addManagedListeners(s,{mouseEnter:()=>{var r;!((r=n.dragSvc)!=null&&r.dragging)&&!o.get("suppressRowHoverHighlight")&&(t.classList.add("ag-row-hover"),s.setHovered(!0))},mouseLeave:()=>{this.resetHoveredStatus(t)}})}resetHoveredStatus(e){const t=e?[e]:this.allRowGuis.map(i=>i.element);for(const i of t)i.classList.remove("ag-row-hover");this.rowNode.setHovered(!1)}roundRowTopToBounds(e){const t=this.beans.ctrlsSvc.getScrollFeature().getApproximateVScollPosition(),i=this.applyPaginationOffset(t.top,!0)-100,s=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(i,e),s)}forEachGui(e,t){if(e)t(e);else for(const i of this.allRowGuis)t(i)}isRowRendered(){return this.allRowGuis.length>0}onRowHeightChanged(e){if(this.rowNode.rowHeight==null)return;const t=this.rowNode.rowHeight,i=this.beans.environment.getDefaultRowHeight(),n=OP(this.gos)?Ba(this.beans,this.rowNode).height:void 0,o=n?`${Math.min(i,n)-2}px`:void 0;this.forEachGui(e,r=>{r.element.style.height=`${t}px`,o&&r.element.style.setProperty("--ag-line-height",o)})}destroyFirstPass(e=!1){var s;this.active=!1;const{rowNode:t}=this;if(!e&&xd(this.gos)&&!t.sticky)if(t.rowTop!=null){const o=this.roundRowTopToBounds(t.rowTop);this.setRowTop(o)}else for(const o of this.allRowGuis)o.rowComp.toggleCss("ag-opacity-zero",!0);(s=this.fullWidthGui)!=null&&s.element.contains(Dt(this.beans))&&this.beans.focusSvc.attemptToRecoverFocus(),t.setHovered(!1);const i=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(i),this.beans.eventSvc.dispatchEvent(i),super.destroy()}destroySecondPass(){this.allRowGuis.length=0;const e=t=>{for(const i of t.list)i.destroy();return{list:[],map:{}}};this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,t=>{t.rowComp.toggleCss("ag-row-focus",this.rowFocused),t.rowComp.toggleCss("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){const{focusSvc:e}=this.beans,t=e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses())}onPaginationChanged(){var t;const e=((t=this.beans.pagination)==null?void 0:t.getCurrentPage())??0;this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e,t=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;const i=this.beans.pageBounds.getPixelOffset();return e+i*(t?1:-1)}setRowTop(e){if(!this.printLayout&&ae(e)){const t=this.applyPaginationOffset(e),n=`${this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeight.getRealPixelPosition(t)}px`;this.setRowTopStyle(n)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";const t=this.rowNode;let i;if(t.sticky)i=t.stickyRowTop;else{const s=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,n=this.applyPaginationOffset(s);i=t.isRowPinned()?n:this.beans.rowContainerHeight.getRealPixelPosition(n)}return i+"px"}setRowTopStyle(e){for(const t of this.allRowGuis)this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform(`translateY(${e})`)}getCellCtrl(e,t=!1){let i=null;for(const s of this.getAllCellCtrls())s.column==e&&(i=s);if(i!=null||t)return i;for(const s of this.getAllCellCtrls())(s==null?void 0:s.getColSpanningList().indexOf(e))>=0&&(i=s);return i}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(e){var o,r;const t=this.rowNode.getRowIndexString();if(t===null)return;const i=(((o=this.beans.ctrlsSvc.getHeaderRowContainerCtrl())==null?void 0:o.getRowCount())??0)+(((r=this.beans.filterManager)==null?void 0:r.getHeaderRowCount())??0),s=this.rowNode.rowIndex%2===0,n=i+this.rowNode.rowIndex+1;this.forEachGui(e,a=>{a.rowComp.setRowIndex(t),a.rowComp.toggleCss("ag-row-even",s),a.rowComp.toggleCss("ag-row-odd",!s),Dm(a.element,n)})}},P5=class extends V{constructor(){super(),this.beanName="navigation",this.onPageDown=sR(this.onPageDown,100),this.onPageUp=sR(this.onPageUp,100)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){const i=e.key,s=e.altKey,n=e.ctrlKey||e.metaKey,o=!!this.beans.rangeSvc&&e.shiftKey,r=MV(this.gos,e);let a=!1;switch(i){case H.PAGE_HOME:case H.PAGE_END:!n&&!s&&(this.onHomeOrEndKey(i),a=!0);break;case H.LEFT:case H.RIGHT:case H.UP:case H.DOWN:if(!r)return!1;n&&!s&&!o&&(this.onCtrlUpDownLeftRight(i,r),a=!0);break;case H.PAGE_DOWN:case H.PAGE_UP:!n&&!s&&(a=this.handlePageUpDown(i,r,t));break}return a&&e.preventDefault(),a}handlePageUpDown(e,t,i){return i&&(t=this.beans.focusSvc.getFocusedCell()),t?(e===H.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0):!1}navigateTo({scrollIndex:e,scrollType:t,scrollColumn:i,focusIndex:s,focusColumn:n,isAsync:o,rowPinned:r}){const{scrollFeature:a}=this.gridBodyCon;ae(i)&&!i.isPinned()&&a.ensureColumnVisible(i),ae(e)&&a.ensureIndexVisible(e,t),o||a.ensureIndexVisible(s);const{focusSvc:l,rangeSvc:c}=this.beans;l.setFocusedCell({rowIndex:s,column:n,rowPinned:r,forceBrowserFocus:!0}),c==null||c.setRangeToCell({rowIndex:s,rowPinned:r,column:n})}onPageDown(e){const t=this.beans,i=jC(t),s=this.getViewportHeight(),{pageBounds:n,rowModel:o,rowAutoHeight:r}=t,a=n.getPixelOffset(),l=i.top+s,c=o.getRowIndexAtPixel(l+a);r!=null&&r.active?this.navigateToNextPageWithAutoHeight(e,c):this.navigateToNextPage(e,c)}onPageUp(e){const t=this.beans,i=jC(t),{pageBounds:s,rowModel:n,rowAutoHeight:o}=t,r=s.getPixelOffset(),a=i.top,l=n.getRowIndexAtPixel(a+r);o!=null&&o.active?this.navigateToNextPageWithAutoHeight(e,l,!0):this.navigateToNextPage(e,l,!0)}navigateToNextPage(e,t,i=!1){const{pageBounds:s,rowModel:n}=this.beans,o=this.getViewportHeight(),r=s.getFirstRow(),a=s.getLastRow(),l=s.getPixelOffset(),c=n.getRow(e.rowIndex),d=i?(c==null?void 0:c.rowHeight)-o-l:o-l,h=(c==null?void 0:c.rowTop)+d;let u=n.getRowIndexAtPixel(h+l);if(u===e.rowIndex){const p=i?-1:1;t=u=e.rowIndex+p}let f;i?(f="bottom",u<r&&(u=r),t<r&&(t=r)):(f="top",u>a&&(u=a),t>a&&(t=a)),this.isRowTallerThanView(n.getRow(u))&&(t=u,f="top"),this.navigateTo({scrollIndex:t,scrollType:f,scrollColumn:null,focusIndex:u,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,i=!1){this.navigateTo({scrollIndex:t,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{const s=this.getNextFocusIndexForAutoHeight(e,i);this.navigateTo({scrollIndex:t,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:s,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){const i=t?-1:1,s=this.getViewportHeight(),{pageBounds:n,rowModel:o}=this.beans,r=n.getLastRow();let a=0,l=e.rowIndex;for(;l>=0&&l<=r;){const c=o.getRow(l);if(c){const d=c.rowHeight??0;if(a+d>s)break;a+=d}l+=i}return Math.max(0,Math.min(l,r))}getViewportHeight(){const e=this.beans,t=jC(e),i=this.beans.scrollVisibleSvc.getScrollbarWidth();let s=t.bottom-t.top;return e.ctrlsSvc.get("center").isHorizontalScrollShowing()&&(s-=i),s}isRowTallerThanView(e){if(!e)return!1;const t=e.rowHeight;return typeof t!="number"?!1:t>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const i=this.beans.cellNavigation.getNextCellToFocus(e,t,!0),s=this.getNormalisedPosition(i),{rowIndex:n,rowPinned:o,column:r}=s??i,a=r;this.navigateTo({scrollIndex:n,scrollType:null,scrollColumn:a,focusIndex:n,focusColumn:a,rowPinned:o})}onHomeOrEndKey(e){const t=e===H.PAGE_HOME,{visibleCols:i,pageBounds:s,rowModel:n}=this.beans,o=i.allCols,r=t?s.getFirstRow():s.getLastRow(),a=n.getRow(r);if(!a)return;const l=(t?o:[...o].reverse()).find(c=>!c.isSuppressNavigable(a));l&&this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:l,focusIndex:r,focusColumn:l})}onTabKeyDown(e,t){const i=t.shiftKey,s=this.tabToNextCellCommon(e,i,t),n=this.beans,{ctrlsSvc:o,pageBounds:r,focusSvc:a,gos:l}=n;if(s!==!1){s?t.preventDefault():s===null&&o.get("gridCtrl").allowFocusForNextCoreContainer(i);return}if(i){const{rowIndex:c,rowPinned:d}=e.getRowPosition();(d?c===0:c===r.getFirstRow())&&(l.get("headerHeight")===0||Rc(n)?jh(n,!0,!0):(t.preventDefault(),a.focusPreviousFromFirstCell(t)))}else e instanceof Md&&e.focusCell(!0),(a.focusOverlay(!1)||jh(n,i))&&t.preventDefault()}tabToNextCell(e,t){const i=this.beans,{focusSvc:s,rowRenderer:n}=i,o=s.getFocusedCell();if(!o)return!1;let r=pd(i,o);return!r&&(r=n.getRowByPosition(o),!(r!=null&&r.isFullWidth()))?!1:!!this.tabToNextCellCommon(r,e,t,"api")}tabToNextCellCommon(e,t,i,s="ui"){var l;const{editSvc:n,focusSvc:o}=this.beans;let r;const a=e instanceof Md?e:(l=e.getAllCellCtrls())==null?void 0:l[0];return n!=null&&n.isEditing()?r=n==null?void 0:n.moveToNextCell(a,t,i,s):r=this.moveToNextCellNotEditing(e,t,i),r===null?r:r||!!o.focusedHeader}moveToNextCellNotEditing(e,t,i){const s=this.beans.visibleCols.allCols;let n;if(e instanceof Xm){if(n={...e.getRowPosition(),column:t?s[0]:Ct(s)},this.gos.get("embedFullWidthRows")&&i){const r=e.findFullWidthInfoForEvent(i);r&&(n.column=r.column)}}else n=e.getFocusedCellPosition();const o=this.findNextCellToFocusOn(n,{backwards:t,startEditing:!1});if(o===!1)return null;if(o instanceof Md)o.focusCell(!0);else if(o)return this.tryToFocusFullWidthRow(o,t);return ae(o)}findNextCellToFocusOn(e,{backwards:t,startEditing:i,skipToNextEditableCell:s}){let n=e;const o=this.beans,{cellNavigation:r,gos:a,focusSvc:l,rowRenderer:c,rangeSvc:d}=o;for(;;){e!==n&&(e=n),t||(n=this.getLastCellOfColSpan(n)),n=r.getNextTabbedCell(n,t);const h=a.getCallback("tabToNextCell");if(ae(h)){const m=h({backwards:t,editing:i,previousCellPosition:e,nextCellPosition:n||null});if(m===!0)n=e;else{if(m===!1)return!1;n={rowIndex:m.rowIndex,column:m.column,rowPinned:m.rowPinned}}}if(!n)return null;if(n.rowIndex<0){const p=wo(o);return l.focusHeaderPosition({headerPosition:{headerRowIndex:p+n.rowIndex,column:n.column},fromCell:!0}),null}const u=a.get("editType")==="fullRow";if(i&&(!u||s)&&!this.isCellEditable(n))continue;this.ensureCellVisible(n);const f=pd(o,n);if(!f){const p=c.getRowByPosition(n);if(!p||!p.isFullWidth()||i)continue;return{...p.getRowPosition(),column:n==null?void 0:n.column}}if(!r.isSuppressNavigable(f.column,f.rowNode))return f.setFocusedCellPosition(n),d==null||d.setRangeToCell(n),f}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return t?e.column.isCellEditable(t):!1}lookupRowNodeForCell({rowIndex:e,rowPinned:t}){const{pinnedRowModel:i,rowModel:s}=this.beans;return t==="top"?i==null?void 0:i.getPinnedTopRow(e):t==="bottom"?i==null?void 0:i.getPinnedBottomRow(e):s.getRow(e)}navigateToNextCell(e,t,i,s){let n=i,o=!1;const r=this.beans,{cellNavigation:a,focusSvc:l,gos:c}=r;for(;n&&(n===i||!this.isValidNavigateCell(n));)c.get("enableRtl")?t===H.LEFT&&(n=this.getLastCellOfColSpan(n)):t===H.RIGHT&&(n=this.getLastCellOfColSpan(n)),n=a.getNextCellToFocus(t,n),o=At(n);if(o&&e&&e.key===H.UP&&(n={rowIndex:-1,rowPinned:null,column:i.column}),s){const h=c.getCallback("navigateToNextCell");if(ae(h)){const f=h({key:t,previousCellPosition:i,nextCellPosition:n||null,event:e});ae(f)?n={rowPinned:f.rowPinned,rowIndex:f.rowIndex,column:f.column}:n=null}}if(!n)return;if(n.rowIndex<0){const h=wo(r);l.focusHeaderPosition({headerPosition:{headerRowIndex:h+n.rowIndex,column:i.column},event:e||void 0,fromCell:!0});return}const d=this.getNormalisedPosition(n);d?this.focusPosition(d):this.tryToFocusFullWidthRow(n)}getNormalisedPosition(e){var s;if(!!((s=this.beans.spannedRowRenderer)!=null&&s.getCellByPosition(e)))return e;this.ensureCellVisible(e);const i=pd(this.beans,e);return i?(e=i.getFocusedCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){const{visibleCols:i,rowRenderer:s,focusSvc:n,eventSvc:o}=this.beans,r=i.allCols,a=s.getRowByPosition(e);if(!(a!=null&&a.isFullWidth()))return!1;const l=n.getFocusedCell(),c={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?Ct(r):r[0])};this.focusPosition(c);const d=t??(l!=null&&xW(c,l));return o.dispatchEvent({type:"fullWidthRowFocused",rowIndex:c.rowIndex,rowPinned:c.rowPinned,column:c.column,isFullWidthCell:!0,fromBelow:d}),!0}focusPosition(e){const{focusSvc:t,rangeSvc:i}=this.beans;t.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),i==null||i.setRangeToCell(e)}isValidNavigateCell(e){return!!Dr(this.beans,e)}getLastCellOfColSpan(e){const t=pd(this.beans,e);if(!t)return e;const i=t.getColSpanningList();return i.length===1?e:{rowIndex:e.rowIndex,column:Ct(i),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=HP(this.gos),i=this.beans.rowModel.getRow(e.rowIndex),s=t&&(i==null?void 0:i.sticky),{scrollFeature:n}=this.gridBodyCon;!s&&At(e.rowPinned)&&n.ensureIndexVisible(e.rowIndex),e.column.isPinned()||n.ensureColumnVisible(e.column)}ensureColumnVisible(e){const t=this.gridBodyCon.scrollFeature;e.isPinned()||t.ensureColumnVisible(e)}ensureRowVisible(e){this.gridBodyCon.scrollFeature.ensureIndexVisible(e)}};function jC(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}var T5={moduleName:"KeyboardNavigation",version:ne,beans:[P5,QU,lU],apiFunctions:{getFocusedCell:JU,clearFocusedCell:ZU,setFocusedCell:e5,setFocusedHeader:s5,tabToNextCell:t5,tabToPreviousCell:i5}},D5=class extends V{constructor(){super(...arguments),this.beanName="pageBoundsListener"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages(),this.eventSvc.dispatchEvent({type:"paginationChanged",animate:(e==null?void 0:e.animate)??!1,newData:(e==null?void 0:e.newData)??!1,newPage:(e==null?void 0:e.newPage)??!1,newPageSize:(e==null?void 0:e.newPageSize)??!1,keepRenderedRows:(e==null?void 0:e.keepRenderedRows)??!1})}calculatePages(){const{pageBounds:e,pagination:t,rowModel:i}=this.beans;t?t.calculatePages():e.calculateBounds(0,i.getRowCount()-1)}},M5=class extends V{constructor(){super(...arguments),this.beanName="pageBounds",this.pixelOffset=0}getFirstRow(){var e;return((e=this.topRowBounds)==null?void 0:e.rowIndex)??-1}getLastRow(){var e;return((e=this.bottomRowBounds)==null?void 0:e.rowIndex)??-1}getCurrentPageHeight(){const{topRowBounds:e,bottomRowBounds:t}=this;return!e||!t?0:Math.max(t.rowTop+t.rowHeight-e.rowTop,0)}getCurrentPagePixelRange(){const{topRowBounds:e,bottomRowBounds:t}=this,i=(e==null?void 0:e.rowTop)??0,s=t?t.rowTop+t.rowHeight:0;return{pageFirstPixel:i,pageLastPixel:s}}calculateBounds(e,t){const{rowModel:i}=this.beans,s=i.getRowBounds(e);s&&(s.rowIndex=e),this.topRowBounds=s;const n=i.getRowBounds(t);n&&(n.rowIndex=t),this.bottomRowBounds=n,this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){var t;const e=((t=this.topRowBounds)==null?void 0:t.rowTop)??0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventSvc.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},I5=".ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top{min-width:0;overflow:hidden;position:relative}.ag-pinned-left-sticky-top,.ag-pinned-right-sticky-top{height:100%;overflow:hidden;position:relative}.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{height:100%;overflow:hidden;width:100%}.ag-pinned-left-header,.ag-pinned-right-header{display:inline-block;height:100%;overflow:hidden;position:relative}.ag-body-horizontal-scroll:not(.ag-scrollbar-invisible){.ag-horizontal-left-spacer:not(.ag-scroller-corner){border-right:var(--ag-pinned-column-border)}.ag-horizontal-right-spacer:not(.ag-scroller-corner){border-left:var(--ag-pinned-column-border)}}.ag-pinned-right-header{border-left:var(--ag-pinned-column-border)}.ag-pinned-left-header{border-right:var(--ag-pinned-column-border)}.ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-left:var(--ag-pinned-column-border)}.ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-right:var(--ag-pinned-column-border)}.ag-pinned-left-header .ag-header-cell-resize:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}.ag-pinned-right-header .ag-header-cell-resize:after{left:50%}.ag-pinned-left-header .ag-header-cell-resize{right:-3px}.ag-pinned-right-header .ag-header-cell-resize{left:-3px}",k5=class extends V{constructor(e,t){super(),this.isLeft=e,this.elements=t,this.getWidth=e?()=>this.beans.pinnedCols.leftWidth:()=>this.beans.pinnedCols.rightWidth}postConstruct(){this.addManagedEventListeners({[`${this.isLeft?"left":"right"}PinnedWidthChanged`]:this.onPinnedWidthChanged.bind(this)})}onPinnedWidthChanged(){const e=this.getWidth(),t=e>0;for(const i of this.elements)i&&(xt(i,t),yo(i,e))}},_5=class extends V{constructor(){super(...arguments),this.beanName="pinnedCols"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridBodyCtrl=t.gridBodyCtrl});const e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const{gos:e,visibleCols:t,eventSvc:i}=this.beans,s=Ii(e,"print"),n=s?0:t.getColsLeftWidth(),o=s?0:t.getDisplayedColumnsRightWidth();n!=this.leftWidth&&(this.leftWidth=n,i.dispatchEvent({type:"leftPinnedWidthChanged"})),o!=this.rightWidth&&(this.rightWidth=o,i.dispatchEvent({type:"rightPinnedWidthChanged"}))}keepPinnedColumnsNarrowerThanViewport(){const e=this.gridBodyCtrl.eBodyViewport,t=cg(e);if(t<=50)return;const i=this.getPinnedColumnsOverflowingViewport(t-50),s=this.gos.getCallback("processUnpinnedColumns"),{columns:n,hasLockedPinned:o}=i;let r=n;!r.length&&!o||(s&&(r=s({columns:r,viewportWidth:t})),r!=null&&r.length&&(r=r.filter(a=>!yr(a)),this.setColsPinned(r,null,"viewportSizeFeature")))}createPinnedWidthFeature(e,...t){return new k5(e,t)}setColsPinned(e,t,i){const{colModel:s,colAnimation:n,visibleCols:o,gos:r}=this.beans;if(!s.cols||!(e!=null&&e.length))return;if(Ii(r,"print")){j(37);return}n==null||n.start();let a;t===!0||t==="left"?a="left":t==="right"?a="right":a=null;const l=[];for(const c of e){if(!c)continue;const d=s.getCol(c);d&&d.getPinned()!==a&&(this.setColPinned(d,a),l.push(d))}l.length&&(o.refresh(i),ZP(this.eventSvc,l,i)),n==null||n.finish()}initCol(e){const{pinned:t,initialPinned:i}=e.colDef;t!==void 0?this.setColPinned(e,t):this.setColPinned(e,i)}setColPinned(e,t){t===!0||t==="left"?e.pinned="left":t==="right"?e.pinned="right":e.pinned=null,e.dispatchStateUpdatedEvent("pinned")}setupHeaderPinnedWidth(e){const{scrollVisibleSvc:t}=this.beans;if(e.pinned==null)return;const i=e.pinned==="left",s=e.pinned==="right";e.hidden=!0;const n=()=>{const o=i?this.leftWidth:this.rightWidth;if(o==null)return;const r=o==0,a=e.hidden!==r,l=this.gos.get("enableRtl"),c=t.getScrollbarWidth(),h=t.verticalScrollShowing&&(l&&i||!l&&s)?o+c:o;e.comp.setPinnedContainerWidth(`${h}px`),e.comp.setDisplayed(!r),a&&(e.hidden=r,e.refresh())};e.addManagedEventListeners({leftPinnedWidthChanged:n,rightPinnedWidthChanged:n,scrollVisibilityChanged:n,scrollbarWidthChanged:n})}getHeaderResizeDiff(e,t){if(t.getPinned()){const{leftWidth:s,rightWidth:n}=this,o=cg(this.beans.ctrlsSvc.getGridBodyCtrl().eBodyViewport)-50;if(s+n+e>o)if(o>s+n)e=o-s-n;else return 0}return e}getPinnedColumnsOverflowingViewport(e){const t=this.rightWidth??0,i=this.leftWidth??0,s=t+i;let n=!1;if(s<e)return{columns:[],hasLockedPinned:n};const{visibleCols:o}=this.beans,r=[...o.leftCols],a=[...o.rightCols];let l=0,c=0;const d=0,h=[];let u=s-d-e;for(;(c<r.length||l<a.length)&&u>0;){if(l<a.length){const f=a[l++];if(f.colDef.lockPinned){n=!0;continue}u-=f.getActualWidth(),h.push(f)}if(c<r.length&&u>0){const f=r[c++];if(f.colDef.lockPinned){n=!0;continue}u-=f.getActualWidth(),h.push(f)}}return{columns:h,hasLockedPinned:n}}},L5={moduleName:"PinnedColumn",version:ne,beans:[_5],css:[I5]},O5=class extends V{constructor(){super(),this.beanName="ariaAnnounce",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.lastAnnouncement="",this.updateAnnouncement=Pi(this,this.updateAnnouncement.bind(this),200)}postConstruct(){const e=this.beans,t=pi(e),i=this.descriptionContainer=t.createElement("div");i.classList.add("ag-aria-description-container"),uP(i,"polite"),tH(i,"additions text"),eH(i,!0),e.eGridDiv.appendChild(i)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;const e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout(()=>{this.handleAnnouncementUpdate(e)},50)}handleAnnouncementUpdate(e){if(!this.isAlive()||!this.descriptionContainer)return;let t=e;if(t==null||t.replace(/[ .]/g,"")==""){this.lastAnnouncement="";return}this.lastAnnouncement===t&&(t=`${t}â`),this.lastAnnouncement=t,this.descriptionContainer.textContent=t}destroy(){super.destroy();const{descriptionContainer:e}=this;e&&(Mi(e),e.remove()),this.descriptionContainer=null,this.pendingAnnouncements.clear()}},N5={moduleName:"Aria",version:ne,beans:[O5]},H5=":where(.ag-delay-render){.ag-cell,.ag-header-cell,.ag-header-group-cell,.ag-row,.ag-spanned-cell-wrapper{visibility:hidden}}",rx="ag-delay-render",G5=class extends V{constructor(){super(...arguments),this.beanName="colDelayRenderSvc",this.hideRequested=!1,this.alreadyRevealed=!1,this.timesRetried=0,this.requesters=new Set}hideColumns(e){this.alreadyRevealed||this.requesters.has(e)||(this.requesters.add(e),this.hideRequested||(this.beans.ctrlsSvc.whenReady(this,t=>{t.gridBodyCtrl.eGridBody.classList.add(rx)}),this.hideRequested=!0))}revealColumns(e){if(this.alreadyRevealed||!this.isAlive()||(this.requesters.delete(e),this.requesters.size>0))return;const{renderStatus:t,ctrlsSvc:i}=this.beans;if(t){if(!t.areHeaderCellsRendered()&&this.timesRetried<5){this.timesRetried++,setTimeout(()=>this.revealColumns(e));return}this.timesRetried=0}i.getGridBodyCtrl().eGridBody.classList.remove(rx),this.alreadyRevealed=!0}},B5={moduleName:"ColumnDelayRender",version:ne,beans:[G5],css:[H5]};function V5(e){var t;(t=e.overlays)==null||t.showLoadingOverlay()}function z5(e){var t;(t=e.overlays)==null||t.showNoRowsOverlay()}function W5(e){var t;(t=e.overlays)==null||t.hideOverlay()}var $5=".ag-overlay{inset:0;pointer-events:none;position:absolute;z-index:2}.ag-overlay-panel,.ag-overlay-wrapper{display:flex;height:100%;width:100%}.ag-overlay-wrapper{align-items:center;flex:none;justify-content:center;text-align:center}.ag-overlay-loading-wrapper{pointer-events:all}.ag-overlay-loading-center{background:var(--ag-background-color);border:solid var(--ag-border-width) var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-popup-shadow);padding:var(--ag-spacing)}",U5={tag:"div",cls:"ag-overlay",role:"presentation",children:[{tag:"div",cls:"ag-overlay-panel",role:"presentation",children:[{tag:"div",ref:"eOverlayWrapper",cls:"ag-overlay-wrapper",role:"presentation"}]}]},RD=class extends ct{constructor(){super(U5),this.eOverlayWrapper=se,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeCssClass=null,this.elToFocusAfter=null,this.registerCSS($5)}handleKeyDown(e){if(e.key!==H.TAB||e.defaultPrevented||Rr(e))return;const t=this.beans;if(Kc(t,this.eOverlayWrapper,!1,e.shiftKey))return;let s=!1;e.shiftKey?s=t.focusSvc.focusGridView({column:Ct(t.visibleCols.allCols),backwards:!0,canFocusOverlay:!1}):s=jh(t,!1),s&&e.preventDefault()}updateLayoutClasses(e,t){const i=this.eOverlayWrapper.classList,{AUTO_HEIGHT:s,NORMAL:n,PRINT:o}=An;i.toggle(s,t.autoHeight),i.toggle(n,t.normal),i.toggle(o,t.print)}postConstruct(){this.createManagedBean(new PS(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.beans.overlays.setOverlayWrapperComp(this),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}setWrapperTypeClass(e){const t=this.eOverlayWrapper.classList;this.activeCssClass&&t.toggle(this.activeCssClass,!1),this.activeCssClass=e,t.toggle(e,!0)}showOverlay(e,t,i,s){if(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,!!e){if(this.setDisplayed(!0,{skipAriaHidden:!0}),i&&this.isGridFocused()){const n=Dt(this.beans);n&&!lP(this.beans)&&(this.elToFocusAfter=n)}e.then(n=>{if(this.activePromise!==e){this.activeOverlay!==n&&(this.destroyBean(n),n=null);return}if(this.activePromise=null,!!n){if(this.activeOverlay!==n&&(this.eOverlayWrapper.appendChild(n.getGui()),this.activeOverlay=n,s)){const o=n;this.updateListenerDestroyFunc=this.addManagedPropertyListener(s,({currentValue:r})=>{var a;(a=o.refresh)==null||a.call(o,Fe(this.gos,{...r??{}}))})}i&&this.isGridFocused()&&kc(this.eOverlayWrapper)}})}}updateOverlayWrapperPaddingTop(e){this.eOverlayWrapper.style.setProperty("padding-top",`${e}px`)}destroyActiveOverlay(){var s;this.activePromise=null;const e=this.activeOverlay;if(!e)return;let t=this.elToFocusAfter;this.activeOverlay=null,this.elToFocusAfter=null,t&&!this.isGridFocused()&&(t=null);const i=this.updateListenerDestroyFunc;i&&(i(),this.updateListenerDestroyFunc=null),this.destroyBean(e),Mi(this.eOverlayWrapper),(s=t==null?void 0:t.focus)==null||s.call(t,{preventScroll:!0})}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}isGridFocused(){const e=Dt(this.beans);return!!e&&this.beans.eGridDiv.contains(e)}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.beans.overlays.setOverlayWrapperComp(void 0),super.destroy()}},j5={selector:"AG-OVERLAY-WRAPPER",component:RD},K5=class extends V{constructor(){super(...arguments),this.beanName="overlays",this.state=0,this.showInitialOverlay=!0,this.wrapperPadding=0}postConstruct(){this.isClientSide=Ut(this.gos),this.isServerSide=!this.isClientSide&&iu(this.gos);const e=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e,gridSizeChanged:this.refreshWrapperPadding.bind(this),rowCountReady:()=>{this.showInitialOverlay=!1,this.updateOverlayVisibility()}}),this.addManagedPropertyListener("loading",e)}setOverlayWrapperComp(e){this.eWrapper=e,this.updateOverlayVisibility()}isVisible(){return this.state!==0&&!!this.eWrapper}isExclusive(){return this.state===1&&!!this.eWrapper}showLoadingOverlay(){this.showInitialOverlay=!1;const e=this.gos,t=e.get("loading");!t&&(t!==void 0||e.get("suppressLoadingOverlay"))||this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1;const e=this.gos;e.get("loading")||e.get("suppressNoRowsOverlay")||this.doShowNoRowsOverlay()}hideOverlay(){if(this.showInitialOverlay=!1,this.gos.get("loading")){j(99);return}this.doHideOverlay()}getOverlayWrapperSelector(){return j5}getOverlayWrapperCompClass(){return RD}updateOverlayVisibility(){if(!this.eWrapper){this.state=0;return}const{state:e,isClientSide:t,isServerSide:i,beans:{gos:s,colModel:n,rowModel:o}}=this;let r=this.gos.get("loading");r!==void 0&&(this.showInitialOverlay=!1),this.showInitialOverlay&&r===void 0&&!s.get("suppressLoadingOverlay")&&(r=!s.get("columnDefs")||!n.ready||!s.get("rowData")&&t),r?e!==1&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,t&&o.isEmpty()&&!s.get("suppressNoRowsOverlay")?e!==2&&this.doShowNoRowsOverlay():(e===1||!i&&e!==0)&&this.doHideOverlay())}doShowLoadingOverlay(){this.eWrapper&&(this.state=1,this.showOverlay(f2(this.beans.userCompFactory,Fe(this.gos,{})),"ag-overlay-loading-wrapper","loadingOverlayComponentParams"),this.updateExclusive())}doShowNoRowsOverlay(){this.eWrapper&&(this.state=2,this.showOverlay(p2(this.beans.userCompFactory,Fe(this.gos,{})),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams"),this.updateExclusive())}doHideOverlay(){this.eWrapper&&(this.state=0,this.eWrapper.hideOverlay(),this.updateExclusive())}showOverlay(e,t,i){var n;const s=(e==null?void 0:e.newAgStackInstance())??null;(n=this.eWrapper)==null||n.showOverlay(s,t,this.isExclusive(),i),this.refreshWrapperPadding()}updateExclusive(){const e=this.exclusive;this.exclusive=this.isExclusive(),this.exclusive!==e&&this.eventSvc.dispatchEvent({type:"overlayExclusiveChanged"})}refreshWrapperPadding(){const e=this.eWrapper;if(!e)return;let t=0;if(this.state===2){const i=this.beans.ctrlsSvc.get("gridHeaderCtrl");t=(i==null?void 0:i.headerHeight)||0}this.wrapperPadding!==t&&(this.wrapperPadding=t,e.updateOverlayWrapperPaddingTop(t))}},q5={moduleName:"Overlay",version:ne,userComponents:{agLoadingOverlay:lz,agNoRowsOverlay:dz},apiFunctions:{showLoadingOverlay:V5,showNoRowsOverlay:z5,hideOverlay:W5},beans:[K5]},Y5=class extends V{constructor(){super(...arguments),this.beanName="rowContainerHeight",this.scrollY=0,this.uiBodyHeight=0}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=w2(),Ga(this.gos,"RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}updateOffset(){if(!this.stretching)return;const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;Ga(this.gos,`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventSvc.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t=typeof e=="number"?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventSvc.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=e!=null&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=this.modelHeight-this.getUiBodyHeight(),i=e/t;return this.maxScrollY*i}},X5=400,Q5=class extends V{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const e=()=>{for(const o of this.getAllCellCtrls())o.onCellSelectionChanged()},t=()=>{for(const o of this.getAllCellCtrls())o.updateRangeBordersIfRangeCount()},i=()=>{this.eventSvc.addListener("cellSelectionChanged",e),this.eventSvc.addListener("columnMoved",t),this.eventSvc.addListener("columnPinned",t),this.eventSvc.addListener("columnVisible",t)},s=()=>{this.eventSvc.removeListener("cellSelectionChanged",e),this.eventSvc.removeListener("columnMoved",t),this.eventSvc.removeListener("columnPinned",t),this.eventSvc.removeListener("columnVisible",t)};this.addDestroyFunc(()=>s()),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{Tr(this.gos)?i():s()}),Tr(this.gos)&&i()}}wireBeans(e){this.pageBounds=e.pageBounds,this.colModel=e.colModel,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusSvc=e.focusSvc,this.rowContainerHeight=e.rowContainerHeight,this.ctrlsSvc=e.ctrlsSvc,this.editSvc=e.editSvc}postConstruct(){this.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),pinnedRowsChanged:this.onPinnedRowsChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListener("suppressCellFocus",s=>this.onSuppressCellFocusChanged(s.currentValue)),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.addManagedPropertyListener("cellSelection",({currentValue:s,previousValue:n})=>{(!n&&s||n&&!s)&&this.redrawRows()});const{stickyRowSvc:e,gos:t,showRowGroupCols:i}=this.beans;if(i&&this.addManagedPropertyListener("showOpenedGroup",()=>{const s=i.getShowRowGroupCols();s.length&&this.refreshCells({columns:s,force:!0})}),e)this.stickyRowFeature=e.createStickyRowFeature(this,this.createRowCon.bind(this),this.destroyRowCtrls.bind(this));else{const s=this.gridBodyCtrl;s.setStickyTopHeight(0),s.setStickyBottomHeight(0)}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=Ii(t,"print"),this.embedFullWidthRows=this.printLayout||t.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=e??3;this.cachedRowCtrls=new J5(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){var e;return((e=this.stickyRowFeature)==null?void 0:e.stickyTopRowCtrls)??[]}getStickyBottomRowCtrls(){var e;return((e=this.stickyRowFeature)==null?void 0:e.stickyBottomRowCtrls)??[]}updateAllRowCtrls(){var s;const e=Object.values(this.rowCtrlsByRowIndex),t=Object.values(this.zombieRowCtrls),i=((s=this.cachedRowCtrls)==null?void 0:s.getEntries())??[];t.length>0||i.length>0?this.allRowCtrls=[...e,...t,...i]:this.allRowCtrls=e}isCellBeingRendered(e,t){var n;const i=this.rowCtrlsByRowIndex[e];return!t||!i?!!i:i.isFullWidth()?!0:!!((n=this.beans.spannedRowRenderer)==null?void 0:n.getCellByPosition({rowIndex:e,column:t,rowPinned:null}))||!!i.getCellCtrl(t)||!i.isRowRendered()}updateCellFocus(e){for(const t of this.getAllCellCtrls())t.onCellFocused(e);for(const t of this.getFullWidthRowCtrls())t.onFullWidthRowFocused(e)}onCellFocusChanged(e){if((e==null?void 0:e.rowIndex)!=null&&!e.rowPinned){const t=this.beans.colModel.getCol(e.column)??void 0;this.isCellBeingRendered(e.rowIndex,t)||this.redraw()}this.updateCellFocus(e)}onSuppressCellFocusChanged(e){for(const t of this.getAllCellCtrls())t.onSuppressCellFocusChanged(e);for(const t of this.getFullWidthRowCtrls())t.onSuppressCellFocusChanged(e)}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>this.onCellFocusChanged(e),cellFocusCleared:()=>this.updateCellFocus(),flashCells:e=>{const{cellFlashSvc:t}=this.beans;if(t)for(const i of this.getAllCellCtrls())t.onFlashCells(i,e)},columnHoverChanged:()=>{for(const e of this.getAllCellCtrls())e.onColumnHover()},displayedColumnsChanged:()=>{for(const e of this.getAllCellCtrls())e.onDisplayedColumnsChanged()},displayedColumnsWidthChanged:()=>{if(this.printLayout)for(const e of this.getAllCellCtrls())e.onLeftChanged()}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){for(const e of this.destroyFuncsForColumnListeners)e();this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();const e=this.colModel.getCols();for(const t of e){const i=l=>{for(const c of this.getAllCellCtrls())c.column===t&&l(c)},s=()=>{i(l=>l.onLeftChanged())},n=()=>{i(l=>l.onWidthChanged())},o=()=>{i(l=>l.onFirstRightPinnedChanged())},r=()=>{i(l=>l.onLastLeftPinnedChanged())},a=()=>{i(l=>l.onColDefChanged())};t.__addEventListener("leftChanged",s),t.__addEventListener("widthChanged",n),t.__addEventListener("firstRightPinnedChanged",o),t.__addEventListener("lastLeftPinnedChanged",r),t.__addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{t.__removeEventListener("leftChanged",s),t.__removeEventListener("widthChanged",n),t.__removeEventListener("firstRightPinnedChanged",o),t.__removeEventListener("lastLeftPinnedChanged",r),t.__removeEventListener("colDefChanged",a)})}}onDomLayoutChanged(){const e=Ii(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),i=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,i&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsNotSpanningForColumn(e){var i;const t=[];for(const s of this.getAllRowCtrls()){const n=(i=s.getCellCtrl(e,!0))==null?void 0:i.eGui;n&&t.push(n)}return t}refreshFloatingRowComps(e=!0){this.refreshFloatingRows(this.topRowCtrls,"top",e),this.refreshFloatingRows(this.bottomRowCtrls,"bottom",e)}refreshFloatingRows(e,t,i){const{pinnedRowModel:s,beans:n,printLayout:o}=this,r=Object.fromEntries(e.map(l=>[l.rowNode.id,l]));s==null||s.forEachPinnedRow(t,(l,c)=>{const d=e[c];d&&s.getPinnedRowById(d.rowNode.id,t)===void 0&&(d.destroyFirstPass(),d.destroySecondPass()),l.id in r&&i?(e[c]=r[l.id],delete r[l.id]):e[c]=new Xm(l,n,!1,!1,o)});const a=(t==="top"?s==null?void 0:s.getPinnedTopRowCount():s==null?void 0:s.getPinnedBottomRowCount())??0;e.length=a}onPinnedRowDataChanged(){const e={recycleRows:!0};this.redrawAfterModelUpdate(e)}onPinnedRowsChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(e,t=!1){var i,s;if(e.sticky)(i=this.stickyRowFeature)==null||i.refreshStickyNode(e);else if((s=this.cachedRowCtrls)!=null&&s.has(e)){this.cachedRowCtrls.removeRow(e);return}else{const n=o=>{const r=o[e.rowIndex];r&&r.rowNode===e&&(r.destroyFirstPass(),r.destroySecondPass(),o[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":n(this.topRowCtrls);break;case"bottom":n(this.bottomRowCtrls);break;default:n(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){const{editSvc:t}=this.beans;if(t!=null&&t.isEditing()&&(t.isBatchEditing()?t.cleanupEditors():t.stopEditing(void 0,{source:"api"})),e!=null){for(const s of e??[])this.redrawRow(s,!0);this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}redrawAfterModelUpdate(e={}){var a;this.getLockOnRefresh();const t=(a=this.beans.focusSvc)==null?void 0:a.getFocusCellToUseAfterRefresh();this.updateContainerHeights(),this.scrollToTopIfNewData(e);const i=!e.domLayoutChanged&&!!e.recycleRows,s=e.animate&&xd(this.gos),n=i?this.getRowsToRecycle():null;i||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender();const{stickyRowFeature:o,gos:r}=this;if(o){o.checkStickyRows();const l=o.extraTopHeight+o.extraBottomHeight;l&&this.updateContainerHeights(l)}this.recycleRows(n,s),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(r.get("enableRowPinning")?i:void 0),this.dispatchDisplayedRowsChanged(),t!=null&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){var s;const t=e.newData||e.newPage,i=this.gos.get("suppressScrollOnNewData");t&&!i&&(this.gridBodyCtrl.scrollFeature.scrollToTop(),(s=this.stickyRowFeature)==null||s.resetOffsets())}updateContainerHeights(e=0){const{rowContainerHeight:t}=this;if(this.printLayout){t.setModelHeight(null);return}let i=this.pageBounds.getCurrentPageHeight();i===0&&(i=1),t.setModelHeight(i+e)}getLockOnRefresh(){var e,t;if(this.refreshInProgress)throw new Error(So(252));this.refreshInProgress=!0,(t=(e=this.beans.frameworkOverrides).getLockOnRefresh)==null||t.call(e)}releaseLockOnRefresh(){var e,t;this.refreshInProgress=!1,(t=(e=this.beans.frameworkOverrides).releaseLockOnRefresh)==null||t.call(e)}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){if(!e)return;const t=this.beans.focusSvc,i=this.findPositionToFocus(e);if(!i){t.focusHeaderPosition({headerPosition:{headerRowIndex:wo(this.beans)-1,column:e.column}});return}if(e.rowIndex!==i.rowIndex||e.rowPinned!=i.rowPinned){t.setFocusedCell({...i,preventScrollOnBrowserFocus:!0,forceBrowserFocus:!0});return}t.doesRowOrCellHaveBrowserFocus()||this.updateCellFocus(Fe(this.gos,{...i,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"}))}findPositionToFocus(e){const{pagination:t,pageBounds:i}=this.beans;let s=e;for(s.rowPinned==null&&t&&i&&!t.isRowInPage(s.rowIndex)&&(s={rowPinned:null,rowIndex:i.getFirstRow()});s;){if(s.rowPinned==null&&i)if(s.rowIndex<i.getFirstRow()){if(s=qm(this.beans,{rowPinned:null,rowIndex:0}),!s)return null}else s.rowIndex>i.getLastRow()&&(s={rowPinned:null,rowIndex:i.getLastRow()});const n=this.getRowByPosition(s);if(n!=null&&n.isAlive())return{...n.getRowPosition(),column:e.column};s=qm(this.beans,s)}return null}getAllCellCtrls(){const e=[],t=this.getAllRowCtrls(),i=t.length;for(let s=0;s<i;s++){const n=t[s].getAllCellCtrls(),o=n.length;for(let r=0;r<o;r++)e.push(n[r])}return e}getAllRowCtrls(){const{spannedRowRenderer:e}=this.beans,t=this.getStickyTopRowCtrls(),i=this.getStickyBottomRowCtrls();return[...this.topRowCtrls,...this.bottomRowCtrls,...t,...i,...(e==null?void 0:e.getCtrls("top"))??[],...(e==null?void 0:e.getCtrls("bottom"))??[],...(e==null?void 0:e.getCtrls("center"))??[],...Object.values(this.rowCtrlsByRowIndex)]}addRenderedRowListener(e,t,i){const s=this.rowCtrlsByRowIndex[t];s&&s.addEventListener(e,i)}refreshCells({rowNodes:e,columns:t,force:i,suppressFlash:s}={}){const n={force:i,newData:!1,suppressFlash:s};for(const o of this.getCellCtrls(e,t))o.refreshOrDestroyCell(n);this.refreshFullWidth(e)}refreshRows(e={}){for(const t of this.getRowCtrls(e.rowNodes))t.refreshRow(e);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=!1;for(const i of this.getRowCtrls(e)){if(!i.isFullWidth())continue;i.refreshFullWidth()||(t=!0,this.redrawRow(i.rowNode,!0))}t&&this.dispatchDisplayedRowsChanged(!1)}getRowCtrls(e){const t=gy(e),i=this.getAllRowCtrls();return!e||!t?i:i.filter(s=>{const n=s.rowNode;return fy(n,t)})}getCellCtrls(e,t){let i;ae(t)&&(i={},t.forEach(n=>{const o=this.colModel.getCol(n);ae(o)&&(i[o.getId()]=!0)}));const s=[];for(const n of this.getRowCtrls(e))for(const o of n.getAllCellCtrls()){const r=o.column.getId();i&&!i[r]||s.push(o)}return s}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(e=!1){var i;const t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),(i=this.stickyRowFeature)==null||i.destroyStickyCtrls()}getRowsToRecycle(){const e=[];for(const i of Object.keys(this.rowCtrlsByRowIndex))this.rowCtrlsByRowIndex[i].rowNode.id==null&&e.push(i);this.removeRowCtrls(e);const t={};for(const i of Object.values(this.rowCtrlsByRowIndex)){const s=i.rowNode;t[s.id]=i}return this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){for(const i of e){const s=this.rowCtrlsByRowIndex[i];s&&(s.destroyFirstPass(t),s.destroySecondPass()),delete this.rowCtrlsByRowIndex[i]}}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(e={}){const{focusSvc:t,animationFrameSvc:i}=this.beans,{afterScroll:s}=e;let n;const o=this.stickyRowFeature;o&&(n=(t==null?void 0:t.getFocusCellToUseAfterRefresh())||void 0);const r=this.firstRenderedRow,a=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let l=!1;if(o){l=o.checkStickyRows();const d=o.extraTopHeight+o.extraBottomHeight;d&&this.updateContainerHeights(d)}const c=this.firstRenderedRow!==r||this.lastRenderedRow!==a;if(!(s&&!l&&!c)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,s),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(s&&!l),n!=null)){const d=t==null?void 0:t.getFocusCellToUseAfterRefresh();n!=null&&d==null&&(i==null||i.flushAllFrames(),this.restoreFocusedCell(n))}}removeRowCompsNotToDraw(e,t){const i={};for(const o of e)i[o]=!0;const n=Object.keys(this.rowCtrlsByRowIndex).filter(o=>!i[o]);this.removeRowCtrls(n,t)}calculateIndexesToDraw(e){var r,a;const t=[];for(let l=this.firstRenderedRow;l<=this.lastRenderedRow;l++)t.push(l);const i=this.beans.pagination,s=(a=(r=this.beans.focusSvc)==null?void 0:r.getFocusedCell())==null?void 0:a.rowIndex;s!=null&&(s<this.firstRenderedRow||s>this.lastRenderedRow)&&(!i||i.isRowInPage(s))&&s<this.rowModel.getRowCount()&&t.push(s);const n=l=>{const c=l.rowNode.rowIndex;c==null||c===s||(c<this.firstRenderedRow||c>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(l)&&t.push(c)};for(const l of Object.values(this.rowCtrlsByRowIndex))n(l);if(e)for(const l of Object.values(e))n(l);t.sort((l,c)=>l-c);const o=[];for(let l=0;l<t.length;l++){const c=t[l],d=this.rowModel.getRow(c);d&&!d.sticky&&o.push(c)}return o}recycleRows(e,t=!1,i=!1){const s=this.calculateIndexesToDraw(e);(this.printLayout||i)&&(t=!1),this.removeRowCompsNotToDraw(s,!t);for(const n of s)this.createOrUpdateRowCtrl(n,e,t,i);if(e){const{animationFrameSvc:n}=this.beans;(n==null?void 0:n.active)&&i&&!this.printLayout?n.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){this.eventSvc.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){const{visibleCols:e}=this.beans,t=e.isPinningLeft(),i=e.isPinningRight();(this.pinningLeft!==t||i!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=i,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const e=[];for(const t of this.getFullWidthRowCtrls()){const i=t.rowNode.rowIndex;e.push(i.toString())}this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){const t=gy(e);return this.getAllRowCtrls().filter(i=>{if(!i.isFullWidth())return!1;const s=i.rowNode;return!(t!=null&&!fy(s,t))})}createOrUpdateRowCtrl(e,t,i,s){let n,o=this.rowCtrlsByRowIndex[e];if(o||(n=this.rowModel.getRow(e),ae(n)&&ae(t)&&t[n.id]&&n.alreadyRendered&&(o=t[n.id],t[n.id]=null)),!o)if(n||(n=this.rowModel.getRow(e)),ae(n))o=this.createRowCon(n,i,s);else return;n&&(n.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=o}destroyRowCtrls(e,t){const i=[];if(e){for(const s of Object.values(e))if(s){if(this.cachedRowCtrls&&s.isCacheable()){this.cachedRowCtrls.addRow(s);continue}if(s.destroyFirstPass(!t),t){const n=s.instanceId;this.zombieRowCtrls[n]=s,i.push(()=>{s.destroySecondPass(),delete this.zombieRowCtrls[n]})}else s.destroySecondPass()}}t&&(i.push(()=>{this.isAlive()&&(this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged())}),window.setTimeout(()=>{for(const s of i)s()},X5))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){const e=this.getRowBuffer(),t=yc(this.beans);return e*t}workOutFirstAndLastRowsToRender(){const{rowContainerHeight:e,pageBounds:t,rowModel:i}=this;e.updateOffset();let s,n;if(!i.isRowsToRender())s=0,n=-1;else if(this.printLayout)this.beans.environment.refreshRowHeightVariable(),s=t.getFirstRow(),n=t.getLastRow();else{const d=this.getRowBufferInPixels(),h=this.ctrlsSvc.getScrollFeature(),u=this.gos.get("suppressRowVirtualisation");let f=!1,p,m;do{const b=t.getPixelOffset(),{pageFirstPixel:E,pageLastPixel:A}=t.getCurrentPagePixelRange(),P=e.divStretchOffset,T=h.getVScrollPosition(),D=T.top,N=T.bottom;u?(p=E+P,m=A+P):(p=Math.max(D+b-d,E)+P,m=Math.min(N+b+d,A)+P),this.firstVisibleVPixel=Math.max(D+b,E)+P,this.lastVisibleVPixel=Math.min(N+b,A)+P,f=this.ensureAllRowsInRangeHaveHeightsCalculated(p,m)}while(f);let v=i.getRowIndexAtPixel(p),C=i.getRowIndexAtPixel(m);const w=t.getFirstRow(),S=t.getLastRow();v<w&&(v=w),C>S&&(C=S),s=v,n=C}const o=Ii(this.gos,"normal"),r=this.gos.get("suppressMaxRenderedRowRestriction"),a=Math.max(this.getRowBuffer(),500);o&&!r&&n-s>a&&(n=s+a);const l=s!==this.firstRenderedRow,c=n!==this.lastRenderedRow;(l||c)&&(this.firstRenderedRow=s,this.lastRenderedRow=n,this.eventSvc.dispatchEvent({type:"viewportChanged",firstRow:s,lastRow:n}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,Lr(this.beans,()=>{this.beans.eventSvc.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})}))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){var a,l;const i=(a=this.pinnedRowModel)==null?void 0:a.ensureRowHeightsValid(),s=(l=this.stickyRowFeature)==null?void 0:l.ensureRowHeightsValid(),{pageBounds:n,rowModel:o}=this,r=o.ensureRowHeightsValid(e,t,n.getFirstRow(),n.getLastRow());return(r||s)&&this.eventSvc.dispatchEvent({type:"recalculateRowBounds"}),s||r||i?(this.updateContainerHeights(),!0):!1}doNotUnVirtualiseRow(e){var c;const s=e.rowNode,n=this.focusSvc.isRowFocused(s.rowIndex,s.rowPinned),o=(c=this.editSvc)==null?void 0:c.isEditing(e),r=s.detail;return n||o||r?!!this.isRowPresent(s):!1}isRowPresent(e){var t;return this.rowModel.isRowPresent(e)?((t=this.beans.pagination)==null?void 0:t.isRowInPage(e.rowIndex))??!0:!1}createRowCon(e,t,i){var r,a;const s=((r=this.cachedRowCtrls)==null?void 0:r.getRow(e))??null;if(s)return s;const n=i&&!this.printLayout&&!!((a=this.beans.animationFrameSvc)!=null&&a.active);return new Xm(e,this.beans,t,n,this.printLayout)}getRenderedNodes(){const e=Object.values(this.rowCtrlsByRowIndex).map(s=>s.rowNode),t=this.getStickyTopRowCtrls().map(s=>s.rowNode),i=this.getStickyBottomRowCtrls().map(s=>s.rowNode);return[...t,...e,...i]}getRowByPosition(e){let t;const{rowIndex:i}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[i];break;case"bottom":t=this.bottomRowCtrls[i];break;default:t=this.rowCtrlsByRowIndex[i],t||(t=this.getStickyTopRowCtrls().find(s=>s.rowNode.rowIndex===i)||null,t||(t=this.getStickyBottomRowCtrls().find(s=>s.rowNode.rowIndex===i)||null));break}return t}isRangeInRenderedViewport(e,t){if(e==null||t==null)return!1;const s=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!s}},J5=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.rowNode.id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if((e==null?void 0:e.id)==null)return null;const t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.rowNode!=e?null:t):null}has(e){return this.entriesMap[e.id]!=null}removeRow(e){const t=e.id,i=this.entriesMap[t];delete this.entriesMap[t],_n(this.entriesList,i)}removeFromCache(e){const t=e.rowNode.id;delete this.entriesMap[t],_n(this.entriesList,e)}getEntries(){return this.entriesList}};function gy(e){if(!e)return;const t={top:{},bottom:{},normal:{}};for(const i of e){const s=i.id;switch(i.rowPinned){case"top":t.top[s]=i;break;case"bottom":t.bottom[s]=i;break;default:t.normal[s]=i;break}}return t}function fy(e,t){const i=e.id;switch(e.rowPinned){case"top":return t.top[i]!=null;case"bottom":return t.bottom[i]!=null;default:return t.normal[i]!=null}}var Z5=class extends V{constructor(){super(...arguments),this.beanName="rowNodeSorter"}postConstruct(){const{gos:e}=this;this.isAccentedSort=e.get("accentedSort"),this.primaryColumnsSortGroups=mo(e),this.addManagedPropertyListener("accentedSort",t=>this.isAccentedSort=t.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=mo(e))}doFullSort(e,t){const i=e.map((s,n)=>({currentPos:n,rowNode:s}));return i.sort(this.compareRowNodes.bind(this,t)),i.map(s=>s.rowNode)}compareRowNodes(e,t,i){const s=t.rowNode,n=i.rowNode;for(let o=0,r=e.length;o<r;o++){const a=e[o],l=a.sort==="desc",c=this.getValue(s,a.column),d=this.getValue(n,a.column);let h;const u=this.getComparator(a,s);if(u?h=u(c,d,s,n,l):h=KN(c,d,this.isAccentedSort),!isNaN(h)&&h!==0)return a.sort==="asc"?h:h*-1}return t.currentPos-i.currentPos}getComparator(e,t){const i=e.column,s=i.getColDef().comparator;if(s!=null)return s;if(!i.getColDef().showRowGroup)return;const n=!t.group&&i.getColDef().field;if(!n)return;const o=this.beans.colModel.getColDefCol(n);if(o)return o.getColDef().comparator}getValue(e,t){var a;const{valueSvc:i,colModel:s,showRowGroupCols:n,gos:o}=this.beans;if(!this.primaryColumnsSortGroups)return i.getValue(t,e,!1);if(e.rowGroupColumn===t){if(BP(o,s.isPivotActive())){const d=e.data?e:PT(e.childrenAfterGroup);return d&&i.getValue(t,d,!1)}const c=n==null?void 0:n.getShowRowGroupCol(t.getId());return c?(a=e.groupData)==null?void 0:a[c.getId()]:void 0}if(!(e.group&&t.getColDef().showRowGroup))return i.getValue(t,e,!1)}};function e4(e){var t;(t=e.sortSvc)==null||t.onSortChanged("api")}var xD={moduleName:"Sort",version:ne,beans:[vU,Z5],apiFunctions:{onSortChanged:e4},userComponents:{agSortIndicator:NS},icons:{sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"}},t4=class extends V{constructor(){super(...arguments),this.beanName="syncSvc",this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.beans.ctrlsSvc.whenReady(this,()=>{const e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){const{colModel:t,rowModel:i}=this.beans;t.setColumnDefs(e??[],"gridInitializing"),i.start()}gridReady(){const{eventSvc:e,gos:t}=this;e.dispatchEvent({type:"gridReady"}),Ga(t,`initialised successfully, enterprise = ${t.isModuleRegistered("EnterpriseCore")}`)}setColumnDefs(e){const t=this.gos.get("columnDefs");if(t){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(t);return}this.beans.colModel.setColumnDefs(t,Ad(e.source))}}};function i4(e){var t;(t=e.valueCache)==null||t.expire()}function s4(e,t){const{colKey:i,rowNode:s,useFormatter:n}=t,o=e.colModel.getColDefCol(i)??e.colModel.getCol(i);if(At(o))return null;const r=e.valueSvc.getValueForDisplay(o,s,n);return n?r.valueFormatted??tu(r.value):r.value}var n4="paste",o4=class extends V{constructor(){super(...arguments),this.beanName="changeDetectionSvc",this.clientSideRowModel=null}postConstruct(){const{gos:e,rowModel:t}=this.beans;Ut(e)&&(this.clientSideRowModel=t),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){const{gos:t,rowRenderer:i}=this.beans;if(e.source===n4||t.get("suppressChangeDetection"))return;const s=e.node,n=[s],o=this.clientSideRowModel,r=o==null?void 0:o.rootNode;if(r&&!s.isRowPinned()){const a=t.get("aggregateOnlyChangedColumns"),l=new mg(a,r);l.addParentNode(s.parent,[e.column]),o.doAggregate(l),l.forEachChangedNodeDepthFirst(c=>{n.push(c),c.sibling&&n.push(c.sibling)})}i.refreshCells({rowNodes:n})}},r4=class extends V{constructor(){super(...arguments),this.beanName="expressionSvc",this.cache={}}evaluate(e,t){if(typeof e=="string")return this.evaluateExpression(e,t);ut(15,{expression:e})}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(i){return ut(16,{expression:e,params:t,e:i}),null}}createExpressionFunction(e){const t=this.cache;if(t[e])return t[e];const i=this.createFunctionBody(e),s=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",i);return t[e]=s,s}createFunctionBody(e){return e.includes("return")?e:"return "+e+";"}},a4=class extends V{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){const e=this.gos;this.active=e.get("valueCache"),this.neverExpires=e.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,i){if(this.active){const s=this.cacheVersion;e.__cacheVersion!==s&&(e.__cacheVersion=s,e.__cacheData={}),e.__cacheData[t]=i}}getValue(e,t){if(!(!this.active||e.__cacheVersion!==this.cacheVersion))return e.__cacheData[t]}},l4={moduleName:"ValueCache",version:ne,beans:[a4],apiFunctions:{expireValueCache:i4}},c4={moduleName:"Expression",version:ne,beans:[r4]},d4={moduleName:"ChangeDetection",version:ne,beans:[o4]},h4={moduleName:"CellApi",version:ne,apiFunctions:{getCellValue:s4}},u4=class extends V{constructor(){super(...arguments),this.beanName="valueSvc",this.hasEditSvc=!1,this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionSvc=e.expressionSvc,this.colModel=e.colModel,this.valueCache=e.valueCache,this.dataTypeSvc=e.dataTypeSvc,this.editSvc=e.editSvc,this.hasEditSvc=!!e.editSvc}postConstruct(){this.initialised||this.init()}init(){this.executeValueGetter=this.valueCache?this.executeValueGetterWithValueCache.bind(this):this.executeValueGetterWithoutValueCache.bind(this),this.isSsrm=iu(this.gos),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;const e=t=>this.callColumnCellValueChangedHandler(t);this.eventSvc.addListener("cellValueChanged",e,!0),this.addDestroyFunc(()=>this.eventSvc.removeListener("cellValueChanged",e,!0)),this.addManagedPropertyListener("treeData",t=>this.isTreeData=t.currentValue)}getValueForDisplay(e,t,i=!1,s=!1,n="ui"){const{showRowGroupColValueSvc:o}=this.beans,r=!e&&t.group,a=e==null?void 0:e.colDef.showRowGroup,l=!this.isTreeData||t.footer;if(o&&l&&(r||a)){const m=o.getGroupValue(t,e);if(m==null)return{value:null,valueFormatted:null};if(!i)return{value:m.value,valueFormatted:null};const v=o.formatAndPrefixGroupColValue(m,e,s);return{value:m.value,valueFormatted:v}}if(!e)return{value:t.key,valueFormatted:null};const c=t.leafGroup&&this.colModel.isPivotMode(),d=t.group&&t.expanded&&!t.footer&&!c,h=this.gos.get("groupSuppressBlankHeader")||!t.sibling,u=d&&!h,f=this.getValue(e,t,u,n),p=i&&!(s&&e.colDef.useValueFormatterForExport===!1);return{value:f,valueFormatted:p?this.formatValue(e,t,f):null}}getValue(e,t,i=!1,s="ui"){var m;if(this.initialised||this.init(),!t)return;const n=e.getColDef(),o=n.field,r=e.getColId(),a=t.data;if(this.hasEditSvc&&s==="ui"){const v=this.editSvc;if(v.isEditing()){const C=v.getCellDataValue({rowNode:t,column:e},!0);if(C!==void 0)return C}}let l;const c=n.showRowGroup;if(typeof c=="string"&&(((m=this.beans.rowGroupColsSvc)==null?void 0:m.getColumnIndex(c))??-1)>t.level)return null;const d=typeof c!="string"||!t.group,h=t.groupData&&r in t.groupData,u=!i&&t.aggData&&t.aggData[r]!==void 0,f=this.isSsrm&&i&&!!n.aggFunc,p=this.isSsrm&&t.footer&&t.field&&(n.showRowGroup===!0||n.showRowGroup===t.field);if(this.isTreeData&&u)l=t.aggData[r];else if(this.isTreeData&&n.valueGetter)l=this.executeValueGetter(n.valueGetter,a,e,t);else if(this.isTreeData&&o&&a)l=qu(a,o,e.isFieldContainsDots());else if(h)l=t.groupData[r];else if(u)l=t.aggData[r];else if(n.valueGetter&&!f){if(!d)return l;l=this.executeValueGetter(n.valueGetter,a,e,t)}else if(p)l=qu(a,t.field,e.isFieldContainsDots());else if(o&&a&&!f){if(!d)return l;l=qu(a,o,e.isFieldContainsDots())}if(this.cellExpressions&&typeof l=="string"&&l.indexOf("=")===0){const v=l.substring(1);l=this.executeValueGetter(v,a,e,t)}return l}parseValue(e,t,i,s){var r;const n=e.getColDef(),o=n.valueParser;if(ae(o)){const a=Fe(this.gos,{node:t,data:t==null?void 0:t.data,oldValue:s,newValue:i,colDef:n,column:e});return typeof o=="function"?o(a):(r=this.expressionSvc)==null?void 0:r.evaluate(o,a)}return i}getDeleteValue(e,t){return ae(e.getColDef().valueParser)?this.parseValue(e,t,"",this.getValueForDisplay(e,t).value)??null:null}formatValue(e,t,i,s,n=!0){const{expressionSvc:o}=this.beans;let r=null,a;const l=e.getColDef();if(s?a=s:n&&(a=l.valueFormatter),a){const c=t?t.data:null,d=Fe(this.gos,{value:i,node:t,data:c,colDef:l,column:e});typeof a=="function"?r=a(d):r=o?o.evaluate(a,d):null}else if(l.refData)return l.refData[i]||"";return r==null&&Array.isArray(i)&&(r=i.join(", ")),r}setValue(e,t,i,s){var d,h;const n=this.colModel.getColDefCol(t);if(!e||!n)return!1;At(e.data)&&(e.data={});const{field:o,valueSetter:r}=n.getColDef();if(At(o)&&At(r))return j(17),!1;if(this.dataTypeSvc&&!this.dataTypeSvc.checkType(n,i))return j(135),!1;const a=Fe(this.gos,{node:e,data:e.data,oldValue:this.getValue(n,e,void 0,s),newValue:i,colDef:n.getColDef(),column:n});a.newValue=i;let l;if(ae(r)?typeof r=="function"?l=r(a):l=(d=this.expressionSvc)==null?void 0:d.evaluate(r,a):l=this.setValueUsingField(e.data,o,i,n.isFieldContainsDots()),l===void 0&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),(h=this.valueCache)==null||h.onDataChanged();const c=this.getValue(n,e);return this.dispatchCellValueChangedEvent(e,a,c,s),e.pinnedSibling&&this.dispatchCellValueChangedEvent(e.pinnedSibling,a,c,s),!0}dispatchCellValueChangedEvent(e,t,i,s){this.eventSvc.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:t.column,colDef:t.colDef,data:e.data,node:e,oldValue:t.oldValue,newValue:i,value:i,source:s})}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;typeof t=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})})}setValueUsingField(e,t,i,s){if(!t)return!1;let n=!1;if(!s)n=e[t]===i,n||(e[t]=i);else{const o=t.split(".");let r=e;for(;o.length>0&&r;){const a=o.shift();o.length===0?(n=r[a]===i,n||(r[a]=i)):r=r[a]}}return!n}executeValueGetterWithValueCache(e,t,i,s){const n=i.getColId(),o=this.valueCache.getValue(s,n);if(o!==void 0)return o;const r=this.executeValueGetterWithoutValueCache(e,t,i,s);return this.valueCache.setValue(s,n,r),r}executeValueGetterWithoutValueCache(e,t,i,s){var r;const n=Fe(this.gos,{data:t,node:s,column:i,colDef:i.getColDef(),getValue:this.getValueCallback.bind(this,s)});let o;return typeof e=="function"?o=e(n):o=(r=this.expressionSvc)==null?void 0:r.evaluate(e,n),o}getValueCallback(e,t){const i=this.colModel.getColDefCol(t);return i?this.getValue(i,e):null}getKeyForNode(e,t){const i=this.getValue(e,t),s=e.getColDef().keyCreator;let n=i;if(s){const o=Fe(this.gos,{value:i,colDef:e.getColDef(),column:e,node:t,data:t.data});n=s(o)}return typeof n=="string"||n==null||(n=String(n),n==="[object Object]"&&j(121)),n}},g4={moduleName:"CommunityCore",version:ne,beans:[gU,oW,C3,GG,Y5,D$,aU,NU,LG,M5,D5,Q5,u4,hU,rU,uU,b3,t4,g3,f3,qU],icons:{selectOpen:"small-down",smallDown:"small-down",colorPicker:"color-picker",smallUp:"small-up",checkboxChecked:"small-up",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off",smallLeft:"small-left",smallRight:"small-right"},apiFunctions:{getGridId:rW,destroy:aW,isDestroyed:lW,getGridOption:cW,setGridOption:dW,updateGridOptions:ZT,isModuleRegistered:hW},dependsOn:[d3,l$,p$,xD,$U,I$,UU,q5,d4,KU,T5,L5,N5,XU,v3,h3,c4,O$,B5]},ED={AdvancedFilter:1,AiToolkit:1,AllEnterprise:1,BatchEdit:1,CellSelection:1,Clipboard:1,ColumnMenu:1,ColumnsToolPanel:1,ContextMenu:1,ExcelExport:1,FiltersToolPanel:1,Find:1,GridCharts:1,IntegratedCharts:1,GroupFilter:1,MasterDetail:1,Menu:1,MultiFilter:1,NewFiltersToolPanel:1,Pivot:1,RangeSelection:1,RichSelect:1,RowNumbers:1,RowGrouping:1,RowGroupingPanel:1,ServerSideRowModelApi:1,ServerSideRowModel:1,SetFilter:1,SideBar:1,Sparklines:1,StatusBar:1,TreeData:1,ViewportRowModel:1},KC=["TextFilter","NumberFilter","DateFilter","SetFilter","MultiFilter","GroupFilter","CustomFilter"],f4={EditCore:["TextEditor","NumberEditor","DateEditor","CheckboxEditor","LargeTextEditor","SelectEditor","RichSelect","CustomEditor"],CheckboxCellRenderer:["AllCommunity"],ClientSideRowModelHierarchy:["RowGrouping","Pivot","TreeData"],ColumnFilter:KC,ColumnGroupHeaderComp:["AllCommunity"],ColumnGroup:["AllCommunity"],ColumnHeaderComp:["AllCommunity"],ColumnMove:["AllCommunity"],ColumnResize:["AllCommunity"],CommunityCore:["AllCommunity"],CsrmSsrmSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],RowModelSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],EnterpriseCore:["AllEnterprise"],FilterCore:[...KC,"QuickFilter","ExternalFilter","AdvancedFilter"],GroupCellRenderer:["RowGrouping","Pivot","TreeData","MasterDetail","ServerSideRowModel"],KeyboardNavigation:["AllCommunity"],LoadingCellRenderer:["ServerSideRowModel"],MenuCore:["ColumnMenu","ContextMenu"],MenuItem:["ColumnMenu","ContextMenu","MultiFilter","IntegratedCharts","ColumnsToolPanel"],Overlay:["AllCommunity"],PinnedColumn:["AllCommunity"],SharedAggregation:["RowGrouping","Pivot","TreeData","ServerSideRowModel"],SharedDragAndDrop:["AllCommunity"],SharedMasterDetail:["MasterDetail","ServerSideRowModel"],SharedMenu:[...KC,"ColumnMenu","ContextMenu"],SharedPivot:["Pivot","ServerSideRowModel"],SharedRowGrouping:["RowGrouping","ServerSideRowModel"],SharedRowSelection:["RowSelection","ServerSideRowModel"],SkeletonCellRenderer:["ServerSideRowModel"],Sort:["AllCommunity"],SsrmInfiniteSharedApi:["InfiniteRowModel","ServerSideRowModelApi"],SharedTreeData:["TreeData","ServerSideRowModel"]},p4={InfiniteRowModel:"infinite",ClientSideRowModelApi:"clientSide",ClientSideRowModel:"clientSide",ServerSideRowModelApi:"serverSide",ServerSideRowModel:"serverSide",ViewportRowModel:"viewport"};function m4(e,t){const i=[];for(const s of Array.isArray(e)?e:[e]){const n=f4[s];if(n)for(const o of n){const r=p4[o];(!r||r===t)&&i.push(o)}else i.push(s)}return i}var AD=()=>`No AG Grid modules are registered! It is recommended to start with all Community features via the AllCommunityModule:
                    
    import { ModuleRegistry, AllCommunityModule } from 'ag-grid-community';
    
    ModuleRegistry.registerModules([ AllCommunityModule ]);
    `,v4=e=>{const t=e.map(s=>`import { ${Yu(s)} } from '${ED[s]?"ag-grid-enterprise":"ag-grid-community"}';`);return e.some(s=>s==="IntegratedCharts"||s==="Sparklines")&&t.push("import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';"),`import { ModuleRegistry } from 'ag-grid-community'; 
${t.join(` 
`)} 

ModuleRegistry.registerModules([ ${e.map(s=>Yu(s,!0)).join(", ")} ]); 

For more info see: ${Rd}/modules/`};function Yu(e,t=!1){return t&&(e==="IntegratedCharts"||e==="Sparklines")?`${e}Module.with(AgChartsEnterpriseModule)`:`${e}Module`}function C4(e,t){const i=t.filter(o=>o==="IntegratedCharts"||o==="Sparklines");let s="";return!(globalThis==null?void 0:globalThis.agCharts)&&i.length>0?s=`Unable to use ${e} as either the ag-charts-community or ag-charts-enterprise script needs to be included alongside ag-grid-enterprise.
`:t.some(o=>ED[o])&&(s=s+`Unable to use ${e} as that requires the ag-grid-enterprise script to be included.
`),s}function FD({moduleName:e,rowModelType:t}){return`To use the ${e}Module you must set the gridOption "rowModelType='${t}'"`}var ax=({reasonOrId:e,moduleName:t,gridScoped:i,gridId:s,rowModelType:n,additionalText:o,isUmd:r})=>{const a=m4(t,n),l=typeof e=="string"?e:S4[e];if(r)return C4(l,a);const c=a.filter(u=>u==="IntegratedCharts"||u==="Sparklines"),d=c.length>0?`${c.map(u=>Yu(u)).join()} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.`:"";return`${`Unable to use ${l} as ${a.length>1?"one of "+a.map(u=>Yu(u)).join(", "):Yu(a[0])} is not registered${i?" for gridId: "+s:""}. ${d} Check if you have registered the module:
`}
${v4(a)}`+(o?` 

${o}`:"")},lx=e=>`${e} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.

import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';
import { ModuleRegistry } from 'ag-grid-community';
import { ${e} } from 'ag-grid-enterprise';
    
ModuleRegistry.registerModules([${e}.with(AgChartsEnterpriseModule)]);
    `,w4=e=>`AG Grid: Unable to use the Clipboard API (navigator.clipboard.${e}()). The reason why it could not be used has been logged in the previous line. For this reason the grid has defaulted to using a workaround which doesn't perform as well. Either fix why Clipboard API is blocked, OR stop this message from appearing by setting grid property suppressClipboardApi=true (which will default the grid to using the workaround rather than the API.`,b4={1:()=>"`rowData` must be an array",2:({nodeId:e})=>`Duplicate node id '${e}' detected from getRowId callback, this could cause issues in your grid.`,3:()=>"Calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.",4:({id:e})=>`Could not find row id=${e}, data item was not found for this id`,5:({data:e})=>["Could not find data item as object was not found.",e," Consider using getRowId to help the Grid find matching row data"],6:()=>"'groupHideOpenParents' only works when specifying specific columns for 'colDef.showRowGroup'",7:()=>"Pivoting is not supported with aligned grids as it may produce different columns in each grid.",8:({key:e})=>`Unknown key for navigation ${e}`,9:({variable:e})=>`No value for ${e==null?void 0:e.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${e==null?void 0:e.defaultValue} will be used and updated when styles load.`,10:({eventType:e})=>`As of v33, the '${e}' event is deprecated. Use the global 'modelUpdated' event to determine when row children have changed.`,11:()=>"No gridOptions provided to createGrid",12:({colKey:e})=>["column ",e," not found"],13:()=>"Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid.",14:({groupPrefix:e})=>`Row IDs cannot start with ${e}, this is a reserved prefix for AG Grid's row grouping feature.`,15:({expression:e})=>["value should be either a string or a function",e],16:({expression:e,params:t,e:i})=>["Processing of the expression failed","Expression = ",e,"Params = ",t,"Exception = ",i],17:()=>"you need either field or valueSetter set on colDef for editing to work",18:()=>"alignedGrids contains an undefined option.",19:()=>"alignedGrids - No api found on the linked grid.",20:()=>`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`,21:()=>"pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.",22:({key:e})=>`${e} is an initial property and cannot be updated.`,23:()=>"The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.",24:()=>"row height must be a number if not using standard row model",25:({id:e})=>["The getRowId callback must return a string. The ID ",e," is being cast to a string."],26:({fnName:e,preDestroyLink:t})=>`Grid API function ${e}() cannot be called as the grid has been destroyed.
 Either clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
 To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${t}`,27:({fnName:e,module:t})=>`API function '${e}' not registered to module '${t}'`,28:()=>"setRowCount cannot be used while using row grouping.",29:()=>"tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?",30:({toIndex:e})=>["tried to insert columns in invalid location, toIndex = ",e,"remember that you should not count the moving columns when calculating the new index"],31:()=>"infinite loop in resizeColumnSets",32:()=>"applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state.",33:()=>"stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON.",34:({key:e})=>`the column type '${e}' is a default column type and cannot be overridden.`,35:()=>"Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type.",36:({t:e})=>"colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes",37:()=>"Changing the column pinning status is not allowed with domLayout='print'",38:({iconName:e})=>`provided icon '${e}' needs to be a string or a function`,39:()=>"Applying column order broke a group where columns should be married together. Applying new order has been discarded.",40:({e,method:t})=>`${e}
${w4(t)}`,41:()=>"Browser did not allow document.execCommand('copy'). Ensure 'api.copySelectedRowsToClipboard() is invoked via a user event, i.e. button click, otherwise the browser will prevent it for security reasons.",42:()=>"Browser does not support document.execCommand('copy') for clipboard operations",43:({iconName:e})=>`As of v33, icon '${e}' is deprecated. Use the icon CSS name instead.`,44:()=>'Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.',45:({parentCellDataType:e})=>`The data type definition ${e} does not exist.`,46:()=>'The "baseDataType" property of a data type definition must match that of its parent.',47:({cellDataType:e})=>`Missing data type definition - "${e}"`,48:({property:e})=>`Cell data type is "object" but no Value ${e} has been provided. Please either provide an object data type definition with a Value ${e}, or set "colDef.value${e}"`,49:({methodName:e})=>`Framework component is missing the method ${e}()`,50:({compName:e})=>`Could not find component ${e}, did you forget to configure this component?`,51:()=>"Export cancelled. Export is not allowed as per your configuration.",52:()=>"There is no `window` associated with the current `document`",53:()=>"unknown value type during csv conversion",54:()=>"Could not find document body, it is needed for drag and drop and context menu.",55:()=>"addRowDropZone - A container target needs to be provided",56:()=>"addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.",57:()=>"unable to show popup filter, filter instantiation failed",58:()=>"no values found for select cellEditor",59:()=>"cannot select pinned rows",60:()=>"cannot select node until it has finished loading",61:()=>"since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option.",62:({colId:e})=>`setFilterModel() - no column found for colId: ${e}`,63:({colId:e})=>`setFilterModel() - unable to fully apply model, filtering disabled for colId: ${e}`,64:({colId:e})=>`setFilterModel() - unable to fully apply model, unable to create filter for colId: ${e}`,65:()=>"filter missing setModel method, which is needed for setFilterModel",66:()=>"filter API missing getModel method, which is needed for getFilterModel",67:()=>"Filter is missing isFilterActive() method",68:()=>"Column Filter API methods have been disabled as Advanced Filters are enabled.",69:({guiFromFilter:e})=>`getGui method from filter returned ${e}; it should be a DOM element.`,70:({newFilter:e})=>`Grid option quickFilterText only supports string inputs, received: ${typeof e}`,71:()=>"debounceMs is ignored when apply button is present",72:({keys:e})=>["ignoring FilterOptionDef as it doesn't contain one of ",e],73:()=>"invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'",74:()=>"no filter options for filter",75:()=>"Unknown button type specified",76:({filterModelType:e})=>['Unexpected type of filter "',e,'", it looks like the filter was configured with incorrect Filter Options'],77:()=>"Filter model is missing 'conditions'",78:()=>'Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.',79:()=>'"filterParams.maxNumConditions" must be greater than or equal to zero.',80:()=>'"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.',81:()=>'"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".',82:({param:e})=>`DateFilter ${e} is not a number`,83:()=>"DateFilter minValidYear should be <= maxValidYear",84:()=>"DateFilter minValidDate should be <= maxValidDate",85:()=>"DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored.",86:()=>"DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored.",87:()=>"DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.",88:({index:e})=>`Invalid row index for ensureIndexVisible: ${e}`,89:()=>"A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)",90:()=>"datasource is missing getRows method",91:()=>"Filter is missing method doesFilterPass",92:()=>"AnimationFrameService called but animation frames are off",93:()=>"cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`",94:({paginationPageSizeOption:e,pageSizeSet:t,pageSizesSet:i,pageSizeOptions:s})=>`'paginationPageSize=${e}'${t?"":" (default value)"}, but ${e} is not included in${i?"":" the default"} paginationPageSizeSelector=[${s==null?void 0:s.join(", ")}].`,95:({paginationPageSizeOption:e,paginationPageSizeSelector:t})=>`Either set '${t}' to an array that includes ${e} or to 'false' to disable the page size selector.`,96:({id:e,data:t})=>["Duplicate ID",e,"found for pinned row with data",t,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter."],97:({colId:e})=>`cellEditor for column ${e} is missing getGui() method`,98:()=>"popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.",99:()=>"Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead.",101:({propertyName:e,componentName:t,agGridDefaults:i,jsComps:s})=>{const n=[],o=[...Object.keys(i??[]).filter(a=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(a)),...Object.keys(s??[]).filter(a=>!!s[a])],r=Jb({inputValue:t,allSuggestions:o,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return n.push(`Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.
`),r.length>0&&n.push(`         Did you mean: [${r.slice(0,3)}]?
`),n.push("If using a custom component check it has been registered correctly."),n},102:()=>"selectAll: 'filtered' only works when gridOptions.rowModelType='clientSide'",103:()=>"Invalid selection state. When using client-side row model, the state must conform to `string[]`.",104:({value:e,param:t})=>`Numeric value ${e} passed to ${t} param will be interpreted as ${e} seconds. If this is intentional use "${e}s" to silence this warning.`,105:({e})=>["chart rendering failed",e],106:()=>`Theming API and Legacy Themes are both used in the same page. A Theming API theme has been provided to the 'theme' grid option, but the file (ag-grid.css) is also included and will cause styling issues. Remove ag-grid.css from the page. See the migration guide: ${Rd}/theming-migration/`,107:({key:e,value:t})=>`Invalid value for theme param ${e} - ${t}`,108:({e})=>["chart update failed",e],109:({inputValue:e,allSuggestions:t})=>{const i=Jb({inputValue:e,allSuggestions:t,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return[`Could not find '${e}' aggregate function. It was configured as "aggFunc: '${e}'" but it wasn't found in the list of registered aggregations.`,i.length>0?`         Did you mean: [${i.slice(0,3)}]?`:"","If using a custom aggregation function check it has been registered correctly."].join(`
`)},110:()=>"groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup",111:()=>"Invalid selection state. When `groupSelects` is enabled, the state must conform to `IServerSideGroupSelectionState`.",113:()=>"Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values",114:({component:e})=>`Could not find component with name of ${e}. Is it in Vue.components?`,116:()=>"Invalid selection state. The state must conform to `IServerSideSelectionState`.",117:()=>"selectAll must be of boolean type.",118:()=>"Infinite scrolling must be enabled in order to set the row count.",119:()=>"Unable to instantiate filter",120:()=>"MultiFloatingFilterComp expects MultiFilter as its parent",121:()=>"a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (see AG Grid docs) or b) to toString() on the object to return a key",122:()=>"could not find the document, document is empty",123:()=>"Advanced Filter is only supported with the Client-Side Row Model or Server-Side Row Model.",124:()=>"No active charts to update.",125:({chartId:e})=>`Unable to update chart. No active chart found with ID: ${e}.`,126:()=>"unable to restore chart as no chart model is provided",127:({allRange:e})=>`unable to create chart as ${e?"there are no columns in the grid":"no range is selected"}.`,128:({feature:e})=>`${e} is only available if using 'multiRow' selection mode.`,129:({feature:e,rowModel:t})=>`${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`,130:()=>'cannot multi select unless selection mode is "multiRow"',132:()=>"Row selection features are not available unless `rowSelection` is enabled.",133:({iconName:e})=>`icon '${e}' function should return back a string or a dom object`,134:({iconName:e})=>`Did not find icon '${e}'`,135:()=>"Data type of the new value does not match the cell data type of the column",136:()=>"Unable to update chart as the 'type' is missing. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'.",137:({type:e,currentChartType:t})=>`Unable to update chart as a '${e}' update type is not permitted on a ${t}.`,138:({chartType:e})=>`invalid chart type supplied: ${e}`,139:({customThemeName:e})=>`a custom chart theme with the name ${e} has been supplied but not added to the 'chartThemes' list`,140:({name:e})=>`no stock theme exists with the name '${e}' and no custom chart theme with that name was supplied to 'customChartThemes'`,141:()=>"cross filtering with row grouping is not supported.",142:()=>"cross filtering is only supported in the client side row model.",143:({panel:e})=>`'${e}' is not a valid Chart Tool Panel name`,144:({type:e})=>`Invalid charts data panel group name supplied: '${e}'`,145:({group:e})=>`As of v32, only one charts customize panel group can be expanded at a time. '${e}' will not be expanded.`,146:({comp:e})=>`Unable to instantiate component '${e}' as its module hasn't been loaded. Add 'ValidationModule' to see which module is required.`,147:({group:e})=>`Invalid charts customize panel group name supplied: '${e}'`,148:({group:e})=>`invalid chartGroupsDef config '${e}'`,149:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,150:()=>"'seriesChartTypes' are required when the 'customCombo' chart type is specified.",151:({chartType:e})=>`invalid chartType '${e}' supplied in 'seriesChartTypes', converting to 'line' instead.`,152:({colId:e})=>`no 'seriesChartType' found for colId = '${e}', defaulting to 'line'.`,153:({chartDataType:e})=>`unexpected chartDataType value '${e}' supplied, instead use 'category', 'series' or 'excluded'`,154:({colId:e})=>`cross filtering requires a 'agSetColumnFilter' or 'agMultiColumnFilter' to be defined on the column with id: ${e}`,155:({option:e})=>`'${e}' is not a valid Chart Toolbar Option`,156:({panel:e})=>`Invalid panel in chartToolPanelsDef.panels: '${e}'`,157:({unrecognisedGroupIds:e})=>["unable to find group(s) for supplied groupIds:",e],158:()=>"can not expand a column item that does not represent a column group header",159:()=>"Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty.",160:()=>"Export cancelled. Export is not allowed as per your configuration.",161:()=>"The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'",162:({id:e,dataType:t})=>`Unrecognized data type for excel export [${e}.dataType=${t}]`,163:({featureName:e})=>`Excel table export does not work with ${e}. The exported Excel file will not contain any Excel tables.
 Please turn off ${e} to enable Excel table exports.`,164:()=>"Unable to add data table to Excel sheet: A table already exists.",165:()=>"Unable to add data table to Excel sheet: Missing required parameters.",166:({unrecognisedGroupIds:e})=>["unable to find groups for these supplied groupIds:",e],167:({unrecognisedColIds:e})=>["unable to find columns for these supplied colIds:",e],168:()=>"detailCellRendererParams.template should be function or string",169:()=>'Reference to eDetailGrid was missing from the details template. Please add data-ref="eDetailGrid" to the template.',170:({providedStrategy:e})=>`invalid cellRendererParams.refreshStrategy = ${e} supplied, defaulting to refreshStrategy = 'rows'.`,171:()=>"could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions",172:()=>"could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData",173:({group:e})=>`invalid chartGroupsDef config '${e}'`,174:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,175:({menuTabName:e,itemsToConsider:t})=>[`Trying to render an invalid menu item '${e}'. Check that your 'menuTabs' contains one of `,t],176:({key:e})=>`unknown menu item type ${e}`,177:()=>"valid values for cellSelection.handle.direction are 'x', 'y' and 'xy'. Default to 'xy'.",178:({colId:e})=>`column ${e} is not visible`,179:()=>"totalValueGetter should be either a function or a string (expression)",180:()=>"agRichSelectCellEditor requires cellEditorParams.values to be set",181:()=>"agRichSelectCellEditor cannot have `multiSelect` and `allowTyping` set to `true`. AllowTyping has been turned off.",182:()=>'you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data',183:()=>"Group Column Filter only works on group columns. Please use a different filter.",184:({parentGroupData:e,childNodeData:t})=>["duplicate group keys for row data, keys should be unique",[e,t]],185:({data:e})=>["getDataPath() should not return an empty path",[e]],186:({rowId:e,rowData:t,duplicateRowsData:i})=>["duplicate group keys for row data, keys should be unique",e,t,...i??[]],187:({rowId:e,firstData:t,secondData:i})=>[`Duplicate node id ${e}. Row IDs are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values.`,"first instance",t,"second instance",i],188:e=>`getRowId callback must be provided for Server Side Row Model ${(e==null?void 0:e.feature)||"selection"} to work correctly.`,189:({startRow:e})=>`invalid value ${e} for startRow, the value should be >= 0`,190:({rowGroupId:e,data:t})=>["null and undefined values are not allowed for server side row model keys",e?`column = ${e}`:"","data is ",t],194:({method:e})=>`calling gridApi.${e}() is only possible when using rowModelType=\`clientSide\`.`,195:({justCurrentPage:e})=>`selecting just ${e?"current page":"filtered"} only works when gridOptions.rowModelType='clientSide'`,196:({key:e})=>`Provided ids must be of string type. Invalid id provided: ${e}`,197:()=>"`toggledNodes` must be an array of string ids.",199:()=>"getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model. Use `api.getServerSideSelectionState()` instead.",200:ax,201:({rowModelType:e})=>`Could not find row model for rowModelType = ${e}`,202:()=>"`getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model. Use `api.getServerSideSelectionState()` instead.",203:()=>"Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled.",204:()=>"Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled.",205:({duplicateIdText:e})=>`Unable to display rows as duplicate row ids (${e}) were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids.`,206:()=>"getRowId callback must be implemented for transactions to work. Transaction was ignored.",207:()=>'The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.',208:()=>"Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects.",209:()=>`Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects. See ${Rd}/filter-set-filter-list/#filter-value-types`,210:()=>"Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects?",211:()=>"property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date.",212:()=>"please review all your toolPanel components, it seems like at least one of them doesn't have an id",213:()=>"Advanced Filter does not work with Filters Tool Panel. Filters Tool Panel has been disabled.",214:({key:e})=>`unable to lookup Tool Panel as invalid key supplied: ${e}`,215:({key:e,defaultByKey:t})=>`the key ${e} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys(t??{}).join(",")}`,216:({name:e})=>`Missing component for '${e}'`,217:({invalidColIds:e})=>["unable to find grid columns for the supplied colDef(s):",e],218:({property:e,defaultOffset:t})=>`${e} must be a number, the value you provided is not a valid number. Using the default of ${t}px.`,219:({property:e})=>`Property ${e} does not exist on the target object.`,220:({lineDash:e})=>`'${e}' is not a valid 'lineDash' option.`,221:()=>"agAggregationComponent should only be used with the client and server side row model.",222:()=>"agFilteredRowCountComponent should only be used with the client side row model.",223:()=>"agSelectedRowCountComponent should only be used with the client and server side row model.",224:()=>"agTotalAndFilteredRowCountComponent should only be used with the client side row model.",225:()=>"agTotalRowCountComponent should only be used with the client side row model.",226:()=>"viewport is missing init method.",227:()=>"menu item icon must be DOM node or string",228:({menuItemOrString:e})=>`unrecognised menu item ${e}`,229:({index:e})=>["invalid row index for ensureIndexVisible: ",e],230:()=>"detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://www.ag-grid.com/react-data-grid/master-detail-custom-detail/",231:()=>"As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.",232:()=>"Using both rowData and v-model. rowData will be ignored.",233:({methodName:e})=>`Framework component is missing the method ${e}()`,234:()=>'Group Column Filter does not work with the colDef property "field". This property will be ignored.',235:()=>'Group Column Filter does not work with the colDef property "filterValueGetter". This property will be ignored.',236:()=>'Group Column Filter does not work with the colDef property "filterParams". This property will be ignored.',237:()=>"Group Column Filter does not work with Tree Data enabled. Please disable Tree Data, or use a different filter.",238:()=>"setRowCount can only accept a positive row count.",239:()=>'Theming API and CSS File Themes are both used in the same page. In v33 we released the Theming API as the new default method of styling the grid. See the migration docs https://www.ag-grid.com/react-data-grid/theming-migration/. Because no value was provided to the `theme` grid option it defaulted to themeQuartz. But the file (ag-grid.css) is also included and will cause styling issues. Either pass the string "legacy" to the theme grid option to use v32 style themes, or remove ag-grid.css from the page to use Theming API.',240:({theme:e})=>`theme grid option must be a Theming API theme object or the string "legacy", received: ${e}`,243:()=>"Failed to deserialize state - each provided state object must be an object.",244:()=>"Failed to deserialize state - `selectAllChildren` must be a boolean value or undefined.",245:()=>"Failed to deserialize state - `toggledNodes` must be an array.",246:()=>"Failed to deserialize state - Every `toggledNode` requires an associated string id.",247:()=>`Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule. 
Please rebuild the selection state and reapply it.`,248:()=>"SetFloatingFilter expects SetFilter as its parent",249:()=>"Must supply a Value Formatter in Set Filter params when using a Key Creator",250:()=>"Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.",251:({chartType:e})=>`AG Grid: Unable to create chart as an invalid chartType = '${e}' was supplied.`,252:()=>`cannot get grid to draw rows when it is in the middle of drawing rows. 
Your code probably called a grid API method while the grid was in the render stage. 
To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). 
To see what part of your code that caused the refresh check this stacktrace.`,253:({version:e})=>["Illegal version string: ",e],254:()=>"Cannot create chart: no chart themes available.",255:({point:e})=>`Lone surrogate U+${e==null?void 0:e.toString(16).toUpperCase()} is not a scalar value`,256:()=>"Unable to initialise. See validation error, or load ValidationModule if missing.",257:()=>lx("IntegratedChartsModule"),258:()=>lx("SparklinesModule"),259:({part:e})=>`the argument to theme.withPart must be a Theming API part object, received: ${e}`,260:({propName:e,compName:t,gridScoped:i,gridId:s,rowModelType:n})=>ax({reasonOrId:`AG Grid '${e}' component: ${t}`,moduleName:Td[t],gridId:s,gridScoped:i,rowModelType:n}),261:()=>"As of v33, `column.isHovered()` is deprecated. Use `api.isColumnHovered(column)` instead.",262:()=>'As of v33, icon key "smallDown" is deprecated. Use "advancedFilterBuilderSelect" for Advanced Filter Builder dropdown, "selectOpen" for Select cell editor and dropdowns (e.g. Integrated Charts menu), "richSelectOpen" for Rich Select cell editor.',263:()=>'As of v33, icon key "smallLeft" is deprecated. Use "panelDelimiterRtl" for Row Group Panel / Pivot Panel, "subMenuOpenRtl" for sub-menus.',264:()=>'As of v33, icon key "smallRight" is deprecated. Use "panelDelimiter" for Row Group Panel / Pivot Panel, "subMenuOpen" for sub-menus.',265:({colId:e})=>`Unable to infer chart data type for column '${e}' if first data entry is null. Please specify "chartDataType", or a "cellDataType" in the column definition. For more information, see ${Rd}/integrated-charts-range-chart#coldefchartdatatype .`,266:()=>'As of v33.1, using "keyCreator" with the Rich Select Editor has been deprecated. It now requires the "formatValue" callback to convert complex data to strings.',267:()=>"Detail grids can not use a different theme to the master grid, the `theme` detail grid option will be ignored.",268:()=>"Transactions aren't supported with tree data when using treeDataChildrenField",269:()=>"When `masterSelects: 'detail'`, detail grids must be configured with multi-row selection",270:({id:e,parentId:t})=>`Cycle detected for row with id='${e}' and parent id='${t}'. Resetting the parent for row with id='${e}' and showing it as a root-level node.`,271:({id:e,parentId:t})=>`Parent row not found for row with id='${e}' and parent id='${t}'. Showing row with id='${e}' as a root-level node.`,272:()=>AD(),273:({providedId:e,usedId:t})=>`Provided column id '${e}' was already in use, ensure all column and group ids are unique. Using '${t}' instead.`,274:({prop:e})=>{let t=`Since v33, ${e} has been deprecated.`;switch(e){case"maxComponentCreationTimeMs":t+=" This property is no longer required and so will be removed in a future version.";break;case"setGridApi":t+=" This method is not called by AG Grid. To access the GridApi see: https://ag-grid.com/react-data-grid/grid-interface/#grid-api ";break;case"children":t+=" For multiple versions AgGridReact does not support children.";break}return t},275:FD,276:()=>"Row Numbers Row Resizer cannot be used when Grid Columns have `autoHeight` enabled.",277:({colId:e})=>`'enableFilterHandlers' is set to true, but column '${e}' does not have 'filter.doesFilterPass' or 'filter.handler' set.`,278:({colId:e})=>`Unable to create filter handler for column '${e}'`,279:e=>{},280:({colId:e})=>`'name' must be provided for custom filter components for column '${e}`,281:({colId:e})=>`Filter for column '${e}' does not have 'filterParams.buttons', but the new Filters Tool Panel has buttons configured. Either configure buttons for the filter, or disable buttons on the Filters Tool Panel.`,282:()=>"New filter tool panel requires `enableFilterHandlers: true`.",283:()=>"As of v34, use the same method on the filter handler (`api.getColumnFilterHandler(colKey)`) instead.",284:()=>"As of v34, filters are active when they have a model. Use `api.getColumnFilterModel()` instead.",285:()=>"As of v34, use (`api.getColumnFilterModel()`) instead.",286:()=>"As of v34, use (`api.setColumnFilterModel()`) instead.",287:()=>"`api.doFilterAction()` requires `enableFilterHandlers = true",288:()=>"`api.getColumnFilterModel(key, true)` requires `enableFilterHandlers = true",289:({rowModelType:e})=>`Row Model '${e}' is not supported with Batch Editing`,290:({rowIndex:e,rowPinned:t})=>`Row with index '${e}' and pinned state '${t}' not found`,291:()=>"License Key being set multiple times with different values. This can result in an incorrect license key being used,",292:({colId:e})=>`The Multi Filter for column '${e}' has buttons configured against the child filters. When 'enableFilterHandlers=true', buttons must instead be provided against the parent Multi Filter params. The child filter buttons will be ignored.`};function y4(e,t){const i=b4[e];if(!i)return[`Missing error text for error id ${e}!`];const s=i(t),o=`
See ${_P(e,t)}`;return Array.isArray(s)?s.concat(o):[s,o]}var S4={1:"Charting Aggregation",2:"pivotResultFields",3:"setTooltip"},cx=new WeakMap,dx=new WeakMap;function R4(e,t,i){if(!t)return ut(11),{};let s;{const o=jt({tag:"div"});o.style.height="100%",e.appendChild(o),e=o,s=()=>e.remove()}return new E4().create(e,t,o=>{const r=new sW(e);o.createBean(r)},void 0,i,s)}var x4=1,E4=class{create(e,t,i,s,n,o){const r=uS.applyGlobalGridOptions(t),a=r.gridId??String(x4++),l=this.getRegisteredModules(n,a,r.rowModelType),c=this.createBeansList(r.rowModelType,l,a),d=this.createProvidedBeans(e,r,n);if(!c)return;const u={providedBeanInstances:d,beanClasses:c,id:a,beanInitComparator:Bz,beanDestroyComparator:Vz,derivedBeans:[Hz],destroyCallback:()=>{dx.delete(p),cx.delete(e),VH(a),o==null||o()}},f=new vB(u);this.registerModuleFeatures(f,l),i(f),f.getBean("syncSvc").start(),s==null||s(f);const p=f.getBean("gridApi");return cx.set(e,p),dx.set(p,e),p}getRegisteredModules(e,t,i){var s;return hg(g4,void 0,!0),(s=e==null?void 0:e.modules)==null||s.forEach(n=>hg(n,t)),zH(t,hx(i))}registerModuleFeatures(e,t){const i=e.getBean("registry"),s=e.getBean("apiFunctionSvc");for(const n of t){i.registerModule(n);const o=n.apiFunctions;if(o){const r=Object.keys(o);for(const a of r)s==null||s.addFunction(a,o[a])}}}createProvidedBeans(e,t,i){let s=i?i.frameworkOverrides:null;At(s)&&(s=new Nz);const n={gridOptions:t,eGridDiv:e,eRootDiv:e,globalListener:i?i.globalListener:null,globalSyncListener:i?i.globalSyncListener:null,frameworkOverrides:s};return i!=null&&i.providedBeanInstances&&Object.assign(n,i.providedBeanInstances),n}createBeansList(e,t,i){const s={clientSide:"ClientSideRowModel",infinite:"InfiniteRowModel",serverSide:"ServerSideRowModel",viewport:"ViewportRowModel"},n=hx(e),o=s[n];if(!o){Iu(201,{rowModelType:n},`Unknown rowModelType ${n}.`);return}if(!$H()){Iu(272,void 0,AD());return}if(!e){const a=Object.entries(s).filter(([l,c])=>zb(c,i,l));if(a.length==1){const[l,c]=a[0];if(l!==n){const d={moduleName:c,rowModelType:l};Iu(275,d,FD(d));return}}}if(!zb(o,i,n)){Iu(200,{reasonOrId:`rowModelType = '${n}'`,moduleName:o,gridScoped:gS(),gridId:i,rowModelType:n},`Missing module ${o}Module for rowModelType ${n}.`);return}const r=new Set;for(const a of t)for(const l of a.beans??[])r.add(l);return Array.from(r)}};function hx(e){return e??"clientSide"}function Qa(e){const t=e.rowModel;return t.getType()==="clientSide"?t:void 0}function jv(e){const t=e.rowModel;return t.getType()==="infinite"?t:void 0}function A4(e){const t=e.rowModel;return t.getType()==="serverSide"?t:void 0}var F4=class extends V{constructor(){super(...arguments),this.beanName="localeSvc"}getLocaleTextFunc(){const e=this.gos,t=e.getCallback("getLocaleText");return t?PH(t):TH(e.get("localeText"))}};function P4(e,t=!1){const i=[],s=[],n=[],o=[],r=[],a=[],l=[],c=[],d=[];let h=0;for(let u=0;u<e.length;u++){const{colId:f,sort:p,sortIndex:m,rowGroup:v,rowGroupIndex:C,aggFunc:w,pivot:S,pivotIndex:b,pinned:E,hide:A,width:P,flex:T}=e[u];d.push(f),p&&(i[m??h++]={colId:f,sort:p}),v&&(s[C??0]=f),typeof w=="string"&&n.push({colId:f,aggFunc:w}),S&&(o[b??0]=f),E&&(E==="right"?a:r).push(f),A&&l.push(f),(T!=null||P)&&c.push({colId:f,flex:T??void 0,width:P})}return{sort:i.length?{sortModel:qC(i)}:void 0,rowGroup:s.length?{groupColIds:qC(s)}:void 0,aggregation:n.length?{aggregationModel:n}:void 0,pivot:o.length||t?{pivotMode:t,pivotColIds:qC(o)}:void 0,columnPinning:r.length||a.length?{leftColIds:r,rightColIds:a}:void 0,columnVisibility:l.length?{hiddenColIds:l}:void 0,columnSizing:c.length?{columnSizingModel:c}:void 0,columnOrder:d.length?{orderedColIds:d}:void 0}}function qC(e){return e.filter(t=>t!=null)}function T4(e){const t=[];for(const{groupId:i,open:s}of e)s&&t.push(i);return t.length?{openColumnGroupIds:t}:void 0}function YC(e){return e.get("tooltipShowMode")==="whenTruncated"}function D4(e,t){if(typeof e!="number")return"";const i=t(),s=i("thousandSeparator",","),n=i("decimalSeparator",".");return e.toString().replace(".",n).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${s}`)}var M4=class extends V{getFileName(e){const t=this.getDefaultFileExtension();return e!=null&&e.length||(e=this.getDefaultFileName()),e.includes(".")?e:`${e}.${t}`}getData(e){const t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},I4=class{constructor(e){const{colModel:t,rowGroupColsSvc:i,colNames:s,valueSvc:n,gos:o,processCellCallback:r,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c}=e;this.colModel=t,this.rowGroupColsSvc=i,this.colNames=s,this.valueSvc=n,this.gos=o,this.processCellCallback=r,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=c}prepare(e){}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e,t,i,s,n){var u;const o=t===0&&VP(this.gos,n,this.colModel.isPivotMode());if(this.processRowGroupCallback&&(this.gos.get("treeData")||n.group)&&(e.isRowGroupDisplayed(((u=n.rowGroupColumn)==null?void 0:u.getColId())??"")||o))return{value:this.processRowGroupCallback(Fe(this.gos,{column:e,node:n}))??""};if(this.processCellCallback)return{value:this.processCellCallback(Fe(this.gos,{accumulatedRowIndex:i,column:e,node:n,value:this.valueSvc.getValueForDisplay(e,n,void 0,void 0).value,type:s,parseValue:f=>this.valueSvc.parseValue(e,n,f,this.valueSvc.getValue(e,n,void 0)),formatValue:f=>this.valueSvc.formatValue(e,n,f)??f}))??""};const r=this.gos.get("treeData"),a=this.valueSvc,l=n.level===-1&&n.footer,c=e.colDef.showRowGroup===!0&&(n.group||r);if(!l&&(o||c)){let f="",p=n;for(;p&&p.level!==-1;){const{value:m,valueFormatted:v}=a.getValueForDisplay(o?void 0:e,p,!0,!0);f=` -> ${v??m??""}${f}`,p=p.parent}return{value:f,valueFormatted:f}}const{value:d,valueFormatted:h}=a.getValueForDisplay(e,n,!0,!0);return{value:d??"",valueFormatted:h}}getHeaderName(e,t){return e?e(Fe(this.gos,{column:t})):this.colNames.getDisplayNameForColumn(t,"csv",!0)}};function k4(e,t){const i=document.defaultView||window;if(!i){j(52);return}const s=document.createElement("a"),n=i.URL.createObjectURL(t);s.setAttribute("href",n),s.setAttribute("download",e),s.style.display="none",document.body.appendChild(s),s.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:i})),s.remove(),i.setTimeout(()=>{i.URL.revokeObjectURL(n)},0)}var _4={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,groupLockGroupColumns:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,renderingMode:!0,columnMenu:!0,suppressSetFilterByDefault:!0,getDataPath:!0,enableCellSpan:!0,enableFilterHandlers:!0,filterHandlers:!0},os="clientSide",_i="serverSide",Jc="infinite",L4={onGroupExpandedOrCollapsed:[os],refreshClientSideRowModel:[os],isRowDataEmpty:[os],forEachLeafNode:[os],forEachNodeAfterFilter:[os],forEachNodeAfterFilterAndSort:[os],resetRowHeights:[os,_i],applyTransaction:[os],applyTransactionAsync:[os],flushAsyncTransactions:[os],getBestCostNodeSelection:[os],getServerSideSelectionState:[_i],setServerSideSelectionState:[_i],applyServerSideTransaction:[_i],applyServerSideTransactionAsync:[_i],applyServerSideRowData:[_i],retryServerSideLoads:[_i],flushServerSideAsyncTransactions:[_i],refreshServerSide:[_i],getServerSideGroupLevelState:[_i],refreshInfiniteCache:[Jc],purgeInfiniteCache:[Jc],getInfiniteRowCount:[Jc],isLastRowIndexKnown:[Jc,_i],expandAll:[os,_i],collapseAll:[os,_i],onRowHeightChanged:[os,_i],setRowCount:[Jc,_i],getCacheBlockState:[Jc,_i]},O4={showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"},selectAllFiltered:{version:"v33",old:"selectAllFiltered()",new:'selectAll("filtered")'},deselectAllFiltered:{version:"v33",old:"deselectAllFiltered()",new:'deselectAll("filtered")'},selectAllOnCurrentPage:{version:"v33",old:"selectAllOnCurrentPage()",new:'selectAll("currentPage")'},deselectAllOnCurrentPage:{version:"v33",old:"deselectAllOnCurrentPage()",new:'deselectAll("currentPage")'}};function N4(e,t,i){const s=O4[e];if(s){const{version:o,new:r,old:a,message:l}=s,c=a??e;return(...d)=>{const h=r?`Please use ${r} instead. `:"";return Uu(`Since ${o} api.${c} is deprecated. ${h}${l??""}`),t.apply(t,d)}}const n=L4[e];return n?(...o)=>{const r=i.rowModel.getType();if(!n.includes(r)){yd(`api.${e} can only be called when gridOptions.rowModelType is ${n.join(" or ")}`);return}return t.apply(t,o)}:t}var H4={detailCellRendererCtrl:"SharedMasterDetail",dndSourceComp:"DragAndDrop",fillHandle:"CellSelection",groupCellRendererCtrl:"GroupCellRenderer",headerFilterCellCtrl:"ColumnFilter",headerGroupCellCtrl:"ColumnGroup",rangeHandle:"CellSelection",tooltipFeature:"Tooltip",highlightTooltipFeature:"Tooltip",tooltipStateManager:"Tooltip",groupStrategy:"RowGrouping",treeGroupStrategy:"TreeData",rowNumberRowResizer:"RowNumbers",singleCell:"EditCore",fullRow:"EditCore",agSetColumnFilterHandler:"SetFilter",agMultiColumnFilterHandler:"MultiFilter",agGroupColumnFilterHandler:"GroupFilter",agNumberColumnFilterHandler:"NumberFilter",agDateColumnFilterHandler:"DateFilter",agTextColumnFilterHandler:"TextFilter"},G4={expanded:1,contracted:1,"tree-closed":1,"tree-open":1,"tree-indeterminate":1,pin:1,"eye-slash":1,arrows:1,left:1,right:1,group:1,aggregation:1,pivot:1,"not-allowed":1,chart:1,cross:1,cancel:1,tick:1,first:1,previous:1,next:1,last:1,linked:1,unlinked:1,"color-picker":1,loading:1,menu:1,"menu-alt":1,filter:1,"filter-add":1,columns:1,maximize:1,minimize:1,copy:1,cut:1,paste:1,grip:1,save:1,csv:1,excel:1,"small-down":1,"small-left":1,"small-right":1,"small-up":1,asc:1,desc:1,none:1,up:1,down:1,plus:1,minus:1,settings:1,"checkbox-checked":1,"checkbox-indeterminate":1,"checkbox-unchecked":1,"radio-button-on":1,"radio-button-off":1,eye:1,"column-arrow":1,"un-pin":1,"pinned-top":1,"pinned-bottom":1,"chevron-up":1,"chevron-down":1,"chevron-left":1,"chevron-right":1,edit:1},B4={chart:"MenuCore",cancel:"EnterpriseCore",first:"Pagination",previous:"Pagination",next:"Pagination",last:"Pagination",linked:"IntegratedCharts",loadingMenuItems:"MenuCore",unlinked:"IntegratedCharts",menu:"ColumnHeaderComp",legacyMenu:"ColumnMenu",filter:"ColumnFilter",filterActive:"ColumnFilter",filterAdd:"NewFiltersToolPanel",filterCardCollapse:"NewFiltersToolPanel",filterCardExpand:"NewFiltersToolPanel",filterCardEditing:"NewFiltersToolPanel",filterTab:"ColumnMenu",filtersToolPanel:"FiltersToolPanel",columns:["MenuCore"],columnsToolPanel:["ColumnsToolPanel"],maximize:"EnterpriseCore",minimize:"EnterpriseCore",save:"MenuCore",columnGroupOpened:"ColumnGroupHeaderComp",columnGroupClosed:"ColumnGroupHeaderComp",accordionOpen:"EnterpriseCore",accordionClosed:"EnterpriseCore",accordionIndeterminate:"EnterpriseCore",columnSelectClosed:["ColumnsToolPanel","ColumnMenu"],columnSelectOpen:["ColumnsToolPanel","ColumnMenu"],columnSelectIndeterminate:["ColumnsToolPanel","ColumnMenu"],columnMovePin:"SharedDragAndDrop",columnMoveHide:"SharedDragAndDrop",columnMoveMove:"SharedDragAndDrop",columnMoveLeft:"SharedDragAndDrop",columnMoveRight:"SharedDragAndDrop",columnMoveGroup:"SharedDragAndDrop",columnMoveValue:"SharedDragAndDrop",columnMovePivot:"SharedDragAndDrop",dropNotAllowed:"SharedDragAndDrop",ensureColumnVisible:["ColumnsToolPanel","ColumnMenu"],groupContracted:"GroupCellRenderer",groupExpanded:"GroupCellRenderer",setFilterGroupClosed:"SetFilter",setFilterGroupOpen:"SetFilter",setFilterGroupIndeterminate:"SetFilter",setFilterLoading:"SetFilter",close:"EnterpriseCore",check:"MenuItem",colorPicker:"CommunityCore",groupLoading:"LoadingCellRenderer",menuAlt:"ColumnHeaderComp",menuPin:"MenuCore",menuValue:"MenuCore",menuAddRowGroup:["MenuCore","ColumnsToolPanel"],menuRemoveRowGroup:["MenuCore","ColumnsToolPanel"],clipboardCopy:"MenuCore",clipboardCut:"MenuCore",clipboardPaste:"MenuCore",pivotPanel:["ColumnsToolPanel","RowGroupingPanel"],rowGroupPanel:["ColumnsToolPanel","RowGroupingPanel"],valuePanel:"ColumnsToolPanel",columnDrag:"EnterpriseCore",rowDrag:["RowDrag","DragAndDrop"],csvExport:"MenuCore",excelExport:"MenuCore",smallDown:"CommunityCore",selectOpen:"CommunityCore",richSelectOpen:"RichSelect",richSelectRemove:"RichSelect",smallLeft:"CommunityCore",smallRight:"CommunityCore",subMenuOpen:"MenuItem",subMenuOpenRtl:"MenuItem",panelDelimiter:"RowGroupingPanel",panelDelimiterRtl:"RowGroupingPanel",smallUp:"CommunityCore",sortAscending:["MenuCore","Sort"],sortDescending:["MenuCore","Sort"],sortUnSort:["MenuCore","Sort"],advancedFilterBuilder:"AdvancedFilter",advancedFilterBuilderDrag:"AdvancedFilter",advancedFilterBuilderInvalid:"AdvancedFilter",advancedFilterBuilderMoveUp:"AdvancedFilter",advancedFilterBuilderMoveDown:"AdvancedFilter",advancedFilterBuilderAdd:"AdvancedFilter",advancedFilterBuilderRemove:"AdvancedFilter",advancedFilterBuilderSelectOpen:"AdvancedFilter",chartsMenu:"IntegratedCharts",chartsMenuEdit:"IntegratedCharts",chartsMenuAdvancedSettings:"IntegratedCharts",chartsMenuAdd:"IntegratedCharts",chartsColorPicker:"IntegratedCharts",chartsThemePrevious:"IntegratedCharts",chartsThemeNext:"IntegratedCharts",chartsDownload:"IntegratedCharts",checkboxChecked:"CommunityCore",checkboxIndeterminate:"CommunityCore",checkboxUnchecked:"CommunityCore",radioButtonOn:"CommunityCore",radioButtonOff:"CommunityCore",rowPin:"PinnedRow",rowUnpin:"PinnedRow",rowPinBottom:"PinnedRow",rowPinTop:"PinnedRow"},V4=new Set(["colorPicker","smallUp","checkboxChecked","checkboxIndeterminate","checkboxUnchecked","radioButtonOn","radioButtonOff","smallDown","smallLeft","smallRight"]),z4=class extends V{constructor(){super(...arguments),this.beanName="validation"}wireBeans(e){this.gridOptions=e.gridOptions,KH(y4)}warnOnInitialPropertyUpdate(e,t){e==="api"&&_4[t]&&j(22,{key:t})}processGridOptions(e){this.processOptions(e,_U())}validateApiFunction(e,t){return N4(e,t,this.beans)}missingUserComponent(e,t,i,s){const n=Td[t];n?this.gos.assertModuleRegistered(n,`AG Grid '${e}' component: ${t}`):j(101,{propertyName:e,componentName:t,agGridDefaults:i,jsComps:s})}missingDynamicBean(e){const t=H4[e];return t?So(200,{...this.gos.getModuleErrorParams(),moduleName:t,reasonOrId:e}):void 0}checkRowEvents(e){$4.has(e)&&j(10,{eventType:e})}validateIcon(e){if(V4.has(e)&&j(43,{iconName:e}),G4[e])return;const t=B4[e];if(t){ut(200,{reasonOrId:`icon '${e}'`,moduleName:t,gridScoped:gS(),gridId:this.beans.context.getId(),rowModelType:this.gos.get("rowModelType"),additionalText:"Alternatively, use the CSS icon name directly."});return}j(134,{iconName:e})}isProvidedUserComp(e){return!!Td[e]}validateColDef(e){this.processOptions(e,RU())}processOptions(e,t){const{validations:i,deprecations:s,allProperties:n,propertyExceptions:o,objectName:r,docsUrl:a}=t;n&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(e,[...o??[],...Object.keys(s)],n,r,a);const l=new Set;if(Object.keys(e).forEach(d=>{const h=s[d];if(h){const{message:w,version:S}=h;l.add(`As of v${S}, ${String(d)} is deprecated. ${w??""}`)}const u=e[d];if(u==null||u===!1)return;const f=i[d];if(!f)return;const{dependencies:p,validate:m,supportedRowModels:v,expectedType:C}=f;if(C){const w=typeof u;if(w!==C){l.add(`${String(d)} should be of type '${C}' but received '${w}' (${u}).`);return}}if(v){const w=this.gridOptions.rowModelType??"clientSide";if(!v.includes(w)){l.add(`${String(d)} is not supported with the '${w}' row model. It is only valid with: ${v.join(", ")}.`);return}}if(p){const w=this.checkForRequiredDependencies(d,p,e);if(w){l.add(w);return}}if(m){const w=m(e,this.gridOptions,this.beans);if(w){l.add(w);return}}}),l.size>0)for(const d of l)Uu(d)}checkForRequiredDependencies(e,t,i){const n=Object.entries(t).filter(([o,r])=>{const a=i[o];return!r.required.includes(a)});return n.length===0?null:n.map(([o,r])=>`'${String(e)}' requires '${o}' to be one of [${r.required.map(a=>a===null?"null":a===void 0?"undefined":a).join(", ")}]. ${r.reason??""}`).join(`
           `)}checkProperties(e,t,i,s,n){const o=["__ob__","__v_skip","__metadata__"],r=W4(Object.getOwnPropertyNames(e),[...o,...t,...i],i),a=Object.keys(r);for(const l of a){const c=r[l];let d=`invalid ${s} property '${l}' did you mean any of these: ${c.slice(0,8).join(", ")}.`;i.includes("context")&&(d+=`
If you are trying to annotate ${s} with application data, use the '${s}.context' property instead.`),Uu(d)}if(a.length>0&&n){const l=this.beans.frameworkOverrides.getDocLink(n);Uu(`to see all the valid ${s} properties please check: ${l}`)}}};function W4(e,t,i){const s={},n=e.filter(o=>!t.some(r=>r===o));if(n.length>0)for(const o of n)s[o]=Jb({inputValue:o,allSuggestions:i}).values;return s}var $4=new Set(["firstChildChanged","lastChildChanged","childIndexChanged"]),U4={moduleName:"Validation",version:ne,beans:[z4]};function PD(e){const t=e.sibling;t&&(t.childrenAfterFilter=e.childrenAfterFilter)}var j4=class extends V{constructor(){super(...arguments),this.beanName="filterStage",this.step="filter",this.refreshProps=["excludeChildrenWhenTreeDataFiltering"]}wireBeans(e){this.filterManager=e.filterManager}execute(e){const{changedPath:t}=e;this.filter(t)}filter(e){var i;const t=!!((i=this.filterManager)!=null&&i.isChildFilterPresent());this.filterNodes(t,e)}filterNodes(e,t){const i=(s,n)=>{s.hasChildren()&&e&&!n?s.childrenAfterFilter=s.childrenAfterGroup.filter(o=>{const r=o.childrenAfterFilter&&o.childrenAfterFilter.length>0,a=o.data&&this.filterManager.doesRowPassFilter({rowNode:o});return r||a}):s.childrenAfterFilter=s.childrenAfterGroup,PD(s)};if(this.doingTreeDataFiltering()){const s=(o,r)=>{if(o.childrenAfterGroup)for(let a=0;a<o.childrenAfterGroup.length;a++){const l=o.childrenAfterGroup[a],c=r||this.filterManager.doesRowPassFilter({rowNode:l});l.childrenAfterGroup?s(o.childrenAfterGroup[a],c):i(l,c)}i(o,r)},n=o=>s(o,!1);t.executeFromRootNode(n)}else{const s=n=>i(n,!1);t.forEachChangedNodeDepthFirst(s,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}},K4=class extends LS{constructor(){super(...arguments),this.iconCreated=!1}wireComp(e,t,i,s,n){this.comp=e;const o=Qf(this,this.beans.context,n);this.eButtonShowMainFilter=i,this.eFloatingFilterBody=s,this.setGui(t,o),this.setupActive(),this.refreshHeaderStyles(),this.setupWidth(o),this.setupLeft(o),this.setupHover(o),this.setupFocus(o),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(o),this.setupUi(),o.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(o);const r=()=>this.onColDefChanged(o);o.addManagedListeners(this.column,{colDefChanged:r}),o.addManagedEventListeners({filterSwitched:({column:a})=>{a===this.column&&r()}}),o.addDestroyFunc(()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()})}resizeHeader(){}moveHeader(){}getHeaderClassParams(){const{column:e,beans:t}=this,i=e.colDef;return Fe(t.gos,{colDef:i,column:e,floatingFilter:!0})}setupActive(){const e=this.column.getColDef(),t=!!e.filter,i=!!e.floatingFilter;this.active=t&&i}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=tn("filter",this.beans,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new su(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.getLocaleTextFunc();zh(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){var r;const{beans:t}=this;if(Dt(t)===this.eGui)return;const n=Kc(t,this.eGui,null,e.shiftKey);if(n){(r=t.headerNavigation)==null||r.scrollToColumn(this.column),e.preventDefault(),n.focus();return}const o=this.findNextColumnWithFloatingFilter(e.shiftKey);o&&t.focusSvc.focusHeaderPosition({headerPosition:{headerRowIndex:this.rowCtrl.rowIndex,column:o},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.visibleCols;let i=this.column;do if(i=e?t.getColBefore(i):t.getColAfter(i),!i)break;while(!i.getColDef().filter||!i.getColDef().floatingFilter);return i}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case H.UP:case H.DOWN:case H.LEFT:case H.RIGHT:if(t)return;_c(e);case H.ENTER:t&&kc(this.eGui)&&e.preventDefault();break;case H.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const i=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),s=!!e.relatedTarget&&wc(e.relatedTarget,"ag-floating-filter");if(i&&s&&e.target===this.eGui){const n=this.lastFocusEvent,o=!!(n&&n.key===H.TAB);if(n&&o){const r=n.shiftKey;kc(this.eGui,r)}}this.focusThis()}setupHover(e){var t;(t=this.beans.colHover)==null||t.addHeaderFilterColumnHoverListener(e,this.comp,this.column,this.eGui)}setupLeft(e){const t=new _S(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){var e;this.suppressFilterButton=!((e=this.beans.menuSvc)!=null&&e.isFloatingFilterButtonEnabled(this.column)),this.highlightFilterButtonWhenActive=!_s(this.gos)}setupUserComp(){var t;if(!this.active)return;const e=(t=this.beans.colFilter)==null?void 0:t.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){var t;const e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;(t=this.beans.menuSvc)==null||t.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;const{beans:{colFilter:t},column:i,gos:s}=this,n=o=>{if((o==null?void 0:o.source)==="filterDestroyed"&&(!this.isAlive()||!(t!=null&&t.isAlive())))return;const r=this.comp.getFloatingFilterComp();r&&r.then(a=>{if(a){if(s.get("enableFilterHandlers")){const d=o;let h="filter";d!=null&&d.afterFloatingFilter?h="ui":d!=null&&d.afterDataChange?h="dataChanged":(o==null?void 0:o.source)==="api"&&(h="api"),this.updateFloatingFilterParams(this.userCompDetails,h);return}const l=t==null?void 0:t.getCurrentFloatingFilterParentModel(i),c=o?{...o,columns:o.columns??[],source:o.source==="api"?"api":"columnFilter"}:null;a.onParentModelChanged(l,c)}})};[this.destroySyncListener]=e.addManagedListeners(i,{filterChanged:n}),t!=null&&t.isFilterActive(i)&&n(null)}setupWidth(e){const t=()=>{const i=`${this.column.getActualWidth()}px`;this.comp.setWidth(i)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){var e;if(!this.suppressFilterButton&&this.comp){const t=!!((e=this.beans.filterManager)!=null&&e.isFilterAllowed(this.column));this.comp.setButtonWrapperDisplayed(t),this.highlightFilterButtonWhenActive&&t&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){const t=this.active;this.setupActive();const i=!t&&this.active;t&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());const s=this.beans.colFilter,n=this.active?s==null?void 0:s.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,o=this.comp.getFloatingFilterComp();!o||!n?this.updateCompDetails(e,n,i):o.then(r=>{!r||s!=null&&s.areFilterCompsDifferent(this.userCompDetails??null,n)?this.updateCompDetails(e,n,i):this.updateFloatingFilterParams(n,"colDef")})}updateCompDetails(e,t,i){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),i&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e,t){var s;if(!e)return;let i=e.params;(s=this.comp.getFloatingFilterComp())==null||s.then(n=>{var o;typeof(n==null?void 0:n.refresh)=="function"&&(this.gos.get("enableFilterHandlers")&&(i={...i,model:li(((o=this.beans.colFilter)==null?void 0:o.model)??{},this.column.getColId()),source:t}),n.refresh(i))})}addResizeAndMoveKeyboardListeners(){}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}};function q4(e,t){var s;const i=e.colModel.getCol(t);if(!i){ut(12,{colKey:t});return}(s=e.menuSvc)==null||s.showColumnMenu({column:i,positionBy:"auto"})}function Y4(e){var t;(t=e.menuSvc)==null||t.hidePopupMenu()}var X4={moduleName:"SharedMenu",version:ne,beans:[rz],apiFunctions:{showColumnMenu:q4,hidePopupMenu:Y4}},Q4=class extends FB{postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridCtrl=e.gridCtrl}),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)})}getDefaultPopupParent(){return this.gridCtrl.getGui()}positionPopupForMenu(e){const{eventSource:t,ePopup:i,event:s}=e,n=t.getBoundingClientRect(),o=this.getParentRect();this.setAlignedTo(t,i);let r=!1;const a=()=>{const l=this.keepXYWithinBounds(i,n.top-o.top,0),c=i.clientWidth>0?i.clientWidth:200;r||(i.style.minWidth=`${c}px`,r=!0);const h=o.right-o.left-c;let u;return this.gos.get("enableRtl")?(u=p(),u<0&&(u=f(),this.setAlignedStyles(i,"left")),u>h&&(u=0,this.setAlignedStyles(i,"right"))):(u=f(),u>h&&(u=p(),this.setAlignedStyles(i,"right")),u<0&&(u=0,this.setAlignedStyles(i,"left"))),{x:u,y:l};function f(){return n.right-o.left-2}function p(){return n.left-o.left-c}};this.positionPopup({ePopup:i,keepWithinBounds:!0,updatePosition:a,postProcessCallback:()=>this.callPostProcessPopup(e,"subMenu",i,t,s instanceof MouseEvent?s:void 0)})}callPostProcessPopup(e,t,i,s,n){const o=this.gos.getCallback("postProcessPopup");if(o){const{column:r,rowNode:a}=e;o({column:r,rowNode:a,ePopup:i,type:t,eventSource:s,mouseEvent:n})}}getActivePopups(){return this.popupList.map(e=>e.element)}handleThemeChange(e){if(e.themeChanged){const t=this.beans.environment;for(const i of this.popupList)t.applyThemeClasses(i.wrapper)}}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isStopPropagation(e){return Rr(e)}},Kv={moduleName:"Popup",version:ne,beans:[Q4]},J4=".ag-set-filter{--ag-indentation-level:0}.ag-set-filter-item{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-set-filter-item{padding-left:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}:where(.ag-rtl) .ag-set-filter-item{padding-right:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}.ag-set-filter-item-checkbox{display:flex;height:100%;width:100%}.ag-set-filter-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr) .ag-set-filter-group-icons{margin-right:var(--ag-widget-container-horizontal-padding)}:where(.ag-rtl) .ag-set-filter-group-icons{margin-left:var(--ag-widget-container-horizontal-padding)}.ag-filter-body-wrapper{display:flex;flex-direction:column}:where(.ag-menu:not(.ag-tabs) .ag-filter) .ag-filter-body-wrapper,:where(.ag-menu:not(.ag-tabs) .ag-filter)>:not(.ag-filter-wrapper){min-width:180px}.ag-filter-filter{flex:1 1 0px}.ag-filter-condition{display:flex;justify-content:center}.ag-floating-filter-body{display:flex;flex:1 1 auto;height:100%;position:relative}.ag-floating-filter-full-body{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;width:100%}:where(.ag-floating-filter-full-body)>div{flex:1 1 auto}.ag-floating-filter-input{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}:where(.ag-input-field-input[type=date]),:where(.ag-input-field-input[type=datetime-local]){width:1px}}.ag-floating-filter-button{display:flex;flex:none}.ag-date-floating-filter-wrapper{display:flex}.ag-set-floating-filter-input :where(input)[disabled]{pointer-events:none}.ag-floating-filter-button-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;height:var(--ag-icon-size);width:var(--ag-icon-size)}.ag-filter-loading{align-items:unset;background-color:var(--ag-chrome-background-color);height:100%;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;width:100%;z-index:1;:where(.ag-menu) &{background-color:var(--ag-menu-background-color)}}.ag-filter-separator{border-top:solid var(--ag-border-width) var(--menu-separator-color)}:where(.ag-filter-select) .ag-picker-field-wrapper{width:0}.ag-filter-condition-operator{height:17px}:where(.ag-ltr) .ag-filter-condition-operator-or{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-condition-operator-or{margin-right:calc(var(--ag-spacing)*2)}.ag-set-filter-select-all{padding-top:var(--ag-widget-container-vertical-padding)}.ag-filter-no-matches,.ag-set-filter-list{height:calc(var(--ag-list-item-height)*6)}.ag-filter-no-matches{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-set-filter-tree-list{height:calc(var(--ag-list-item-height)*10)}.ag-set-filter-filter{margin-left:var(--ag-widget-container-horizontal-padding);margin-right:var(--ag-widget-container-horizontal-padding);margin-top:var(--ag-widget-container-vertical-padding)}.ag-filter-to{margin-top:var(--ag-widget-vertical-spacing)}.ag-mini-filter{margin:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}:where(.ag-ltr) .ag-set-filter-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-rtl) .ag-set-filter-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-filter-menu) .ag-set-filter-list{min-width:200px}.ag-filter-virtual-list-item:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-filter-apply-panel{display:flex;justify-content:flex-end;overflow:hidden;padding:var(--ag-widget-vertical-spacing) var(--ag-widget-container-horizontal-padding) var(--ag-widget-container-vertical-padding)}.ag-filter-apply-panel-button{line-height:1.5}:where(.ag-ltr) .ag-filter-apply-panel-button{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-apply-panel-button{margin-right:calc(var(--ag-spacing)*2)}.ag-simple-filter-body-wrapper{display:flex;flex-direction:column;min-height:calc(var(--ag-list-item-height) + var(--ag-widget-container-vertical-padding) + var(--ag-widget-vertical-spacing));overflow-y:auto;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);padding-bottom:calc(var(--ag-widget-container-vertical-padding) - var(--ag-widget-vertical-spacing));&>*{margin-bottom:var(--ag-widget-vertical-spacing)}:where(.ag-resizer-wrapper){margin:0}}.ag-multi-filter-menu-item{margin:var(--ag-spacing) 0}.ag-multi-filter-group-title-bar{background-color:transparent;color:var(--ag-header-text-color);font-weight:500;padding:calc(var(--ag-spacing)*1.5) var(--ag-spacing)}.ag-group-filter-field-select-wrapper{display:flex;flex-direction:column;gap:var(--ag-widget-vertical-spacing);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}";function Z4(e){const t=e.filterManager;return!!(t!=null&&t.isColumnFilterPresent())||!!(t!=null&&t.isAggregateFilterPresent())}function e6(e,t){var i;return((i=e.filterManager)==null?void 0:i.getColumnFilterInstance(t))??Promise.resolve(void 0)}function t6(e,t){var s;const i=e.colModel.getColDefCol(t);if(i)return(s=e.colFilter)==null?void 0:s.destroyFilter(i,"api")}function i6(e,t){e.frameworkOverrides.wrapIncoming(()=>{var i;return(i=e.filterManager)==null?void 0:i.setFilterModel(t)})}function s6(e){var t;return((t=e.filterManager)==null?void 0:t.getFilterModel())??{}}function n6(e,t,i){const{gos:s,colModel:n,colFilter:o}=e;i&&!s.get("enableFilterHandlers")&&(j(288),i=!1);const r=n.getColDefCol(t);return r?(o==null?void 0:o.getModelForColumn(r,i))??null:null}function o6(e,t,i){var s;return((s=e.filterManager)==null?void 0:s.setColumnFilterModel(t,i))??Promise.resolve()}function r6(e,t){var s;const i=e.colModel.getCol(t);if(!i){ut(12,{colKey:t});return}(s=e.menuSvc)==null||s.showFilterMenu({column:i,containerType:"columnFilter",positionBy:"auto"})}function a6(e){var t;(t=e.menuSvc)==null||t.hideFilterMenu()}function l6(e,t){var s;const i=e.colModel.getCol(t);if(!i){ut(12,{colKey:t});return}return(s=e.colFilter)==null?void 0:s.getHandler(i,!0)}function c6(e,t){const{colModel:i,colFilter:s,gos:n}=e;if(!n.get("enableFilterHandlers")){j(287);return}const{colId:o,action:r}=t;if(o){const a=i.getColById(o);a&&(s==null||s.updateModel(a,r))}else s==null||s.updateAllModels(r)}var d6={filterHandler:()=>({doesFilterPass:()=>!0})},h6=class extends V{constructor(){super(...arguments),this.beanName="colFilter",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.modelUpdates=[],this.columnModelUpdates=[],this.state=new Map,this.handlerMap={...TT},this.isGlobalButtons=!1,this.activeFilterComps=new Set}postConstruct(){var i,s;this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)});const e=this.gos,t={...((s=(i=e.get("initialState"))==null?void 0:i.filter)==null?void 0:s.filterModel)??{}};this.initialModel=t,this.model={...t},e.get("enableFilterHandlers")||delete this.handlerMap.agMultiColumnFilter}refreshModel(){this.onNewRowsLoaded("rowDataUpdated")}setModel(e,t="api",i){const{colModel:s,dataTypeSvc:n,filterManager:o}=this.beans;if(n!=null&&n.isPendingInference){this.modelUpdates.push({model:e,source:t});return}const r=[],a=this.getModel(!0);if(e){const l=new Set(Object.keys(e));this.allColumnFilters.forEach((c,d)=>{const h=e[d];r.push(this.setModelOnFilterWrapper(c,h)),l.delete(d)}),l.forEach(c=>{const d=s.getColDefCol(c)||s.getCol(c);if(!d){j(62,{colId:c});return}if(!d.isFilterAllowed()){j(63,{colId:c});return}const h=this.getOrCreateFilterWrapper(d,!0);if(!h){j(64,{colId:c});return}r.push(this.setModelOnFilterWrapper(h,e[c],!0))})}else this.model={},this.allColumnFilters.forEach(l=>{r.push(this.setModelOnFilterWrapper(l,null))});Ot.all(r).then(()=>{const l=this.getModel(!0),c=[];this.allColumnFilters.forEach((d,h)=>{const u=a?a[h]:null,f=l?l[h]:null;rg(u,f)||c.push(d.column)}),c.length>0?o==null||o.onFilterChanged({columns:c,source:t}):i&&this.updateActive("filterChanged")})}getModel(e){var o;const t={},{allColumnFilters:i,initialModel:s,beans:{colModel:n}}=this;if(i.forEach((r,a)=>{const l=this.getModelFromFilterWrapper(r);ae(l)&&(t[a]=l)}),!e)for(const r of Object.keys(s)){const a=s[r];ae(a)&&!i.has(r)&&((o=n.getCol(r))!=null&&o.isFilterAllowed())&&(t[r]=a)}return t}setState(e,t,i="api"){if(this.state.clear(),t)for(const s of Object.keys(t)){const n=t[s];this.state.set(s,{model:li(this.model,s),state:n})}this.setModel(e,i,!0)}getState(){const e=this.state;if(!e.size)return;const t={};let i=!1;return e.forEach((s,n)=>{const o=s.state;o!=null&&(i=!0,t[n]=o)}),i?t:void 0}getModelFromFilterWrapper(e){const i=e.column.getColId();if(e.isHandler)return li(this.model,i);const s=e.filter;return s?typeof s.getModel!="function"?(j(66),null):s.getModel():li(this.initialModel,i)}isFilterPresent(){return this.activeColumnFilters.length>0}isAggFilterPresent(){return!!this.activeAggregateFilters.length}disableFilters(){this.initialModel={};const{allColumnFilters:e}=this;return e.size?(e.forEach(t=>this.disposeFilterWrapper(t,"advancedFilterEnabled")),!0):!1}updateActiveFilters(){const e=c=>c?c.isFilterActive?c.isFilterActive():(j(67),!1):!1,{colModel:t,gos:i}=this.beans,s=!!Ub(i),n=c=>{if(!c.isPrimary())return!0;const h=!t.isPivotActive();return!c.isValueActive()||!h?!1:t.isPivotMode()?!0:s},o=[],r=[],a=(c,d,h)=>{d&&(n(c)?o.push(h):r.push(h))},l=[];return this.allColumnFilters.forEach(c=>{const d=c.column,h=d.getColId();if(c.isHandler)l.push(Ot.resolve().then(()=>{a(d,this.isHandlerActive(d),{colId:h,isHandler:!0,handler:c.handler,handlerParams:c.handlerParams})}));else{const u=Hr(c);u&&l.push(u.then(f=>{a(d,e(f),{colId:h,isHandler:!1,comp:f})}))}}),Ot.all(l).then(()=>{this.activeAggregateFilters=o,this.activeColumnFilters=r})}updateFilterFlagInColumns(e,t){var s;const i=[];return this.allColumnFilters.forEach(n=>{const o=n.column;if(n.isHandler)i.push(Ot.resolve().then(()=>{this.setColFilterActive(o,this.isHandlerActive(o),e,t)}));else{const r=Hr(n);r&&i.push(r.then(a=>{this.setColFilterActive(o,a.isFilterActive(),e,t)}))}}),(s=this.beans.groupFilter)==null||s.updateFilterFlags(e,t),Ot.all(i)}doFiltersPass(e,t,i){const{data:s,aggData:n}=e,o=i?this.activeAggregateFilters:this.activeColumnFilters,r=i?n:s,a=this.model;for(let l=0;l<o.length;l++){const c=o[l],{colId:d,isHandler:h}=c;if(d!==t)if(h){const{handler:u,handlerParams:f}=c;if(!u.doesFilterPass({node:e,data:r,model:li(a,d),handlerParams:f}))return!1}else{const u=c.comp;if(typeof u.doesFilterPass!="function"){ut(91);continue}if(!u.doesFilterPass({node:e,data:r}))return!1}}return!0}getHandlerParams(e){const t=this.allColumnFilters.get(e.getColId());return t!=null&&t.isHandler?t.handlerParams:void 0}callOnFilterChangedOutsideRenderCycle(e){const{rowRenderer:t,filterManager:i}=this.beans,s=()=>{this.isAlive()&&(i==null||i.onFilterChanged(e))};t.isRefreshInProgress()?setTimeout(s,0):s()}updateBeforeFilterChanged(e={}){const{column:t,additionalEventAttributes:i}=e,s=t==null?void 0:t.getColId();return this.updateActiveFilters().then(()=>this.updateFilterFlagInColumns("filterChanged",i).then(()=>{this.allColumnFilters.forEach(n=>{var a,l,c;const{column:o,isHandler:r}=n;s!==o.getColId()&&(r&&((l=(a=n.handler).onAnyFilterChanged)==null||l.call(a)),(c=Hr(n,r))==null||c.then(d=>{typeof(d==null?void 0:d.onAnyFilterChanged)=="function"&&d.onAnyFilterChanged()}))}),this.processingFilterChange=!0}))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(e){const t=[];this.allColumnFilters.forEach(i=>{var o,r;const s=i.isHandler;s&&((r=(o=i.handler).onNewRowsLoaded)==null||r.call(o));const n=Hr(i,s);n&&t.push(n.then(a=>{var l;(l=a.onNewRowsLoaded)==null||l.call(a)}))}),Ot.all(t).then(()=>this.updateActive(e,{afterDataChange:!0}))}updateActive(e,t){this.updateFilterFlagInColumns(e,t).then(()=>this.updateActiveFilters())}createGetValue(e,t){const{filterValueSvc:i,colModel:s}=this.beans;return(n,o)=>{const r=o?s.getCol(o):e;return r?i.getValue(r,n,t):void 0}}isFilterActive(e){const t=this.cachedFilter(e);if(t!=null&&t.isHandler)return this.isHandlerActive(e);const i=t==null?void 0:t.filter;return i?i.isFilterActive():li(this.initialModel,e.getColId())!=null}isHandlerActive(e){const t=ae(li(this.model,e.getColId()));if(t)return t;const i=this.beans.groupFilter;return i!=null&&i.isGroupFilter(e)?i.isFilterActive(e):!1}getOrCreateFilterUi(e){const t=this.getOrCreateFilterWrapper(e,!0);return t?Hr(t):null}getFilterUiForDisplay(e){const t=this.getOrCreateFilterWrapper(e,!0);if(!t)return null;const i=Hr(t);return i?i.then(s=>({comp:s,params:t.filterUi.filterParams,isHandler:t.isHandler})):null}getHandler(e,t){const i=this.getOrCreateFilterWrapper(e,t);return i!=null&&i.isHandler?i.handler:void 0}getOrCreateFilterWrapper(e,t){if(!e.isFilterAllowed())return;let i=this.cachedFilter(e);return!i&&t&&(i=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,i)),i}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e,t=!1){return this.getDefaultFilterFromDataType(()=>{var i;return(i=this.beans.dataTypeSvc)==null?void 0:i.getBaseDataType(e)},t)}getDefaultFilterFromDataType(e,t=!1){return cG(this.gos)?t?"agSetColumnFloatingFilter":"agSetColumnFilter":QB(e(),t)}getDefaultFloatingFilter(e){return this.getDefaultFilter(e,!0)}createFilterComp(e,t,i,s,n,o){const r=()=>{const c=this.createFilterCompParams(e,n,o),d=s(c,n);return u2(this.beans.userCompFactory,t,d,i)},a=r();return a?{compDetails:a,createFilterUi:c=>(c?r():a).newAgStackInstance()}:null}createFilterInstance(e,t,i,s){var h,u;const n=this.beans.selectableFilter;n!=null&&n.isSelectable(t)&&(t=n.getFilterDef(e,t));const{handler:o,handlerParams:r,handlerGenerator:a}=this.createHandler(e,t,i)??{},l=this.createFilterComp(e,t,i,s,!!o,"init");if(!l)return{compDetails:null,createFilterUi:null,handler:o,handlerGenerator:a,handlerParams:r};const{compDetails:c,createFilterUi:d}=l;return this.isGlobalButtons&&((u=(h=c.params)==null?void 0:h.buttons)!=null&&u.length||j(281,{colId:e.getColId()})),{compDetails:c,handler:o,handlerGenerator:a,handlerParams:r,createFilterUi:d}}createBaseFilterParams(e,t){const{filterManager:i,rowModel:s}=this.beans;return Fe(this.gos,{column:e,colDef:e.getColDef(),getValue:this.createGetValue(e),doesRowPassOtherFilter:t?()=>!0:n=>(i==null?void 0:i.doesRowPassOtherFilters(e.getColId(),n))??!0,rowModel:s})}createFilterCompParams(e,t,i,s){const n=this.filterChangedCallbackFactory(e),o=this.createBaseFilterParams(e,s);if(o.filterChangedCallback=n,o.filterModifiedCallback=s?()=>{}:r=>this.filterModified(e,r),t){const r=o,a=e.getColId(),l=li(this.model,a);r.model=l,r.state=this.state.get(a)??{model:l},r.onModelChange=(c,d)=>{this.updateStoredModel(a,c),this.refreshHandlerAndUi(e,c,"ui",!1,d).then(()=>{n({...d,source:"columnFilter"})})},r.onStateChange=c=>{this.updateState(e,c),this.updateOrRefreshFilterUi(e)},r.onAction=(c,d,h)=>{this.updateModel(e,c,d),this.dispatchLocalEvent({type:"filterAction",column:e,action:c,event:h})},r.getHandler=()=>this.getHandler(e,!0),r.onUiChange=c=>this.filterUiChanged(e,c),r.source=i}return o}createFilterUiForHandler(e,t){return t?{created:!1,create:t,filterParams:e.params,compDetails:e}:null}createFilterUiLegacy(e,t,i){const s=t(),n={created:!0,create:t,filterParams:e.params,compDetails:e,promise:s};return s.then(i),n}createFilterWrapper(e){var a;const{compDetails:t,handler:i,handlerGenerator:s,handlerParams:n,createFilterUi:o}=this.createFilterInstance(e,e.getColDef(),this.getDefaultFilter(e),l=>l),r=e.getColId();if(i)return delete this.initialModel[r],(a=i.init)==null||a.call(i,{...n,source:"init",model:li(this.model,r)}),{column:e,isHandler:!0,handler:i,handlerGenerator:s,handlerParams:n,filterUi:this.createFilterUiForHandler(t,o)};if(o){const l={column:e,filterUi:null,isHandler:!1};return l.filterUi=this.createFilterUiLegacy(t,o,c=>{l.filter=c??void 0}),l}return{column:e,filterUi:null,isHandler:!1}}createHandlerFunc(e,t,i){var f;const{gos:s,frameworkOverrides:n,registry:o}=this.beans;let r;const a=p=>{const m=p.filter;if(nT(m)){const v=m.handler;return v||(r=m.doesFilterPass,r?()=>({doesFilterPass:r}):void 0)}return typeof m=="string"?m:void 0},l=s.get("enableFilterHandlers"),c=l?a(t):void 0,d=p=>()=>this.createBean(o.createDynamicBean(p,!0));let h,u;if(typeof c=="string"){const p=(f=s.get("filterHandlers"))==null?void 0:f[c];p!=null?h=p:GB.has(c)&&(h=d(c),u=c)}else h=c;if(!h){let p;const{compName:m,jsComp:v,fwComp:C}=aT(n,t);m?p=m:v==null&&C==null&&t.filter===!0&&(p=i),u=this.handlerMap[p],u&&(h=d(u))}return h?{filterHandler:h,handlerNameOrCallback:r??u}:l?(Ut(s)&&j(277,{colId:e.getColId()}),d6):void 0}createHandler(e,t,i){const s=this.createHandlerFunc(e,t,i);if(!s)return;const n=bC(this.beans.userCompFactory,t,this.createFilterCompParams(e,!0,"init")),{handlerNameOrCallback:o,filterHandler:r}=s,{handler:a,handlerParams:l}=this.createHandlerFromFunc(e,r,n);return{handler:a,handlerParams:l,handlerGenerator:o??r}}createHandlerFromFunc(e,t,i){const s=e.getColDef(),n=t(Fe(this.gos,{column:e,colDef:s})),o=this.createHandlerParams(e,i);return{handler:n,handlerParams:o}}createHandlerParams(e,t){const i=e.getColDef(),s=e.getColId(),n=this.filterChangedCallbackFactory(e);return Fe(this.gos,{colDef:i,column:e,getValue:this.createGetValue(e),doesRowPassOtherFilter:o=>{var r;return((r=this.beans.filterManager)==null?void 0:r.doesRowPassOtherFilters(s,o))??!0},onModelChange:(o,r)=>{this.updateStoredModel(s,o),this.refreshHandlerAndUi(e,o,"handler",!1,r).then(()=>{n({...r,source:"columnFilter"})})},filterParams:t})}onColumnsChanged(){const e=[],{colModel:t,filterManager:i,groupFilter:s}=this.beans;this.allColumnFilters.forEach((o,r)=>{let a;o.column.isPrimary()?a=t.getColDefCol(r):a=t.getCol(r),!(a&&a===o.column)&&(e.push(o.column),this.disposeFilterWrapper(o,"columnChanged"),this.disposeColumnListener(r))});const n=s&&e.every(o=>s.isGroupFilter(o));e.length>0&&!n&&(i==null||i.onFilterChanged({columns:e,source:"api"}))}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;const i=this.beans.groupFilter;return i!=null&&i.isGroupFilter(e)?i.isFilterAllowed(e):!0}getFloatingFilterCompDetails(e,t){const{userCompFactory:i,frameworkOverrides:s,selectableFilter:n}=this.beans,o=u=>{const f=this.getOrCreateFilterUi(e);f!=null&&f.then(p=>{u(fg(p))})},r=e.getColDef(),a=n!=null&&n.isSelectable(r)?n.getFilterDef(e,r):r,l=iV(s,a,()=>this.getDefaultFloatingFilter(e))??"agReadOnlyFloatingFilter",c=this.gos.get("enableFilterHandlers"),d=bC(i,a,this.createFilterCompParams(e,c,"init",!0)),h=Fe(this.gos,{column:e,filterParams:d,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:o,showParentFilter:t});if(c){const u=h,f=e.getColId(),p=this.filterChangedCallbackFactory(e);u.onUiChange=m=>this.floatingFilterUiChanged(e,m),u.model=li(this.model,f),u.onModelChange=(m,v)=>{this.updateStoredModel(f,m),this.refreshHandlerAndUi(e,m,"floating",!0,v).then(()=>{p({...v,source:"columnFilter"})})},u.getHandler=()=>this.getHandler(e,!0),u.source="init"}return v2(i,r,h,l)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilterUi(e,t,i,s){const n="paramsUpdated";if(e.isHandler){const o=t.getColId();delete this.initialModel[o],this.state.delete(o);const r=e.filterUi,a=this.createFilterUiForHandler(i,s);e.filterUi=a;const l=this.eventSvc;r!=null&&r.created?r.promise.then(c=>{this.destroyBean(c),l.dispatchEvent({type:"filterDestroyed",source:n,column:t})}):l.dispatchEvent({type:"filterHandlerDestroyed",source:n,column:t})}else this.destroyFilter(t,n)}destroyFilter(e,t="api"){const i=e.getColId(),s=this.allColumnFilters.get(i);this.disposeColumnListener(i),delete this.initialModel[i],s&&this.disposeFilterWrapper(s,t).then(n=>{var o;n&&this.isAlive()&&((o=this.beans.filterManager)==null||o.onFilterChanged({columns:[e],source:"api"}))})}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){let i=!1;const{column:s,isHandler:n,filterUi:o}=e,r=s.getColId();n&&(i=this.isHandlerActive(s),this.destroyBean(e.handler),delete this.model[r],this.state.delete(r));const a=()=>{this.setColFilterActive(s,!1,"filterDestroyed"),this.allColumnFilters.delete(r),this.eventSvc.dispatchEvent({type:"filterDestroyed",source:t,column:s})};if(o){if(o.created)return o.promise.then(l=>(i=n?i:!!(l!=null&&l.isFilterActive()),this.destroyBean(l),a(),i));a()}return Ot.resolve(i)}filterChangedCallbackFactory(e){return t=>{this.callOnFilterChangedOutsideRenderCycle({additionalEventAttributes:t,columns:[e],column:e,source:(t==null?void 0:t.source)??"columnFilter"})}}filterParamsChanged(e,t="api"){var v,C,w,S,b,E;const i=this.allColumnFilters.get(e);if(!i)return;const s=this.beans,n=i.column,o=n.getColDef(),r=n.isFilterAllowed(),a=this.getDefaultFilter(n),l=s.selectableFilter,c=l!=null&&l.isSelectable(o)?l.getFilterDef(n,o):o,d=r?this.createHandlerFunc(n,c,this.getDefaultFilter(n)):void 0,h=!!d,u=i.isHandler;if(u!=h){this.destroyFilter(n,"paramsUpdated");return}const{compDetails:f,createFilterUi:p}=(r?this.createFilterComp(n,c,a,A=>A,h,"colDef"):null)??{compDetails:null,createFilterUi:null},m=(f==null?void 0:f.params)??bC(s.userCompFactory,c,this.createFilterCompParams(n,h,"colDef"));if(u){const A=(d==null?void 0:d.handlerNameOrCallback)??(d==null?void 0:d.filterHandler),P=li(this.model,e);if(i.handlerGenerator!=A){const T=i.handler,{handler:D,handlerParams:N}=this.createHandlerFromFunc(n,d.filterHandler,m);i.handler=D,i.handlerParams=N,i.handlerGenerator=A,delete this.model[e],(v=D.init)==null||v.call(D,{...N,source:"init",model:null}),this.destroyBean(T),P!=null&&((C=this.beans.filterManager)==null||C.onFilterChanged({columns:[n],source:t}))}else{const T=this.createHandlerParams(n,f==null?void 0:f.params);i.handlerParams=T,(S=(w=i.handler).refresh)==null||S.call(w,{...T,source:"colDef",model:P})}}if(this.areFilterCompsDifferent(((b=i.filterUi)==null?void 0:b.compDetails)??null,f)||!i.filterUi||!f){this.destroyFilterUi(i,n,f,p);return}i.filterUi.filterParams=m,(E=Hr(i,u))==null||E.then(A=>{(A!=null&&A.refresh?A.refresh(m):!0)===!1?this.destroyFilterUi(i,n,f,p):this.dispatchLocalEvent({type:"filterParamsChanged",column:n,params:m})})}refreshHandlerAndUi(e,t,i,s,n){const o=this.cachedFilter(e);if(!o)return s&&this.getOrCreateFilterWrapper(e,!0),Ot.resolve();if(!o.isHandler)return Ot.resolve();const{filterUi:r,handler:a,handlerParams:l}=o;return BB(()=>{if(r){const{created:c,filterParams:d}=r;if(c)return r.promise.then(h=>h?{filter:h,filterParams:d}:void 0);r.refreshed=!0}return Ot.resolve(void 0)},a,l,t,this.state.get(e.getColId())??{model:t},i,n)}setColumnFilterWrapper(e,t){const i=e.getColId();this.allColumnFilters.set(i,t),this.allColumnListeners.set(i,this.addManagedListeners(e,{colDefChanged:()=>this.filterParamsChanged(i)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;const{componentClass:i}=e,{componentClass:s}=t;return!(i===s||(i==null?void 0:i.render)&&(s==null?void 0:s.render)&&i.render===s.render)}hasFloatingFilters(){return this.beans.colModel.getCols().some(t=>t.getColDef().floatingFilter)}getFilterInstance(e){const t=this.beans.colModel.getColDefCol(e);if(!t)return Promise.resolve(void 0);const i=this.getOrCreateFilterUi(t);return i?new Promise(s=>{i.then(n=>{s(fg(n))})}):Promise.resolve(null)}processFilterModelUpdateQueue(){this.modelUpdates.forEach(({model:e,source:t})=>this.setModel(e,t)),this.modelUpdates=[],this.columnModelUpdates.forEach(({key:e,model:t,resolve:i})=>{this.setModelForColumn(e,t).then(()=>i())}),this.columnModelUpdates=[]}getModelForColumn(e,t){if(t){const{state:s,model:n}=this,o=e.getColId(),r=s.get(o);return r?r.model??null:li(n,o)}const i=this.cachedFilter(e);return i?this.getModelFromFilterWrapper(i):null}setModelForColumn(e,t){var i;if((i=this.beans.dataTypeSvc)!=null&&i.isPendingInference){let s=()=>{};const n=new Promise(o=>{s=o});return this.columnModelUpdates.push({key:e,model:t,resolve:s}),n}return new Promise(s=>{this.setModelForColumnLegacy(e,t).then(n=>s(n))})}getStateForColumn(e){return this.state.get(e)??{model:li(this.model,e)}}setModelForColumnLegacy(e,t){const i=this.beans.colModel.getColDefCol(e),s=i?this.getOrCreateFilterWrapper(i,!0):null;return s?this.setModelOnFilterWrapper(s,t):Ot.resolve()}setColDefPropsForDataType(e,t,i){var d;const s=e.filter,n=s===!0?this.getDefaultFilterFromDataType(()=>t.baseDataType):s;if(typeof n!="string")return;let o,r;const a=this.beans,{filterParams:l,filterValueGetter:c}=e;n==="agMultiColumnFilter"?{filterParams:o,filterValueGetter:r}=((d=a.multiFilter)==null?void 0:d.getParamsForDataType(l,c,t,i))??{}:{filterParams:o,filterValueGetter:r}=qB(n,l,c,t,i,a,this.getLocaleTextFunc()),e.filterParams=o,r&&(e.filterValueGetter=r)}setColFilterActive(e,t,i,s){e.filterActive!==t&&(e.filterActive=t,e.dispatchColEvent("filterActiveChanged",i)),e.dispatchColEvent("filterChanged",i,s)}setModelOnFilterWrapper(e,t,i){return new Ot(s=>{if(e.isHandler){const o=e.column,r=o.getColId(),a=this.model[r];if(this.updateStoredModel(r,t),i&&t===a){s();return}this.refreshHandlerAndUi(o,t,"api").then(()=>s());return}const n=Hr(e);if(n){n.then(o=>{if(typeof(o==null?void 0:o.setModel)!="function"){j(65),s();return}(o.setModel(t)||Ot.resolve()).then(()=>s())});return}s()})}updateStoredModel(e,t){ae(t)?this.model[e]=t:delete this.model[e];const i=this.state.get(e),s={model:t,state:i==null?void 0:i.state};this.state.set(e,s)}filterModified(e,t){var i;(i=this.getOrCreateFilterUi(e))==null||i.then(s=>{this.eventSvc.dispatchEvent({type:"filterModified",column:e,filterInstance:s,...t})})}filterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent({type:"filterUiChanged",column:e,...t})}floatingFilterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent({type:"floatingFilterUiChanged",column:e,...t})}updateModel(e,t,i){var r;const s=e.getColId(),n=this.cachedFilter(e),o=()=>n==null?void 0:n.filterUi;RR(t,o,()=>li(this.model,s),()=>this.state.get(s),a=>this.updateState(e,a),a=>{var l,c;return(c=(l=o())==null?void 0:l.filterParams)==null?void 0:c.onModelChange(a,i)},n!=null&&n.isHandler?(r=n.handler.processModelToApply)==null?void 0:r.bind(n.handler):void 0)}updateAllModels(e,t){const i=[];this.allColumnFilters.forEach((s,n)=>{var r;const o=this.beans.colModel.getColDefCol(n);o&&RR(e,()=>s.filterUi,()=>li(this.model,n),()=>this.state.get(n),a=>this.updateState(o,a),a=>{this.updateStoredModel(n,a),this.dispatchLocalEvent({type:"filterAction",column:o,action:e}),i.push(this.refreshHandlerAndUi(o,a,"ui"))},s!=null&&s.isHandler?(r=s.handler.processModelToApply)==null?void 0:r.bind(s.handler):void 0)}),i.length&&Ot.all(i).then(()=>{this.callOnFilterChangedOutsideRenderCycle({source:"columnFilter",additionalEventAttributes:t,columns:[]})})}updateOrRefreshFilterUi(e){const t=e.getColId();MT(()=>{var i;return(i=this.cachedFilter(e))==null?void 0:i.filterUi},()=>li(this.model,t),()=>this.state.get(t))}updateState(e,t){this.state.set(e.getColId(),t),this.dispatchLocalEvent({type:"filterStateChanged",column:e,state:t})}canApplyAll(){const{state:e,model:t,activeFilterComps:i}=this;for(const n of i)if(n.source==="COLUMN_MENU")return!1;let s=!1;for(const n of e.keys()){const o=e.get(n);if(o.valid===!1)return!1;(o.model??null)!==li(t,n)&&(s=!0)}return s}hasUnappliedModel(e){var s;const{model:t,state:i}=this;return(((s=i.get(e))==null?void 0:s.model)??null)!==li(t,e)}setGlobalButtons(e){this.isGlobalButtons=e,this.dispatchLocalEvent({type:"filterGlobalButtons",isGlobal:e})}shouldKeepStateOnDetach(e,t){if(t==="newFiltersToolPanel")return!0;const i=this.beans.filterPanelSvc;return i!=null&&i.isActive?!!i.getState(e.getColId()):!1}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear(),this.state.clear(),this.activeFilterComps.clear()}};function u6(e){var t;return!!((t=e.filterManager)!=null&&t.isAnyFilterPresent())}function g6(e,t="api"){var i;(i=e.filterManager)==null||i.onFilterChanged({source:t})}var f6=class extends V{constructor(){super(...arguments),this.beanName="filterManager",this.advFilterModelUpdateQueue=[]}wireBeans(e){this.quickFilter=e.quickFilter,this.advancedFilter=e.advancedFilter,this.colFilter=e.colFilter}postConstruct(){const e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:({enabled:s})=>this.onAdvFilterEnabledChanged(s),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.quickFilter&&this.addManagedListeners(this.quickFilter,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})});const{gos:i}=this;this.alwaysPassFilter=i.get("alwaysPassFilter"),this.addManagedPropertyListener("alwaysPassFilter",()=>{this.alwaysPassFilter=i.get("alwaysPassFilter"),this.onFilterChanged({source:"api"})})}isExternalFilterPresentCallback(){const e=this.gos.getCallback("isExternalFilterPresent");return typeof e=="function"&&e({})}doesExternalFilterPass(e){const t=this.gos.get("doesExternalFilterPass");return typeof t=="function"&&t(e)}setFilterState(e,t,i="api"){var s;this.isAdvFilterEnabled()||(s=this.colFilter)==null||s.setState(e,t,i)}setFilterModel(e,t="api",i){var s;if(this.isAdvFilterEnabled()){i||this.warnAdvFilters();return}(s=this.colFilter)==null||s.setModel(e,t)}getFilterModel(){var e;return((e=this.colFilter)==null?void 0:e.getModel())??{}}getFilterState(){var e;return(e=this.colFilter)==null?void 0:e.getState()}isColumnFilterPresent(){var e;return!!((e=this.colFilter)!=null&&e.isFilterPresent())}isAggregateFilterPresent(){var e;return!!((e=this.colFilter)!=null&&e.isAggFilterPresent())}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.externalFilterPresent||this.isAdvFilterPresent()}isAnyFilterPresent(){return this.isChildFilterPresent()||this.isAggregateFilterPresent()}isAdvFilterPresent(){return this.isAdvFilterEnabled()&&this.advancedFilter.isFilterPresent()}onAdvFilterEnabledChanged(e){var t,i;e?(t=this.colFilter)!=null&&t.disableFilters()&&this.onFilterChanged({source:"advancedFilter"}):(i=this.advancedFilter)!=null&&i.isFilterPresent()&&(this.advancedFilter.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvFilterEnabled(){var e;return!!((e=this.advancedFilter)!=null&&e.isEnabled())}isAdvFilterHeaderActive(){return this.isAdvFilterEnabled()&&this.advancedFilter.isHeaderActive()}refreshFiltersForAggregations(){Ub(this.gos)&&this.isAnyFilterPresent()&&this.onFilterChanged()}onFilterChanged(e={}){const{source:t,additionalEventAttributes:i,columns:s=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.colFilter?this.colFilter.updateBeforeFilterChanged(e):Ot.resolve()).then(()=>{var o;const n={source:t,type:"filterChanged",columns:s};i&&ts(n,i),this.eventSvc.dispatchEvent(n),(o=this.colFilter)==null||o.updateAfterFilterChanged()})}isSuppressFlashingCellsBecauseFiltering(){var e;return!!((e=this.colFilter)!=null&&e.isSuppressFlashingCellsBecauseFiltering())}isQuickFilterPresent(){var e;return!!((e=this.quickFilter)!=null&&e.isFilterPresent())}updateAggFiltering(){this.aggFiltering=!!Ub(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.beans.colModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,colIdToSkip:e})}doesRowPassAggregateFilters(e){var i;const{rowNode:t}=e;return(i=this.alwaysPassFilter)!=null&&i.call(this,t)?!0:!(this.isAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.isAggregateFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip,!0))}doesRowPassFilter(e){var i;const{rowNode:t}=e;return(i=this.alwaysPassFilter)!=null&&i.call(this,t)?!0:!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.externalFilterPresent&&!this.doesExternalFilterPass(t)||this.isColumnFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip)||this.isAdvFilterPresent()&&!this.advancedFilter.doesFilterPass(t))}isFilterAllowed(e){var t;return this.isAdvFilterEnabled()?!1:!!((t=this.colFilter)!=null&&t.isFilterAllowed(e))}getAdvFilterModel(){return this.isAdvFilterEnabled()?this.advancedFilter.getModel():null}setAdvFilterModel(e,t="api"){var i;if(this.isAdvFilterEnabled()){if((i=this.beans.dataTypeSvc)!=null&&i.isPendingInference){this.advFilterModelUpdateQueue.push(e);return}this.advancedFilter.setModel(e??null),this.onFilterChanged({source:t})}}toggleAdvFilterBuilder(e,t){this.isAdvFilterEnabled()&&this.advancedFilter.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvFilterColumns(){this.isAdvFilterEnabled()&&this.advancedFilter.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){var e;return this.isAdvFilterEnabled()?!1:!!((e=this.colFilter)!=null&&e.hasFloatingFilters())}getColumnFilterInstance(e){var t;return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve(void 0)):((t=this.colFilter)==null?void 0:t.getFilterInstance(e))??Promise.resolve(void 0)}warnAdvFilters(){j(68)}setupAdvFilterHeaderComp(e){var t;(t=this.advancedFilter)==null||t.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvFilterHeaderActive()?this.advancedFilter.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){for(const e of this.advFilterModelUpdateQueue)this.setAdvFilterModel(e);this.advFilterModelUpdateQueue=[]}setColumnFilterModel(e,t){var i;return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve()):((i=this.colFilter)==null?void 0:i.setModelForColumn(e,t))??Promise.resolve()}},p6=class extends V{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupSvc=e.popupSvc}hideActiveMenu(){var e;(e=this.hidePopup)==null||e.call(this)}showMenuAfterMouseEvent(e,t,i,s){e&&!e.isColumn||this.showPopup(e,n=>{var o;(o=this.popupSvc)==null||o.positionPopupUnderMouseEvent({column:e,type:i,mouseEvent:t,ePopup:n})},i,t.target,_s(this.gos),s)}showMenuAfterButtonClick(e,t,i,s){if(e&&!e.isColumn)return;let n=-1,o="left";const r=_s(this.gos);!r&&this.gos.get("enableRtl")&&(n=1,o="right");const a=r?void 0:4*n,l=r?void 0:4;this.showPopup(e,c=>{var d;(d=this.popupSvc)==null||d.positionPopupByComponent({type:i,eventSource:t,ePopup:c,nudgeX:a,nudgeY:l,alignSide:o,keepWithinBounds:!0,position:"under",column:e})},i,t,r,s)}showPopup(e,t,i,s,n,o){var m;const r=e?this.createBean(new jB(e,"COLUMN_MENU")):void 0;if(this.activeMenu=r,!(r!=null&&r.hasFilter())||!e){ut(57);return}const a=jt({tag:"div",cls:`ag-menu${n?"":" ag-filter-menu"}`,role:"presentation"});[this.tabListener]=this.addManagedElementListeners(a,{keydown:v=>this.trapFocusWithin(v,a)}),a.appendChild(r==null?void 0:r.getGui());let l;const c=()=>r==null?void 0:r.afterGuiDetached(),d=dG(this.gos)?s??this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody:void 0,h=v=>{MR(e,!1,"contextMenu");const C=v instanceof KeyboardEvent;if(this.tabListener&&(this.tabListener=this.tabListener()),C&&s&&To(s)){const w=gT(s);w==null||w.focus({preventScroll:!0})}c(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,i,e),o==null||o()},u=this.getLocaleTextFunc(),f=n&&i!=="columnFilter"?u("ariaLabelColumnMenu","Column Menu"):u("ariaLabelColumnFilter","Column Filter"),p=(m=this.popupSvc)==null?void 0:m.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:h,positionCallback:()=>t(a),anchorToElement:d,ariaLabel:f});p&&(this.hidePopup=l=p.hideFunc),r.afterInit().then(()=>{t(a),r.afterGuiAttached({container:i,hidePopup:l})}),MR(e,!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,i,e)}trapFocusWithin(e,t){e.key!==H.TAB||e.defaultPrevented||Kc(this.beans,t,!1,e.shiftKey)||(e.preventDefault(),kc(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,i){this.eventSvc.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:i??null,columnGroup:null})}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},m6=class extends V{constructor(){super(...arguments),this.beanName="filterValueSvc"}getValue(e,t,i){if(!t)return;const s=e.getColDef(),{selectableFilter:n,valueSvc:o}=this.beans,r=i??(n==null?void 0:n.getFilterValueGetter(e.getColId()))??s.filterValueGetter;return r?this.executeFilterValueGetter(r,t.data,e,t,s):o.getValue(e,t)}executeFilterValueGetter(e,t,i,s,n){const{expressionSvc:o,valueSvc:r}=this.beans,a=Fe(this.gos,{data:t,node:s,column:i,colDef:n,getValue:r.getValueCallback.bind(r,s)});return typeof e=="function"?e(a):o==null?void 0:o.evaluate(e,a)}},v6={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eFloatingFilterText"}]},C6=class extends ct{constructor(){super(v6,[Vv]),this.eFloatingFilterText=se}init(e){this.params=e;const t=this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0);if(this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`),this.gos.get("enableFilterHandlers")){const i=e,s=i.getHandler();if(s.getModelAsString){const n=s.getModelAsString(i.model);this.eFloatingFilterText.setValue(n)}}}onParentModelChanged(e){if(e==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(t=>{if(t.getModelAsString){const i=t.getModelAsString(e);this.eFloatingFilterText.setValue(i)}})}refresh(e){this.init(e)}},VS=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions??t,this.mapCustomOptions(),this.defaultOption=this.getDefaultItem(e.defaultOption)}refresh(e,t){const i=e.filterOptions??t;this.filterOptions!==i&&(this.filterOptions=i,this.customFilterOptions={},this.mapCustomOptions()),this.defaultOption=this.getDefaultItem(e.defaultOption)}mapCustomOptions(){const{filterOptions:e}=this;if(e)for(const t of e){if(typeof t=="string")continue;const i=[["displayKey"],["displayName"],["predicate","test"]],s=n=>n.some(o=>t[o]!=null)?!0:(j(72,{keys:n}),!1);if(!i.every(s)){this.filterOptions=e.filter(n=>n===t)||[];continue}this.customFilterOptions[t.displayKey]=t}}getDefaultItem(e){const{filterOptions:t}=this;if(e)return e;if(t.length>=1){const i=t[0];if(typeof i=="string")return i;if(i.displayKey)return i.displayKey;j(73)}else j(74)}getCustomOption(e){return this.customFilterOptions[e]}};function Xu(e,t,i){return i==null?e.splice(t):e.splice(t,i)}function Qm(e){return e==null||typeof e=="string"&&e.trim().length===0}function w6(e){return e==="AND"||e==="OR"?e:"AND"}function b6(e,t,i){if(e==null)return;const{predicate:s}=e;if(s!=null&&!t.some(n=>n==null))return s(t,i)}function y6(e,t){let i=e.length;return i>t&&(e.splice(t),j(78),i=t),i}function Cg(e,t){const i=t.getCustomOption(e);if(i){const{numberOfInputs:n}=i;return n??1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:e==="inRange"?2:1}var zS=class extends tV{constructor(e,t,i){super(e,"simple-filter"),this.mapValuesFromModel=t,this.defaultOptions=i,this.eTypes=[],this.eJoinPanels=[],this.eJoinAnds=[],this.eJoinOrs=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}setParams(e){super.setParams(e);const t=new VS;this.optionsFactory=t,t.init(e,this.defaultOptions),this.commonUpdateSimpleParams(e),this.createOption(),this.createMissingConditionsAndOperators()}updateParams(e,t){this.optionsFactory.refresh(e,this.defaultOptions),super.updateParams(e,t),this.commonUpdateSimpleParams(e)}commonUpdateSimpleParams(e){this.setNumConditions(e),this.defaultJoinOperator=w6(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.createFilterListOptions();const t=this.getGui();this.isReadOnly()?t.setAttribute("tabindex","-1"):t.removeAttribute("tabindex")}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged("immediately",!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach((t,i)=>{const s=i===0?e:this.optionsFactory.defaultOption;t.setValue(s,!0)})}getModelFromUi(){const e=this.getUiCompleteConditions();return e.length===0?null:this.maxNumConditions>1&&e.length>1?{filterType:this.filterType,operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){const{eJoinOrs:e,defaultJoinOperator:t}=this;return e.length===0?t:e[0].getValue()===!0?"OR":"AND"}areNonNullModelsEqual(e,t){const i=!e.operator,s=!t.operator;if(!i&&s||i&&!s)return!1;let o;if(i){const r=e,a=t;o=this.areSimpleModelsEqual(r,a)}else{const r=e,a=t;o=r.operator===a.operator&&Ya(r.conditions,a.conditions,(l,c)=>this.areSimpleModelsEqual(l,c))}return o}setModelIntoUi(e,t){if(e==null)return this.resetUiToDefaults(t),Ot.resolve();if(e.operator){const s=e;let n=s.conditions;n==null&&(n=[],j(77));const o=y6(n,this.maxNumConditions),r=this.getNumConditions();if(o<r)this.removeConditionsAndOperators(o);else if(o>r)for(let l=r;l<o;l++)this.createJoinOperatorPanel(),this.createOption();const a=s.operator==="OR";this.eJoinAnds.forEach(l=>l.setValue(!a,!0)),this.eJoinOrs.forEach(l=>l.setValue(a,!0)),n.forEach((l,c)=>{this.eTypes[c].setValue(l.type,!0),this.setConditionIntoUi(l,c)})}else{const s=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(s.type,!0),this.setConditionIntoUi(s,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.updateUiVisibility(),t||this.params.onUiChange(this.getUiChangeEventParams()),Ot.resolve()}setNumConditions(e){let t=e.maxNumConditions??2;t<1&&(j(79),t=1),this.maxNumConditions=t;let i=e.numAlwaysVisibleConditions??1;i<1&&(j(80),i=1),i>t&&(j(81),i=t),this.numAlwaysVisibleConditions=i}createOption(){const e=this.getGui(),t=this.createManagedBean(new SS);this.eTypes.push(t),t.addCss("ag-filter-select"),e.appendChild(t.getGui());const i=this.createEValue();this.eConditionBodies.push(i),e.appendChild(i),this.putOptionsIntoDropdown(t),this.resetType(t);const s=this.getNumConditions()-1;this.forEachPositionInput(s,n=>this.resetInput(n)),this.addChangedListeners(t,s)}createJoinOperatorPanel(){const e=jt({tag:"div",cls:"ag-filter-condition"});this.eJoinPanels.push(e);const t=this.createJoinOperator(this.eJoinAnds,e,"and"),i=this.createJoinOperator(this.eJoinOrs,e,"or");this.getGui().appendChild(e);const s=this.eJoinPanels.length-1,n=this.joinOperatorId++;this.resetJoinOperatorAnd(t,s,n),this.resetJoinOperatorOr(i,s,n),this.isReadOnly()||(t.onValueChange(this.listener),i.onValueChange(this.listener))}createJoinOperator(e,t,i){const s=this.createManagedBean(new I2);e.push(s);const n="ag-filter-condition-operator";return s.addCss(n),s.addCss(`${n}-${i}`),t.appendChild(s.getGui()),s}createFilterListOptions(){this.filterListOptions=this.optionsFactory.filterOptions.map(e=>typeof e=="string"?this.createBoilerplateListOption(e):this.createCustomListOption(e))}putOptionsIntoDropdown(e){const{filterListOptions:t}=this;for(const i of t)e.addOption(i);e.setDisabled(t.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){const{displayKey:t}=e,i=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:i?this.getLocaleTextFunc()(i.displayKey,i.displayName):this.translate(t)}}createBodyTemplate(){return null}getAgComponents(){return[]}updateUiVisibility(){const e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let i=0;i<this.getNumConditions();i++)this.isConditionUiComplete(i)?e=i:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{const i=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<i){this.removeConditionsAndOperators(i+1);const s=e+1,n=i-s;n>0&&this.removeConditionsAndOperators(s,n),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach((s,n)=>{const o=this.isConditionDisabled(n,e);s.setDisabled(o||this.filterListOptions.length<=1),n===1&&(lg(this.eJoinPanels[0],o),this.eJoinAnds[0].setDisabled(o),this.eJoinOrs[0].setDisabled(o))}),this.eConditionBodies.forEach((s,n)=>{xt(s,this.isConditionBodyVisible(n))});const i=(t??this.getJoinOperator())==="OR";for(const s of this.eJoinAnds)s.setValue(!i,!0);for(const s of this.eJoinOrs)s.setValue(i,!0);this.forEachInput((s,n,o,r)=>{this.setElementDisplayed(s,n<r),this.setElementDisabled(s,this.isConditionDisabled(o,e))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;const{eTypes:i,eConditionBodies:s,eJoinPanels:n,eJoinAnds:o,eJoinOrs:r}=this;this.removeComponents(i,e,t),this.removeElements(s,e,t),this.removeEValues(e,t);const a=Math.max(e-1,0);this.removeElements(n,a,t),this.removeComponents(o,a,t),this.removeComponents(r,a,t)}removeElements(e,t,i){const s=Xu(e,t,i);for(const n of s)Dn(n)}removeComponents(e,t,i){const s=Xu(e,t,i);for(const n of s)Dn(n.getGui()),this.destroyBean(n)}afterGuiAttached(e){var t;if(super.afterGuiAttached(e),this.resetPlaceholder(),!(e!=null&&e.suppressFocus)){let i;if(!this.isReadOnly()){const s=this.getInputs(0)[0];s instanceof gl&&this.isConditionBodyVisible(0)?i=s.getInputElement():i=(t=this.eTypes[0])==null?void 0:t.getFocusableElement()}(i??this.getGui()).focus({preventScroll:!0})}}afterGuiDetached(){var r;super.afterGuiDetached();const e=this.params;if((r=this.beans.colFilter)!=null&&r.shouldKeepStateOnDetach(e.column))return;e.onStateChange({model:e.model});let t=-1,i=-1,s=!1;const n=this.getJoinOperator();for(let a=this.getNumConditions()-1;a>=0;a--)if(this.isConditionUiComplete(a))t===-1&&(t=a,i=a);else{const l=a>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(a-1),c=a<t;(l||c)&&(this.removeConditionsAndOperators(a,1),s=!0,c&&i--)}let o=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),o=!0),this.shouldAddNewConditionAtEnd(i===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),o=!0),o&&this.updateConditionStatusesAndValues(i,n),s&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=i}getModelAsString(e){var t,i;return((i=(t=this.params.getHandler())==null?void 0:t.getModelAsString)==null?void 0:i.call(t,e))??""}getPlaceholderText(e,t){let i=this.translate(e);if(typeof this.filterPlaceholder=="function"){const s=this.eTypes[t].getValue(),n=this.translate(s);i=this.filterPlaceholder({filterOptionKey:s,filterOption:n,placeholder:i})}else typeof this.filterPlaceholder=="string"&&(i=this.filterPlaceholder);return i}resetPlaceholder(){const e=this.getLocaleTextFunc();this.forEachInput((t,i,s,n)=>{if(!(t instanceof gl))return;const o=i===0&&n>1?"inRangeStart":i===0?"filterOoo":"inRangeEnd",r=i===0&&n>1?e("ariaFilterFromValue","Filter from value"):i===0?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");t.setInputPlaceholder(this.getPlaceholderText(o,s)),t.setInputAriaLabel(r)})}setElementValue(e,t,i){e instanceof gl&&e.setValue(t!=null?String(t):null,!0)}setElementDisplayed(e,t){uR(e)&&xt(e.getGui(),t)}setElementDisabled(e,t){uR(e)&&lg(e.getGui(),t)}attachElementOnChange(e,t){e instanceof gl&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach((t,i)=>{this.forEachPositionTypeInput(i,t,e)})}forEachPositionInput(e,t){const i=this.getConditionType(e);this.forEachPositionTypeInput(e,i,t)}forEachPositionTypeInput(e,t,i){const s=Cg(t,this.optionsFactory),n=this.getInputs(e);for(let o=0;o<n.length;o++){const r=n[o];r!=null&&i(r,o,e,s)}}isConditionDisabled(e,t){return this.isReadOnly()?!0:e===0?!1:e>t+1}isConditionBodyVisible(e){const t=this.getConditionType(e);return Cg(t,this.optionsFactory)>0}isConditionUiComplete(e){return!(e>=this.getNumConditions()||this.getConditionType(e)==="empty"||this.getValues(e).some(i=>i==null))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(t=>this.resetType(t)),this.eJoinAnds.forEach((t,i)=>this.resetJoinOperatorAnd(t,i,this.joinOperatorId+i)),this.eJoinOrs.forEach((t,i)=>this.resetJoinOperatorOr(t,i,this.joinOperatorId+i)),this.joinOperatorId++,this.forEachInput(t=>this.resetInput(t)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,this.updateUiVisibility(),e||this.params.onUiChange(this.getUiChangeEventParams())}resetType(e){const i=this.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.defaultOption,!0).setAriaLabel(i).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,i){this.resetJoinOperator(e,t,this.defaultJoinOperator==="AND",this.translate("andCondition"),i)}resetJoinOperatorOr(e,t,i){this.resetJoinOperator(e,t,this.defaultJoinOperator==="OR",this.translate("orCondition"),i)}resetJoinOperator(e,t,i,s,n){this.updateJoinOperatorDisabled(e.setValue(i,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${n}`).setLabel(s),t)}updateJoinOperatorsDisabled(){const e=(t,i)=>this.updateJoinOperatorDisabled(t,i);this.eJoinAnds.forEach(e),this.eJoinOrs.forEach(e)}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){const i=this.mapValuesFromModel(e,this.optionsFactory);this.forEachInput((s,n,o)=>{o===t&&this.setElementValue(s,i[n]!=null?i[n]:null)})}setValueFromFloatingFilter(e){this.forEachInput((t,i,s)=>{this.setElementValue(t,i===0&&s===0?e:null,!0)})}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,i=>{this.attachElementOnChange(i,this.listener)}))}hasInvalidInputs(){return!1}isReadOnly(){return!!this.params.readOnly}},TD=class{constructor(e,t,i,s,n,o){this.alive=!0,this.context=e,this.eParent=n;const r=g2(t,i,s);r&&r.newAgStackInstance().then(a=>{var d,h;if(!this.alive){e.destroyBean(a);return}if(this.dateComp=a,!a)return;n.appendChild(a.getGui()),(d=a==null?void 0:a.afterGuiAttached)==null||d.call(a);const{tempValue:l,disabled:c}=this;l&&a.setDate(l),c!=null&&((h=a.setDisabled)==null||h.call(a,c)),o==null||o(this)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){const t=this.dateComp;t?t.setDate(e):this.tempValue=e}setDisabled(e){var i;const t=this.dateComp;t?(i=t.setDisabled)==null||i.call(t,e):this.disabled=e}setDisplayed(e){xt(this.eParent,e)}setInputPlaceholder(e){var t,i;(i=(t=this.dateComp)==null?void 0:t.setInputPlaceholder)==null||i.call(t,e)}setInputAriaLabel(e){var t,i;(i=(t=this.dateComp)==null?void 0:t.setInputAriaLabel)==null||i.call(t,e)}afterGuiAttached(e){var t,i;(i=(t=this.dateComp)==null?void 0:t.afterGuiAttached)==null||i.call(t,e)}updateParams(e){var t,i;(i=(t=this.dateComp)==null?void 0:t.refresh)==null||i.call(t,e)}},WS=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"];function DD(e,t){const{dateFrom:i,dateTo:s,type:n}=e||{};return[i&&vs(i,void 0,!0)||null,s&&vs(s,void 0,!0)||null].slice(0,Cg(n,t))}var ux=1e3,gx=1/0,S6=class extends zS{constructor(){super("dateFilter",DD,WS),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=ux,this.maxValidYear=gx,this.minValidDate=null,this.maxValidDate=null,this.filterType="date"}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}commonUpdateSimpleParams(e){super.commonUpdateSimpleParams(e);const t=(l,c)=>{const d=e[l];if(d!=null)if(isNaN(d))j(82,{param:l});else return d==null?c:Number(d);return c},i=t("minValidYear",ux),s=t("maxValidYear",gx);this.minValidYear=i,this.maxValidYear=s,i>s&&j(83);const{minValidDate:n,maxValidDate:o}=e,r=n instanceof Date?n:vs(n);this.minValidDate=r;const a=o instanceof Date?o:vs(o);this.maxValidDate=a,r&&a&&r>a&&j(84)}createDateCompWrapper(e){const{beans:{userCompFactory:t,context:i,gos:s},params:n}=this,o=new TD(i,t,n.colDef,Fe(s,{onDateChanged:()=>this.onUiChanged(),filterParams:n,location:"filter"}),e);return this.addDestroyFunc(()=>o.destroy()),o}setElementValue(e,t){e.setDate(t)}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}createEValue(){const e=jt({tag:"div",cls:"ag-filter-body"});return this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e}createFromToElement(e,t,i,s){const n=jt({tag:"div",cls:`ag-filter-${s} ag-filter-date-${s}`});t.push(n),e.appendChild(n),i.push(this.createDateCompWrapper(n))}removeEValues(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),Xu(this.eConditionPanelsFrom,e,t),Xu(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,i){const s=Xu(e,t,i);for(const n of s)n.destroy()}isValidDateValue(e){if(e===null)return!1;const{minValidDate:t,maxValidDate:i,minValidYear:s,maxValidYear:n}=this;if(t){if(e<t)return!1}else if(e.getUTCFullYear()<s)return!1;if(i){if(e>i)return!1}else if(e.getUTCFullYear()>n)return!1;return!0}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachInput((i,s,n,o)=>{n!==e||!t||s>=o||(t=t&&this.isValidDateValue(i.getDate()))}),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}createCondition(e){const t=this.getConditionType(e),i={},s=this.getValues(e),n=this.params.useIsoSeparator?"T":" ";return s.length>0&&(i.dateFrom=Os(s[0],!0,n)),s.length>1&&(i.dateTo=Os(s[1],!0,n)),{dateFrom:null,dateTo:null,filterType:this.filterType,type:t,...i}}resetPlaceholder(){const e=this.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),i=e("ariaFilterValue","Filter Value");this.forEachInput(s=>{s.setInputPlaceholder(t),s.setInputAriaLabel(i)})}getInputs(e){const{dateConditionFromComps:t,dateConditionToComps:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}getValues(e){const t=[];return this.forEachPositionInput(e,(i,s,n,o)=>{s<o&&t.push(i.getDate())}),t}translate(e){return e==="lessThan"?super.translate("before"):e==="greaterThan"?super.translate("after"):super.translate(e)}},MD=class extends V{constructor(e,t){super(),this.mapValuesFromModel=e,this.defaultOptions=t}init(e){const t=e.filterParams,i=new VS;this.optionsFactory=i,i.init(t,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(i,t)),this.updateParams(e),this.validateModel(e)}refresh(e){if(e.source==="colDef"){const t=e.filterParams,i=this.optionsFactory;i.refresh(t,this.defaultOptions),this.filterModelFormatter.updateParams({optionsFactory:i,filterParams:t}),this.updateParams(e)}this.validateModel(e)}updateParams(e){this.params=e}doesFilterPass(e){const t=e.model;if(t==null)return!0;const{operator:i}=t,s=[];if(i){const r=t;s.push(...r.conditions??[])}else s.push(t);const n=i&&i==="OR"?"some":"every",o=this.params.getValue(e.node);return s[n](r=>this.individualConditionPasses(e,r,o))}getModelAsString(e,t){return this.filterModelFormatter.getModelAsString(e,t)??""}validateModel(e){const{model:t,filterParams:{filterOptions:i,maxNumConditions:s}}=e;if(t==null)return;let o=_T(t)?t.conditions:[t];const r=(i==null?void 0:i.map(d=>typeof d=="string"?d:d.displayKey))??this.defaultOptions;if(!(!o||o.every(d=>r.find(h=>h===d.type)!==void 0))){this.params={...e,model:null},e.onModelChange(null);return}let l=!1;const c=this.filterType;if((o&&!o.every(d=>d.filterType===c)||t.filterType!==c)&&(o=o.map(d=>({...d,filterType:c})),l=!0),typeof s=="number"&&o&&o.length>s&&(o=o.slice(0,s),l=!0),l){const d=o.length>1?{...t,filterType:c,conditions:o}:{...o[0],filterType:c};this.params={...e,model:d},e.onModelChange(d)}}individualConditionPasses(e,t,i){const s=this.optionsFactory,n=this.mapValuesFromModel(t,s),o=s.getCustomOption(t.type),r=b6(o,n,i);return r??(i==null?this.evaluateNullValue(t.type):this.evaluateNonNullValue(n,i,t,e))}},ID=class extends MD{evaluateNullValue(e){const{includeBlanksInEquals:t,includeBlanksInNotEqual:i,includeBlanksInGreaterThan:s,includeBlanksInLessThan:n,includeBlanksInRange:o}=this.params.filterParams;switch(e){case"equals":if(t)return!0;break;case"notEqual":if(i)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(s)return!0;break;case"lessThan":case"lessThanOrEqual":if(n)return!0;break;case"inRange":if(o)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,i){const s=i.type;if(!this.isValid(t))return s==="notEqual"||s==="notBlank";const n=this.comparator(),o=e[0]!=null?n(e[0],t):0;switch(s){case"equals":return o===0;case"notEqual":return o!==0;case"greaterThan":return o>0;case"greaterThanOrEqual":return o>=0;case"lessThan":return o<0;case"lessThanOrEqual":return o<=0;case"inRange":{const r=n(e[1],t);return this.params.filterParams.inRangeInclusive?o>=0&&r<=0:o>0&&r<0}case"blank":return Qm(t);case"notBlank":return!Qm(t);default:return j(76,{filterModelType:s}),!0}}},kD={equals:"Equals",notEqual:"NotEqual",greaterThan:"GreaterThan",greaterThanOrEqual:"GreaterThanOrEqual",lessThan:"LessThan",lessThanOrEqual:"LessThanOrEqual",inRange:"InRange"},R6={contains:"Contains",notContains:"NotContains",equals:"TextEquals",notEqual:"TextNotEqual",startsWith:"StartsWith",endsWith:"EndsWith",inRange:"InRange"},$S=class extends V{constructor(e,t,i){super(),this.optionsFactory=e,this.filterParams=t,this.valueFormatter=i}getModelAsString(e,t){const i=this.getLocaleTextFunc(),s=t==="filterToolPanel";if(!e)return s?Yr(this,"filterSummaryInactive"):null;if(e.operator!=null){const o=e,a=(o.conditions??[]).map(c=>this.getModelAsString(c,t)),l=o.operator==="AND"?"andCondition":"orCondition";return a.join(` ${Yr(this,l)} `)}else{if(e.type==="blank"||e.type==="notBlank")return s?Yr(this,e.type==="blank"?"filterSummaryBlank":"filterSummaryNotBlank"):i(e.type,e.type);{const o=e,r=this.optionsFactory.getCustomOption(o.type),{displayKey:a,displayName:l,numberOfInputs:c}=r||{};return a&&l&&c===0?i(a,l):this.conditionToString(o,s,o.type==="inRange"||c===2,a,l)}}}updateParams(e){const{optionsFactory:t,filterParams:i}=e;this.optionsFactory=t,this.filterParams=i}conditionForToolPanel(e,t,i,s,n,o){let r;const a=this.getTypeKey(e);return a&&(r=Yr(this,a)),n&&o&&(r=this.getLocaleTextFunc()(n,o)),r!=null?t?`${r} ${Yr(this,"filterSummaryInRangeValues",[i(),s()])}`:`${r} ${i()}`:null}getTypeKey(e){const t=this.filterTypeKeys[e];return t?`filterSummary${t}`:null}formatValue(e){const t=this.valueFormatter;return t?t(e??null)??"":String(e)}},_D=class extends $S{constructor(e,t){super(e,t,i=>{const{dataTypeSvc:s,valueSvc:n}=this.beans,o=t.column,r=s==null?void 0:s.getDateFormatterFunction(o),a=r?r(i??void 0):i;return n.formatValue(o,null,a)}),this.filterTypeKeys=kD}conditionToString(e,t,i,s,n){const{type:o}=e,r=vs(e.dateFrom),a=vs(e.dateTo),l=this.filterParams.inRangeFloatingFilterDateFormat,c=t?this.formatValue.bind(this):u=>Qb(u,l),d=()=>r!==null?c(r):"null",h=()=>a!==null?c(a):"null";if(t){const u=this.conditionForToolPanel(o,i,d,h,s,n);if(u!=null)return u}return i?`${d()}-${h()}`:r!=null?c(r):`${o}`}};function x6(e,t){const i=t;return i<e?-1:i>e?1:0}var E6=class extends ID{constructor(){super(DD,WS),this.filterType="date",this.FilterModelFormatterClass=_D}comparator(){return this.params.filterParams.comparator??x6}isValid(e){const t=this.params.filterParams.isValidDate;return!t||t(e)}},LD=class extends ct{constructor(){super(...arguments),this.defaultDebounceMs=0}setLastTypeFromModel(e){if(!e){this.lastType=this.optionsFactory.defaultOption;return}const t=e.operator;let i;t?i=e.conditions[0]:i=e,this.lastType=i.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;const i=e;return this.isTypeEditable(i.type)}init(e){this.params=e;const t=this.gos.get("enableFilterHandlers");if(this.reactive=t,this.setParams(e),t){const i=e;this.onModelUpdated(i.model)}}setParams(e){const t=new VS;this.optionsFactory=t,t.init(e.filterParams,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(t,e.filterParams)),this.setSimpleParams(e,!1)}setSimpleParams(e,t=!0){const i=this.optionsFactory.defaultOption;t||(this.lastType=i),this.readOnly=!!e.filterParams.readOnly;const s=this.isTypeEditable(i);this.setEditable(s)}refresh(e){this.params=e;const t=e,i=this.reactive;if((!i||t.source==="colDef")&&this.updateParams(e),i){const{source:s,model:n}=t;if(s==="dataChanged"||s==="ui")return;this.onModelUpdated(n)}}updateParams(e){const t=this.optionsFactory;t.refresh(e.filterParams,this.defaultOptions),this.setSimpleParams(e),this.filterModelFormatter.updateParams({optionsFactory:t,filterParams:e.filterParams})}onParentModelChanged(e,t){t!=null&&t.afterFloatingFilter||t!=null&&t.afterDataChange||this.onModelUpdated(e)}hasSingleInput(e){var i;const t=(i=this.optionsFactory.getCustomOption(e))==null?void 0:i.numberOfInputs;return t==null||t==1}isTypeEditable(e){const t=["inRange","empty","blank","notBlank"];return!!e&&!this.readOnly&&this.hasSingleInput(e)&&t.indexOf(e)<0}getAriaLabel(e){return`${this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0)} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},A6={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eReadOnlyText"},{tag:"div",ref:"eDateWrapper",cls:"ag-date-floating-filter-wrapper"}]},F6=class extends LD{constructor(){super(A6,[Vv]),this.eReadOnlyText=se,this.eDateWrapper=se,this.FilterModelFormatterClass=_D,this.filterType="date",this.defaultOptions=WS}setParams(e){super.setParams(e),this.createDateComponent();const t=this.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}updateParams(e){super.updateParams(e),this.dateComp.updateParams(this.getDateComponentParams()),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){const t=!this.readOnly&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){const i=e?vs(e.dateFrom):null;this.dateComp.setDate(i),this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){xt(this.eDateWrapper,e),xt(this.eReadOnlyText.getGui(),!e)}onModelUpdated(e){super.setLastTypeFromModel(e),this.updateCompOnModelChange(e)}onDateChanged(){const e=this.dateComp.getDate();if(this.reactive){const t=this.params;t.onUiChange();const i=t.model,s=Os(e),n=s==null?null:{...i??{filterType:this.filterType,type:this.lastType??this.optionsFactory.defaultOption},dateFrom:s};t.onModelChange(n,{afterFloatingFilter:!0})}else this.params.parentFilterInstance(t=>{t==null||t.onFloatingFilterChanged(this.lastType||null,e)})}getDateComponentParams(){const{filterParams:e}=this.params,t=FS(e,this.defaultDebounceMs);return Fe(this.gos,{onDateChanged:Pi(this,this.onDateChanged.bind(this),t),filterParams:e,location:"floatingFilter"})}createDateComponent(){const{beans:{context:e,userCompFactory:t},eDateWrapper:i,params:s}=this;this.dateComp=new TD(e,t,s.column.getColDef(),this.getDateComponentParams(),i,n=>{n.setInputAriaLabel(this.getAriaLabel(s))}),this.addDestroyFunc(()=>this.dateComp.destroy())}},P6={tag:"div",cls:"ag-filter-filter",children:[{tag:"ag-input-text-field",ref:"eDateInput",cls:"ag-date-filter"}]},T6=class extends ct{constructor(){super(P6,[Vv]),this.eDateInput=se,this.isApply=!1,this.applyOnFocusOut=!1}init(e){this.params=e,this.setParams(e);const t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus({preventScroll:!0})},input:this.handleInput.bind(this,!1),change:this.handleInput.bind(this,!0),focusout:this.handleFocusOut.bind(this)})}handleInput(e){if(!this.eDateInput.isDisabled()){if(this.isApply){this.applyOnFocusOut=!e,e&&this.params.onDateChanged();return}e||this.params.onDateChanged()}}handleFocusOut(){this.applyOnFocusOut&&(this.applyOnFocusOut=!1,this.params.onDateChanged())}setParams(e){var u;const t=this.eDateInput.getInputElement(),i=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=i&&Xa();const{minValidYear:s,maxValidYear:n,minValidDate:o,maxValidDate:r,buttons:a,includeTime:l,colDef:c}=e.filterParams||{},d=this.beans.dataTypeSvc,h=l??((u=d==null?void 0:d.getDateIncludesTimeFlag)==null?void 0:u.call(d,c.cellDataType))??!1;if(i?h?(t.type="datetime-local",t.step="1"):t.type="date":t.type="text",o&&s&&j(85),r&&n&&j(86),o&&r){const[f,p]=[o,r].map(m=>m instanceof Date?m:vs(m));f&&p&&f.getTime()>p.getTime()&&j(87)}o?o instanceof Date?t.min=Qb(o):t.min=o:s&&(t.min=`${s}-01-01`),r?r instanceof Date?t.max=Qb(r):t.max=r:n&&(t.max=`${n}-12-31`),this.isApply=e.location==="floatingFilter"&&!!(a!=null&&a.includes("apply"))}refresh(e){this.params=e,this.setParams(e)}getDate(){return vs(this.eDateInput.getValue())}setDate(e){var s;const t=this.params.filterParams.colDef.cellDataType,i=((s=this.beans.dataTypeSvc)==null?void 0:s.getDateIncludesTimeFlag(t))??!1;this.eDateInput.setValue(Os(e,i))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){e!=null&&e.suppressFocus||this.eDateInput.getInputElement().focus({preventScroll:!0})}shouldUseBrowserDatePicker(e){var t;return((t=e==null?void 0:e.filterParams)==null?void 0:t.browserDatePicker)??!0}},US=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"];function py(e){const{allowedCharPattern:t}=e??{};return t??null}function my(e){return e==null||isNaN(e)?null:e}function OD(e,t){const{filter:i,filterTo:s,type:n}=e||{};return[my(i),my(s)].slice(0,Cg(n,t))}var D6=class extends zS{constructor(){super("numberFilter",OD,US),this.eValuesFrom=[],this.eValuesTo=[],this.filterType="number",this.defaultDebounceMs=500}setElementValue(e,t,i){const{numberFormatter:s}=this.params,n=!i&&s?s(t??null):t;super.setElementValue(e,n)}createEValue(){const e=py(this.params),t=jt({tag:"div",cls:"ag-filter-body",role:"presentation"});return this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,i,s){const n=this.createManagedBean(s?new qc({allowedCharPattern:s}):new yS);n.addCss(`ag-filter-${i}`),n.addCss("ag-filter-filter"),t.push(n),e.appendChild(n.getGui())}removeEValues(e,t){const i=s=>this.removeComponents(s,e,t);i(this.eValuesFrom),i(this.eValuesTo)}getValues(e){const t=[];return this.forEachPositionInput(e,(i,s,n,o)=>{s<o&&t.push(my(this.stringToFloat(i.getValue())))}),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}stringToFloat(e){if(typeof e=="number")return e;let t=br(e);t!=null&&t.trim()===""&&(t=null);const i=this.params.numberParser;return i?i(t):t==null||t.trim()==="-"?null:Number.parseFloat(t)}createCondition(e){const t=this.getConditionType(e),i={filterType:this.filterType,type:t},s=this.getValues(e);return s.length>0&&(i.filter=s[0]),s.length>1&&(i.filterTo=s[1]),i}getInputs(e){const{eValuesFrom:t,eValuesTo:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>{t.getInputElement().validity.valid||(e=!0)}),e}},ND=class extends $S{constructor(e,t){super(e,t,t.numberFormatter),this.filterTypeKeys=kD}conditionToString(e,t,i,s,n){const{filter:o,filterTo:r,type:a}=e,l=this.formatValue.bind(this);if(t){const c=this.conditionForToolPanel(a,i,()=>l(o),()=>l(r),s,n);if(c!=null)return c}return i?`${l(o)}-${l(r)}`:o!=null?l(o):`${a}`}},M6=class extends ID{constructor(){super(OD,US),this.filterType="number",this.FilterModelFormatterClass=ND}comparator(){return(e,t)=>e===t?0:e<t?1:-1}isValid(e){return!isNaN(e)}},HD=class extends V{constructor(e){super(),this.params=e,this.eInput=se,this.onValueChanged=()=>{}}setupGui(e){var s;this.eInput=this.createManagedBean(new qc((s=this.params)==null?void 0:s.config));const t=this.eInput.getGui();e.appendChild(t);const i=n=>this.onValueChanged(n);this.addManagedListeners(t,{input:i,keydown:i})}setEditable(e){this.eInput.setDisabled(!e)}getValue(){return this.eInput.getValue()}setValue(e,t){this.eInput.setValue(e,t)}setValueChangedListener(e){this.onValueChanged=e}setParams({ariaLabel:e,autoComplete:t}){const{eInput:i}=this;i.setInputAriaLabel(e),t!==void 0&&i.setAutoComplete(t)}};function vy(e){const t=e==null?void 0:e.trim();return t===""?e:t}function GD(e,t){const{filter:i,filterTo:s,type:n}=e||{};return[i||null,s||null].slice(0,Cg(n,t))}var I6={tag:"div",ref:"eFloatingFilterInputContainer",cls:"ag-floating-filter-input",role:"presentation"},BD=class extends LD{constructor(){super(...arguments),this.eFloatingFilterInputContainer=se,this.defaultDebounceMs=500}postConstruct(){this.setTemplate(I6)}onModelUpdated(e){this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.inputSvc.setValue(this.filterModelFormatter.getModelAsString(e))}setParams(e){this.setupFloatingFilterInputService(e),super.setParams(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.inputSvc=this.createFloatingFilterInputService(e),this.inputSvc.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){const t=e.browserAutoComplete??!1,{inputSvc:i,defaultDebounceMs:s,readOnly:n}=this;if(i.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:t}),this.applyActive=Wv(e.filterParams),!n){const o=FS(e.filterParams,s),r=Pi(this,this.syncUpWithParentFilter.bind(this),o);i.setValueChangedListener(r)}}updateParams(e){super.updateParams(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){const{inputSvc:t}=this,i=t.getValue();Mi(this.eFloatingFilterInputContainer),this.destroyBean(t),this.setupFloatingFilterInputService(e),t.setValue(i,!0)}syncUpWithParentFilter(e){const t=e.key===H.ENTER,i=this.reactive;if(i&&this.params.onUiChange(),this.applyActive&&!t)return;const{inputSvc:s,params:n,lastType:o}=this;let r=s.getValue();if(n.filterParams.trimInput&&(r=vy(r),s.setValue(r,!0)),i){const a=n,l=a.model,c=this.convertValue(r),d=c==null?null:{...l??{filterType:this.filterType,type:o??this.optionsFactory.defaultOption},filter:c};a.onModelChange(d,{afterFloatingFilter:!0})}else n.parentFilterInstance(a=>{a==null||a.onFloatingFilterChanged(o||null,r||null)})}convertValue(e){return e||null}setEditable(e){this.inputSvc.setEditable(e)}},k6=class extends V{constructor(){super(...arguments),this.onValueChanged=()=>{},this.numberInputActive=!0}setupGui(e){this.eNumberInput=this.createManagedBean(new yS),this.eTextInput=this.createManagedBean(new qc),this.eTextInput.setDisabled(!0);const t=this.eNumberInput.getGui(),i=this.eTextInput.getGui();e.appendChild(t),e.appendChild(i),this.setupListeners(t,s=>this.onValueChanged(s)),this.setupListeners(i,s=>this.onValueChanged(s))}setEditable(e){this.numberInputActive=e,this.eNumberInput.setDisplayed(this.numberInputActive),this.eTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eNumberInput.setAutoComplete(e),this.eTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eNumberInput:this.eTextInput}setValueChangedListener(e){this.onValueChanged=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams(e){this.setAriaLabel(e.ariaLabel),e.autoComplete!==void 0&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eNumberInput.setInputAriaLabel(e),this.eTextInput.setInputAriaLabel(e)}},_6=class extends BD{constructor(){super(...arguments),this.FilterModelFormatterClass=ND,this.filterType="number",this.defaultOptions=US}updateParams(e){py(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.updateParams(e)}createFloatingFilterInputService(e){return this.allowedCharPattern=py(e.filterParams),this.allowedCharPattern?this.createManagedBean(new HD({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new k6)}convertValue(e){return e?Number(e):null}},jS=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],L6=class extends zS{constructor(){super("textFilter",GD,jS),this.filterType="text",this.eValuesFrom=[],this.eValuesTo=[],this.defaultDebounceMs=500}createCondition(e){const t=this.getConditionType(e),i={filterType:this.filterType,type:t},s=this.getValues(e);return s.length>0&&(i.filter=s[0]),s.length>1&&(i.filterTo=s[1]),i}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){const{eValuesFrom:t,eValuesTo:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}getValues(e){const t=[];return this.forEachPositionInput(e,(i,s,n,o)=>{s<o&&t.push(br(i.getValue()))}),t}createEValue(){const e=jt({tag:"div",cls:"ag-filter-body",role:"presentation"}),{eValuesFrom:t,eValuesTo:i}=this;return this.createFromToElement(e,t,"from"),this.createFromToElement(e,i,"to"),e}createFromToElement(e,t,i){const s=this.createManagedBean(new qc);s.addCss(`ag-filter-${i}`),s.addCss("ag-filter-filter"),t.push(s),e.appendChild(s.getGui())}removeEValues(e,t){const i=o=>this.removeComponents(o,e,t),{eValuesFrom:s,eValuesTo:n}=this;i(s),i(n)}},VD=class extends $S{constructor(){super(...arguments),this.filterTypeKeys=R6}conditionToString(e,t,i,s,n){const{filter:o,filterTo:r,type:a}=e;if(t){const l=d=>()=>Yr(this,"filterSummaryTextQuote",[d]),c=this.conditionForToolPanel(a,i,l(o),l(r),s,n);if(c!=null)return c}return i?`${o}-${r}`:o!=null?`${o}`:`${a}`}},O6=({filterOption:e,value:t,filterText:i})=>{if(i==null)return!1;switch(e){case"contains":return t.includes(i);case"notContains":return!t.includes(i);case"equals":return t===i;case"notEqual":return t!=i;case"startsWith":return t.indexOf(i)===0;case"endsWith":{const s=t.lastIndexOf(i);return s>=0&&s===t.length-i.length}default:return!1}},N6=e=>e,H6=e=>e==null?null:e.toString().toLowerCase(),G6=class extends MD{constructor(){super(GD,jS),this.filterType="text",this.FilterModelFormatterClass=VD}updateParams(e){super.updateParams(e);const t=e.filterParams;this.matcher=t.textMatcher??O6,this.formatter=t.textFormatter??(t.caseSensitive?N6:H6)}evaluateNullValue(e){return e?["notEqual","notContains","blank"].indexOf(e)>=0:!1}evaluateNonNullValue(e,t,i,s){const n=e.map(u=>this.formatter(u))||[],o=this.formatter(t),{api:r,colDef:a,column:l,context:c,filterParams:{textFormatter:d}}=this.params;if(i.type==="blank")return Qm(t);if(i.type==="notBlank")return!Qm(t);const h={api:r,colDef:a,column:l,context:c,node:s.node,data:s.data,filterOption:i.type,value:o,textFormatter:d};return n.some(u=>this.matcher({...h,filterText:u}))}processModelToApply(e){if(e&&this.params.filterParams.trimInput){const t=i=>{const s={...i},{filter:n,filterTo:o}=i;return n&&(s.filter=vy(n)??null),o&&(s.filterTo=vy(o)??null),s};return _T(e)?{...e,conditions:e.conditions.map(t)}:t(e)}return e}},B6=class extends BD{constructor(){super(...arguments),this.FilterModelFormatterClass=VD,this.filterType="text",this.defaultOptions=jS}createFloatingFilterInputService(){return this.createManagedBean(new HD)}};function V6(e){var t;return!!((t=e.quickFilter)!=null&&t.isFilterPresent())}function z6(e){var t;return(t=e.quickFilter)==null?void 0:t.getText()}function W6(e){var t;(t=e.quickFilter)==null||t.resetCache()}var $6=class extends V{constructor(){super(...arguments),this.beanName="quickFilter",this.quickFilter=null,this.quickFilterParts=null}postConstruct(){const e=this.resetCache.bind(this),t=this.gos;this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{t.get("includeHiddenColumnsInQuickFilter")||this.resetCache()}}),this.addManagedPropertyListener("quickFilterText",i=>this.setFilter(i.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onColumnConfigChanged()),this.quickFilter=this.parseFilter(t.get("quickFilterText")),this.parser=t.get("quickFilterParser"),this.matcher=t.get("quickFilterMatcher"),this.setFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setParserAndMatcher())}refreshCols(){var l;const{autoColSvc:e,colModel:t,gos:i,pivotResultCols:s}=this.beans,n=t.isPivotMode(),o=e==null?void 0:e.getColumns(),r=t.getColDefCols();let a=(n&&!i.get("applyQuickFilterBeforePivotOrAgg")?(l=s==null?void 0:s.getPivotResultCols())==null?void 0:l.list:r)??[];o&&(a=a.concat(o)),this.colsToUse=i.get("includeHiddenColumnsInQuickFilter")?a:a.filter(c=>c.isVisible()||c.isRowGroupActive())}isFilterPresent(){return this.quickFilter!==null}doesRowPass(e){const t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassMatcher(t,e):this.quickFilterParts.every(i=>t?this.doesRowPassCache(e,i):this.doesRowPassNoCache(e,i))}resetCache(){this.beans.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}getText(){return this.gos.get("quickFilterText")}setFilterParts(){const{quickFilter:e,parser:t}=this;e?this.quickFilterParts=t?t(e):e.split(" "):this.quickFilterParts=null}parseFilter(e){return ae(e)?e.toUpperCase():null}setFilter(e){if(e!=null&&typeof e!="string"){j(70,{newFilter:e});return}const t=this.parseFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setParserAndMatcher(){const e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),i=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,i&&(this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onColumnConfigChanged(){this.refreshCols(),this.resetCache(),this.isFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassNoCache(e,t){return this.colsToUse.some(i=>{const s=this.getTextForColumn(i,e);return ae(s)&&s.includes(t)})}doesRowPassCache(e,t){return this.checkGenerateAggText(e),e.quickFilterAggregateText.includes(t)}doesRowPassMatcher(e,t){let i;e?(this.checkGenerateAggText(t),i=t.quickFilterAggregateText):i=this.getAggText(t);const{quickFilterParts:s,matcher:n}=this;return n(s,i)}checkGenerateAggText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getAggText(e))}getTextForColumn(e,t){let i=this.beans.filterValueSvc.getValue(e,t);const s=e.getColDef();if(s.getQuickFilterText){const n=Fe(this.gos,{value:i,node:t,data:t.data,column:e,colDef:s});i=s.getQuickFilterText(n)}return ae(i)?i.toString().toUpperCase():null}getAggText(e){const t=[];for(const i of this.colsToUse){const s=this.getTextForColumn(i,e);ae(s)&&t.push(s)}return t.join(`
`)}},U6={moduleName:"ClientSideRowModelFilter",version:ne,rowModels:["clientSide"],beans:[j4]},KS={moduleName:"FilterCore",version:ne,beans:[f6],apiFunctions:{isAnyFilterPresent:u6,onFilterChanged:g6},css:[J4],dependsOn:[U6]},zD={moduleName:"FilterValue",version:ne,beans:[m6]},qv={moduleName:"ColumnFilter",version:ne,beans:[h6,p6],dynamicBeans:{headerFilterCellCtrl:K4},icons:{filter:"filter",filterActive:"filter"},apiFunctions:{isColumnFilterPresent:Z4,getColumnFilterInstance:e6,destroyFilter:t6,setFilterModel:i6,getFilterModel:s6,getColumnFilterModel:n6,setColumnFilterModel:o6,showColumnFilter:r6,hideColumnFilter:a6,getColumnFilterHandler:l6,doFilterAction:c6},dependsOn:[KS,Kv,zD,X4]},j6={moduleName:"CustomFilter",version:ne,userComponents:{agReadOnlyFloatingFilter:C6},dependsOn:[qv]},K6={moduleName:"TextFilter",version:ne,dependsOn:[qv],userComponents:{agTextColumnFilter:{classImp:L6,params:{useForm:!0}},agTextColumnFloatingFilter:B6},dynamicBeans:{agTextColumnFilterHandler:G6}},q6={moduleName:"NumberFilter",version:ne,dependsOn:[qv],userComponents:{agNumberColumnFilter:{classImp:D6,params:{useForm:!0}},agNumberColumnFloatingFilter:_6},dynamicBeans:{agNumberColumnFilterHandler:M6}},Y6={moduleName:"DateFilter",version:ne,dependsOn:[qv],userComponents:{agDateColumnFilter:{classImp:S6,params:{useForm:!0}},agDateInput:T6,agDateColumnFloatingFilter:F6},dynamicBeans:{agDateColumnFilterHandler:E6}},X6={moduleName:"QuickFilterCore",version:ne,rowModels:["clientSide"],beans:[$6],dependsOn:[KS,zD]},Q6={moduleName:"QuickFilter",version:ne,apiFunctions:{isQuickFilterPresent:V6,getQuickFilter:z6,resetQuickFilter:W6},dependsOn:[X6]},J6={moduleName:"ExternalFilter",version:ne,dependsOn:[KS]},Z6=".ag-tooltip{background-color:var(--ag-tooltip-background-color);border:var(--ag-tooltip-border);border-radius:var(--ag-border-radius);color:var(--ag-tooltip-text-color);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;white-space:normal;z-index:99999;&:where(.ag-cell-editor-tooltip){background-color:var(--ag-tooltip-error-background-color);border:var(--ag-tooltip-error-border);color:var(--ag-tooltip-error-text-color);font-weight:500}}.ag-tooltip-custom{position:absolute;z-index:99999}.ag-tooltip-custom:where(:not(.ag-tooltip-interactive)),.ag-tooltip:where(:not(.ag-tooltip-interactive)){pointer-events:none}.ag-tooltip-animate{transition:opacity 1s;&:where(.ag-tooltip-hiding){opacity:0}}",XC=(e,t,i)=>{var a,l,c;const{editModelSvc:s}=e,n=(l=(a=s==null?void 0:s.getCellValidationModel())==null?void 0:a.getCellValidation(t))==null?void 0:l.errorMessages,o=(c=s==null?void 0:s.getRowValidationModel().getRowValidation(t))==null?void 0:c.errorMessages,r=n||o;return r!=null&&r.length?r.join(i("tooltipValidationErrorSeparator",". ")):void 0},ej=class extends V{constructor(){super(...arguments),this.beanName="tooltipSvc"}setupHeaderTooltip(e,t,i,s){e&&t.destroyBean(e);const n=this.gos,o=YC(n),{column:r,eGui:a}=t,l=r.getColDef();!s&&o&&!l.headerComponent&&(s=rm(()=>a.querySelector(".ag-header-cell-text")));const c="header",h=this.beans.colNames.getDisplayNameForColumn(r,"header",!0),u=i??h,f={getGui:()=>a,getLocation:()=>c,getTooltipValue:()=>{var m;return i??((m=l==null?void 0:l.headerTooltipValueGetter)==null?void 0:m.call(l,Fe(n,{location:c,colDef:l,column:r,value:u,valueFormatted:h})))??(l==null?void 0:l.headerTooltip)},shouldDisplayTooltip:s,getAdditionalParams:()=>({column:r,colDef:r.getColDef()})};let p=this.createTooltipFeature(f);return p&&(p=t.createBean(p),t.setRefreshFunction("tooltip",()=>p.refreshTooltip())),p}setupHeaderGroupTooltip(e,t,i,s){e&&t.destroyBean(e);const n=this.gos,o=YC(n),{column:r,eGui:a}=t,l=r.getColGroupDef();!s&&o&&!(l!=null&&l.headerGroupComponent)&&(s=rm(()=>a.querySelector(".ag-header-group-text")));const c="headerGroup",h=this.beans.colNames.getDisplayNameForColumnGroup(r,"header"),u=i??h,f={getGui:()=>a,getLocation:()=>c,getTooltipValue:()=>{var m;return i??((m=l==null?void 0:l.headerTooltipValueGetter)==null?void 0:m.call(l,Fe(n,{location:c,colDef:l,column:r,value:u,valueFormatted:h})))??(l==null?void 0:l.headerTooltip)},shouldDisplayTooltip:s,getAdditionalParams:()=>{const m={column:r};return l&&(m.colDef=l),m}},p=this.createTooltipFeature(f);return p&&t.createBean(p)}enableCellTooltipFeature(e,t,i){const{beans:s}=this,{gos:n,editSvc:o}=s,{column:r,rowNode:a}=e;let l="cell";const c=()=>{const f=!!!(o!=null&&o.isEditing(e))&&XC(s,e,this.getLocaleTextFunc());if(f)return l="cellEditor",f;l="cell";const p=r.getColDef(),m=a.data;if(p.tooltipField&&ae(m))return qu(m,p.tooltipField,r.isTooltipFieldContainsDots());const v=p.tooltipValueGetter;return v?v(Fe(n,{location:"cell",colDef:r.getColDef(),column:r,rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,value:e.value,valueFormatted:e.valueFormatted})):null},d=YC(n);i||(d&&!e.isCellRenderer()?i=()=>{const u=!!(o!=null&&o.isEditing(e));if(!u&&XC(s,e,this.getLocaleTextFunc()))return!0;if(!r.isTooltipEnabled())return!1;const m=rm(()=>{const v=e.eGui;return v.children.length===0?v:v.querySelector(".ag-cell-value")});return!u&&m()}:i=()=>!(o!=null&&o.isEditing(e)));const h={getGui:()=>e.eGui,getLocation:()=>l,getTooltipValue:t!=null?()=>t:c,shouldDisplayTooltip:i,getAdditionalParams:()=>({column:r,colDef:r.getColDef(),rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,valueFormatted:e.valueFormatted})};return this.createTooltipFeature(h,s)}setupFullWidthRowTooltip(e,t,i,s){const n={getGui:()=>t.getFullWidthElement(),getTooltipValue:()=>i,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:s},o=this.beans,r=o.context;e&&t.destroyBean(e,r);const a=this.createTooltipFeature(n,o);if(a)return t.createBean(a,r)}setupCellEditorTooltip(e,t){var a,l;const{beans:i}=this,{context:s}=i,n=((a=t.getValidationElement)==null?void 0:a.call(t,!0))||!((l=t.isPopup)!=null&&l.call(t))&&e.eGui;if(!n)return;const o={getGui:()=>n,getTooltipValue:()=>XC(i,e,this.getLocaleTextFunc()),getLocation:()=>"cellEditor",shouldDisplayTooltip:()=>{var p,m;const{editModelSvc:c}=i,d=(p=c==null?void 0:c.getRowValidationModel())==null?void 0:p.getRowValidationMap(),h=(m=c==null?void 0:c.getCellValidationModel())==null?void 0:m.getCellValidationMap(),u=!!d&&d.size>0,f=!!h&&h.size>0;return u||f}},r=this.createTooltipFeature(o,i);if(r)return e.createBean(r,s)}initCol(e){const{colDef:t}=e;e.tooltipEnabled=ae(t.tooltipField)||ae(t.tooltipValueGetter)||ae(t.tooltipComponent)}createTooltipFeature(e,t){return this.beans.registry.createDynamicBean("tooltipFeature",!1,e,t)}},tj=class extends xB{createTooltipComp(e,t){const i=m2(this.beans.userCompFactory,e);i==null||i.newAgStackInstance().then(t)}setEventHandlers(e){[this.onColumnMovedEventCallback]=this.addManagedEventListeners({columnMoved:e})}clearEventHandlers(){var e;(e=this.onColumnMovedEventCallback)==null||e.call(this),this.onColumnMovedEventCallback=void 0}},WD={moduleName:"Tooltip",version:ne,beans:[ej],dynamicBeans:{tooltipFeature:xT,highlightTooltipFeature:EB,tooltipStateManager:tj},userComponents:{agTooltipComponent:PB},dependsOn:[Kv],css:[Z6]},dd=class{constructor(e){this.cellValueChanges=e}},QC=class extends dd{constructor(e,t,i,s){super(e),this.initialRange=t,this.finalRange=i,this.ranges=s}},ij=10,fx=class{constructor(e){this.actionStack=[],this.maxStackSize=e||ij,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}},sj=class extends V{constructor(){super(...arguments),this.beanName="undoRedo",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.batchEditing=!1,this.bulkEditing=!1,this.onCellValueChanged=e=>{const t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},i=this.activeCellEdit!==null&&eD(this.activeCellEdit,t),s=this.activeRowEdit!==null&&EW(this.activeRowEdit,t);if(!(i||s||this.isPasting||this.isRangeInAction))return;const{rowPinned:o,rowIndex:r,column:a,oldValue:l,value:c}=e,d={rowPinned:o,rowIndex:r,columnId:a.getColId(),newValue:c,oldValue:l};this.cellValueChanges.push(d)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}postConstruct(){const{gos:e,ctrlsSvc:t}=this.beans;if(!e.get("undoRedoCellEditing"))return;const i=e.get("undoRedoCellEditingLimit");if(i<=0)return;this.undoStack=new fx(i),this.redoStack=new fx(i),this.addListeners();const s=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:n=>{n.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:s,newColumnsLoaded:s,columnGroupOpened:s,columnRowGroupChanged:s,columnMoved:s,columnPinned:s,columnVisible:s,rowDragEnd:s}),t.whenReady(this,n=>{this.gridBodyCtrl=n.gridBodyCtrl})}getCurrentUndoStackSize(){var e;return((e=this.undoStack)==null?void 0:e.getCurrentStackSize())??0}getCurrentRedoStackSize(){var e;return((e=this.redoStack)==null?void 0:e.getCurrentStackSize())??0}undo(e){const{eventSvc:t,undoStack:i,redoStack:s}=this;t.dispatchEvent({type:"undoStarted",source:e});const n=this.undoRedo(i,s,"initialRange","oldValue","undo");t.dispatchEvent({type:"undoEnded",source:e,operationPerformed:n})}redo(e){const{eventSvc:t,undoStack:i,redoStack:s}=this;t.dispatchEvent({type:"redoStarted",source:e});const n=this.undoRedo(s,i,"finalRange","newValue","redo");t.dispatchEvent({type:"redoEnded",source:e,operationPerformed:n})}undoRedo(e,t,i,s,n){if(!e)return!1;const o=e.pop();return o!=null&&o.cellValueChanges?(this.processAction(o,r=>r[s],n),o instanceof QC?this.processRange(o.ranges||[o[i]]):this.processCell(o.cellValueChanges),t.push(o),!0):!1}processAction(e,t,i){for(const s of e.cellValueChanges){const{rowIndex:n,rowPinned:o,columnId:r}=s,a={rowIndex:n,rowPinned:o},l=Dr(this.beans,a);l.displayed&&l.setDataValue(r,t(s),i)}}processRange(e){let t;const i=this.beans.rangeSvc;i.removeAllCellRanges(!0),e.forEach((s,n)=>{if(!s)return;const o=s.startRow,r=s.endRow;n===e.length-1&&(t={rowPinned:o.rowPinned,rowIndex:o.rowIndex,columnId:s.startColumn.getColId()},this.setLastFocusedCell(t));const a={rowStartIndex:o.rowIndex,rowStartPinned:o.rowPinned,rowEndIndex:r.rowIndex,rowEndPinned:r.rowPinned,columnStart:s.startColumn,columns:s.columns};i.addCellRange(a)})}processCell(e){const t=e[0],{rowIndex:i,rowPinned:s}=t,n={rowIndex:i,rowPinned:s},o=Dr(this.beans,n),r={rowPinned:t.rowPinned,rowIndex:o.rowIndex,columnId:t.columnId};this.setLastFocusedCell(r)}setLastFocusedCell(e){const{rowIndex:t,columnId:i,rowPinned:s}=e,{colModel:n,focusSvc:o,rangeSvc:r}=this.beans,a=n.getCol(i);if(!a)return;const{scrollFeature:l}=this.gridBodyCtrl;l.ensureIndexVisible(t),l.ensureColumnVisible(a);const c={rowIndex:t,column:a,rowPinned:s};o.setFocusedCell({...c,forceBrowserFocus:!0}),r==null||r.setRangeToCell(c)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{const e=new dd(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const i=new dd(this.cellValueChanges);this.pushActionsToUndoStack(i)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{const e=new dd(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{const t=new QC(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e;const{rangeSvc:t,gos:i}=this.beans;t&&Tr(i)?e=new QC(this.cellValueChanges,void 0,void 0,[...t.getCellRanges()]):e=new dd(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1},batchEditingStarted:()=>this.startBigChange("batchEditing"),batchEditingStopped:({changes:e})=>this.stopBigChange("batchEditing",e),bulkEditingStarted:()=>this.startBigChange("bulkEditing"),bulkEditingStopped:({changes:e})=>this.stopBigChange("bulkEditing",e)})}startBigChange(e){this.updateBigChange(e,!0)}updateBigChange(e,t){e==="bulkEditing"?this.bulkEditing=t:this.batchEditing=t}stopBigChange(e,t){if(e==="bulkEditing"&&!this.bulkEditing||e==="batchEditing"&&!this.batchEditing||(this.updateBigChange(e,!1),(t==null?void 0:t.length)===0))return;const i=new dd(t??[]);this.pushActionsToUndoStack(i),this.cellValueChanges=[]}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}},nj=".ag-cell-inline-editing{border:var(--ag-cell-editing-border)!important;border-radius:var(--ag-border-radius);box-shadow:var(--ag-cell-editing-shadow);padding:0;z-index:1;.ag-cell-edit-wrapper,.ag-cell-editor,.ag-cell-wrapper,:where(.ag-cell-editor) .ag-input-field-input,:where(.ag-cell-editor) .ag-wrapper{height:100%;line-height:normal;min-height:100%;width:100%}&.ag-cell-editing-error{border-color:var(--ag-invalid-color)!important}}:where(.ag-popup-editor) .ag-large-text{background-color:var(--ag-background-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);padding:0}.ag-large-text-input{display:block;height:auto;padding:var(--ag-cell-horizontal-padding)}:where(.ag-rtl .ag-large-text-input) textarea{resize:none}:where(.ag-ltr) .ag-checkbox-edit{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-checkbox-edit{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-row.ag-row-editing-invalid .ag-cell-inline-editing){opacity:.8}.ag-popup-editor{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}",oj={tag:"div",cls:"ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit",children:[{tag:"ag-checkbox",ref:"eEditor",role:"presentation"}]},rj=class extends Uv{constructor(){super(oj,[bS]),this.eEditor=se}initialiseEditor(e){const t=e.value??void 0,i=this.eEditor;i.setValue(t),i.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(t),this.addManagedListeners(i,{fieldValueChanged:n=>this.setAriaLabel(n.selected)})}getValue(){return this.eEditor.getValue()}focusIn(){this.eEditor.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){const t=this.getLocaleTextFunc(),i=Gv(t,e),s=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eEditor.setInputAriaLabel(`${s} (${i})`)}getValidationElement(e){return e?this.params.eGridCell:this.eEditor.getInputElement()}getValidationErrors(){const{params:e}=this,{getValidationErrors:t}=e,i=this.getValue();return t?t({value:i,internalErrors:null,cellEditorParams:e}):null}},Yv=class extends Uv{constructor(e){super(),this.cellEditorInput=e,this.eEditor=se}initialiseEditor(e){const{cellEditorInput:t}=this;this.setTemplate({tag:"div",cls:"ag-cell-edit-wrapper",children:[t.getTemplate()]},t.getAgComponents());const{eEditor:i}=this,{cellStartedEdit:s,eventKey:n,suppressPreventDefault:o}=e;i.getInputElement().setAttribute("title",""),t.init(i,e);let r,a=!0;s?(this.focusAfterAttached=!0,n===H.BACKSPACE||n===H.DELETE?r="":n&&n.length===1?o?a=!1:r=n:(r=t.getStartValue(),n!==H.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,r=t.getStartValue()),a&&r!=null&&i.setStartValue(r),this.addGuiEventListener("keydown",l=>{const{key:c}=l;(c===H.PAGE_UP||c===H.PAGE_DOWN)&&l.preventDefault()})}afterGuiAttached(){var s,n;const e=this.getLocaleTextFunc(),t=this.eEditor;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;Xa()||t.getFocusableElement().focus();const i=t.getInputElement();this.highlightAllOnFocus?i.select():(n=(s=this.cellEditorInput).setCaret)==null||n.call(s)}focusIn(){const{eEditor:e}=this,t=e.getFocusableElement(),i=e.getInputElement();t.focus(),i.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){return this.cellEditorInput.getValidationErrors()}},aj={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},lj=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return aj}getAgComponents(){return[pT]}init(e,t){var r,a;this.eEditor=e,this.params=t;const{min:i,max:s,step:n,colDef:o}=t;i!=null&&e.setMin(i),s!=null&&e.setMax(s),n!=null&&e.setStep(n),this.includeTime=t.includeTime??((a=(r=this.getDataTypeService())==null?void 0:r.getDateIncludesTimeFlag)==null?void 0:a.call(r,o.cellDataType)),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){const t=this.eEditor.getInputElement().valueAsDate,{params:i}=this,{min:s,max:n,getValidationErrors:o}=i;let r=[];const a=this.getLocaleTextFunc();if(t instanceof Date&&!isNaN(t.getTime())){if(s){const l=s instanceof Date?s:new Date(s);if(t<l){const c=l.toLocaleDateString();r.push(a("minDateValidation",`Date must be after ${c}`,[c]))}}if(n){const l=n instanceof Date?n:new Date(n);if(t>l){const c=l.toLocaleDateString();r.push(a("maxDateValidation",`Date must be before ${c}`,[c]))}}}return r.length||(r=null),o?o({value:t,cellEditorParams:i,internalErrors:r}):r}getValue(){const{eEditor:e,params:t}=this,i=e.getDate();return!ae(i)&&!ae(t.value)?t.value:i??null}getStartValue(){const{value:e}=this.params;if(e instanceof Date)return Os(e,this.includeTime??!1)}},cj=class extends Yv{constructor(){super(new lj(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},dj={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},hj=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return dj}getAgComponents(){return[pT]}init(e,t){var r,a;this.eEditor=e,this.params=t;const{min:i,max:s,step:n,colDef:o}=t;i!=null&&e.setMin(i),s!=null&&e.setMax(s),n!=null&&e.setStep(n),this.includeTime=t.includeTime??((a=(r=this.getDataTypeService())==null?void 0:r.getDateIncludesTimeFlag)==null?void 0:a.call(r,o.cellDataType)),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){const{eEditor:e,params:t}=this,i=e.getInputElement().value,s=this.formatDate(this.parseDate(i??void 0)),{min:n,max:o,getValidationErrors:r}=t;let a=[];if(s){const l=new Date(s),c=this.getLocaleTextFunc();if(n){const d=new Date(n);if(l<d){const h=d.toLocaleDateString();a.push(c("minDateValidation",`Date must be after ${h}`,[h]))}}if(o){const d=new Date(o);if(l>d){const h=d.toLocaleDateString();a.push(c("maxDateValidation",`Date must be before ${h}`,[h]))}}}return a.length||(a=null),r?r({value:this.getValue(),cellEditorParams:t,internalErrors:a}):a}getValue(){const{params:e,eEditor:t}=this,i=this.formatDate(t.getDate());return!ae(i)&&!ae(e.value)?e.value:e.parseValue(i??"")}getStartValue(){return Os(this.parseDate(this.params.value??void 0)??null,this.includeTime??!1)}parseDate(e){const t=this.getDataTypeService();return t?t.getDateParserFunction(this.params.column)(e):vs(e)??void 0}formatDate(e){const t=this.getDataTypeService();return t?t.getDateFormatterFunction(this.params.column)(e):Os(e??null,this.includeTime??!1)??void 0}},uj=class extends Yv{constructor(){super(new hj(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},gj={tag:"div",cls:"ag-large-text",children:[{tag:"ag-input-text-area",ref:"eEditor",cls:"ag-large-text-input"}]},fj=class extends Uv{constructor(){super(gj,[_2]),this.eEditor=se}initialiseEditor(e){const{eEditor:t}=this,{cellStartedEdit:i,eventKey:s,maxLength:n,cols:o,rows:r}=e;this.focusAfterAttached=i,t.getInputElement().setAttribute("title",""),t.setMaxLength(n||200).setCols(o||60).setRows(r||10);let a;i?(this.focusAfterAttached=!0,s===H.BACKSPACE||s===H.DELETE?a="":s&&s.length===1?a=s:(a=this.getStartValue(e),s!==H.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,a=this.getStartValue(e)),a!=null&&t.setValue(a,!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}getStartValue(e){const{value:t}=e;return(t==null?void 0:t.toString())??t}onKeyDown(e){const t=e.key;(t===H.LEFT||t===H.UP||t===H.RIGHT||t===H.DOWN||e.shiftKey&&t===H.ENTER)&&e.stopPropagation()}afterGuiAttached(){const{eEditor:e,focusAfterAttached:t,highlightAllOnFocus:i}=this,s=this.getLocaleTextFunc();e.setInputAriaLabel(s("ariaInputEditor","Input Editor")),t&&(e.getFocusableElement().focus(),i&&e.getInputElement().select())}getValue(){const{eEditor:e,params:t}=this,{value:i}=t,s=e.getValue();return!ae(s)&&!ae(i)?i:t.parseValue(s)}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){const{params:e}=this,{maxLength:t,getValidationErrors:i}=e,s=this.getLocaleTextFunc(),n=this.getValue();let o=[];return typeof n=="string"&&t!=null&&n.length>t&&o.push(s("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),o.length||(o=null),i?i({value:n,internalErrors:o,cellEditorParams:e}):o}},pj={tag:"ag-input-number-field",ref:"eEditor",cls:"ag-cell-editor"},mj=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return pj}getAgComponents(){return[L2]}init(e,t){this.eEditor=e,this.params=t;const{max:i,min:s,precision:n,step:o}=t;i!=null&&e.setMax(i),s!=null&&e.setMin(s),n!=null&&e.setPrecision(n),o!=null&&e.setStep(o);const r=e.getInputElement();t.preventStepping?e.addManagedElementListeners(r,{keydown:this.preventStepping}):t.showStepperButtons&&r.classList.add("ag-number-field-input-stepper")}getValidationErrors(){const{params:e}=this,{min:t,max:i,getValidationErrors:s}=e,o=this.eEditor.getInputElement().valueAsNumber,r=this.getLocaleTextFunc();let a=[];return typeof o=="number"&&(t!=null&&o<t&&a.push(r("minValueValidation",`Must be greater than or equal to ${t}.`,[String(t)])),i!=null&&o>i&&a.push(r("maxValueValidation",`Must be less than or equal to ${i}.`,[String(i)]))),a.length||(a=null),s?s({value:o,cellEditorParams:e,internalErrors:a}):a}preventStepping(e){(e.key===H.UP||e.key===H.DOWN)&&e.preventDefault()}getValue(){const{eEditor:e,params:t}=this,i=e.getValue();if(!ae(i)&&!ae(t.value))return t.value;let s=t.parseValue(i);if(s==null)return s;if(typeof s=="string"){if(s==="")return null;s=Number(s)}return isNaN(s)?null:s}getStartValue(){return this.params.value}setCaret(){Xa()&&this.eEditor.getInputElement().focus({preventScroll:!0})}},vj=class extends Yv{constructor(){super(new mj(()=>this.getLocaleTextFunc()))}},Cj={tag:"div",cls:"ag-cell-edit-wrapper",children:[{tag:"ag-select",ref:"eEditor",cls:"ag-cell-editor"}]},wj=class extends Uv{constructor(){super(Cj,[j2]),this.eEditor=se,this.startedByEnter=!1}wireBeans(e){this.valueSvc=e.valueSvc}initialiseEditor(e){this.focusAfterAttached=e.cellStartedEdit;const{eEditor:t,valueSvc:i,gos:s}=this,{values:n,value:o,eventKey:r}=e;if(At(n)){j(58);return}this.startedByEnter=r!=null?r===H.ENTER:!1;let a=!1;n.forEach(h=>{const u={value:h},f=i.formatValue(e.column,null,h),p=f!=null;u.text=p?f:h,t.addOption(u),a=a||o===h}),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);const{valueListGap:l,valueListMaxWidth:c,valueListMaxHeight:d}=e;l!=null&&t.setPickerGap(l),d!=null&&t.setPickerMaxHeight(d),c!=null&&t.setPickerMaxWidth(c),s.get("editType")!=="fullRow"&&this.addManagedListeners(this.eEditor,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eEditor.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eEditor.showPicker()})}focusIn(){this.eEditor.getFocusableElement().focus()}getValue(){return this.eEditor.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getAriaElement()}getValidationErrors(){const{params:e}=this,{values:t,getValidationErrors:i}=e,s=this.getValue();let n=[];if(t&&!t.includes(s)){const o=this.getLocaleTextFunc();n.push(o("invalidSelectionValidation","Invalid selection."))}else n=null;return i?i({value:s,internalErrors:n,cellEditorParams:e}):n}},bj={tag:"ag-input-text-field",ref:"eEditor",cls:"ag-cell-editor"},yj=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return bj}getAgComponents(){return[Vv]}init(e,t){this.eEditor=e,this.params=t;const i=t.maxLength;i!=null&&e.setMaxLength(i)}getValidationErrors(){const{params:e}=this,{maxLength:t,getValidationErrors:i}=e,s=this.getValue(),n=this.getLocaleTextFunc();let o=[];return t!=null&&typeof s=="string"&&s.length>t&&o.push(n("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),o.length||(o=null),i?i({value:s,cellEditorParams:e,internalErrors:o}):o}getValue(){const{eEditor:e,params:t}=this,i=e.getValue();return!ae(i)&&!ae(t.value)?t.value:t.parseValue(i)}getStartValue(){const e=this.params;return e.useFormatter||e.column.getColDef().refData?e.formatValue(e.value):e.value}setCaret(){Xa()&&this.eEditor.getInputElement().focus({preventScroll:!0});const e=this.eEditor,t=e.getValue(),i=ae(t)&&t.length||0;i&&e.getInputElement().setSelectionRange(i,i)}},px=class extends Yv{constructor(){super(new yj(()=>this.getLocaleTextFunc()))}};function Sj(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}function Rj(e){return e.ctrlsSvc.getScrollFeature().getHScrollPosition()}function $D(e,t,i="auto"){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureColumnVisible(t,i),"ensureVisible")}function UD(e,t,i){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureIndexVisible(t,i),"ensureVisible")}function xj(e,t,i=null){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureNodeVisible(t,i),"ensureVisible")}function Ej(e){var t;(t=e.undoRedo)==null||t.undo("api")}function Aj(e){var t;(t=e.undoRedo)==null||t.redo("api")}function Fj(e,t){var i;return(i=e.editModelSvc)==null?void 0:i.getEditRowDataValue(t,{checkSiblings:!0})}function Pj(e){var s;const t=(s=e.editModelSvc)==null?void 0:s.getEditMap(),i=[];return t==null||t.forEach((n,o)=>{const{rowIndex:r,rowPinned:a}=o;n.forEach((l,c)=>{const{editorValue:d,pendingValue:h,sourceValue:u,state:f}=l,p=vr(l);let m=d??h;m===rn&&(m=void 0);const v={newValue:m,oldValue:u,state:f,column:c,colId:c.getColId(),colKey:c.getColId(),rowIndex:r,rowPinned:a};(f==="editing"||f==="changed"&&p)&&i.push(v)})}),i}function Tj(e,t=!1){var s;const{editSvc:i}=e;if(i!=null&&i.isBatchEditing()){if(t)for(const n of((s=e.editModelSvc)==null?void 0:s.getEditPositions())??[])n.state==="editing"&&i.revertSingleCellEdit(n);else fl(e,{persist:!0});Dd(e,void 0,{cancel:t})}else i==null||i.stopEditing(void 0,{cancel:t,source:"edit",forceStop:!t,forceCancel:t})}function Dj(e,t){var s;const i=Pt(e,t);return((s=e.editSvc)==null?void 0:s.isEditing(i))??!1}function Mj(e,t){const{key:i,colKey:s,rowIndex:n,rowPinned:o}=t,{editSvc:r,colModel:a}=e,l=a.getCol(s);if(!l){j(12,{colKey:s});return}const d=Dr(e,{rowIndex:n,rowPinned:o||null});if(!d){j(290,{rowIndex:n,rowPinned:o});return}if(!l.isCellEditable(d))return;o==null&&UD(e,n),$D(e,s),r==null||r.startEditing({rowNode:d,column:l},{event:i?new KeyboardEvent("keydown",{key:i}):void 0,source:"api"})}function Ij(e){var t;return((t=e.editSvc)==null?void 0:t.validateEdit())||null}function kj(e){var t;return((t=e.undoRedo)==null?void 0:t.getCurrentUndoStackSize())??0}function _j(e){var t;return((t=e.undoRedo)==null?void 0:t.getCurrentRedoStackSize())??0}var Lj={tag:"div",cls:"ag-popup-editor",attrs:{tabindex:"-1"}},Oj=class extends vS{constructor(e){super(Lj),this.params=e}postConstruct(){Ic(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){const e=this.getGui(),t=this.params,i=s=>{ny(this.gos,s,t.node,t.column,!0)||t.onKeyDown(s)};this.addManagedElementListeners(e,{keydown:i})}};function Nj(e,{column:t},i,s,n="ui"){var c;if(i instanceof KeyboardEvent&&(i.key===H.TAB||i.key===H.ENTER||i.key===H.F2||i.key===H.BACKSPACE&&s))return!0;if((i==null?void 0:i.shiftKey)&&((c=e.rangeSvc)==null?void 0:c.getCellRanges().length)!=0)return!1;const r=t==null?void 0:t.getColDef(),a=Hj(e.gos,r),l=i==null?void 0:i.type;return l==="click"&&(i==null?void 0:i.detail)===1&&a===1||l==="dblclick"&&(i==null?void 0:i.detail)===2&&a===2?!0:n==="api"?s??!1:!1}function Hj(e,t){return e.get("suppressClickEdit")===!0?0:e.get("singleClickEdit")===!0||t!=null&&t.singleClickEdit?1:2}function Cy(e,{rowNode:t,column:i},s="ui"){const n=i.getColDef().editable,o=e.editModelSvc;return i.isColumnFunc(t,n)||!!o&&o.hasEdits({rowNode:t,column:i},{withOpenEditor:!0})}function Gj(e,t,i="ui"){const s=Cy(e,t,i);return s===!0||i==="ui"?s:e.colModel.getCols().some(o=>Cy(e,{rowNode:t.rowNode,column:o},i))}var Jm=(e,t=!1)=>{if(e!==void 0)return vr(e)||t&&e.state==="editing"};function jD(e,t,i=!1){var s;return Jm((s=e.editModelSvc)==null?void 0:s.getEdit(t),i)}var KD=(e,t,i)=>{if(e)for(let s=0,n=e.length;s<n;++s){const o=e[s];if(o.data&&(Jm(t==null?void 0:t.getEdit({rowNode:o,column:i}))||Jm(t==null?void 0:t.getEdit({rowNode:o.pinnedSibling,column:i})))||KD(o.childrenAfterGroup,t,i))return!0}};function qD(e,t){const{column:i,rowNode:s}=t;return e.gos.get("groupTotalRow")&&!(s!=null&&s.footer)?!1:KD(s==null?void 0:s.childrenAfterGroup,e.editModelSvc,i)}function YD(e,{rowNode:t,column:i}){var s;if(t=t.pinnedSibling,!!t)return Jm((s=e.editModelSvc)==null?void 0:s.getEdit({rowNode:t,column:i}))}var Bj=class extends V{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}setComp(e){this.cellComp=e,this.applyCellStyles()}applyCellStyles(){var n;const{cellCtrl:e,editSvc:t,beans:i}=this;if(t!=null&&t.isBatchEditing()&&t.isEditing()){const o=jD(i,e)||qD(i,e)||YD(i,e);this.applyBatchingStyle(o)}else this.applyBatchingStyle(!1);const s=!!((n=this.editModelSvc)!=null&&n.getCellValidationModel().hasCellValidation(this.cellCtrl));this.cellComp.toggleCss("ag-cell-editing-error",s)}applyBatchingStyle(e){var t;this.cellComp.toggleCss("ag-cell-editing",e??!1),this.cellComp.toggleCss("ag-cell-batch-edit",(e&&((t=this.editSvc)==null?void 0:t.isBatchEditing()))??!1)}},Vj=class extends V{constructor(e,t){super(),this.rowCtrl=e,this.beans=t,this.gos=t.gos,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}applyRowStyles(){var r;const{rowCtrl:e,editModelSvc:t,beans:i}=this;let s=e.rowNode,n=t==null?void 0:t.getEditRow(s);const o=(r=this.editModelSvc)==null?void 0:r.getRowValidationModel().hasRowValidation({rowNode:s});if(!n&&s.pinnedSibling&&(s=s.pinnedSibling,n=t==null?void 0:t.getEditRow(s)),n){const a=Array.from(n.keys()).some(l=>{const c={rowNode:s,column:l};return jD(i,c,!0)||qD(i,c)||YD(i,c)});this.applyStyle(o,a);return}this.applyStyle(o)}applyStyle(e=!1,t=!1){var n,o;const i=((n=this.editSvc)==null?void 0:n.isBatchEditing())??!1,s=this.gos.get("editType")==="fullRow";(o=this.rowCtrl)==null||o.forEachGui(void 0,({rowComp:r})=>{r.toggleCss("ag-row-editing",s&&t),r.toggleCss("ag-row-batch-edit",s&&t&&i),r.toggleCss("ag-row-inline-editing",t),r.toggleCss("ag-row-not-inline-editing",!t),r.toggleCss("ag-row-editing-invalid",s&&t&&e)})}},zj=({rowModel:e,pinnedRowModel:t,editModelSvc:i},s)=>{const n=new Set;e.forEachNode(o=>s.has(o)&&n.add(o)),t==null||t.forEachPinnedRow("top",o=>s.has(o)&&n.add(o)),t==null||t.forEachPinnedRow("bottom",o=>s.has(o)&&n.add(o));for(const o of s)n.has(o)||i.removeEdits({rowNode:o});return n},Wj=({editModelSvc:e},t,i)=>{var s;for(const n of t)(s=e==null?void 0:e.getEditRow(n))==null||s.forEach((o,r)=>!i.has(r)&&e.removeEdits({rowNode:n,column:r}))},$j=e=>()=>{const t=new Set(e.colModel.getCols()),i=e.editModelSvc.getEditMap(!0),s=new Set(i.keys());Wj(e,zj(e,s),t)},Uj=new Set(["undo","redo","paste","bulk","rangeSvc"]),jj=new Set(["ui","api"]),XD={paste:"api",rangeSvc:"api",fillHandle:"api",cellClear:"api",bulk:"api"},Kj=new Set(Object.keys(XD)),qj=new Set(["paste","rangeSvc","renderer","cellClear","redo","undo"]),Ap={cancel:!0,source:"api"},Yj={cancel:!1,source:"api"},Zc={checkSiblings:!0},gu={force:!0,suppressFlash:!0},Xj=class extends V{constructor(){super(...arguments),this.beanName="editSvc",this.batch=!1,this.stopping=!1,this.committing=!1}postConstruct(){const{beans:e}=this;this.model=e.editModelSvc,this.valueSvc=e.valueSvc,this.rangeSvc=e.rangeSvc,this.addManagedPropertyListener("editType",({currentValue:s})=>{this.stopEditing(void 0,Ap),this.createStrategy(s)});const t=$j(e),i=()=>{const s=this.model.getCellValidationModel().getCellValidationMap().size>0,n=this.model.getRowValidationModel().getRowValidationMap().size>0;return s||n?this.stopEditing(void 0,Ap):this.isEditing()&&(this.isBatchEditing()?Dd(e,this.model.getEditPositions()):this.stopEditing(void 0,Yj)),!1};this.addManagedEventListeners({columnPinned:t,columnVisible:t,columnRowGroupChanged:t,rowExpansionStateChanged:t,pinnedRowsChanged:t,displayedRowsChanged:t,sortChanged:i,filterChanged:i,cellFocused:this.onCellFocused.bind(this)})}isBatchEditing(){return this.batch}setBatchEditing(e){e?(this.batch=!0,this.stopEditing(void 0,Ap)):(this.stopEditing(void 0,Ap),this.batch=!1)}createStrategy(e){const{beans:t,gos:i,strategy:s}=this,n=mx(i,e);if(s){if(s.beanName===n)return s;this.destroyStrategy()}return this.strategy=this.createOptionalManagedBean(t.registry.createDynamicBean(n,!0))}destroyStrategy(){this.strategy&&(this.strategy.destroy(),this.strategy=this.destroyBean(this.strategy))}shouldStartEditing(e,t,i,s="ui"){const n=Nj(this.beans,e,t,i,s);return n&&(this.strategy??(this.strategy=this.createStrategy())),n}shouldStopEditing(e,t,i="ui"){var s;return((s=this.strategy)==null?void 0:s.shouldStop(e,t,i))??null}shouldCancelEditing(e,t,i="ui"){var s;return((s=this.strategy)==null?void 0:s.shouldCancel(e,t,i))??null}validateEdit(){return h5(this.beans)}isEditing(e,t){return this.model.hasEdits(e,t??Zc)}isRowEditing(e,t){return(e&&this.model.hasRowEdits(e,t))??!1}startEditing(e,t){const{startedEdit:i=!0,event:s=null,source:n="ui",ignoreEventKey:o=!1,silent:r}=t;if(this.strategy??(this.strategy=this.createStrategy()),!this.isCellEditable(e,"api"))return;const a=Pt(this.beans,e);if(a&&!a.comp){a.onCompAttachedFuncs.push(()=>this.startEditing(e,t));return}const l=this.shouldStartEditing(e,s,i,n);if(l===!1&&n!=="api"){this.isEditing(e)&&this.stopEditing();return}!this.batch&&this.shouldStopEditing(e,void 0,n)&&!t.continueEditing&&this.stopEditing(void 0,{source:n}),l&&this.isBatchEditing()&&this.dispatchBatchEvent("batchEditingStarted",new Map),this.strategy.start({position:e,event:s,source:n,ignoreEventKey:o,startedEdit:i,silent:r})}stopEditing(e,t){var v,C,w;const{event:i,cancel:s,source:n="ui",forceCancel:o,forceStop:r}=t||{},{beans:a,model:l}=this;if(Kj.has(n)&&this.isBatchEditing())return this.bulkRefresh(e),!1;const c=this.committing?XD[n]:n;if(!(this.committing||this.isEditing(e)||this.isBatchEditing()&&l.hasEdits(e,Zc))||!this.strategy||this.stopping)return!1;this.stopping=!0;const h=Pt(a,e);h&&(h.onEditorAttachedFuncs=[]);let u=l.getEditMap(!0),f=!1;const p=!s&&(!!this.shouldStopEditing(e,i,c)||this.committing&&!this.batch)||(r??!1),m=s&&!!this.shouldCancelEditing(e,i,c)||(o??!1);if(p||m){fl(a,{persist:!0,isCancelling:m||s,isStopping:p});const S=l.getEditMap(),b=this.processEdits(S,s,n);(v=this.strategy)==null||v.stop(s,i);for(const E of b)l.clearEditValue(E);this.bulkRefresh(void 0,u);for(const E of l.getEditPositions(S)){const A=Pt(a,E),P=vr(E);A==null||A.refreshCell({force:!0,suppressFlash:!P})}u=S,f||(f=p)}else if(i instanceof KeyboardEvent&&this.batch&&((C=this.strategy)!=null&&C.midBatchInputsAllowed(e))&&this.isEditing(e,{withOpenEditor:!0})){const{key:S}=i,b=S===H.ENTER,E=S===H.ESCAPE,A=S===H.TAB;(b||A||E)&&(b||A?fl(a,{persist:!0}):E&&this.revertSingleCellEdit(h),this.isBatchEditing()?(w=this.strategy)==null||w.cleanupEditors():Dd(a,l.getEditPositions(),{event:i,cancel:E}),i.preventDefault(),this.bulkRefresh(e,u,{suppressFlash:!0}),u=l.getEditMap())}else fl(a,{persist:!0}),u=l.getEditMap();return f&&e&&this.model.removeEdits(e),this.navigateAfterEdit(t,h==null?void 0:h.cellPosition),uy(a),this.model.hasEdits()||(this.model.getCellValidationModel().clearCellValidationMap(),this.model.getRowValidationModel().clearRowValidationMap()),this.bulkRefresh(),m&&this.beans.rowRenderer.refreshRows({rowNodes:Array.from(u.keys())}),this.isBatchEditing()&&(this.beans.rowRenderer.refreshRows({suppressFlash:!0,force:!0}),f&&p&&this.dispatchBatchEvent("batchEditingStopped",u)),this.stopping=!1,f}navigateAfterEdit(e,t){var c;if(!e||!t)return;const{event:i,suppressNavigateAfterEdit:s}=e;if(!(i instanceof KeyboardEvent)||s)return;const{key:o,shiftKey:r}=i,a=this.gos.get("enterNavigatesVerticallyAfterEdit");if(o!==H.ENTER||!a)return;const l=r?H.UP:H.DOWN;(c=this.beans.navigation)==null||c.navigateToNextCell(null,l,t,!1)}processEdits(e,t=!1,i){const s=Array.from(e.keys()),n=this.model.getCellValidationModel().getCellValidationMap().size>0||this.model.getRowValidationModel().getRowValidationMap().size>0,o=[];for(const r of s){const a=e.get(r);for(const l of a.keys()){const c=a.get(l),d={rowNode:r,column:l},h=vr(c);!t&&h&&!n&&(this.setNodeDataValue(r,l,c.pendingValue,void 0,i)||o.push(d))}}return o}setNodeDataValue(e,t,i,s,n="edit"){const{beans:o}=this,r=Pt(o,{rowNode:e,column:t}),a=jj.has(n)?"edit":n;r&&(r.suppressRefreshCell=!0),this.commitNextEdit();const l=e.setDataValue(t,i,a);return r&&(r.suppressRefreshCell=!1),s&&(r==null||r.refreshCell(gu)),l}setEditMap(e,t){var s;this.strategy??(this.strategy=this.createStrategy()),(s=this.strategy)==null||s.setEditMap(e,t),this.bulkRefresh();let i=gu;t!=null&&t.forceRefreshOfEditCellsOnly&&(i={...Qj(e),...gu}),this.beans.rowRenderer.refreshCells(i)}dispatchEditValuesChanged({rowNode:e,column:t},i={}){if(!e||!t||!i)return;const{pendingValue:s,sourceValue:n}=i,{rowIndex:o,rowPinned:r,data:a}=e;this.beans.eventSvc.dispatchEvent({type:"cellEditValuesChanged",node:e,rowIndex:o,rowPinned:r,column:t,source:"api",data:a,newValue:s,oldValue:n,value:s,colDef:t.getColDef()})}bulkRefresh(e={},t,i={}){var a;const{beans:s,gos:n}=this,{editModelSvc:o,rowModel:r}=s;Ut(n)&&(e.rowNode&&e.column?this.refCell(e,this.model.getEdit(e),i):t&&((a=o==null?void 0:o.getEditMap(!1))==null||a.forEach((l,c)=>{for(const d of l.keys())this.refCell({rowNode:c,column:d},l.get(d),i)})))}refCell({rowNode:e,column:t},i,s={}){var h,u,f;const{beans:n,gos:o}=this,r=new Set([e]),a=new Set,l=e.pinnedSibling;l&&r.add(l);const c=e.sibling;c&&a.add(c);let d=e.parent;for(;d;)(h=d.sibling)!=null&&h.footer&&o.get("groupTotalRow")||!d.parent&&d.sibling&&o.get("grandTotalRow")?a.add(d.sibling):a.add(d),d=d.parent;for(const p of r)this.dispatchEditValuesChanged({rowNode:p,column:t},i);for(const p of r)(u=Pt(n,{rowNode:p,column:t}))==null||u.refreshCell(s);for(const p of a)(f=Pt(n,{rowNode:p,column:t}))==null||f.refreshCell(s)}stopAllEditing(e=!1,t="ui"){this.isEditing()&&this.stopEditing(void 0,{cancel:e,source:t})}isCellEditable(e,t="ui"){const{rowNode:i}=e,{gos:s,beans:n}=this;if(i.group){if(s.get("treeData")){if(!i.data&&!s.get("enableGroupEdit"))return!1}else if(!s.get("enableGroupEdit"))return!1}const o=mx(s)==="fullRow"?Gj(n,e,t):Cy(n,e,t);return o&&(this.strategy??(this.strategy=this.createStrategy())),o}cellEditingInvalidCommitBlocks(){return this.gos.get("invalidEditValueMode")==="block"}checkNavWithValidation(e,t,i=!0){var s,n,o,r;if(this.hasValidationErrors(e)){const a=Pt(this.beans,e);return this.cellEditingInvalidCommitBlocks()?((s=t==null?void 0:t.preventDefault)==null||s.call(t),i&&(!(a!=null&&a.hasBrowserFocus())&&(a==null||a.focusCell()),(r=(o=(n=a==null?void 0:a.comp)==null?void 0:n.getCellEditor())==null?void 0:o.focusIn)==null||r.call(o)),"block-stop"):(a&&this.revertSingleCellEdit(a),"revert-continue")}return"continue"}revertSingleCellEdit(e,t=!1){var s,n,o,r;const i=Pt(this.beans,e);(s=i==null?void 0:i.comp)!=null&&s.getCellEditor()&&(Dd(this.beans,[e],{silent:!0}),this.model.clearEditValue(e),Kh(this.beans,e,{silent:!0}),Lc(this.beans),i==null||i.refreshCell(gu),t&&(i==null||i.focusCell(),(r=(o=(n=i==null?void 0:i.comp)==null?void 0:n.getCellEditor())==null?void 0:o.focusIn)==null||r.call(o)))}hasValidationErrors(e){var s;Lc(this.beans);const t=Pt(this.beans,e);t&&(t.refreshCell(gu),(s=t.rowCtrl.rowEditStyleFeature)==null||s.applyRowStyles());let i=!1;return e!=null&&e.rowNode?(i||(i=this.model.getRowValidationModel().hasRowValidation({rowNode:e.rowNode})),e.column&&(i||(i=this.model.getCellValidationModel().hasCellValidation({rowNode:e.rowNode,column:e.column})))):(i||(i=this.model.getCellValidationModel().getCellValidationMap().size>0),i||(i=this.model.getRowValidationModel().getRowValidationMap().size>0)),i}moveToNextCell(e,t,i,s="ui"){var a;let n;const o=this.isEditing(),r=o&&this.checkNavWithValidation(void 0,i)==="block-stop";return e instanceof Md&&o&&(n=(a=this.strategy)==null?void 0:a.moveToNextEditingCell(e,t,i,s,r)),n===null||(n=n||!!this.beans.focusSvc.focusedHeader,n===!1&&!r&&this.stopEditing()),n}getCellDataValue({rowNode:e,column:t},i=!0){if(!e||!t)return;let s=this.model.getEdit({rowNode:e,column:t});const n=e.pinnedSibling;if(n){const r=this.model.getEdit({rowNode:n,column:t});r&&(s=r)}const o=i?(s==null?void 0:s.editorValue)??(s==null?void 0:s.pendingValue):s==null?void 0:s.pendingValue;return o===rn||!s?(s==null?void 0:s.sourceValue)??this.valueSvc.getValue(t,e,!1,"api"):o}addStopEditingWhenGridLosesFocus(e){o5(this,this.beans,e)}createPopupEditorWrapper(e){return new Oj(e)}commitNextEdit(){this.committing=!0}setDataValue(e,t,i){var s;try{if((!this.isEditing()||this.committing)&&!qj.has(i))return;const{beans:n}=this;this.strategy??(this.strategy=this.createStrategy());const o=this.isBatchEditing()?"ui":this.committing?i??"api":"api";if(!i||Uj.has(i))return Cm(n,e,t,i,void 0,{persist:!0}),this.setNodeDataValue(e.rowNode,e.column,t,!0,i);const r=this.model.getEdit(e);if(r){if(r.pendingValue===t)return!1;if(r.sourceValue!==t)return Cm(n,e,t,i,void 0,{persist:!0}),this.stopEditing(e,{source:o,suppressNavigateAfterEdit:!0}),!0;if(r.sourceValue===t)return(s=n.editModelSvc)==null||s.removeEdits(e),this.dispatchEditValuesChanged(e,{...r,pendingValue:t}),!0}return Cm(n,e,t,i,void 0,{persist:!0}),this.stopEditing(e,{source:o,suppressNavigateAfterEdit:!0}),!0}finally{this.committing=!1}}handleColDefChanged(e){l5(this.beans,e)}destroy(){this.model.clear(),this.destroyStrategy(),super.destroy()}prepDetailsDuringBatch(e,t){if(!this.batch||!this.model.hasRowEdits(e.rowNode,Zc))return;const{rowNode:s,column:n}=e,{compDetails:o,valueToDisplay:r}=t;if(o){const{params:l}=o;return l.data=this.model.getEditRowDataValue(s,Zc),{compDetails:o}}const a=this.model.getEditRow(e.rowNode,Zc);if(r!==void 0&&(a!=null&&a.has(n)))return{valueToDisplay:this.valueSvc.getValue(n,s)}}cleanupEditors(){var e;(e=this.strategy)==null||e.cleanupEditors()}dispatchCellEvent(e,t,i,s){var n;(n=this.strategy)==null||n.dispatchCellEvent(e,t,i,s)}dispatchBatchEvent(e,t){this.eventSvc.dispatchEvent(this.createBatchEditEvent(e,t))}createBatchEditEvent(e,t){return Fe(this.gos,{type:e,...e==="batchEditingStopped"?{changes:this.toEventChangeList(t)}:{}})}toEventChangeList(e){return this.model.getEditPositions(e).map(t=>({rowIndex:t.rowNode.rowIndex,rowPinned:t.rowNode.rowPinned,columnId:t.column.getColId(),newValue:t.pendingValue,oldValue:t.sourceValue}))}applyBulkEdit({rowNode:e,column:t},i){var c,d;if(!i||i.length===0)return;const{beans:s,rangeSvc:n,valueSvc:o}=this;fl(s,{persist:!0});const r=this.model.getEditMap(!0),a=(d=(c=r.get(e))==null?void 0:c.get(t))==null?void 0:d.pendingValue;this.batch||this.eventSvc.dispatchEvent({type:"bulkEditingStarted"}),i.forEach(h=>{if(n==null||n.forEachRowInRange(h,u=>{const f=Dr(s,u);if(f===void 0)return;const p=r.get(f)??new Map;for(const m of h.columns)if(m&&this.isCellEditable({rowNode:f,column:m},"api")){const v=o.getValue(m,f,!0,"api");let C=o.parseValue(m,f??null,a,v);Number.isNaN(C)&&(C=null),p.set(m,{editorValue:void 0,pendingValue:C,sourceValue:v,state:"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}p.size>0&&r.set(f,p)}),this.setEditMap(r),this.batch){this.cleanupEditors(),uy(s),this.bulkRefresh();return}this.commitNextEdit(),this.stopEditing(void 0,{source:"bulk"}),this.eventSvc.dispatchEvent({type:"bulkEditingStopped",changes:this.toEventChangeList(r)})}),this.bulkRefresh();const l=Pt(s,{rowNode:e,column:t});l&&l.focusCell(!0)}createCellStyleFeature(e,t){return new Bj(e,t)}createRowStyleFeature(e,t){return new Vj(e,t)}setEditingCells(e,t){const{beans:i}=this,{colModel:s,valueSvc:n}=i,o=new Map;for(let{colId:r,column:a,colKey:l,rowIndex:c,rowPinned:d,newValue:h,state:u}of e){const f=r?s.getCol(r):l?s.getCol(l):a;if(!f)continue;const p=Dr(i,{rowIndex:c,rowPinned:d});if(!p)continue;const m=n.getValue(f,p,!0,"api");if(!(t!=null&&t.forceRefreshOfEditCellsOnly)&&!vr({pendingValue:h,sourceValue:m})&&u!=="editing")continue;let v=o.get(p);v||(v=new Map,o.set(p,v)),h===void 0&&(h=rn),v.set(f,{editorValue:void 0,pendingValue:h,sourceValue:m,state:u??"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}this.setEditMap(o,t)}onCellFocused(e){var o;const t=Pt(this.beans,e);if(!t||!this.isEditing(t,Zc))return;const i=this.model.getEdit(t);if(!i||!vr(i))return;const n=this.getLocaleTextFunc()("ariaPendingChange","Pending Change");(o=this.beans.ariaAnnounce)==null||o.announceValue(n,"pendingChange")}allowedFocusTargetOnValidation(e){return Pt(this.beans,e)}};function Qj(e){return{rowNodes:e?Array.from(e.keys()):void 0,columns:e?[...new Set(Array.from(e.values()).flatMap(t=>Array.from(t.keys())))]:void 0}}function mx(e,t){return t??e.get("editType")??"singleCell"}var QD=class extends V{postConstruct(){var e,t;this.model=this.beans.editModelSvc,this.editSvc=this.beans.editSvc,this.addManagedEventListeners({cellFocused:(e=this.onCellFocusChanged)==null?void 0:e.bind(this),cellFocusCleared:(t=this.onCellFocusChanged)==null?void 0:t.bind(this)})}clearEdits(e){this.model.clearEditValue(e)}onCellFocusChanged(e){let t;const i=e.previousParams,{editSvc:s,beans:n}=this,o=e.type==="cellFocused"?e.sourceEvent:null;i&&(t=Pt(n,i));const{gos:r,editModelSvc:a}=n,l=e.type==="cellFocusCleared";if(s.isEditing(void 0,{withOpenEditor:!0})){const{column:c,rowIndex:d,rowPinned:h}=e,u={column:c,rowNode:Dr(n,{rowIndex:d,rowPinned:h})},f=r.get("invalidEditValueMode")==="block";if(f)return;const p=!f,m=!!(a!=null&&a.getCellValidationModel().hasCellValidation(u)),v=p&&m;(i||l?s.stopEditing(void 0,{cancel:v,source:l&&p?"api":void 0,event:o}):!0)||(s.isBatchEditing()?s.cleanupEditors():s.stopEditing(void 0,{source:"api"}))}t==null||t.refreshCell({suppressFlash:!0,force:!0})}stop(e,t){var n,o;const i=this.model.getEditPositions(),s={all:[],pass:[],fail:[]};for(const r of i){s.all.push(r);const a=this.model.getCellValidationModel().getCellValidation(r);if((((n=a==null?void 0:a.errorMessages)==null?void 0:n.length)??0)>0){s.fail.push(r);continue}s.pass.push(r)}if(e)for(const r of i)Ym(this.beans,r,{cancel:e}),this.model.stop(r);else{const r=this.processValidationResults(s);if(r.destroy.length>0)for(const a of r.destroy)Ym(this.beans,a,{event:t,cancel:e}),this.model.stop(a);if(r.keep.length>0)for(const a of r.keep){const l=Pt(this.beans,a);(o=this.editSvc)!=null&&o.cellEditingInvalidCommitBlocks()||l&&this.editSvc.revertSingleCellEdit(l)}}return!0}cleanupEditors({rowNode:e}={},t){fl(this.beans,{persist:!1});const i=this.model.getEditPositions(),s=[];if(e)for(const n of i)n.rowNode!==e&&s.push(n);else for(const n of i)s.push(n);Dd(this.beans,s),uy(this.beans,t)}setFocusOutOnEditor(e){var t,i,s;(s=(i=(t=e.comp)==null?void 0:t.getCellEditor())==null?void 0:i.focusOut)==null||s.call(i)}setFocusInOnEditor(e){const t=e.comp,i=t==null?void 0:t.getCellEditor();if(i!=null&&i.focusIn)i.focusIn();else{const s=this.beans.gos.get("editType")==="fullRow";e.focusCell(s),e.onEditorAttachedFuncs.push(()=>{var n,o;return(o=(n=t==null?void 0:t.getCellEditor())==null?void 0:n.focusIn)==null?void 0:o.call(n)})}}setupEditors(e){const{event:t,ignoreEventKey:i=!1,startedEdit:s,position:n,cells:o=this.model.getEditPositions()}=e,r=t instanceof KeyboardEvent&&!i&&t.key||void 0;a5(this.beans,o,n,r,t,s)}dispatchCellEvent(e,t,i,s){const n=Pt(this.beans,e);n&&this.eventSvc.dispatchEvent({...n.createEvent(t??null,i),...s})}dispatchRowEvent(e,t,i){if(i)return;const s=HS(this.beans,e);s&&this.eventSvc.dispatchEvent(s.createRowEvent(t))}shouldStop(e,t,i="ui"){const s=this.editSvc.isBatchEditing();return s&&i==="api"?!0:s&&(i==="ui"||i==="edit")?!1:i==="api"?!0:t instanceof KeyboardEvent&&!s?t.key===H.ENTER:null}shouldCancel(e,t,i="ui"){const s=this.editSvc.isBatchEditing();return!!(t instanceof KeyboardEvent&&!s&&t.key===H.ESCAPE||s&&i==="api"||i==="api")}setEditMap(e,t){var s;t!=null&&t.update||this.editSvc.stopEditing(void 0,{cancel:!0,source:"api"});const i=[];if(e.forEach((n,o)=>{n.forEach((r,a)=>{r.state==="editing"&&i.push({...r,rowNode:o,column:a})})}),t!=null&&t.update&&(e=new Map([...this.model.getEditMap(),...e])),(s=this.model)==null||s.setEditMap(e),i.length>0){const n=i.at(-1),o=n.pendingValue===rn?void 0:n.pendingValue;this.start({position:n,event:new KeyboardEvent("keydown",{key:o}),source:"api"});const r=Pt(this.beans,n);r&&this.setFocusInOnEditor(r)}}destroy(){this.cleanupEditors(),super.destroy()}},Jj=class extends QD{constructor(){super(...arguments),this.beanName="fullRow",this.startedRows=[]}shouldStop(e,t,i="ui"){const{rowNode:s}=e||{};if(!HS(this.beans,{rowNode:this.rowNode}))return!0;const o=super.shouldStop({rowNode:this.rowNode},t,i);return o!==null?o:this.rowNode?s!==this.rowNode:!1}midBatchInputsAllowed({rowNode:e}){return e?this.model.hasEdits({rowNode:e}):!1}clearEdits(e){this.model.clearEditValue(e)}start(e){const{position:t,silent:i,startedEdit:s,event:n,ignoreEventKey:o}=e,{rowNode:r}=t;this.rowNode!==r&&super.cleanupEditors(t);const a=this.beans.visibleCols.allCols,l=[],c=[];for(const d of a)d.isCellEditable(r)&&c.push(d);if(c.length!=0){this.dispatchRowEvent({rowNode:r},"rowEditingStarted",i),this.startedRows.push(r);for(const d of c){const h={rowNode:r,column:d};l.push(h),this.model.hasEdits(h)||this.model.start(h)}this.rowNode=r,this.setupEditors({cells:l,position:t,startedEdit:s,event:n,ignoreEventKey:o})}}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){var n;const{rowNode:i}=this;if(i&&!this.model.hasRowEdits(i))return!1;const s=[];if(e||this.model.getEditMap().forEach((o,r)=>{if(!(!o||o.size===0)){for(const a of o.values())if(vr(a)){s.push(r);break}}}),Lc(this.beans),!e&&((n=this.editSvc)==null?void 0:n.checkNavWithValidation({rowNode:i}))==="block-stop")return!1;super.stop(e,t);for(const o of s)this.dispatchRowEvent({rowNode:o},"rowValueChanged");return this.cleanupEditors({rowNode:i},!0),this.rowNode=void 0,!0}onCellFocusChanged(e){const{rowIndex:t}=e,i=e.previousParams;if((i==null?void 0:i.rowIndex)===t||e.sourceEvent instanceof KeyboardEvent)return;const s=Pt(this.beans,i);this.gos.get("invalidEditValueMode")==="block"&&s&&(this.model.getCellValidationModel().getCellValidation(s)||this.model.getRowValidationModel().getRowValidation(s))||super.onCellFocusChanged(e)}cleanupEditors(e={},t){super.cleanupEditors(e,t);for(const i of this.startedRows)this.dispatchRowEvent({rowNode:i},"rowEditingStopped");this.startedRows.length=0}moveToNextEditingCell(e,t,i,s="ui",n=!1){var u,f,p,m;const o=e.cellPosition;let r;this.model.suspend(!0);try{r=(u=this.beans.navigation)==null?void 0:u.findNextCellToFocusOn(o,{backwards:t,startEditing:!0,skipToNextEditableCell:!1})}finally{this.model.suspend(!1)}if(r===!1)return null;if(r==null)return!1;const a=r.cellPosition,l=e.isCellEditable(),c=r.isCellEditable(),d=a&&o.rowIndex===a.rowIndex&&o.rowPinned===a.rowPinned;l&&this.setFocusOutOnEditor(e),this.restoreEditors();const h=this.gos.get("suppressStartEditOnTab");return c&&!n?h?r.focusCell(!0,i):((f=r.comp)!=null&&f.getCellEditor()||Kh(this.beans,r,{event:i,cellStartedEdit:!0}),this.setFocusInOnEditor(r),r.focusCell(!1,i)):(c&&n&&this.setFocusInOnEditor(r),r.focusCell(!0,i)),!d&&!n&&((p=this.editSvc)==null||p.stopEditing({rowNode:e.rowNode},{event:i}),this.cleanupEditors(r,!0),h?r.focusCell(!0,i):this.editSvc.startEditing(r,{startedEdit:!0,event:i,source:s,ignoreEventKey:!0})),(m=e.rowCtrl)==null||m.refreshRow({suppressFlash:!0,force:!0}),!0}restoreEditors(){this.model.getEditMap().forEach((e,t)=>e.forEach(({state:i},s)=>{var o;if(i!=="editing")return;const n=Pt(this.beans,{rowNode:t,column:s});n&&!((o=n.comp)!=null&&o.getCellEditor())&&Kh(this.beans,n,{silent:!0})}))}destroy(){super.destroy(),this.rowNode=void 0,this.startedRows.length=0}},Zj=class extends QD{constructor(){super(...arguments),this.beanName="singleCell"}shouldStop(e,t,i="ui"){const s=super.shouldStop(e,t,i);if(s!==null)return s;const{rowNode:n,column:o}=e||{};return(!this.rowNode||!this.column)&&n&&o?null:this.rowNode!==n||this.column!==o}midBatchInputsAllowed(e){return this.model.hasEdits(e)}start(e){const{position:t,startedEdit:i,event:s,ignoreEventKey:n}=e;(this.rowNode!==t.rowNode||this.column!==t.column)&&super.cleanupEditors(),this.rowNode=t.rowNode,this.column=t.column,this.model.start(t),this.setupEditors({cells:[t],position:t,startedEdit:i,event:s,ignoreEventKey:n})}dispatchRowEvent(e,t,i){}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){return super.stop(e,t),this.rowNode=void 0,this.column=void 0,!0}onCellFocusChanged(e){const{colModel:t,editSvc:i}=this.beans,{rowIndex:s,column:n,rowPinned:o}=e,r=Dr(this.beans,{rowIndex:s,rowPinned:o}),a=hy(n),l=t.getCol(a),c=e.previousParams;if(c){const d=hy(c.column);if((c==null?void 0:c.rowIndex)===s&&d===a&&(c==null?void 0:c.rowPinned)===o)return}i!=null&&i.isEditing({rowNode:r,column:l},{withOpenEditor:!0})&&e.type==="cellFocused"||super.onCellFocusChanged(e)}moveToNextEditingCell(e,t,i,s="ui",n=!1){var p,m,v,C,w,S;const o=this.beans.focusSvc.getFocusedCell();o&&(e=pd(this.beans,o)??e);const r=e.cellPosition;let a;const l=this.beans.gos.get("editType")==="fullRow";l&&this.model.suspend(!0),n||(e.eGui.focus(),(m=this.editSvc)==null||m.stopEditing(e,{source:(p=this.editSvc)!=null&&p.isBatchEditing()?"ui":"api",event:i}));try{a=(v=this.beans.navigation)==null?void 0:v.findNextCellToFocusOn(r,{backwards:t,startEditing:!0})}finally{l&&this.model.suspend(!1)}if(a===!1)return null;if(a==null)return!1;const c=a.cellPosition,d=e.isCellEditable(),h=a.isCellEditable(),u=c&&r.rowIndex===c.rowIndex&&r.rowPinned===c.rowPinned;d&&!n&&this.setFocusOutOnEditor(e);const f=this.gos.get("suppressStartEditOnTab");if(!u&&!n&&(super.cleanupEditors(a,!0),f?a.focusCell(!0,i):this.editSvc.startEditing(a,{startedEdit:!0,event:i,source:s,ignoreEventKey:!0})),h&&!n){if(a.focusCell(!1,i),f)a.focusCell(!0,i);else if(!((C=a.comp)!=null&&C.getCellEditor())){const b=(w=this.editSvc)==null?void 0:w.isEditing(a,{withOpenEditor:!0});Kh(this.beans,a,{event:i,cellStartedEdit:!0,silent:b}),this.setFocusInOnEditor(a),this.cleanupEditors(a)}}else h&&n&&this.setFocusInOnEditor(a),a.focusCell(!0,i);return(S=e.rowCtrl)==null||S.refreshRow({suppressFlash:!0,force:!0}),!0}destroy(){super.destroy(),this.rowNode=void 0,this.column=void 0}},Ja={moduleName:"EditCore",version:ne,beans:[n5,Xj],apiFunctions:{getEditingCells:Pj,getEditRowValues:Fj,getCellEditorInstances:r5,startEditingCell:Mj,stopEditing:Tj,isEditing:Dj,validateEdit:Ij},dynamicBeans:{singleCell:Zj,fullRow:Jj},dependsOn:[Kv,WD],css:[nj]},e8={moduleName:"UndoRedoEdit",version:ne,beans:[sj],apiFunctions:{undoCellEditing:Ej,redoCellEditing:Aj,getCurrentUndoSize:kj,getCurrentRedoSize:_j},dependsOn:[Ja]},t8={moduleName:"TextEditor",version:ne,userComponents:{agCellEditor:px,agTextCellEditor:px},dependsOn:[Ja]},i8={moduleName:"NumberEditor",version:ne,userComponents:{agNumberCellEditor:{classImp:vj}},dependsOn:[Ja]},s8={moduleName:"DateEditor",version:ne,userComponents:{agDateCellEditor:cj,agDateStringCellEditor:uj},dependsOn:[Ja]},n8={moduleName:"CheckboxEditor",version:ne,userComponents:{agCheckboxCellEditor:rj},dependsOn:[Ja]},o8={moduleName:"SelectEditor",version:ne,userComponents:{agSelectCellEditor:wj},dependsOn:[Ja]},r8={moduleName:"LargeTextEditor",version:ne,userComponents:{agLargeTextCellEditor:fj},dependsOn:[Ja]},a8={moduleName:"CustomEditor",version:ne,dependsOn:[Ja]},l8=class extends V{constructor(){super(...arguments),this.beanName="selectionColSvc"}postConstruct(){this.addManagedPropertyListener("rowSelection",e=>{this.onSelectionOptionsChanged(e.currentValue,e.previousValue,Ad(e.source))}),this.addManagedPropertyListener("selectionColumnDef",this.updateColumns.bind(this))}addColumns(e){const t=this.columns;t!=null&&(e.list=t.list.concat(e.list),e.tree=t.tree.concat(e.tree),CG(e))}createColumns(e,t){var u,f;const i=()=>{var p;Bm(this.beans,(p=this.columns)==null?void 0:p.tree),this.columns=null},s=e.treeDepth,o=(((u=this.columns)==null?void 0:u.treeDepth)??-1)==s,r=this.generateSelectionCols();if(vG(r,((f=this.columns)==null?void 0:f.list)??[])&&o)return;i();const{colGroupSvc:l}=this.beans,c=(l==null?void 0:l.findDepth(e.tree))??0,d=(l==null?void 0:l.balanceTreeForAutoCols(r,c))??[];this.columns={list:r,tree:d,treeDepth:c,map:{}},t(p=>{if(!p)return null;const m=p.filter(v=>!Or(v));return[...r,...m]})}updateColumns(e){var i;const t=Ad(e.source);for(const s of((i=this.columns)==null?void 0:i.list)??[]){const n=this.createSelectionColDef(e.currentValue);s.setColDef(n,null,t),In(this.beans,{state:[{...n,colId:s.getColId()}]},t)}}getColumn(e){var t;return((t=this.columns)==null?void 0:t.list.find(i=>ju(i,e)))??null}getColumns(){var e;return((e=this.columns)==null?void 0:e.list)??null}isSelectionColumnEnabled(){var r,a;const{gos:e,beans:t}=this,i=e.get("rowSelection");if(typeof i!="object"||!bc(e))return!1;const s=(((a=(r=t.autoColSvc)==null?void 0:r.getColumns())==null?void 0:a.length)??0)>0;if(i.checkboxLocation==="autoGroupColumn"&&s)return!1;const n=!!Ed(i),o=dm(i);return n||o}createSelectionColDef(e){const{gos:t}=this,i=e??t.get("selectionColumnDef"),s=t.get("enableRtl"),{rowSpan:n,spanRows:o,...r}=i??{};return{width:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:s?"right":"left",comparator(a,l,c,d){const h=c.isSelected(),u=d.isSelected();return h===u?0:h?1:-1},editable:!1,suppressFillHandle:!0,pinned:null,...r,colId:UP,chartDataType:"excluded"}}generateSelectionCols(){if(!this.isSelectionColumnEnabled())return[];const e=this.createSelectionColDef(),t=e.colId;this.gos.validateColDef(e,t,!0);const i=new jc(e,null,t,!1);return this.createBean(i),[i]}onSelectionOptionsChanged(e,t,i){const s=t&&typeof t!="string"?Ed(t):void 0,n=e&&typeof e!="string"?Ed(e):void 0,o=s!==n,r=t&&typeof t!="string"?dm(t):void 0,a=e&&typeof e!="string"?dm(e):void 0,l=r!==a,c=Nm(e),d=Nm(t);(o||l||c!==d)&&this.beans.colModel.refreshAll(i)}destroy(){var e;Bm(this.beans,(e=this.columns)==null?void 0:e.tree),super.destroy()}refreshVisibility(e,t,i){var l,c;if(!((l=this.columns)!=null&&l.list.length))return;const s=e.length+t.length+i.length;if(s===0)return;const n=this.columns.list[0];if(!n.isVisible())return;const o=()=>{let d;switch(n.pinned){case"left":case!0:d=e;break;case"right":d=i;break;default:d=t}d&&_n(d,n)};(((c=this.beans.rowNumbersSvc)==null?void 0:c.getColumn(jP))?2:1)===s&&o()}};function c8(e,t){var r;if(!t.nodes.every(a=>a.rowPinned&&!tp(a)?(j(59),!1):a.id===void 0?(j(60),!1):!0))return;const{nodes:s,source:n,newValue:o}=t;(r=e.selectionSvc)==null||r.setNodesSelected({nodes:s,source:n??"api",newValue:o})}function d8(e,t,i="apiSelectAll"){var s;(s=e.selectionSvc)==null||s.selectAllRowNodes({source:i,selectAll:t})}function h8(e,t,i="apiSelectAll"){var s;(s=e.selectionSvc)==null||s.deselectAllRowNodes({source:i,selectAll:t})}function u8(e,t="apiSelectAllFiltered"){var i;(i=e.selectionSvc)==null||i.selectAllRowNodes({source:t,selectAll:"filtered"})}function g8(e,t="apiSelectAllFiltered"){var i;(i=e.selectionSvc)==null||i.deselectAllRowNodes({source:t,selectAll:"filtered"})}function f8(e,t="apiSelectAllCurrentPage"){var i;(i=e.selectionSvc)==null||i.selectAllRowNodes({source:t,selectAll:"currentPage"})}function p8(e,t="apiSelectAllCurrentPage"){var i;(i=e.selectionSvc)==null||i.deselectAllRowNodes({source:t,selectAll:"currentPage"})}function m8(e){var t;return((t=e.selectionSvc)==null?void 0:t.getSelectedNodes())??[]}function v8(e){var t;return((t=e.selectionSvc)==null?void 0:t.getSelectedRows())??[]}var C8=class extends Dz{constructor(){super(...arguments),this.beanName="selectionSvc",this.selectedNodes=new Map,this.detailSelection=new Map,this.masterSelectsDetail=!1}postConstruct(){super.postConstruct();const{gos:e}=this;this.mode=Hm(e),this.groupSelectsDescendants=gg(e),this.groupSelectsFiltered=Gm(e)==="filteredDescendants",this.masterSelectsDetail=aR(e)==="detail",this.addManagedPropertyListeners(["groupSelectsChildren","groupSelectsFiltered","rowSelection"],()=>{const t=gg(e),i=Hm(e),s=Gm(e)==="filteredDescendants";this.masterSelectsDetail=aR(e)==="detail",(t!==this.groupSelectsDescendants||s!==this.groupSelectsFiltered||i!==this.mode)&&(this.deselectAllRowNodes({source:"api"}),this.groupSelectsDescendants=t,this.groupSelectsFiltered=s,this.mode=i)}),this.addManagedEventListeners({rowSelected:this.onRowSelected.bind(this)})}destroy(){super.destroy(),this.resetNodes()}handleSelectionEvent(e,t,i){if(this.isRowSelectionBlocked(t))return 0;const s=this.inferNodeSelections(t,e.shiftKey,e.metaKey||e.ctrlKey,i);if(s==null)return 0;if(this.selectionCtx.selectAll=!1,"select"in s)return s.reset?this.resetNodes():this.selectRange(s.deselect,!1,i),this.selectRange(s.select,!0,i);{const n=s.checkFilteredNodes?ZD(s.node):s.newValue;return this.setNodesSelected({nodes:[s.node],newValue:n,clearSelection:s.clearSelection,keepDescendants:s.keepDescendants,event:e,source:i})}}setNodesSelected({newValue:e,clearSelection:t,suppressFinishActions:i,nodes:s,event:n,source:o,keepDescendants:r=!1}){var c;if(s.length===0)return 0;const{gos:a}=this;if(!bc(a)&&e)return j(132),0;if(s.length>1&&!this.isMultiSelect())return j(130),0;let l=0;for(let d=0;d<s.length;d++){const h=s[d],u=ed(h);if(u.rowPinned&&!tp(u)){j(59);continue}if(u.id===void 0){j(60);continue}this.groupSelectsFiltered&&u.group&&!a.get("treeData")||this.selectRowNode(u,e,n,o)&&(this.detailSelection.delete(u.id),l++),this.groupSelectsDescendants&&((c=u.childrenAfterGroup)!=null&&c.length)&&(l+=this.selectChildren(u,e,o))}return i||(s.length===1&&o==="api"&&this.selectionCtx.setRoot(ed(s[0])),e&&(t||!this.isMultiSelect())&&(l+=this.clearOtherNodes(ed(s[0]),r,o)),l>0&&(this.updateGroupsFromChildrenSelections(o),this.dispatchSelectionChanged(o))),l}selectRange(e,t,i){let s=0;return e.forEach(n=>{const o=ed(n);if(o.group&&this.groupSelectsDescendants)return;this.selectRowNode(o,t,void 0,i)&&s++}),s>0&&(this.updateGroupsFromChildrenSelections(i),this.dispatchSelectionChanged(i)),s}selectChildren(e,t,i){const s=this.groupSelectsFiltered?e.childrenAfterAggFilter:e.childrenAfterGroup;return s?this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,source:i,nodes:s}):0}getSelectedNodes(){return Array.from(this.selectedNodes.values())}getSelectedRows(){const e=[];return this.selectedNodes.forEach(t=>t.data&&e.push(t.data)),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){const t=new Map;this.selectedNodes.forEach((i,s)=>{e(i)&&t.set(s,i)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsDescendants)return!1;const{gos:i,rowModel:s}=this.beans;if(!Ut(i))return!1;const n=s.rootNode;if(!n)return!1;t||(t=new mg(!0,n),t.active=!1);let o=!1;return t.forEachChangedNodeDepthFirst(r=>{if(r!==n){const a=this.calculateSelectedFromChildren(r);o=this.selectRowNode(r,a===null?!1:a,void 0,e)||o}}),o}clearOtherNodes(e,t,i){const s=new Map;let n=0;return this.selectedNodes.forEach(o=>{const r=o.id==e.id;if((t?!b8(e,o):!0)&&!r){const l=this.selectedNodes.get(o.id);n+=this.setNodesSelected({nodes:[l],newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:i}),this.groupSelectsDescendants&&o.parent&&s.set(o.parent.id,o.parent)}}),s.forEach(o=>{const r=this.calculateSelectedFromChildren(o);this.selectRowNode(o,r===null?!1:r,void 0,i)}),n}onRowSelected(e){const t=e.node;this.groupSelectsDescendants&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}createDaemonNode(e){if(!e.id)return;const t=new za(this.beans);return t.id=e.id,t.data=e.data,t.__selected=e.__selected,t.level=e.level,t}syncInOldRowNode(e,t){t&&e.id!==t.id&&this.selectedNodes.get(t.id)==e&&this.selectedNodes.set(t.id,t)}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.__selected=!0,this.selectedNodes.set(e.id,e)):e.__selected=!1}reset(e){const t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){this.selectedNodes.forEach(e=>{this.selectRowNode(e,!1)}),this.selectedNodes.clear()}getBestCostNodeSelection(){const{gos:e,rowModel:t}=this.beans;if(!Ut(e))return;const i=t.getTopLevelNodes();if(i===null)return;const s=[];function n(o){for(let r=0,a=o.length;r<a;r++){const l=o[r];l.isSelected()?s.push(l):l.group&&l.childrenAfterGroup&&n(l.childrenAfterGroup)}}return n(i),s}isEmpty(){return this.getSelectionCount()===0}deselectAllRowNodes({source:e,selectAll:t}){const i=Ut(this.gos);let s=!1;const n=o=>{const r=this.selectRowNode(ed(o),!1,void 0,e);s||(s=r)};if(t==="currentPage"||t==="filtered"){if(!i){ut(102);return}this.getNodesToSelect(t).forEach(n)}else this.selectedNodes.forEach(n),this.reset(e);if(this.selectionCtx.selectAll=!1,i&&this.groupSelectsDescendants){const o=this.updateGroupsFromChildrenSelections(e);s||(s=o)}s&&this.dispatchSelectionChanged(e)}getSelectedCounts(e){let t=0,i=0;return this.getNodesToSelect(e).forEach(s=>{this.groupSelectsDescendants&&s.group||(s.isSelected()?t++:s.selectable&&i++)}),{selectedCount:t,notSelectedCount:i}}getSelectAllState(e){const{selectedCount:t,notSelectedCount:i}=this.getSelectedCounts(e);return JD(t,i)??null}hasNodesToSelect(e){return this.getNodesToSelect(e).filter(t=>t.selectable).length>0}getNodesToSelect(e){if(!this.canSelectAll())return[];const t=[],i=n=>t.push(n);if(e==="currentPage")return this.forEachNodeOnPage(n=>{if(!n.group){i(n);return}if(!n.expanded&&!n.footer){const o=r=>{var a;i(r),(a=r.childrenAfterFilter)==null||a.forEach(o)};o(n);return}this.groupSelectsDescendants||i(n)}),t;const s=this.beans.rowModel;return e==="filtered"?(s.forEachNodeAfterFilter(i),t):(s.forEachNode(i),t)}forEachNodeOnPage(e){const{pageBounds:t,rowModel:i}=this.beans,s=t.getFirstRow(),n=t.getLastRow();for(let o=s;o<=n;o++){const r=i.getRow(o);r&&e(r)}}selectAllRowNodes(e){const{gos:t,selectionCtx:i}=this;if(!bc(t)){j(132);return}if(nG(t)&&!ug(t)){j(130);return}if(!this.canSelectAll())return;const{source:s,selectAll:n}=e;let o=!1;if(this.getNodesToSelect(n).forEach(r=>{const a=this.selectRowNode(ed(r),!0,void 0,s);o||(o=a)}),i.selectAll=!0,Ut(t)&&this.groupSelectsDescendants){const r=this.updateGroupsFromChildrenSelections(s);o||(o=r)}o&&this.dispatchSelectionChanged(s)}getSelectionState(){return this.isEmpty()?null:Array.from(this.selectedNodes.keys())}setSelectionState(e,t,i){if(e||(e=[]),!Array.isArray(e)){ut(103);return}const s=new Set(e),n=[];this.beans.rowModel.forEachNode(o=>{s.has(o.id)&&n.push(o)}),i&&this.resetNodes(),this.setNodesSelected({newValue:!0,nodes:n,source:t})}canSelectAll(){return Ut(this.beans.gos)}updateSelectable(e){var l;const{gos:t,rowModel:i}=this.beans;if(!bc(t))return;const s="selectableChanged",n=e!==void 0,o=Ut(t)&&this.groupSelectsDescendants,r=[],a=c=>{var h;if(n&&!c.group)return;if(o&&c.group){const u=((h=c.childrenAfterGroup)==null?void 0:h.some(f=>f.selectable))??!1;this.setRowSelectable(c,u,!0);return}!this.updateRowSelectable(c,!0)&&c.isSelected()&&r.push(c)};if(o){if(e===void 0){const c=i.rootNode;e=c?new mg(!1,c):void 0}e==null||e.forEachChangedNodeDepthFirst(a,!n,!n)}else i.forEachNode(a);r.length&&this.setNodesSelected({nodes:r,newValue:!1,source:s}),!n&&o&&((l=this.updateGroupsFromChildrenSelections)==null||l.call(this,s))}updateSelectableAfterGrouping(e){var t;this.updateSelectable(e),this.groupSelectsDescendants&&((t=this.updateGroupsFromChildrenSelections)!=null&&t.call(this,"rowGroupChanged",e))&&this.dispatchSelectionChanged("rowGroupChanged")}refreshMasterNodeState(e,t){var o,r;if(!this.masterSelectsDetail)return;const i=(r=(o=e.detailNode)==null?void 0:o.detailGridInfo)==null?void 0:r.api;if(!i)return;const s=w8(i);if(e.isSelected()!==s&&this.selectRowNode(e,s,t,"masterDetail")&&this.dispatchSelectionChanged("masterDetail"),!s){const a=this.detailSelection.get(e.id)??new Set;for(const l of i.getSelectedNodes())a.add(l.id);this.detailSelection.set(e.id,a)}}setDetailSelectionState(e,t,i){if(this.masterSelectsDetail){if(!ug(t)){j(269);return}switch(e.isSelected()){case!0:{i.selectAll();break}case!1:{i.deselectAll();break}case void 0:{const s=this.detailSelection.get(e.id);if(s){const n=[];for(const o of s){const r=i.getRowNode(o);r&&n.push(r)}i.setNodesSelected({nodes:n,newValue:!0,source:"masterDetail"})}break}}}}dispatchSelectionChanged(e){this.eventSvc.dispatchEvent({type:"selectionChanged",source:e,selectedNodes:this.getSelectedNodes(),serverSideState:null})}};function ed(e){return tp(e)?e.pinnedSibling:e.footer?e.sibling:e}function w8(e){let t=0,i=0;return e.forEachNode(s=>{s.isSelected()?t++:s.selectable&&i++}),JD(t,i)}function JD(e,t){if(e===0&&t===0)return!1;if(!(e>0&&t>0))return e>0}function b8(e,t){let i=t.parent;for(;i;){if(i===e)return!0;i=i.parent}return!1}function ZD(e){var s;const t=e.isSelected()===!1,i=((s=e.childrenAfterFilter)==null?void 0:s.some(ZD))??!1;return t||i}var y8={moduleName:"SharedRowSelection",version:ne,beans:[l8],apiFunctions:{setNodesSelected:c8,selectAll:d8,deselectAll:h8,selectAllFiltered:u8,deselectAllFiltered:g8,selectAllOnCurrentPage:f8,deselectAllOnCurrentPage:p8,getSelectedNodes:m8,getSelectedRows:v8}},S8={moduleName:"RowSelection",version:ne,rowModels:["clientSide","infinite","viewport"],beans:[C8],dependsOn:[y8]};function R8(e){var t;(t=e.expansionSvc)==null||t.expandAll(!0)}function x8(e){var t;(t=e.expansionSvc)==null||t.expandAll(!1)}function eM(e){var t;(t=e.rowModel)==null||t.onRowHeightChanged()}function tM(e){var t,i;if((t=e.rowAutoHeight)!=null&&t.active){j(3);return}(i=e.rowModel)==null||i.resetRowHeights()}function E8(e,t,i){var n,o;const s=A4(e);if(s){if(((n=e.rowGroupColsSvc)==null?void 0:n.columns.length)===0){if(t<0){ut(238);return}s.setRowCount(t,i);return}ut(28);return}(o=jv(e))==null||o.setRowCount(t,i)}function A8(e){var t;return iu(e.gos)?e.rowModel.getBlockStates():((t=e.rowNodeBlockLoader)==null?void 0:t.getBlockState())??{}}function F8(e){return e.rowModel.isLastRowIndexKnown()}var P8={moduleName:"CsrmSsrmSharedApi",version:ne,apiFunctions:{expandAll:R8,collapseAll:x8}},T8={moduleName:"RowModelSharedApi",version:ne,apiFunctions:{onRowHeightChanged:eM,resetRowHeights:tM}},D8={moduleName:"SsrmInfiniteSharedApi",version:ne,apiFunctions:{setRowCount:E8,getCacheBlockState:A8,isLastRowIndexKnown:F8}},M8=class extends V{constructor(){super(...arguments),this.beanName="alignedGridsSvc",this.consuming=!1}getAlignedGridApis(){let e=this.gos.get("alignedGrids")??[];const t=typeof e=="function";return typeof e=="function"&&(e=e()),e.map(s=>{var o;if(!s){ut(18),t||ut(20);return}if(this.isGridApi(s))return s;const n=s;return"current"in n?(o=n.current)==null?void 0:o.api:(n.api||ut(19),n.api)}).filter(s=>!!s&&!s.isDestroyed())}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){const e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:({event:t})=>this.onColumnEvent(t),alignedGridScroll:({event:t})=>this.onScrollEvent(t)})}fireEvent(e){if(!this.consuming)for(const t of this.getAlignedGridApis())t.isDestroyed()||t.dispatchEvent(e)}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent({type:"alignedGridColumn",event:e})}fireScrollEvent(e){e.direction==="horizontal"&&this.fireEvent({type:"alignedGridScroll",event:e})}onScrollEvent(e){this.onEvent(()=>{this.beans.ctrlsSvc.getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}extractDataFromEvent(e,t){const i=[];return e.columns?e.columns.forEach(s=>{i.push(t(s))}):e.column&&i.push(t(e.column)),i}getMasterColumns(e){return this.extractDataFromEvent(e,t=>t)}getColumnIds(e){return this.extractDataFromEvent(e,t=>t.getColId())}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":{this.processColumnEvent(e);break}case"columnGroupOpened":{this.processGroupOpenedEvent(e);break}case"columnPivotChanged":j(21);break}})}processGroupOpenedEvent(e){const{colGroupSvc:t}=this.beans;if(t)for(const i of e.columnGroups){let s=null;i&&(s=t.getProvidedColGroup(i.getGroupId())),!(i&&!s)&&t.setColumnGroupOpened(s,i.isExpanded(),"alignedGridChanged")}}processColumnEvent(e){const t=e.column;let i=null;const s=this.beans,{colResize:n,ctrlsSvc:o,colModel:r}=s;if(t&&(i=r.getColDefCol(t.getColId())),t&&!i)return;const a=this.getMasterColumns(e);switch(e.type){case"columnMoved":{const h=e.api.getColumnState().map(u=>({colId:u.colId}));In(s,{state:h,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{const h=e.api.getColumnState().map(u=>({colId:u.colId,hide:u.hide}));In(s,{state:h},"alignedGridChanged")}break;case"columnPinned":{const h=e.api.getColumnState().map(u=>({colId:u.colId,pinned:u.pinned}));In(s,{state:h},"alignedGridChanged")}break;case"columnResized":{const d=e,h={};for(const u of a)h[u.getId()]={key:u.getColId(),newWidth:u.getActualWidth()};for(const u of d.flexColumns??[])h[u.getId()]&&delete h[u.getId()];n==null||n.setColumnWidths(Object.values(h),!1,d.finished,"alignedGridChanged");break}}const c=o.getGridBodyCtrl().isVerticalScrollShowing();for(const d of this.getAlignedGridApis())d.setGridOption("alwaysShowVerticalScroll",c)}},I8={moduleName:"AlignedGrids",version:ne,beans:[M8],dependsOn:[aD]},k8=class extends V{constructor(e){super(),this.rootNode=e,this.nextId=0,this.allNodesMap={},vx(e)}getRowNode(e){return this.allNodesMap[e]}setNewRowData(e){const{selectionSvc:t,pinnedRowModel:i,groupStage:s}=this.beans;t==null||t.reset("rowDataChanged"),i!=null&&i.isManual()&&i.reset(),this.dispatchRowDataUpdateStarted(e),this.allNodesMap=Object.create(null),this.nextId=0;const n=vx(this.rootNode),o=new Array(e.length);n._leafs=o;let r=0;const a=s==null?void 0:s.getNestedDataGetter(),l=a?new Set:null,c=(d,h)=>{const u=d.level+1;for(let f=0,p=h.length;f<p;++f){const m=h[f];if(!m)continue;const v=this.createRowNode(m,u);if(v.sourceRowIndex=r,o[r++]=v,l&&!l.has(m)){l.add(m),v.treeParent=d;const C=a(m);C&&c(v,C)}}};c(n,e),o.length=r}setImmutableRowData(e,t){var C;const{rootNode:i,gos:s}=this;this.dispatchRowDataUpdateStarted(t);const n=Wh(s),o=e.changedRowNodes,{adds:r,updates:a}=o,l=new Set,c=[],d=(C=this.beans.groupStage)==null?void 0:C.getNestedDataGetter();let h=s.get("suppressMaintainUnsortedOrder")?void 0:!1,u=-1,f=!1;const p=(w,S)=>{if(!h&&h!==void 0){const b=w.sourceRowIndex;h=b<=u,u=b}w.data!==S&&(w.updateData(S),r.has(w)||a.add(w),!w.selectable&&w.isSelected()&&c.push(w))},m=(w,S,b)=>{for(let E=0,A=S.length;E<A;++E){const P=S[E];if(!P)continue;let T=this.getRowNode(n({data:P,level:b}));if(T?(p(T,P),f||(f=!!d&&T.treeParent!==w)):(T=this.createRowNode(P,b),r.add(T)),!d||l.has(T)){l.add(T);continue}l.add(T),T.treeParent=w;const D=d(P);D&&m(T,D,b+1)}};m(i,t,0);const v=this.deleteUnusedNodes(l,o,c)||h||r.size>0;if(v){const w=i._leafs??(i._leafs=[]);h===void 0?H8(w,l,o):N8(w,l)&&(o.reordered=!0)}(v||f||a.size)&&(e.rowDataUpdated=!0,this.deselect(c))}deleteUnusedNodes(e,{removals:t},i){const s=this.rootNode._leafs;for(let n=0,o=s.length;n<o;n++){const r=s[n];e.has(r)||(t.add(r),r.isSelected()&&i.push(r),this.deleteNode(r))}return t.size>0}updateRowData(e,t){var a;if(this.dispatchRowDataUpdateStarted(e.add),(a=this.beans.groupStage)!=null&&a.getNestedDataGetter())return j(268),{remove:[],update:[],add:[]};const i=[],s=Wh(this.gos),n=this.executeRemove(s,e,t,i),o=this.executeUpdate(s,e,t,i),r=this.executeAdd(e,t);return this.deselect(i),{remove:n,update:o,add:r}}executeRemove(e,{remove:t},{adds:i,updates:s,removals:n},o){const r=this.rootNode._leafs,a=r==null?void 0:r.length,l=t==null?void 0:t.length;if(!l||!a)return[];let c=0,d=a,h=0,u;const f=new Array(l);for(let p=0;p<l;++p){const m=this.lookupNode(e,t[p]);if(!m)continue;const v=m.sourceRowIndex;v<d&&(d=v),v>h&&(h=v),m.isSelected()&&o.push(m),this.deleteNode(m),i.delete(m)?(u??(u=new Set),u.add(m)):(s.delete(m),n.add(m)),f[c++]=m}return f.length=c,c&&O8(r,d,h,n,u),f}executeUpdate(e,{update:t},{adds:i,updates:s},n){const o=t==null?void 0:t.length;if(!o)return[];const r=new Array(o);let a=0;for(let l=0;l<o;l++){const c=t[l],d=this.lookupNode(e,c);d&&(d.updateData(c),!d.selectable&&d.isSelected()&&n.push(d),r[a++]=d,i.has(d)||s.add(d))}return r.length=a,r}executeAdd(e,t){var i;const s=(i=this.rootNode)._leafs??(i._leafs=[]),n=s.length,o=e.add,r=o==null?void 0:o.length;if(!r)return[];const a=n+r;let l=this.sanitizeAddIndex(s,e.addIndex);if(l<n){for(let h=n-1,u=a-1;h>=l;--h){const f=s[h];f.sourceRowIndex=u,s[u--]=f}t.reordered=!0}s.length=a;const c=new Array(r),d=t.adds;for(let h=0;h<r;h++){const u=this.createRowNode(o[h],0);d.add(u),u.sourceRowIndex=l,s[l]=u,c[h]=u,l++}return c}dispatchRowDataUpdateStarted(e){this.eventSvc.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e!=null&&e.length?e[0]:null})}deselect(e){var s;const t="rowDataChanged",i=this.beans.selectionSvc;e.length&&(i==null||i.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t})),(s=i==null?void 0:i.updateGroupsFromChildrenSelections)==null||s.call(i,t),e.length&&this.eventSvc.dispatchEvent({type:"selectionChanged",source:t,selectedNodes:(i==null?void 0:i.getSelectedNodes())??null,serverSideState:null})}createRowNode(e,t){const i=new za(this.beans);i.parent=this.rootNode,i.level=t,i.group=!1,i.expanded=!1,i.setDataAndId(e,String(this.nextId++));const s=i.id,n=this.allNodesMap;return n[s]&&j(2,{nodeId:s}),n[s]=i,i}deleteNode(e){var n;e.clearRowTopAndRowIndex();const t=e.id,i=this.allNodesMap;i[t]===e&&delete i[t];const s=e.pinnedSibling;s&&((n=this.beans.pinnedRowModel)==null||n.pinRow(s,null))}lookupNode(e,t){if(!e)return L8(this.rootNode._leafs,t);const i=e({data:t,level:0}),s=this.allNodesMap[i];return s||(ut(4,{id:i}),null)}sanitizeAddIndex(e,t){const i=e.length;if(typeof t!="number"||t<0||t>=i||Number.isNaN(t))return i;t=Math.ceil(t);const s=this.gos;return t>0&&s.get("treeData")&&s.get("getDataPath")&&(t=_8(e,t)),t}},_8=(e,t)=>{for(let i=0,s=e.length;i<s;i++){const n=e[i];if((n==null?void 0:n.rowIndex)==t-1)return i+1}return t},vx=e=>{var r;e.group=!0,e.level=-1,e.id="ROOT_NODE_ID",((r=e._leafs)==null?void 0:r.length)!==0&&(e._leafs=[]);const t=[],i=[],s=[],n=[];e.childrenAfterGroup=t,e.childrenAfterSort=i,e.childrenAfterAggFilter=s,e.childrenAfterFilter=n;const o=e.sibling;return o&&(o.childrenAfterGroup=t,o.childrenAfterSort=i,o.childrenAfterAggFilter=s,o.childrenAfterFilter=n,o.childrenMapped=e.childrenMapped),e.updateHasChildren(),e},L8=(e,t)=>{if(e)for(let i=0,s=e.length;i<s;i++){const n=e[i];if(n.data===t)return n}return ut(5,{data:t}),null},O8=(e,t,i,s,n)=>{t=Math.max(0,t);for(let o=t,r=e.length;o<r;++o){const a=e[o];o<=i&&(s.has(a)||n!=null&&n.has(a))||(a.sourceRowIndex=t,e[t++]=a)}e.length=t},N8=(e,t)=>{const i=t.size;e.length=i;let s=0,n=!1,o=!1;for(const r of t){const a=r.sourceRowIndex;a===s?o||(o=n):(a>=0?o=!0:n=!0,r.sourceRowIndex=s,e[s]=r),++s}return o},H8=(e,t,{removals:i,adds:s})=>{const n=e.length;e.length=t.size;let o=0;for(let r=0;r<n;++r){const a=e[r];i.has(a)||(o!==r&&(a.sourceRowIndex=o,e[o]=a),++o)}for(const r of s)r.sourceRowIndex<0&&(r.sourceRowIndex=o,e[o++]=r);e.length=o},iM=e=>{const t=e.childrenAfterSort,i=e.sibling;if(i&&(i.childrenAfterSort=t),!!t)for(let s=0,n=t.length-1;s<=n;s++){const o=t[s],r=s===0,a=s===n;o.firstChild!==r&&(o.firstChild=r,o.dispatchRowEvent("firstChildChanged")),o.lastChild!==a&&(o.lastChild=a,o.dispatchRowEvent("lastChildChanged")),o.childIndex!==s&&(o.childIndex=s,o.dispatchRowEvent("childIndexChanged"))}},G8=class extends V{constructor(){super(...arguments),this.beanName="sortStage",this.step="sort",this.refreshProps=["postSortRows","groupDisplayType","accentedSort"]}execute(e){const t=this.beans.sortSvc.getSortOptions(),i=t.length>0&&!!e.changedRowNodes&&this.gos.get("deltaSort");this.sort(t,i,e.changedRowNodes,e.changedPath)}sort(e,t,i,s){const{gos:n,colModel:o,rowGroupColsSvc:r,rowNodeSorter:a,rowRenderer:l,showRowGroupCols:c}=this.beans,d=n.get("groupMaintainOrder"),h=o.getCols().some(w=>w.isRowGroupActive()),u=r==null?void 0:r.columns,f=o.isPivotMode(),p=n.getCallback("postSortRows");let m=!1,v;const C=w=>{var A,P;const S=f&&w.leafGroup;let b=d&&h&&!w.leafGroup;b&&(v??(v=this.shouldSortContainsGroupCols(e)),b&&(b=!v));let E=null;if(b){let T=!1;if(u){const D=w.level+1;D<u.length&&(T=u[D].getSort()===null)}T||(E=z8(w))}else!e.length||S||(t&&i?E=B8(a,w,i,s,e):E=a.doFullSort(w.childrenAfterAggFilter,e));if(E||(E=((A=w.childrenAfterAggFilter)==null?void 0:A.slice(0))??[]),m||(m=((P=w.childrenAfterSort)==null?void 0:P[0])!==E[0]),w.childrenAfterSort=E,iM(w),p){const T={nodes:w.childrenAfterSort};p(T)}};if(s==null||s.forEachChangedNodeDepthFirst(C),m&&n.get("groupHideOpenParents")){const w=c==null?void 0:c.getShowRowGroupCols();w!=null&&w.length&&l.refreshCells({columns:w,force:!0})}}shouldSortContainsGroupCols(e){const t=e.length;if(!t)return!1;if(mo(this.gos)){for(let i=0;i<t;++i){const s=e[i].column;if(s.isPrimary()&&s.isRowGroupActive())return!0}return!1}for(let i=0;i<t;++i)if(e[i].column.getColDef().showRowGroup)return!0;return!1}},B8=(e,t,i,s,n)=>{const o=t.childrenAfterAggFilter,r=t.childrenAfterSort;if(!r)return e.doFullSort(o,n);const a=new Set,l=[],{updates:c,adds:d}=i;for(let u=0,f=o.length;u<f;++u){const p=o[u];c.has(p)||d.has(p)||s&&!s.canSkip(p)?l.push({currentPos:l.length,rowNode:p}):a.add(p)}const h=r.filter(u=>a.has(u)).map((u,f)=>({currentPos:f,rowNode:u}));return l.sort((u,f)=>e.compareRowNodes(n,u,f)),V8(e,n,l,h)},V8=(e,t,i,s)=>{let n=0,o=0;const r=i.length,a=s.length,l=new Array(r+a);let c=0;for(;n<r&&o<a;){const d=i[n],h=s[o];e.compareRowNodes(t,d,h)<0?(l[c++]=d.rowNode,++n):(l[c++]=h.rowNode,++o)}for(;n<r;)l[c++]=i[n++].rowNode;for(;o<a;)l[c++]=s[o++].rowNode;return l},z8=e=>{const t=e.childrenAfterSort,i=e.childrenAfterAggFilter,s=t==null?void 0:t.length,n=i==null?void 0:i.length;if(!s||!n)return null;const o=new Array(n),r=new Set;for(let l=0;l<n;++l)r.add(i[l]);let a=0;for(let l=0;l<s;++l){const c=t[l];r.delete(c)&&(o[a++]=c)}if(r.size===0&&a===s)return t;for(const l of r)o[a++]=l;return o.length=a,o},W8=class extends V{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null,this.rowCountReady=!1,this.nodeManager=void 0,this.rowsToDisplay=[],this.rowDataUpdatedPending=!1,this.asyncTransactions=null,this.asyncTransactionsTimer=0,this.started=!1,this.refreshingModel=!1,this.rowNodesCountReady=!1,this.stages=[],this.stagesRefreshProps=new Map,this.onRowHeightChanged_debounced=Pi(this,this.onRowHeightChanged.bind(this),100)}postConstruct(){const e=this.beans,t=new za(e);this.rootNode=t,this.nodeManager=this.createBean(new k8(t));const i=this.refreshModel.bind(this,{step:"group"}),s=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame")});this.addManagedEventListeners({newColumnsLoaded:s,columnRowGroupChanged:i,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:"pivot"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:i,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this),rowExpansionStateChanged:this.onRowGroupOpened.bind(this)}),this.addPropertyListeners()}addPropertyListeners(){const{beans:e,stagesRefreshProps:t}=this,i=[e.groupStage,e.filterStage,e.pivotStage,e.aggStage,e.sortStage,e.filterAggStage,e.flattenStage].filter(s=>!!s);this.stages=i;for(let s=i.length-1;s>=0;--s)for(const n of i[s].refreshProps)t.set(n,s);this.addManagedPropertyListeners([...t.keys()],s=>{var o;const n=(o=s.changeSet)==null?void 0:o.properties;n&&this.onPropChange(n)}),this.addManagedPropertyListener("rowData",()=>this.onPropChange(["rowData"])),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.started=!0,this.rowNodesCountReady?this.refreshModel({step:"group",rowDataUpdated:!0,newData:!0}):this.setInitialData()}setInitialData(){this.gos.get("rowData")&&this.onPropChange(["rowData"])}ensureRowHeightsValid(e,t,i,s){let n,o=!1;do{n=!1;const r=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(r,i),c=Math.min(a,s);for(let d=l;d<=c;d++){const h=this.getRow(d);if(h.rowHeightEstimated){const u=Ba(this.beans,h);h.setRowHeight(u.height),n=!0,o=!0}}n&&this.setRowTopAndRowIndex()}while(n);return o}onPropChange(e){const{nodeManager:t,gos:i,beans:s}=this,n=s.groupStage;if(!t)return;const o=new Set(e),r=n==null?void 0:n.onPropChange(o);let a;o.has("rowData")?a=i.get("rowData"):r&&(a=n==null?void 0:n.extractData()),a&&!Array.isArray(a)&&(a=null,j(1));const l={step:"nothing",changedProps:o};a&&(!r&&!this.isEmpty()&&a.length>0&&i.exists("getRowId")&&!i.get("resetRowDataOnUpdate")?(l.keepRenderedRows=!0,l.animate=!i.get("suppressAnimationFrame"),l.changedRowNodes=new pm,t.setImmutableRowData(l,a)):(l.rowDataUpdated=!0,l.newData=!0,t.setNewRowData(a),this.rowNodesCountReady=!0));const c=l.rowDataUpdated?"group":this.getRefreshedStage(e);c&&(l.step=c,this.refreshModel(l))}getRefreshedStage(e){const{stages:t,stagesRefreshProps:i}=this,s=t.length;let n=s;for(let o=0,r=e.length;o<r&&n;++o)n=Math.min(n,i.get(e[o])??n);return n<s?t[n].step:null}setRowTopAndRowIndex(e){const{beans:t,rowsToDisplay:i}=this,s=t.environment.getDefaultRowHeight();let n=0;const o=Ii(this.gos,"normal");for(let r=0,a=i.length;r<a;++r){const l=i[r],c=l.id;if(c!=null&&(e==null||e.add(c)),l.rowHeight==null){const d=Ba(t,l,o,s);l.setRowHeight(d.height,d.estimated)}l.setRowTop(n),l.setRowIndex(r),n+=l.rowHeight}}clearRowTopAndRowIndex(e,t){const i=e.active,s=r=>{(r==null?void 0:r.id)!=null&&!t.has(r.id)&&r.clearRowTopAndRowIndex()},n=r=>{s(r),s(r.detailNode),s(r.sibling);const a=r.childrenAfterGroup;if(!r.hasChildren()||!a)return;const l=r.level==-1;if(!(i&&!l&&!r.expanded))for(let d=0,h=a.length;d<h;++d)n(a[d])},o=this.rootNode;o&&n(o)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay.length}getTopLevelRowCount(){var n,o;const{rootNode:e,rowsToDisplay:t}=this;if(!e||!t.length)return 0;if(t[0]===e)return 1;const s=(n=e.sibling)!=null&&n.displayed?1:0;return(((o=e.childrenAfterSort)==null?void 0:o.length)??0)+s}getTopLevelRowDisplayedIndex(e){const{beans:t,rootNode:i,rowsToDisplay:s}=this;if(!i||!s.length||s[0]===i)return e;const o=i.childrenAfterSort,r=l=>{let c=o[l];if(this.gos.get("groupHideOpenParents"))for(;c.expanded&&c.childrenAfterSort&&c.childrenAfterSort.length>0;)c=c.childrenAfterSort[0];return c.rowIndex},a=t.footerSvc;return a?a==null?void 0:a.getTopDisplayIndex(s,e,o,r):r(e)}getTopLevelIndexFromDisplayedIndex(e){var a;const{rootNode:t,rowsToDisplay:i}=this;if(!t||!i.length||i[0]===t)return e;let n=this.getRow(e);n.footer&&(n=n.sibling);let o=n.parent;for(;o&&o!==t;)n=o,o=n.parent;const r=((a=t.childrenAfterSort)==null?void 0:a.indexOf(n))??-1;return r>=0?r:e}getRowBounds(e){const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){this.refreshModel({step:"map",keepRenderedRows:!0,animate:xd(this.gos)})}onFilterChanged({afterDataChange:e,columns:t}){if(!e){const s=t.length===0||t.some(n=>n.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:s,keepRenderedRows:!0,animate:xd(this.gos)})}}onSortChanged(){this.refreshModel({step:"sort",keepRenderedRows:!0,animate:xd(this.gos)})}getType(){return"clientSide"}onValueChanged(){this.refreshModel({step:this.beans.colModel.isPivotActive()?"pivot":"aggregate"})}createChangePath(e){const t=new mg(!1,this.rootNode);return t.active=e,t}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;const{changedRowNodes:t,newData:i,rowDataUpdated:s}=e;return!(!t||i||!s||t.removals.size||t.adds.size)}refreshModel(e){var c,d;const{nodeManager:t,beans:i,eventSvc:s,started:n,refreshingModel:o}=this;if(!t)return;const r=!!e.rowDataUpdated,a=e.changedPath??(e.changedPath=this.createChangePath(!e.newData&&r));if(n&&r&&s.dispatchEvent({type:"rowDataUpdated"}),!n||o||i.colModel.changeEventsDispatching||this.isSuppressModelUpdateAfterUpdateTransaction(e)){this.rowDataUpdatedPending||(this.rowDataUpdatedPending=r);return}switch(this.rowDataUpdatedPending&&(this.rowDataUpdatedPending=!1,e.step="group"),this.refreshingModel=!0,(c=i.masterDetailSvc)==null||c.refreshModel(e),r&&e.step!=="group"&&((d=i.colFilter)==null||d.refreshModel()),e.step){case"group":this.doGrouping(e);case"filter":this.doFilter(a);case"pivot":this.doPivot(a);case"aggregate":this.doAggregate(a);case"filter_aggregates":this.doFilterAggregates(a);case"sort":this.doSort(e.changedRowNodes,a);case"map":this.doRowsToDisplay()}const l=new Set;this.setRowTopAndRowIndex(l),this.clearRowTopAndRowIndex(a,l),this.refreshingModel=!1,s.dispatchEvent({type:"modelUpdated",animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1,keepUndoRedoStack:e.keepUndoRedoStack})}isEmpty(){var e,t,i;return!((t=(e=this.rootNode)==null?void 0:e._leafs)!=null&&t.length)||!((i=this.beans.colModel)!=null&&i.ready)}isRowsToRender(){return this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let i=!1,s=!1;const n=[],o=gg(this.gos);return this.forEachNodeAfterFilterAndSort(r=>{if(s)return;if(i&&(r===t||r===e)&&(s=!0,o&&r.group)){sM(n,r);return}if(!i){if(r!==t&&r!==e)return;i=!0,t===e&&(s=!0)}(!r.group||!o)&&n.push(r)}),n}getTopLevelNodes(){var e;return((e=this.rootNode)==null?void 0:e.childrenAfterGroup)??null}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){const t=this.rowsToDisplay,i=t.length;if(this.isEmpty()||i===0)return-1;let s=0,n=i-1;if(e<=0)return 0;if(t[n].rowTop<=e)return n;let r=-1,a=-1;for(;;){const l=Math.floor((s+n)/2),c=t[l];if(this.isRowInPixel(c,e)||(c.rowTop<e?s=l+1:c.rowTop>e&&(n=l-1),r===s&&a===n))return l;r=s,a=n}}isRowInPixel(e,t){const i=e.rowTop,s=i+e.rowHeight;return i<=t&&s>t}forEachLeafNode(e){var i;const t=(i=this.rootNode)==null?void 0:i._leafs;if(t)for(let s=0,n=t.length;s<n;++s)e(t[s],s)}forEachNode(e,t=!1){this.depthFirstSearchRowNodes(e,t)}forEachDisplayedNode(e){const t=this.rowsToDisplay;for(let i=0,s=t.length;i<s;++i)e(t[i],i)}forEachNodeAfterFilter(e,t=!1){this.depthFirstSearchRowNodes(e,t,i=>i.childrenAfterAggFilter)}forEachNodeAfterFilterAndSort(e,t=!1){this.depthFirstSearchRowNodes(e,t,i=>i.childrenAfterSort)}forEachPivotNode(e,t,i){const{colModel:s,rowGroupColsSvc:n}=this.beans;if(!s.isPivotMode())return;if(!(n!=null&&n.columns.length)){e(this.rootNode,0);return}const o=i?"childrenAfterSort":"childrenAfterGroup";this.depthFirstSearchRowNodes(e,t,r=>r.leafGroup?null:r[o])}depthFirstSearchRowNodes(e,t=!1,i=o=>o.childrenAfterGroup,s=this.rootNode,n=0){let o=n;if(!s)return o;const r=s===this.rootNode;if(r||e(s,o++),s.hasChildren()&&!s.footer){const a=i(s);if(a){const l=this.beans.footerSvc;o=(l==null?void 0:l.addTotalRows(o,s,e,t,r,"top"))??o;for(const c of a)o=this.depthFirstSearchRowNodes(e,t,i,c,o);return(l==null?void 0:l.addTotalRows(o,s,e,t,r,"bottom"))??o}}return o}doAggregate(e){var i;const t=this.rootNode;t&&((i=this.beans.aggStage)==null||i.execute({rowNode:t,changedPath:e}))}doFilterAggregates(e){const t=this.rootNode,i=this.beans.filterAggStage;if(i){i.execute({rowNode:t,changedPath:e});return}t.childrenAfterAggFilter=t.childrenAfterFilter}doSort(e,t){const i=this.beans.sortStage;if(i){i.execute({rowNode:this.rootNode,changedRowNodes:e,changedPath:t});return}t.forEachChangedNodeDepthFirst(s=>{s.childrenAfterSort=s.childrenAfterAggFilter.slice(0),iM(s)})}doGrouping(e){var n;const t=this.rootNode,i=this.beans.groupStage,s=i==null?void 0:i.execute({rowNode:t,changedRowNodes:e.changedRowNodes,changedPath:e.changedPath,afterColumnsChanged:!!e.afterColumnsChanged});if(s===void 0){const o=t._leafs;t.childrenAfterGroup=o,t.updateHasChildren();const r=t.sibling;r&&(r.childrenAfterGroup=o)}(s||e.rowDataUpdated)&&((n=this.beans.colFilter)==null||n.refreshModel()),!this.rowCountReady&&this.rowNodesCountReady&&(this.rowCountReady=!0,this.eventSvc.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){const t=this.beans.filterStage;if(t){t.execute({rowNode:this.rootNode,changedPath:e});return}e.forEachChangedNodeDepthFirst(i=>{i.childrenAfterFilter=i.childrenAfterGroup,PD(i)},!0)}doPivot(e){var t;(t=this.beans.pivotStage)==null||t.execute({rowNode:this.rootNode,changedPath:e})}getRowNode(e){var s,n;const t=(s=this.nodeManager)==null?void 0:s.getRowNode(e);return typeof t=="object"?t:typeof e=="string"&&e.indexOf(ty)===0?(n=this.beans.groupStage)==null?void 0:n.getNode(e):void 0}batchUpdateRowData(e,t){if(!this.asyncTransactionsTimer){this.asyncTransactions=[];const i=this.gos.get("asyncTransactionWaitMillis");this.asyncTransactionsTimer=setTimeout(()=>this.executeBatchUpdateRowData(),i)}this.asyncTransactions.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){const e=this.asyncTransactionsTimer;e&&(clearTimeout(e),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){var a;const{nodeManager:e,beans:t,eventSvc:i,asyncTransactions:s}=this;if(!e)return;(a=t.valueCache)==null||a.onDataChanged();const n=[],o=[],r=new pm;for(const{rowDataTransaction:l,callback:c}of s??[]){this.rowNodesCountReady=!0;const d=e.updateRowData(l,r);n.push(d),c&&o.push(c.bind(null,d))}this.commitTransactions(r),o.length>0&&setTimeout(()=>{for(let l=0,c=o.length;l<c;l++)o[l]()},0),n.length>0&&i.dispatchEvent({type:"asyncTransactionsFlushed",results:n}),this.asyncTransactionsTimer=0,this.asyncTransactions=null}updateRowData(e){var n;const t=this.nodeManager;if(!t)return null;(n=this.beans.valueCache)==null||n.onDataChanged(),this.rowNodesCountReady=!0;const i=new pm,s=t.updateRowData(e,i);return this.commitTransactions(i),s}commitTransactions(e){this.refreshModel({step:"group",rowDataUpdated:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedRowNodes:e,changedPath:this.createChangePath(!0)})}doRowsToDisplay(){const{beans:e,rootNode:t}=this,i=e.flattenStage;if(i){this.rowsToDisplay=i.execute({rowNode:t});return}const s=this.rootNode.childrenAfterSort??[];for(const n of s)n.setUiLevel(0);this.rowsToDisplay=s}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepUndoRedoStack:!0})}resetRowHeights(){const e=this.rootNode;if(!e)return;const t=this.resetRowHeightsForAllRowNodes();e.setRowHeight(e.rowHeight,!0);const i=e.sibling;i==null||i.setRowHeight(i.rowHeight,!0),t&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);const i=t.detailNode;i==null||i.setRowHeight(i.rowHeight,!0);const s=t.sibling;s==null||s.setRowHeight(s.rowHeight,!0),e=!0}),e}onGridStylesChanges(e){var t;e.rowHeightChanged&&!((t=this.beans.rowAutoHeight)!=null&&t.active)&&this.resetRowHeights()}onGridReady(){this.started||this.setInitialData()}destroy(){super.destroy(),this.nodeManager=this.destroyBean(this.nodeManager),this.started=!1,this.rootNode=null,this.rowsToDisplay=[],this.asyncTransactions=null,clearTimeout(this.asyncTransactionsTimer)}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}},sM=(e,t)=>{const i=t.childrenAfterGroup;if(i)for(let s=0,n=i.length;s<n;++s){const o=i[s];o.data&&e.push(o),o.group&&sM(e,o)}};function $8(e){var t;(t=e.expansionSvc)==null||t.onGroupExpandedOrCollapsed()}function U8(e,t){const i=Qa(e);i&&((!t||t==="everything")&&(t="group"),i.refreshModel({step:t,keepRenderedRows:!0,animate:!e.gos.get("suppressAnimationFrame")}))}function j8(e){var t;return((t=Qa(e))==null?void 0:t.isEmpty())??!0}function K8(e,t){var i;(i=Qa(e))==null||i.forEachLeafNode(t)}function q8(e,t){var i;(i=Qa(e))==null||i.forEachNodeAfterFilter(t)}function Y8(e,t){var i;(i=Qa(e))==null||i.forEachNodeAfterFilterAndSort(t)}function X8(e,t){return e.frameworkOverrides.wrapIncoming(()=>{var i;return(i=Qa(e))==null?void 0:i.updateRowData(t)})}function Q8(e,t,i){e.frameworkOverrides.wrapIncoming(()=>{var s;return(s=Qa(e))==null?void 0:s.batchUpdateRowData(t,i)})}function J8(e){e.frameworkOverrides.wrapIncoming(()=>{var t;return(t=Qa(e))==null?void 0:t.flushAsyncTransactions()})}function Z8(e){var t;return(t=e.selectionSvc)==null?void 0:t.getBestCostNodeSelection()}var eK={moduleName:"ClientSideRowModel",version:ne,rowModels:["clientSide"],beans:[W8,G8],dependsOn:[xD]},tK={moduleName:"ClientSideRowModelApi",version:ne,apiFunctions:{onGroupExpandedOrCollapsed:$8,refreshClientSideRowModel:U8,isRowDataEmpty:j8,forEachLeafNode:K8,forEachNodeAfterFilter:q8,forEachNodeAfterFilterAndSort:Y8,applyTransaction:X8,applyTransactionAsync:Q8,flushAsyncTransactions:J8,getBestCostNodeSelection:Z8,resetRowHeights:tM,onRowHeightChanged:eM},dependsOn:[P8,T8]},iK=class extends V{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel}serialize(e,t={}){const{allColumns:i,columnKeys:s,skipRowGroups:n,exportRowNumbers:o}=t,r=this.getColumnsToExport({allColumns:i,skipRowGroups:n,columnKeys:s,exportRowNumbers:o});return[this.prepareSession(r),this.prependContent(t),this.exportColumnGroups(t,r),this.exportHeaders(t,r),this.processPinnedTopRows(t,r),this.processRows(t,r),this.processPinnedBottomRows(t,r),this.appendContent(t)].reduce((a,l)=>l(a),e).parse()}processRow(e,t,i,s){var p;const n=t.shouldRowBeSkipped||(()=>!1),r=t.rowPositions!=null||!!t.onlySelected,a=this.gos.get("groupHideOpenParents")&&!r,l=this.colModel.isPivotMode()?s.leafGroup:!s.group,c=!!s.footer,d=s.allChildrenCount===1&&((p=s.childrenAfterGroup)==null?void 0:p.length)===1&&iG(this.gos,s);if(!l&&!c&&(t.skipRowGroups||d||a)||t.onlySelected&&!s.isSelected()||t.skipPinnedTop&&s.rowPinned==="top"||t.skipPinnedBottom&&s.rowPinned==="bottom"||s.stub||s.level===-1&&!l&&!c||n(Fe(this.gos,{node:s})))return;const f=e.onNewBodyRow(s);if(i.forEach((m,v)=>{f.onColumn(m,v,s)}),t.getCustomContentBelowRow){const m=t.getCustomContentBelowRow(Fe(this.gos,{node:s}));m&&e.addCustomContent(m)}}appendContent(e){return t=>{const i=e.appendContent;return i&&t.addCustomContent(i),t}}prependContent(e){return t=>{const i=e.prependContent;return i&&t.addCustomContent(i),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return i=>{if(!e.skipColumnGroupHeaders){const s=new iT,{colGroupSvc:n}=this.beans,o=n?n.createColumnGroups({columns:t,idCreator:s,pinned:null,isStandaloneStructure:!0}):t;this.recursivelyAddHeaderGroups(o,i,e.processGroupHeaderCallback)}return i}}exportHeaders(e,t){return i=>{if(!e.skipColumnHeaders){const s=i.onNewHeaderRow();t.forEach((n,o)=>{s.onColumn(n,o,void 0)})}return i}}processPinnedTopRows(e,t){return i=>{var n,o;const s=this.processRow.bind(this,i,e,t);return e.rowPositions?e.rowPositions.filter(r=>r.rowPinned==="top").sort((r,a)=>r.rowIndex-a.rowIndex).map(r=>{var a;return(a=this.pinnedRowModel)==null?void 0:a.getPinnedTopRow(r.rowIndex)}).forEach(s):(n=this.pinnedRowModel)!=null&&n.isManual()||(o=this.pinnedRowModel)==null||o.forEachPinnedRow("top",s),i}}processRows(e,t){return i=>{var c;const s=this.rowModel,n=Ut(this.gos),o=iu(this.gos),r=!n&&e.onlySelected,a=this.processRow.bind(this,i,e,t),{exportedRows:l="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter(d=>d.rowPinned==null).sort((d,h)=>d.rowIndex-h.rowIndex).map(d=>s.getRow(d.rowIndex)).forEach(a);else if(this.colModel.isPivotMode())n?s.forEachPivotNode(a,!0,l==="filteredAndSorted"):o?s.forEachNodeAfterFilterAndSort(a,!0):s.forEachNode(a);else if(e.onlySelectedAllPages||r){const d=((c=this.beans.selectionSvc)==null?void 0:c.getSelectedNodes())??[];this.replicateSortedOrder(d),d.forEach(a)}else l==="all"?s.forEachNode(a):n||o?s.forEachNodeAfterFilterAndSort(a,!0):s.forEachNode(a);return i}}replicateSortedOrder(e){const{sortSvc:t,rowNodeSorter:i}=this.beans;if(!t||!i)return;const s=t.getSortOptions(),n=(o,r)=>{var a,l;return o.rowIndex!=null&&r.rowIndex!=null?o.rowIndex-r.rowIndex:o.level===r.level?((a=o.parent)==null?void 0:a.id)===((l=r.parent)==null?void 0:l.id)?i.compareRowNodes(s,{rowNode:o,currentPos:o.rowIndex??-1},{rowNode:r,currentPos:r.rowIndex??-1}):n(o.parent,r.parent):o.level>r.level?n(o.parent,r):n(o,r.parent)};e.sort(n)}processPinnedBottomRows(e,t){return i=>{var n,o;const s=this.processRow.bind(this,i,e,t);return e.rowPositions?e.rowPositions.filter(r=>r.rowPinned==="bottom").sort((r,a)=>r.rowIndex-a.rowIndex).map(r=>{var a;return(a=this.pinnedRowModel)==null?void 0:a.getPinnedBottomRow(r.rowIndex)}).forEach(s):(n=this.pinnedRowModel)!=null&&n.isManual()||(o=this.pinnedRowModel)==null||o.forEachPinnedRow("bottom",s),i}}getColumnsToExport(e){const{allColumns:t=!1,skipRowGroups:i=!1,exportRowNumbers:s=!1,columnKeys:n}=e,{colModel:o,gos:r,visibleCols:a}=this,l=o.isPivotMode(),c=u=>Or(u)?!1:!yr(u)||s;if(n!=null&&n.length)return o.getColsForKeys(n).filter(c);const d=r.get("treeData");let h=[];return t&&!l?h=o.getCols():h=a.allCols,h=h.filter(u=>c(u)&&(i&&!d?!pS(u):!0)),h}recursivelyAddHeaderGroups(e,t,i){const s=[];for(const n of e){const o=n;if(o.getChildren)for(const r of o.getChildren()??[])s.push(r)}e.length>0&&$t(e[0])&&this.doAddHeaderHeader(t,e,i),s&&s.length>0&&this.recursivelyAddHeaderGroups(s,t,i)}doAddHeaderHeader(e,t,i){const s=e.onNewHeaderGroupingRow();let n=0;for(const o of t){const r=o;let a;i?a=i(Fe(this.gos,{columnGroup:r})):a=this.beans.colNames.getDisplayNameForColumnGroup(r,"header");const c=(r.isExpandable()?r.getLeafColumns():[]).reduce((d,h,u,f)=>{let p=Ct(d);return h.getColumnGroupShow()==="open"?(!p||p[1]!=null)&&(p=[u],d.push(p)):p&&p[1]==null&&(p[1]=u-1),u===f.length-1&&p&&p[1]==null&&(p[1]=u),d},[]);s.onColumn(r,a||"",n++,r.getLeafColumns().length-1,c)}}},sK={moduleName:"SharedExport",version:ne,beans:[iK]},Cx=`\r
`,nK=class extends I4{constructor(e){super(e),this.config=e,this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:i}=e;this.suppressQuotes=t,this.columnSeparator=i}addCustomContent(e){e&&(typeof e=="string"?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,Cx),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((i,s)=>{s!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(i.data.value||""),i.mergeAcross&&this.appendEmptyCells(i.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,i,s){i!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(s)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){t!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,i){t!=0&&(this.result+=this.columnSeparator);const s=this.extractRowCellValue(e,t,t,"csv",i);this.result+=this.putInQuotes(s.valueFormatted??s.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(e==null)return'""';let t;return typeof e=="string"?t=e:typeof e.toString=="function"?t=e.toString():(j(53),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=Cx),this.isFirstLine=!1}},oK=class extends M4{constructor(){super(...arguments),this.beanName="csvCreator"}wireBeans(e){this.colModel=e.colModel,this.colNames=e.colNames,this.rowGroupColsSvc=e.rowGroupColsSvc,this.valueSvc=e.valueSvc}getMergedParams(e){const t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){j(51);return}const t=this.getMergedParams(e),i=this.getData(t),s=new Blob(["\uFEFF",i],{type:"text/plain"}),n=typeof t.fileName=="function"?t.fileName(Fe(this.gos,{})):t.fileName;k4(this.getFileName(n),s)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){const i=t?Object.assign({},e):this.getMergedParams(e);return this.getData(i)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{colModel:t,colNames:i,rowGroupColsSvc:s,valueSvc:n,gos:o}=this,{processCellCallback:r,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c,suppressQuotes:d,columnSeparator:h}=e;return new nK({colModel:t,colNames:i,valueSvc:n,gos:o,processCellCallback:r||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:c||void 0,suppressQuotes:d||!1,columnSeparator:h||",",rowGroupColsSvc:s})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};function rK(e,t){var i;return(i=e.csvCreator)==null?void 0:i.getDataAsCsv(t)}function aK(e,t){var i;(i=e.csvCreator)==null||i.exportDataAsCsv(t)}var lK={moduleName:"CsvExport",version:ne,beans:[oK],apiFunctions:{getDataAsCsv:rK,exportDataAsCsv:aK},dependsOn:[sK]},cK=class extends V{constructor(e,t,i){super(),this.id=e,this.parentCache=t,this.params=i,this.state="needsLoading",this.version=0,this.startRow=e*i.blockSize,this.endRow=this.startRow+i.blockSize}load(){this.state="loading",this.loadFromDatasource()}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed"),this.dispatchLocalEvent({type:"loadComplete"})}pageLoaded(e,t,i){this.successCommon(e,{rowData:t,rowCount:i})}isRequestMostRecentAndLive(e){const t=e===this.version,i=this.isAlive();return t&&i}successCommon(e,t){this.dispatchLocalEvent({type:"loadComplete"}),this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}postConstruct(){this.rowNodes=[];const{params:{blockSize:e,rowHeight:t},startRow:i,beans:s,rowNodes:n}=this;for(let o=0;o<e;o++){const r=i+o,a=new za(s);a.setRowHeight(t),a.uiLevel=0,a.setRowIndex(r),a.setRowTop(t*r),n.push(a)}}getBlockStateJson(){const{id:e,startRow:t,endRow:i,state:s}=this;return{id:""+e,state:{blockNumber:e,startRow:t,endRow:i,pageStatus:s}}}setDataAndId(e,t,i){ae(t)?e.setDataAndId(t,i.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){const e=this.createLoadParams();if(At(this.params.datasource.getRows)){j(90);return}window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}createLoadParams(){const{startRow:e,endRow:t,version:i,params:{sortModel:s,filterModel:n},gos:o}=this;return{startRow:e,endRow:t,successCallback:this.pageLoaded.bind(this,i),failCallback:this.pageLoadFailed.bind(this,i),sortModel:s,filterModel:n,context:Fe(o,{}).context}}forEachNode(e,t,i){this.rowNodes.forEach((s,n)=>{this.startRow+n<i&&e(s,t.value++)})}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.value++);const i=e-this.startRow;return this.rowNodes[i]}processServerResult(e){const{rowNodes:t,beans:i}=this;t.forEach((n,o)=>{const r=e.rowData?e.rowData[o]:void 0;!n.id&&n.alreadyRendered&&r&&(t[o]=new za(i),t[o].setRowIndex(n.rowIndex),t[o].setRowTop(n.rowTop),t[o].setRowHeight(n.rowHeight),n.clearRowTopAndRowIndex()),this.setDataAndId(t[o],r,this.startRow+o)});const s=e.rowCount!=null&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,s)}destroy(){for(const e of this.rowNodes)e.clearRowTopAndRowIndex();super.destroy()}},dK=2,hK=class extends V{constructor(e){super(),this.params=e,this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount}getRow(e,t=!1){const i=Math.floor(e/this.params.blockSize);let s=this.blocks[i];if(!s){if(t)return;s=this.createBlock(i)}return s.getRow(e)}createBlock(e){const t=this.params,i=this.createBean(new cK(e,this,t));return this.blocks[i.id]=i,this.blockCount++,this.purgeBlocksIfNeeded(i),t.rowNodeBlockLoader.addBlock(i),i}refreshCache(){if(this.blockCount==0){this.purgeCache();return}for(const t of this.getBlocksInOrder())t.setStateWaitingToLoad();this.params.rowNodeBlockLoader.checkBlockToLoad()}destroy(){for(const e of this.getBlocksInOrder())this.destroyBlock(e);super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(Ga(this.gos,`InfiniteCache - onPageLoaded: page = ${e.id}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){const t=this.getBlocksInOrder().filter(r=>r!=e),i=(r,a)=>a.lastAccessed-r.lastAccessed;t.sort(i);const s=this.params.maxBlocksInCache>0,n=s?this.params.maxBlocksInCache-1:null,o=dK-1;t.forEach((r,a)=>{const l=r.state==="needsLoading"&&a>=o,c=s?a>=n:!1;if(l||c){if(this.isBlockCurrentlyDisplayed(r)||this.isBlockFocused(r))return;this.removeBlockFromCache(r)}})}isBlockFocused(e){const t=this.beans.focusSvc.getFocusCellToUseAfterRefresh();if(!t||t.rowPinned!=null)return!1;const{startRow:i,endRow:s}=e;return t.rowIndex>=i&&t.rowIndex<s}isBlockCurrentlyDisplayed(e){const{startRow:t,endRow:i}=e;return this.beans.rowRenderer.isRangeInRenderedViewport(t,i-1)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if(typeof t=="number"&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const{blockSize:i,overflowSize:s}=this.params,o=(e.id+1)*i+s;this.rowCount<o&&(this.rowCount=o)}}setRowCount(e,t){this.rowCount=e,ae(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){const t={value:0};for(const i of this.getBlocksInOrder())i.forEachNode(e,t,this.rowCount)}getBlocksInOrder(){const e=(i,s)=>i.id-s.id;return Object.values(this.blocks).sort(e)}destroyBlock(e){delete this.blocks[e.id],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventSvc.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){const e=[];for(const t of this.getBlocksInOrder())t.id*this.params.blockSize>=this.rowCount&&e.push(t);if(e.length>0)for(const t of e)this.destroyBlock(t)}purgeCache(){for(const e of this.getBlocksInOrder())this.removeBlockFromCache(e);this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){const i=[];let s=-1,n=!1;const o={value:0};let r=!1;for(const l of this.getBlocksInOrder())if(!r){if(n&&s+1!==l.id){r=!0;continue}s=l.id,l.forEachNode(c=>{const d=c===e||c===t;(n||d)&&i.push(c),d&&(n=!n)},o,this.rowCount)}return r||n?[]:i}},uK=class extends V{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){if(this.gos.get("rowModelType")!=="infinite")return;const e=this.beans,t=new za(e);this.rootNode=t,t.level=-1,this.rowHeight=yc(e),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache())}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy(),this.rootNode=null}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.beans.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.reset.bind(this),sortChanged:this.reset.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.dispatchModelUpdatedEvent.bind(this)}),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=yc(this.beans),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onColumnEverything(){var t;let e;this.cacheParams?e=!rg(this.cacheParams.sortModel,((t=this.beans.sortSvc)==null?void 0:t.getSortModel())??[]):e=!0,e&&this.reset()}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){var i;return((i=this.infiniteCache)==null?void 0:i.getRowNodesInRange(e,t))??[]}reset(){var i;if(!this.datasource)return;Wh(this.gos)!=null||(i=this.beans.selectionSvc)==null||i.reset("rowDataChanged"),this.resetCache()}dispatchModelUpdatedEvent(){this.eventSvc.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){this.destroyCache();const e=this.beans,{filterManager:t,sortSvc:i,rowNodeBlockLoader:s,eventSvc:n,gos:o}=e;this.cacheParams={datasource:this.datasource,filterModel:(t==null?void 0:t.getFilterModel())??{},sortModel:(i==null?void 0:i.getSortModel())??[],rowNodeBlockLoader:s,initialRowCount:o.get("infiniteInitialRowCount"),maxBlocksInCache:o.get("maxBlocksInCache"),rowHeight:yc(e),overflowSize:o.get("cacheOverflowSize"),blockSize:o.get("cacheBlockSize"),lastAccessedSequence:{value:0}},this.infiniteCache=this.createBean(new hK(this.cacheParams)),n.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode(e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)}),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache=this.destroyBean(this.infiniteCache)}getRow(e){const t=this.infiniteCache;if(t&&!(e>=t.getRowCount()))return t.getRow(e)}getRowNode(e){let t;return this.forEachNode(i=>{i.id===e&&(t=i)}),t}forEachNode(e){var t;(t=this.infiniteCache)==null||t.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(this.rowHeight!==0){const t=Math.floor(e/this.rowHeight),i=this.getRowCount()-1;return t>i?i:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){var e;(e=this.infiniteCache)==null||e.refreshCache()}purgeCache(){var e;(e=this.infiniteCache)==null||e.purgeCache()}isLastRowIndexKnown(){var e;return((e=this.infiniteCache)==null?void 0:e.isLastRowIndexKnown())??!1}setRowCount(e,t){var i;(i=this.infiniteCache)==null||i.setRowCount(e,t)}resetRowHeights(){}onRowHeightChanged(){}};function gK(e){var t;(t=jv(e))==null||t.refreshCache()}function fK(e){var t;(t=jv(e))==null||t.purgeCache()}function pK(e){var t;return(t=jv(e))==null?void 0:t.getRowCount()}var mK=class extends V{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=sG(this.gos);const e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=Pi(this,this.performCheckBlocksToLoad.bind(this),e))}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){_n(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad()}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){Ga(this.gos,"RowNodeBlockLoader - checkBlockToLoad: max loads exceeded");return}const e=this.maxConcurrentRequests!=null?this.maxConcurrentRequests-this.activeBlockLoadsCount:1,t=this.blocks.filter(i=>i.state==="needsLoading").slice(0,e);this.activeBlockLoadsCount+=t.length;for(const i of t)i.load();this.printCacheStatus()}getBlockState(){const e={};return this.blocks.forEach(t=>{const{id:i,state:s}=t.getBlockStateJson();e[i]=s}),e}printCacheStatus(){Ga(this.gos,`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}},vK={moduleName:"InfiniteRowModelCore",version:ne,rowModels:["infinite"],beans:[uK,mK]},CK={moduleName:"InfiniteRowModel",version:ne,apiFunctions:{refreshInfiniteCache:gK,purgeInfiniteCache:fK,getInfiniteRowCount:pK},dependsOn:[vK,D8]},wK="â",bK="â",yK={tag:"span",children:[{tag:"span",ref:"eDelta",cls:"ag-value-change-delta"},{tag:"span",ref:"eValue",cls:"ag-value-change-value"}]},SK=class extends ct{constructor(){super(yK),this.eValue=se,this.eDelta=se,this.refreshCount=0}init(e){this.refresh(e,!0)}showDelta(e,t){const i=Math.abs(t),s=e.formatValue(i),n=ae(s)?s:i,o=t>=0,r=this.eDelta;o?r.textContent=wK+n:r.textContent=bK+n,r.classList.toggle("ag-value-change-delta-up",o),r.classList.toggle("ag-value-change-delta-down",!o)}setTimerToRemoveDelta(){this.refreshCount++;const e=this.refreshCount;this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),Mi(this.eDelta)}refresh(e,t=!1){var c;const{value:i,valueFormatted:s}=e,{eValue:n,lastValue:o,beans:r}=this;if(i===o||(ae(s)?n.textContent=s:ae(i)?n.textContent=i:Mi(n),(c=r.filterManager)!=null&&c.isSuppressFlashingCellsBecauseFiltering()))return!1;const a=i&&typeof i=="object"&&"toNumber"in i?i.toNumber():i,l=o&&typeof o=="object"&&"toNumber"in o?o.toNumber():o;if(a===l)return!1;if(typeof a=="number"&&typeof l=="number"){const d=a-l;this.showDelta(e,d)}return o&&n.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=i,!0}},RK=".ag-value-slide-out{opacity:1}:where(.ag-ltr) .ag-value-slide-out{margin-right:5px;transition:opacity 3s,margin-right 3s}:where(.ag-rtl) .ag-value-slide-out{margin-left:5px;transition:opacity 3s,margin-left 3s}:where(.ag-ltr,.ag-rtl) .ag-value-slide-out{transition-timing-function:linear}.ag-value-slide-out-end{opacity:0}:where(.ag-ltr) .ag-value-slide-out-end{margin-right:10px}:where(.ag-rtl) .ag-value-slide-out-end{margin-left:10px}",xK={tag:"span",children:[{tag:"span",ref:"eCurrent",cls:"ag-value-slide-current"}]},EK=class extends ct{constructor(){super(xK),this.eCurrent=se,this.refreshCount=0,this.registerCSS(RK)}init(e){this.refresh(e,!0)}addSlideAnimation(){var n;this.refreshCount++;const e=this.refreshCount;(n=this.ePrevious)==null||n.remove();const{beans:t,eCurrent:i}=this,s=jt({tag:"span",cls:"ag-value-slide-previous ag-value-slide-out"});this.ePrevious=s,s.textContent=i.textContent,this.getGui().insertBefore(s,i),t.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{var o;e===this.refreshCount&&((o=this.ePrevious)==null||o.remove(),this.ePrevious=null)},3e3)})}refresh(e,t=!1){var n;let i=e.value;if(At(i)&&(i=""),i===this.lastValue||(n=this.beans.filterManager)!=null&&n.isSuppressFlashingCellsBecauseFiltering())return!1;t||this.addSlideAnimation(),this.lastValue=i;const s=this.eCurrent;return ae(e.valueFormatted)?s.textContent=e.valueFormatted:ae(e.value)?s.textContent=i:Mi(s),!0}},AK=class extends V{constructor(){super(...arguments),this.beanName="cellFlashSvc",this.nextAnimationTime=null,this.nextAnimationCycle=null,this.animations={highlight:new Map,"data-changed":new Map}}animateCell(e,t,i=this.beans.gos.get("cellFlashDuration"),s=this.beans.gos.get("cellFadeDuration")){const n=this.animations[t];n.delete(e);const o=Date.now(),r=o+i,a=o+i+s,l={phase:"flash",flashEndTime:r,fadeEndTime:a};n.set(e,l);const c=`ag-cell-${t}`,d=`${c}-animation`,{comp:h,eGui:{style:u}}=e;h.toggleCss(c,!0),h.toggleCss(d,!1),u.removeProperty("transition"),u.removeProperty("transition-delay"),this.nextAnimationTime&&r+15<this.nextAnimationTime&&(clearTimeout(this.nextAnimationCycle),this.nextAnimationCycle=null,this.nextAnimationTime=null),this.nextAnimationCycle||(this.beans.frameworkOverrides.wrapIncoming(()=>{this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),i)}),this.nextAnimationTime=r)}advanceAnimations(){const e=Date.now();let t=null;for(const i of Object.keys(this.animations)){const s=this.animations[i],n=`ag-cell-${i}`,o=`${n}-animation`;for(const[r,a]of s){if(!r.isAlive()||!r.comp){s.delete(r);continue}const{phase:l,flashEndTime:c,fadeEndTime:d}=a,h=l==="flash"?c:d;if(!(e+15>=h)){t=Math.min(h,t??1/0);continue}const{comp:f,eGui:{style:p}}=r;switch(l){case"flash":f.toggleCss(n,!1),f.toggleCss(o,!0),p.transition=`background-color ${d-c}ms`,p.transitionDelay=`${c-e}ms`,t=Math.min(d,t??1/0),a.phase="fade";break;case"fade":f.toggleCss(n,!1),f.toggleCss(o,!1),p.removeProperty("transition"),p.removeProperty("transition-delay"),s.delete(r);break}}}t==null?(this.nextAnimationTime=null,this.nextAnimationCycle=null):t&&(this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),t-e),this.nextAnimationTime=t)}onFlashCells(e,t){if(!e.comp)return;const i=RW(e.cellPosition);t.cells[i]&&this.animateCell(e,"highlight")}flashCell(e,t){this.animateCell(e,"data-changed",t==null?void 0:t.flashDuration,t==null?void 0:t.fadeDuration)}destroy(){for(const e of Object.keys(this.animations))this.animations[e].clear()}};function FK(e,t={}){const{cellFlashSvc:i}=e;i&&e.frameworkOverrides.wrapIncoming(()=>{for(const s of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns))i.flashCell(s,t)})}var PK={moduleName:"HighlightChanges",version:ne,beans:[AK],userComponents:{agAnimateShowChangeCellRenderer:SK,agAnimateSlideCellRenderer:EK},apiFunctions:{flashCells:FK}};function TK(e){var t;return((t=e.stateSvc)==null?void 0:t.getState())??{}}function DK(e,t,i){var s;return(s=e.stateSvc)==null?void 0:s.setState(t,i)}function wx(e){return e={...e},e.version||(e.version="32.1.0"),e.version==="32.1.0"&&(e=MK(e)),e.version=ne,e}function MK(e){return e.cellSelection=IK(e,"rangeSelection"),e}function IK(e,t){if(e&&typeof e=="object")return e[t]}var kK=class extends V{constructor(){super(...arguments),this.beanName="stateSvc",this.updateRowGroupExpansionStateTimer=0,this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=Pi(this,()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=Pi(this,()=>{this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(this.updateCachedState("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowGroupExpansion",void 0)):(this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("ssrmRowGroupExpansion",void 0))},0),this.onRowSelectedDebounced=Pi(this,()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){const{gos:e,ctrlsSvc:t,colDelayRenderSvc:i}=this.beans;this.isClientSideRowModel=Ut(e);const s=wx(e.get("initialState")??{}),n=s.partialColumnState;delete s.partialColumnState,this.cachedState=s;const o=this.suppressEventsAndDispatchInitEvent.bind(this);t.whenReady(this,()=>o(()=>this.setupStateOnGridReady(s))),(s.columnOrder||s.columnVisibility||s.columnSizing||s.columnPinning||s.columnGroup)&&(i==null||i.hideColumns("columnState"));const[r,a,l]=this.addManagedEventListeners({newColumnsLoaded:({source:c})=>{c==="gridInitializing"&&(r(),o(()=>{this.setupStateOnColumnsInitialised(s,!!n),i==null||i.revealColumns("columnState")}))},rowCountReady:()=>{a==null||a(),o(()=>this.setupStateOnRowCountReady(s))},firstDataRendered:()=>{l==null||l(),o(()=>this.setupStateOnFirstDataRendered(s))}})}destroy(){super.destroy(),clearTimeout(this.updateRowGroupExpansionStateTimer),this.queuedUpdateSources.clear()}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setState(e,t){const i=wx(e);delete i.partialColumnState,this.cachedState=i,this.startSuppressEvents();const s="api",n=t?new Set(t):void 0;this.setGridReadyState(i,s,n),this.setColumnsInitialisedState(i,s,!!n,n),this.setRowCountState(i,s,n),setTimeout(()=>{this.isAlive()&&this.setFirstDataRenderedState(i,s,n),this.stopSuppressEvents(s)})}setGridReadyState(e,t,i){var s,n;t==="api"&&!(i!=null&&i.has("sideBar"))&&((n=(s=this.beans.sideBar)==null?void 0:s.comp)==null||n.setState(e.sideBar)),this.updateCachedState("sideBar",this.getSideBarState())}setupStateOnGridReady(e){this.setGridReadyState(e,"gridInitializing");const t=()=>this.updateCachedState("sideBar",this.getSideBarState());this.addManagedEventListeners({toolPanelVisibleChanged:t,sideBarUpdated:t})}updateColumnAndGroupState(){this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState())}setColumnsInitialisedState(e,t,i,s){this.setColumnState(e,t,i,s),this.setColumnGroupState(e,t,s),this.updateColumnAndGroupState()}setupStateOnColumnsInitialised(e,t){this.setColumnsInitialisedState(e,"gridInitializing",t);const i=s=>()=>this.updateColumnState([s]);this.addManagedEventListeners({columnValueChanged:i("aggregation"),columnMoved:i("columnOrder"),columnPinned:i("columnPinning"),columnResized:i("columnSizing"),columnVisible:i("columnVisibility"),columnPivotChanged:i("pivot"),columnPivotModeChanged:i("pivot"),columnRowGroupChanged:i("rowGroup"),sortChanged:i("sort"),newColumnsLoaded:this.updateColumnAndGroupState.bind(this),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setRowCountState(e,t,i){const{filter:s,rowGroupExpansion:n,ssrmRowGroupExpansion:o,rowSelection:r,pagination:a}=e,l=(d,h)=>!(i!=null&&i.has(d))&&(h||t==="api");l("filter",s)&&this.setFilterState(s),l("rowGroupExpansion",n)&&this.setRowGroupExpansionState(o,n,t),l("rowSelection",r)&&this.setRowSelectionState(r,t),l("pagination",a)&&this.setPaginationState(a,t);const c=this.updateCachedState.bind(this);c("filter",this.getFilterState()),this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(c("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),c("rowGroupExpansion",void 0)):(c("rowGroupExpansion",this.getRowGroupExpansionState()),c("ssrmRowGroupExpansion",void 0)),c("rowSelection",this.getRowSelectionState()),c("pagination",this.getPaginationState())}setupStateOnRowCountReady(e){this.setRowCountState(e,"gridInitializing");const t=this.updateCachedState.bind(this),i=()=>{this.updateRowGroupExpansionStateTimer=0,this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(t("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),t("rowGroupExpansion",void 0)):(t("rowGroupExpansion",this.getRowGroupExpansionState()),t("ssrmRowGroupExpansion",void 0))},s=()=>t("filter",this.getFilterState()),{gos:n,colFilter:o}=this.beans;this.addManagedEventListeners({filterChanged:s,rowExpansionStateChanged:this.onRowGroupOpenedDebounced,expandOrCollapseAll:i,columnRowGroupChanged:i,rowDataUpdated:()=>{(n.get("groupDefaultExpanded")!==0||n.get("isGroupOpenByDefault"))&&(this.updateRowGroupExpansionStateTimer||(this.updateRowGroupExpansionStateTimer=setTimeout(i)))},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:r=>{(r.newPage||r.newPageSize)&&t("pagination",this.getPaginationState())}}),o&&this.addManagedListeners(o,{filterStateChanged:s})}setFirstDataRenderedState(e,t,i){const{scroll:s,cellSelection:n,focusedCell:o,columnOrder:r,rowPinning:a}=e,l=(h,u)=>!(i!=null&&i.has(h))&&(u||t==="api");l("focusedCell",o)&&this.setFocusedCellState(o),l("cellSelection",n)&&this.setCellSelectionState(n),l("scroll",s)&&this.setScrollState(s),l("rowPinning",a)&&this.setRowPinningState(a),this.setColumnPivotState(!!(r!=null&&r.orderedColIds),t);const c=this.updateCachedState.bind(this);c("sideBar",this.getSideBarState()),c("focusedCell",this.getFocusedCellState());const d=this.getRangeSelectionState();c("rangeSelection",d),c("cellSelection",d),c("scroll",this.getScrollState())}setupStateOnFirstDataRendered(e){this.setFirstDataRenderedState(e,"gridInitializing");const t=this.updateCachedState.bind(this),i=()=>t("focusedCell",this.getFocusedCellState());this.addManagedEventListeners({cellFocused:i,cellFocusCleared:i,cellSelectionChanged:s=>{if(s.finished){const n=this.getRangeSelectionState();t("rangeSelection",n),t("cellSelection",n)}},bodyScrollEnd:()=>t("scroll",this.getScrollState()),pinnedRowsChanged:()=>t("rowPinning",this.getRowPinningState())})}getColumnState(){const e=this.beans;return P4(zm(e),e.colModel.isPivotMode())}setColumnState(e,t,i,s){const{sort:n,rowGroup:o,aggregation:r,pivot:a,columnPinning:l,columnVisibility:c,columnSizing:d,columnOrder:h}=e;let u=!1;const f=(M,_)=>{const W=!(s!=null&&s.has(M))&&!!(_||t==="api");return u||(u=W),W},p={},m=M=>{let _=p[M];return _||(_={colId:M},p[M]=_,_)},v={},C=f("sort",n);C&&(n==null||n.sortModel.forEach(({colId:M,sort:_},W)=>{const $=m(M);$.sort=_,$.sortIndex=W})),(C||!i)&&(v.sort=null,v.sortIndex=null);const w=f("rowGroup",o);w&&(o==null||o.groupColIds.forEach((M,_)=>{const W=m(M);W.rowGroup=!0,W.rowGroupIndex=_})),(w||!i)&&(v.rowGroup=null,v.rowGroupIndex=null);const S=f("aggregation",r);S&&(r==null||r.aggregationModel.forEach(({colId:M,aggFunc:_})=>{m(M).aggFunc=_})),(S||!i)&&(v.aggFunc=null);const b=f("pivot",a);b&&(a==null||a.pivotColIds.forEach((M,_)=>{const W=m(M);W.pivot=!0,W.pivotIndex=_}),this.gos.updateGridOptions({options:{pivotMode:!!(a!=null&&a.pivotMode)},source:t})),(b||!i)&&(v.pivot=null,v.pivotIndex=null);const E=f("columnPinning",l);if(E){for(const M of(l==null?void 0:l.leftColIds)??[])m(M).pinned="left";for(const M of(l==null?void 0:l.rightColIds)??[])m(M).pinned="right"}(E||!i)&&(v.pinned=null);const A=f("columnVisibility",c);if(A)for(const M of(c==null?void 0:c.hiddenColIds)??[])m(M).hide=!0;(A||!i)&&(v.hide=null);const P=f("columnSizing",d);if(P)for(const{colId:M,flex:_,width:W}of(d==null?void 0:d.columnSizingModel)??[]){const $=m(M);$.flex=_??null,$.width=W}(P||!i)&&(v.flex=null);const T=h==null?void 0:h.orderedColIds,D=!!(T!=null&&T.length)&&!(s!=null&&s.has("columnOrder")),N=D?T.map(M=>m(M)):Object.values(p);(N.length||u)&&(this.columnStates=N,In(this.beans,{state:N,applyOrder:D,defaultState:v},t))}setColumnPivotState(e,t){const i=this.columnStates;this.columnStates=void 0;const s=this.columnGroupStates;this.columnGroupStates=void 0;const n=this.beans,{pivotResultCols:o,colGroupSvc:r}=n;if(o!=null&&o.isPivotResultColsPresent()){if(i){const a=[];for(const l of i)o.getPivotResultCol(l.colId)&&a.push(l);In(n,{state:a,applyOrder:e},t)}s&&(r==null||r.setColumnGroupState(s,t))}}getColumnGroupState(){const e=this.beans.colGroupSvc;if(!e)return;const t=e.getColumnGroupState();return T4(t)}setColumnGroupState(e,t,i){var a;const s=this.beans.colGroupSvc;if(!s||i!=null&&i.has("columnGroup")||t!=="api"&&!Object.prototype.hasOwnProperty.call(e,"columnGroup"))return;const n=new Set((a=e.columnGroup)==null?void 0:a.openColumnGroupIds),r=s.getColumnGroupState().map(({groupId:l})=>{const c=n.has(l);return c&&n.delete(l),{groupId:l,open:c}});for(const l of n)r.push({groupId:l,open:!0});r.length&&(this.columnGroupStates=r),s.setColumnGroupState(r,t)}getFilterState(){const e=this.beans.filterManager;let t=e==null?void 0:e.getFilterModel();t&&Object.keys(t).length===0&&(t=void 0);const i=e==null?void 0:e.getFilterState(),s=(e==null?void 0:e.getAdvFilterModel())??void 0;return t||s||i?{filterModel:t,columnFilterState:i,advancedFilterModel:s}:void 0}setFilterState(e){const t=this.beans.filterManager,{filterModel:i,columnFilterState:s,advancedFilterModel:n}=e??{filterModel:null,columnFilterState:null,advancedFilterModel:null};(i!==void 0||s!==void 0)&&(t==null||t.setFilterState(i??null,s??null,"columnFilter")),n!==void 0&&(t==null||t.setAdvFilterModel(n??null,"advancedFilter"))}getRangeSelectionState(){var t;const e=(t=this.beans.rangeSvc)==null?void 0:t.getCellRanges().map(i=>{const{id:s,type:n,startRow:o,endRow:r,columns:a,startColumn:l}=i;return{id:s,type:n,startRow:o,endRow:r,colIds:a.map(c=>c.getColId()),startColId:l.getColId()}});return e!=null&&e.length?{cellRanges:e}:void 0}setCellSelectionState(e){const{gos:t,rangeSvc:i,colModel:s,visibleCols:n}=this.beans;if(!Tr(t)||!i)return;const o=[];for(const r of(e==null?void 0:e.cellRanges)??[]){const a=[];for(const c of r.colIds){const d=s.getCol(c);d&&a.push(d)}if(!a.length)continue;let l=s.getCol(r.startColId);if(!l){const c=n.allCols,d=new Set(a);l=c.find(h=>d.has(h))}o.push({...r,columns:a,startColumn:l})}i.setCellRanges(o)}getScrollState(){if(!this.isClientSideRowModel)return;const e=this.beans.ctrlsSvc.getScrollFeature(),{left:t}=(e==null?void 0:e.getHScrollPosition())??{left:0},{top:i}=(e==null?void 0:e.getVScrollPosition())??{top:0};return i||t?{top:i,left:t}:void 0}setScrollState(e){if(!this.isClientSideRowModel)return;const{top:t,left:i}=e??{top:0,left:0},{frameworkOverrides:s,rowRenderer:n,animationFrameSvc:o,ctrlsSvc:r}=this.beans;s.wrapIncoming(()=>{var a;r.get("center").setCenterViewportScrollLeft(i),(a=r.getScrollFeature())==null||a.setVerticalScrollPosition(t),n.redraw({afterScroll:!0}),o==null||o.flushAllFrames()})}getSideBarState(){var e,t;return(t=(e=this.beans.sideBar)==null?void 0:e.comp)==null?void 0:t.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const e=this.beans.focusSvc.getFocusedCell();if(e){const{column:t,rowIndex:i,rowPinned:s}=e;return{colId:t.getColId(),rowIndex:i,rowPinned:s}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;const{focusSvc:t,colModel:i}=this.beans;if(!e){t.clearFocusedCell();return}const{colId:s,rowIndex:n,rowPinned:o}=e;t.setFocusedCell({column:i.getCol(s),rowIndex:n,rowPinned:o,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){const{pagination:e,gos:t}=this.beans;if(!e)return;const i=e.getCurrentPage(),s=t.get("paginationAutoPageSize")?void 0:e.getPageSize();if(!(!i&&!s))return{page:i,pageSize:s}}setPaginationState(e,t){const{pagination:i,gos:s}=this.beans;if(!i)return;const{pageSize:n,page:o}=e??{page:0,pageSize:s.get("paginationPageSize")},r=t==="gridInitializing";n&&!s.get("paginationAutoPageSize")&&i.setPageSize(n,r?"initialState":"pageSizeSelector"),typeof o=="number"&&(r?i.setPage(o):i.goToPage(o))}getRowSelectionState(){var s;const e=this.beans.selectionSvc;if(!e)return;const t=e.getSelectionState();return!t||!Array.isArray(t)&&(t.selectAll===!1||t.selectAllChildren===!1)&&!((s=t==null?void 0:t.toggledNodes)!=null&&s.length)?void 0:t}setRowSelectionState(e,t){var i;(i=this.beans.selectionSvc)==null||i.setSelectionState(e,t,t==="api")}getRowGroupExpansionState(){const{expansionSvc:e}=this.beans;if(e)return e.getExpansionState()}getRowPinningState(){var e;return(e=this.beans.pinnedRowModel)==null?void 0:e.getPinnedState()}setRowPinningState(e){const t=this.beans.pinnedRowModel;e?t==null||t.setPinnedState(e):t==null||t.reset()}setRowGroupExpansionState(e,t,i){const s=this.beans.expansionSvc;if(!s)return;const n=t??{expandedRowGroupIds:[],collapsedRowGroupIds:[]};s.setExpansionState(n,i)}updateColumnState(e){const t=this.getColumnState();let i=!1;const s=this.cachedState;for(const n of Object.keys(t)){const o=t[n];rg(o,s[n])||(i=!0)}this.cachedState={...s,...t},i&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){const i=this.cachedState[e];this.setCachedStateValue(e,t),rg(t,i)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState={...this.cachedState,[e]:t}}refreshStaleState(){const e=this.staleStateKeys;for(const t of e)t==="rowSelection"&&this.setCachedStateValue(t,this.getRowSelectionState());e.clear()}dispatchStateUpdateEvent(e){if(!this.suppressEvents){for(const t of e)this.queuedUpdateSources.add(t);this.dispatchStateUpdateEventDebounced()}}dispatchQueuedStateUpdateEvents(){const e=this.queuedUpdateSources,t=Array.from(e);e.clear(),this.eventSvc.dispatchEvent({type:"stateUpdated",sources:t,state:this.cachedState})}startSuppressEvents(){var e;this.suppressEvents=!0,(e=this.beans.colAnimation)==null||e.setSuppressAnimation(!0)}stopSuppressEvents(e){setTimeout(()=>{var t;this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&((t=this.beans.colAnimation)==null||t.setSuppressAnimation(!1),this.dispatchStateUpdateEvent([e]))})}suppressEventsAndDispatchInitEvent(e){this.startSuppressEvents(),e(),this.stopSuppressEvents("gridInitializing")}},_K={moduleName:"GridState",version:ne,beans:[kK],apiFunctions:{getState:TK,setState:DK}};function LK(e){return e.rowModel.isLastRowIndexKnown()}function OK(e){var t;return((t=e.pagination)==null?void 0:t.getPageSize())??100}function NK(e){var t;return((t=e.pagination)==null?void 0:t.getCurrentPage())??0}function HK(e){var t;return((t=e.pagination)==null?void 0:t.getTotalPages())??1}function GK(e){return e.pagination?e.pagination.getMasterRowCount():e.rowModel.getRowCount()}function BK(e){var t;(t=e.pagination)==null||t.goToNextPage()}function VK(e){var t;(t=e.pagination)==null||t.goToPreviousPage()}function zK(e){var t;(t=e.pagination)==null||t.goToFirstPage()}function WK(e){var t;(t=e.pagination)==null||t.goToLastPage()}function $K(e,t){var i;(i=e.pagination)==null||i.goToPage(t)}var UK=class extends V{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeSvc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowsCtrl=e.center;const t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.beans.pagination.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const e=this.centerRowsCtrl.viewportSizeFeature.getBodyHeight();if(e>0){const t=this.beans,i=()=>{const s=Math.max(yc(t),1),n=Math.floor(e/s);t.pagination.setPageSize(n,"autoCalculated")};this.isBodyRendered?Pi(this,i,50)():(i(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},fu="paginationPageSizeSelector",jK={tag:"span",cls:"ag-paging-page-size"},KK=class extends ct{constructor(){super(jK),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const e=this.selectPageSizeComp.getValue();if(!e)return;const t=Number(e);isNaN(t)||t<1||t===this.pagination.getPageSize()||(this.pagination.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.pagination=e.pagination}postConstruct(){this.addManagedPropertyListener(fu,()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!(e!=null&&e.newPageSize))return;const t=this.pagination.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){Mi(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get(fu)!==!1}reloadPageSizesSelector(){const e=this.getPageSizeSelectorValues(),t=this.pagination.getPageSize(),i=!t||!e.includes(t);if(i){const n=this.gos.exists("paginationPageSize"),o=this.gos.get(fu)!==!0;j(94,{pageSizeSet:n,pageSizesSet:o,pageSizeOptions:e,paginationPageSizeOption:t}),o||j(95,{paginationPageSizeOption:t,paginationPageSizeSelector:fu}),e.unshift("")}const s=String(i?"":t);this.selectPageSizeComp?(Ya(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(s,!0)):this.createPageSizeSelectorComp(e,s),this.hasEmptyOption=i}createPageSizeSelectOptions(e){return e.map(t=>({value:String(t)}))}createPageSizeSelectorComp(e,t){const i=this.getLocaleTextFunc(),s=i("pageSizeSelectorLabel","Page Size:"),n=i("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new SS).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(n).setLabel(s).onValueChange(()=>this.handlePageSizeItemSelected()),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){const e=[20,50,100],t=this.gos.get(fu);return!Array.isArray(t)||!(t!=null&&t.length)?e:[...t].sort((i,s)=>i-s)}destroy(){this.toggleSelectDisplay(!1),super.destroy()}},qK={selector:"AG-PAGE-SIZE-SELECTOR",component:KK},YK=".ag-paging-panel{align-items:center;border-top:var(--ag-footer-row-border);display:flex;gap:calc(var(--ag-spacing)*4);height:var(--ag-pagination-panel-height);justify-content:flex-end;padding:0 var(--ag-cell-horizontal-padding)}:where(.ag-paging-page-size) .ag-wrapper{min-width:50px}.ag-paging-page-summary-panel{align-items:center;display:flex;gap:var(--ag-cell-widget-spacing);.ag-disabled &{pointer-events:none}}.ag-paging-button{cursor:pointer;position:relative;&.ag-disabled{cursor:default;opacity:.5}}.ag-paging-number,.ag-paging-row-summary-panel-number{font-weight:500}",XK=class extends QT{constructor(){super(),this.btFirst=se,this.btPrevious=se,this.btNext=se,this.btLast=se,this.lbRecordCount=se,this.lbFirstRowOnPage=se,this.lbLastRowOnPage=se,this.lbCurrent=se,this.lbTotal=se,this.pageSizeComp=se,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1,this.registerCSS(YK)}wireBeans(e){this.rowModel=e.rowModel,this.pagination=e.pagination,this.ariaAnnounce=e.ariaAnnounce}postConstruct(){const e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[qK]);const{btFirst:t,btPrevious:i,btNext:s,btLast:n}=this;this.activateTabIndex([t,i,s,n]),t.insertAdjacentElement("afterbegin",tn(e?"last":"first",this.beans)),i.insertAdjacentElement("afterbegin",tn(e?"next":"previous",this.beans)),s.insertAdjacentElement("afterbegin",tn(e?"previous":"next",this.beans)),n.insertAdjacentElement("afterbegin",tn(e?"first":"last",this.beans)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:o=>this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(o):WV(this.beans,o),forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){const t=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){if(!this.areListenersSetup){this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)});for(const e of[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}]){const{el:t,fn:i}=e;this.addManagedListeners(t,{click:i,keydown:s=>{(s.key===H.ENTER||s.key===H.SPACE)&&(s.preventDefault(),i())}})}zV(this.beans,this,this.getGui()),this.areListenersSetup=!0}}onBtFirst(){this.previousAndFirstButtonsDisabled||this.pagination.goToFirstPage()}formatNumber(e){const t=this.gos.getCallback("paginationNumberFormatter");return t?t({value:e}):D4(e,this.getLocaleTextFunc.bind(this))}getTemplate(){const e=this.getLocaleTextFunc(),t=`ag-${this.getCompId()}`;return{tag:"div",cls:"ag-paging-panel ag-unselectable",attrs:{id:`${t}`},children:[{tag:"ag-page-size-selector",ref:"pageSizeComp"},{tag:"span",cls:"ag-paging-row-summary-panel",children:[{tag:"span",ref:"lbFirstRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-first-row`}},{tag:"span",attrs:{id:`${t}-to`},children:e("to","to")},{tag:"span",ref:"lbLastRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-last-row`}},{tag:"span",attrs:{id:`${t}-of`},children:e("of","of")},{tag:"span",ref:"lbRecordCount",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-row-count`}}]},{tag:"span",cls:"ag-paging-page-summary-panel",role:"presentation",children:[{tag:"div",ref:"btFirst",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("firstPage","First Page")}},{tag:"div",ref:"btPrevious",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("previousPage","Previous Page")}},{tag:"span",cls:"ag-paging-description",children:[{tag:"span",attrs:{id:`${t}-start-page`},children:e("page","Page")},{tag:"span",ref:"lbCurrent",cls:"ag-paging-number",attrs:{id:`${t}-start-page-number`}},{tag:"span",attrs:{id:`${t}-of-page`},children:e("of","of")},{tag:"span",ref:"lbTotal",cls:"ag-paging-number",attrs:{id:`${t}-of-page-number`}}]},{tag:"div",ref:"btNext",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("nextPage","Next Page")}},{tag:"div",ref:"btLast",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("lastPage","Last Page")}}]}]}}onBtNext(){this.nextButtonDisabled||this.pagination.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.pagination.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.pagination.goToLastPage()}enableOrDisableButtons(){const e=this.pagination.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),i=this.pagination.getTotalPages();this.previousAndFirstButtonsDisabled=e===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const s=this.isZeroPagesToDisplay(),n=e===i-1;this.nextButtonDisabled=n||s,this.lastButtonDisabled=!t||s||e===i-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){sH(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){const e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages();return e&&t===0}updateLabels(){const e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages(),i=this.pagination.getMasterRowCount(),s=e?i:null,n=this.pagination.getCurrentPage(),o=this.pagination.getPageSize();let r,a;this.isZeroPagesToDisplay()?r=a=0:(r=o*n+1,a=r+o-1,e&&a>s&&(a=s));const l=r+o-1,c=!e&&i<l,d=this.formatNumber(r);this.lbFirstRowOnPage.textContent=d;let h;const u=this.getLocaleTextFunc();c?h=u("pageLastRowUnknown","?"):h=this.formatNumber(a),this.lbLastRowOnPage.textContent=h;const p=t>0?n+1:0,m=this.formatNumber(p);this.lbCurrent.textContent=m;let v,C;if(e)v=this.formatNumber(t),C=this.formatNumber(s);else{const w=u("more","more");v=w,C=w}this.lbTotal.textContent=v,this.lbRecordCount.textContent=C,this.announceAriaStatus(d,h,C,m,v)}announceAriaStatus(e,t,i,s,n){var h,u;const o=this.getLocaleTextFunc(),r=o("page","Page"),a=o("to","to"),l=o("of","of"),c=`${e} ${a} ${t} ${l} ${i}`,d=`${r} ${s} ${l} ${n}`;c!==this.ariaRowStatus&&(this.ariaRowStatus=c,(h=this.ariaAnnounce)==null||h.announceValue(c,"paginationRow")),d!==this.ariaPageStatus&&(this.ariaPageStatus=d,(u=this.ariaAnnounce)==null||u.announceValue(d,"paginationPage"))}},QK={selector:"AG-PAGINATION",component:XK},JK=class extends V{constructor(){super(...arguments),this.beanName="pagination",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}postConstruct(){const e=this.gos;this.active=e.get("pagination"),this.pageSizeFromGridOptions=e.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return QK}isPaginateChildRows(){const e=this.gos;return e.get("groupHideParentOfSingleChild")||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")?!0:e.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){const t=this.currentPage;if(!this.active||t===e||typeof t!="number")return;const{editSvc:i}=this.beans;i!=null&&i.isEditing()&&(i.isBatchEditing()?i.cleanupEditors():i.stopEditing(void 0,{source:"api"})),this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0})}goToPageWithIndex(e){var i,s;if(!this.active)return;let t=e;this.paginateChildRows||(t=((s=(i=this.beans.rowModel).getTopLevelIndexFromDisplayedIndex)==null?void 0:s.call(i,e))??e),this.goToPage(Math.floor(t/this.pageSize))}isRowInPage(e){return this.active?e>=this.topDisplayedRowIndex&&e<=this.bottomDisplayedRowIndex:!0}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.beans.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return ae(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:ae(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:ae(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:ae(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.beans.pageBounds.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;const e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){const i=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}i!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){const e=this.totalPages;this.currentPage>=e&&(this.currentPage=e-1);const t=this.currentPage;(!isFinite(t)||isNaN(t)||t<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){const e=this.beans.rowModel,t=e.getTopLevelRowCount();if(this.masterRowCount=t,t<=0){this.setZeroRows();return}const i=this.pageSize,s=t-1;this.totalPages=Math.floor(s/i)+1,this.adjustCurrentPageIfInvalid();const n=this.currentPage,o=i*n;let r=i*(n+1)-1;if(r>s&&(r=s),this.topDisplayedRowIndex=e.getTopLevelRowDisplayedIndex(o),r===s)this.bottomDisplayedRowIndex=e.getRowCount()-1;else{const a=e.getTopLevelRowDisplayedIndex(r+1);this.bottomDisplayedRowIndex=a-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){const e=this.beans.rowModel.getRowCount();if(this.masterRowCount=e,e===0){this.setZeroRows();return}const{pageSize:t,currentPage:i}=this,s=e-1;this.totalPages=Math.floor(s/t)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=t*i,this.bottomDisplayedRowIndex=t*(i+1)-1,this.bottomDisplayedRowIndex>s&&(this.bottomDisplayedRowIndex=s)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.beans.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){const{keepRenderedRows:t=!1,newPage:i=!1,newPageSize:s=!1}=e;this.eventSvc.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:i,newPageSize:s,keepRenderedRows:t})}},ZK={moduleName:"Pagination",version:ne,beans:[JK,UK],icons:{first:"first",previous:"previous",next:"next",last:"last"},apiFunctions:{paginationIsLastPageFound:LK,paginationGetPageSize:OK,paginationGetCurrentPage:NK,paginationGetTotalPages:HK,paginationGetRowCount:GK,paginationGoToNextPage:BK,paginationGoToPreviousPage:VK,paginationGoToFirstPage:zK,paginationGoToLastPage:WK,paginationGoToPage:$K},dependsOn:[Kv]};function eq(e,t={}){const i=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.redrawRows(i))}function nM(e,t,i,s,n){t&&(s&&t.parent&&t.parent.level!==-1&&nM(e,t.parent,i,s,n),t.setExpanded(i,void 0,n))}function tq(e,t){return e.rowModel.getRowNode(t)}function iq(e,t,i,s){e.rowRenderer.addRenderedRowListener(t,i,s)}function sq(e){return e.rowRenderer.getRenderedNodes()}function nq(e,t,i){e.rowModel.forEachNode(t,i)}function oq(e){return e.rowRenderer.firstRenderedRow}function rq(e){return e.rowRenderer.lastRenderedRow}function aq(e,t){return e.rowModel.getRow(t)}function lq(e){return e.rowModel.getRowCount()}var cq={moduleName:"RowApi",version:ne,apiFunctions:{redrawRows:eq,setRowNodeExpanded:nM,getRowNode:tq,addRenderedRowListener:iq,getRenderedNodes:sq,forEachNode:nq,getFirstDisplayedRowIndex:oq,getLastDisplayedRowIndex:rq,getDisplayedRowAtIndex:aq,getDisplayedRowCount:lq}},dq={moduleName:"ScrollApi",version:ne,apiFunctions:{getVerticalPixelRange:Sj,getHorizontalPixelRange:Rj,ensureColumnVisible:$D,ensureIndexVisible:UD,ensureNodeVisible:xj}};function hq(e,t,i){if(!t)return;const s=e.ctrlsSvc.getGridBodyCtrl().eGridBody,n=`aria-${t}`;i===null?s.removeAttribute(n):s.setAttribute(n,i)}function uq(e,t={}){e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.refreshCells(t))}function gq(e){e.frameworkOverrides.wrapIncoming(()=>{for(const t of e.ctrlsSvc.getHeaderRowContainerCtrls())t.refresh()})}function fq(e){var t;return((t=e.animationFrameSvc)==null?void 0:t.isQueueEmpty())??!0}function pq(e){var t;(t=e.animationFrameSvc)==null||t.flushAllFrames()}function mq(e){return{rowHeight:yc(e),headerHeight:ep(e)}}function vq(e,t={}){var o;const i=[];for(const r of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns)){const a=r.getCellRenderer();a!=null&&i.push(fg(a))}if((o=t.columns)!=null&&o.length)return i;const s=[],n=gy(t.rowNodes);for(const r of e.rowRenderer.getAllRowCtrls()){if(n&&!fy(r.rowNode,n)||!r.isFullWidth())continue;const a=r.getFullWidthCellRenderers();for(let l=0;l<a.length;l++){const c=a[l];c!=null&&s.push(fg(c))}}return[...s,...i]}var Cq={moduleName:"RenderApi",version:ne,apiFunctions:{setGridAriaProperty:hq,refreshCells:uq,refreshHeader:gq,isAnimationFrameQueueEmpty:fq,flushAllAnimationFrames:pq,getSizesForCurrentTheme:mq,getCellRendererInstances:vq}};function wq(e,t){var i,s;typeof t=="number"?(i=e.colAutosize)==null||i.sizeColumnsToFit(t,"api"):(s=e.colAutosize)==null||s.sizeColumnsToFitGridBody(t)}function oM({colAutosize:e,visibleCols:t},i,s){Array.isArray(i)?e==null||e.autoSizeCols({colKeys:i,skipHeader:s,source:"api"}):e==null||e.autoSizeCols({...i,colKeys:i.colIds??t.allCols,source:"api"})}function bq(e,t){var i;t&&typeof t=="object"?oM(e,t):(i=e.colAutosize)==null||i.autoSizeAllColumns({source:"api",skipHeader:t})}var yq=class extends V{constructor(){super(...arguments),this.beanName="colAutosize",this.timesDelayed=0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}postConstruct(){var i;const{gos:e}=this,t=e.get("autoSizeStrategy");if(t){let s=!1;const n=t.type;if(n==="fitGridWidth"||n==="fitProvidedWidth")s=!0;else if(n==="fitCellContents"){this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered(t)});const o=e.get("rowData");s=o!=null&&o.length>0&&Ut(e)}s&&((i=this.beans.colDelayRenderSvc)==null||i.hideColumns(n))}}autoSizeCols(e){const{eventSvc:t,visibleCols:i}=this.beans;this.innerAutoSizeCols(e).then(s=>{var c;const n=d=>$h(t,Array.from(d),!0,"autosizeColumns");if(!e.scaleUpToFitGridWidth)return n(s);const o=bx(this.beans),r=d=>i.leftCols.some(h=>ju(h,d)),a=d=>i.rightCols.some(h=>ju(h,d)),l=e.colKeys.filter(d=>!Or(d)&&!yr(d)&&!r(d)&&!a(d));this.sizeColumnsToFit(o,e.source,!0,{defaultMaxWidth:e.defaultMaxWidth,defaultMinWidth:e.defaultMinWidth,columnLimits:(c=e.columnLimits)==null?void 0:c.map(d=>({...d,key:d.colId})),colKeys:l,onlyScaleUp:!0}),n(s)})}innerAutoSizeCols(e){return new Promise((t,i)=>{if(this.shouldQueueResizeOperations)return this.pushResizeOperation(()=>this.innerAutoSizeCols(e).then(t,i));const{colKeys:s,skipHeader:n,skipHeaderGroups:o,stopAtGroup:r,defaultMaxWidth:a,defaultMinWidth:l,columnLimits:c=[],source:d="api"}=e,{animationFrameSvc:h,renderStatus:u,colModel:f,autoWidthCalc:p,visibleCols:m}=this.beans;if(h==null||h.flushAllFrames(),this.timesDelayed<5&&u&&(!u.areHeaderCellsRendered()||!u.areCellsRendered())){this.timesDelayed++,setTimeout(()=>{this.isAlive()&&this.innerAutoSizeCols(e).then(t,i)});return}this.timesDelayed=0;const v=new Set;let C=-1;const w=Object.fromEntries(c.map(({colId:E,...A})=>[E,A])),S=n??this.gos.get("skipHeaderOnAutoSize"),b=o??S;for(;C!==0;){C=0;const E=[];for(const A of s){if(!A||mG(A))continue;const P=f.getCol(A);if(!P||v.has(P))continue;const T=p.getPreferredWidthForColumn(P,S);if(T>0){const D=w[P.colId]??{};D.minWidth??(D.minWidth=l),D.maxWidth??(D.maxWidth=a);const N=Sq(P,T,D);P.setActualWidth(N,d),v.add(P),C++}E.push(P)}E.length&&m.refresh(d)}b||this.autoSizeColumnGroupsByColumns(s,d,r),t(v)})}autoSizeColumn(e,t,i){this.autoSizeCols({colKeys:[e],skipHeader:i,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,i){const{colModel:s,ctrlsSvc:n}=this.beans,o=new Set,r=s.getColsForKeys(e);for(const l of r){let c=l.getParent();for(;c&&c!=i;)c.isPadding()||o.add(c),c=c.getParent()}let a;for(const l of o){for(const c of n.getHeaderRowContainerCtrls())if(a=c.getHeaderCtrlForColumn(l),a)break;a==null||a.resizeLeafColumnsToFit(t)}}autoSizeAllColumns(e){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.autoSizeAllColumns(e));return}this.autoSizeCols({colKeys:this.beans.visibleCols.allCols,...e})}addColumnAutosizeListeners(e,t){const i=this.gos.get("skipHeaderOnAutoSize"),s=()=>{this.autoSizeColumn(t,"uiColumnResized",i)};e.addEventListener("dblclick",s);const n=new rl(e);return n.addEventListener("doubleTap",s),()=>{e.removeEventListener("dblclick",s),n.destroy()}}addColumnGroupResize(e,t,i){const s=this.gos.get("skipHeaderOnAutoSize"),n=()=>{const o=[],r=t.getDisplayedLeafColumns();for(const a of r)a.getColDef().suppressAutoSize||o.push(a.getColId());o.length>0&&this.autoSizeCols({colKeys:o,skipHeader:s,stopAtGroup:t,source:"uiColumnResized"}),i()};return e.addEventListener("dblclick",n),()=>e.removeEventListener("dblclick",n)}sizeColumnsToFitGridBody(e,t){if(!this.isAlive())return;const i=bx(this.beans);if(i>0){this.sizeColumnsToFit(i,"sizeColumnsToFit",!1,e);return}t===void 0?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,100)},0):t===100?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,500)},100):t===500?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,-1)},500):j(29)}sizeColumnsToFit(e,t="sizeColumnsToFit",i,s){var p,m;if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.sizeColumnsToFit(e,t,i,s));return}const n={};for(const{key:v,...C}of(s==null?void 0:s.columnLimits)??[])n[typeof v=="string"?v:v.getColId()]=C;const o=this.beans.visibleCols.allCols;if(e<=0||!o.length)return;const r=Bo(o);if(s!=null&&s.onlyScaleUp&&r>e||e===r&&o.every(C=>{if(C.colDef.suppressSizeToFit)return!0;const w=n==null?void 0:n[C.getId()],S=(w==null?void 0:w.minWidth)??(s==null?void 0:s.defaultMinWidth),b=(w==null?void 0:w.maxWidth)??(s==null?void 0:s.defaultMaxWidth),E=C.getActualWidth();return(S==null||E>=S)&&(b==null||E<=b)}))return;const l=[],c=[];for(const v of o){const C=((p=s==null?void 0:s.colKeys)==null?void 0:p.some(w=>ju(v,w)))??!0;v.getColDef().suppressSizeToFit||!C?c.push(v):l.push(v)}const d=l.slice(0);let h=!1;const u=v=>{_n(l,v),c.push(v)};for(const v of l){v.resetActualWidth(t);const C=n==null?void 0:n[v.getId()],w=(C==null?void 0:C.minWidth)??(s==null?void 0:s.defaultMinWidth),S=(C==null?void 0:C.maxWidth)??(s==null?void 0:s.defaultMaxWidth),b=v.getActualWidth();typeof w=="number"&&b<w?v.setActualWidth(w,t,!0):typeof S=="number"&&b>S&&v.setActualWidth(S,t,!0)}for(;!h;){h=!0;const v=e-Bo(c);if(v<=0)for(const C of l){const w=((m=n==null?void 0:n[C.getId()])==null?void 0:m.minWidth)??(s==null?void 0:s.defaultMinWidth)??C.minWidth;C.setActualWidth(w,t,!0)}else{const C=v/Bo(l);let w=v;for(let S=l.length-1;S>=0;S--){const b=l[S],E=n==null?void 0:n[b.getId()],A=(E==null?void 0:E.minWidth)??(s==null?void 0:s.defaultMinWidth),P=(E==null?void 0:E.maxWidth)??(s==null?void 0:s.defaultMaxWidth),T=b.getMinWidth(),D=b.getMaxWidth(),N=typeof A=="number"&&A>T?A:T,M=typeof P=="number"&&P<D?P:D;let _=Math.round(b.getActualWidth()*C);_<N?(_=N,u(b),h=!1):_>M?(_=M,u(b),h=!1):S===0&&(_=w),b.setActualWidth(_,t,!0),w-=_}}}for(const v of d)v.fireColumnWidthChangedEvent(t);const f=this.beans.visibleCols;f.setLeftValues(t),f.updateBodyWidths(),!i&&$h(this.eventSvc,d,!0,t)}applyAutosizeStrategy(){const{gos:e,colDelayRenderSvc:t}=this.beans,i=e.get("autoSizeStrategy");(i==null?void 0:i.type)!=="fitGridWidth"&&(i==null?void 0:i.type)!=="fitProvidedWidth"||setTimeout(()=>{if(!this.isAlive())return;const s=i.type;if(s==="fitGridWidth"){const{columnLimits:n,defaultMinWidth:o,defaultMaxWidth:r}=i,a=n==null?void 0:n.map(({colId:l,minWidth:c,maxWidth:d})=>({key:l,minWidth:c,maxWidth:d}));this.sizeColumnsToFitGridBody({defaultMinWidth:o,defaultMaxWidth:r,columnLimits:a})}else s==="fitProvidedWidth"&&this.sizeColumnsToFit(i.width,"sizeColumnsToFit");t==null||t.revealColumns(s)})}onFirstDataRendered({colIds:e,...t}){setTimeout(()=>{var s;if(!this.isAlive())return;const i="autosizeColumns";e?this.autoSizeCols({...t,source:i,colKeys:e}):this.autoSizeAllColumns({...t,source:i}),(s=this.beans.colDelayRenderSvc)==null||s.revealColumns(t.type)})}processResizeOperations(){this.shouldQueueResizeOperations=!1;for(const e of this.resizeOperationQueue)e();this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}destroy(){this.resizeOperationQueue.length=0,super.destroy()}};function Sq(e,t,i={}){const s=i.minWidth??e.getMinWidth();t<s&&(t=s);const n=i.maxWidth??e.getMaxWidth();return t>n&&(t=n),t}function bx({ctrlsSvc:e,scrollVisibleSvc:t}){const i=e.getGridBodyCtrl(),n=i.isVerticalScrollShowing()?t.getScrollbarWidth():0;return cg(i.eGridBody)-n}var Rq={moduleName:"ColumnAutoSize",version:ne,beans:[yq],apiFunctions:{sizeColumnsToFit:wq,autoSizeColumns:oM,autoSizeAllColumns:bq},dependsOn:[rD]},xq=".ag-row-pinned-source{background-color:var(--ag-pinned-source-row-background-color);color:var(--ag-pinned-source-row-text-color);font-weight:var(--ag-pinned-source-row-font-weight)}.ag-row-pinned-manual{background-color:var(--ag-pinned-row-background-color);color:var(--ag-pinned-row-text-color);font-weight:var(--ag-pinned-row-font-weight)}";function Eq(e){var t;return((t=e.pinnedRowModel)==null?void 0:t.getPinnedTopRowCount())??0}function Aq(e){var t;return((t=e.pinnedRowModel)==null?void 0:t.getPinnedBottomRowCount())??0}function Fq(e,t){var i;return(i=e.pinnedRowModel)==null?void 0:i.getPinnedTopRow(t)}function Pq(e,t){var i;return(i=e.pinnedRowModel)==null?void 0:i.getPinnedBottomRow(t)}function Tq(e,t,i){var s;return(s=e.pinnedRowModel)==null?void 0:s.forEachPinnedRow(t,i)}var Dq={moduleName:"PinnedRow",version:ne,beans:[Ez],css:[xq],apiFunctions:{getPinnedTopRowCount:Eq,getPinnedBottomRowCount:Aq,getPinnedTopRow:Fq,getPinnedBottomRow:Pq,forEachPinnedRow:Tq},icons:{rowPin:"pin",rowPinTop:"pinned-top",rowPinBottom:"pinned-bottom",rowUnpin:"un-pin"}},Mq=class{constructor(e,t){this.col=e,this.firstNode=t,this.cellSpan=!0,this.spannedNodes=new Set,this.addSpannedNode(t)}reset(){this.spannedNodes.clear(),this.addSpannedNode(this.firstNode)}addSpannedNode(e){this.spannedNodes.add(e),this.lastNode=e}getLastNode(){return this.lastNode}getCellHeight(){return this.lastNode.rowTop+this.lastNode.rowHeight-this.firstNode.rowTop-1}doesSpanContain(e){return e.column!==this.col||e.rowPinned!=this.firstNode.rowPinned?!1:this.firstNode.rowIndex<=e.rowIndex&&e.rowIndex<=this.lastNode.rowIndex}getLastNodeAutoHeight(){var i;const e=(i=this.firstNode.__autoHeights)==null?void 0:i[this.col.getColId()];if(e==null)return;let t=0;for(const s of this.spannedNodes)s!==this.lastNode&&(t+=s.rowHeight);return e-t}},Iq=class extends V{constructor(e){super(),this.column=e}buildCache(e){var S;const{column:t,beans:{gos:i,pinnedRowModel:s,rowModel:n,valueSvc:o,pagination:r}}=this,{colDef:a}=t,l=this.getNodeMap(e),c=new Map,d=i.getCallback("isFullWidthRow"),h=a.equals,u=a.spanRows,f=typeof u=="function";let p=null,m=null,v;const C=(b,E)=>{p=b,m=null,v=E},w=b=>{const E=!b.isExpandable()&&!b.group&&!b.detail&&(d?!d({rowNode:b}):!0);if(b.rowIndex==null||!E){C(null,null);return}if(p==null||b.level!==p.level||b.footer||m&&b.rowIndex-1!==(m==null?void 0:m.getLastNode().rowIndex)){C(b,o.getValue(t,b));return}const A=o.getValue(t,b);if(f){const P=Fe(i,{valueA:v,nodeA:p,valueB:A,nodeB:b,column:t,colDef:a});if(!u(P)){C(b,A);return}}else if(h?!h(v,A):v!==A){C(b,A);return}if(!m){const P=l==null?void 0:l.get(p);(P==null?void 0:P.firstNode)===p?(P.reset(),m=P):m=new Mq(t,p),c.set(p,m)}m.addSpannedNode(b),c.set(b,m)};switch(e){case"center":(S=n.forEachDisplayedNode)==null||S.call(n,b=>{(!r||r.isRowInPage(b.rowIndex))&&w(b)}),this.centerValueNodeMap=c;break;case"top":s==null||s.forEachPinnedRow("top",w),this.topValueNodeMap=c;break;case"bottom":s==null||s.forEachPinnedRow("bottom",w),this.bottomValueNodeMap=c;break}}isCellSpanning(e){return!!this.getCellSpan(e)}getCellSpan(e){return this.getNodeMap(e.rowPinned).get(e)}getNodeMap(e){switch(e){case"top":return this.topValueNodeMap;case"bottom":return this.bottomValueNodeMap;default:return this.centerValueNodeMap}}},kq=class extends V{constructor(){super(...arguments),this.beanName="rowSpanSvc",this.spanningColumns=new Map,this.debouncePinnedEvent=Pi(this,this.dispatchCellsUpdatedEvent.bind(this,!0),0),this.debounceModelEvent=Pi(this,this.dispatchCellsUpdatedEvent.bind(this,!1),0),this.pinnedTimeout=null,this.modelTimeout=null}postConstruct(){const e=this.onRowDataUpdated.bind(this),t=this.buildPinnedCaches.bind(this);this.addManagedEventListeners({paginationChanged:this.buildModelCaches.bind(this),pinnedRowDataChanged:t,pinnedRowsChanged:t,rowNodeDataChanged:e,cellValueChanged:e})}register(e){const{gos:t}=this.beans;if(!t.get("enableCellSpan")||this.spanningColumns.has(e))return;const i=this.createManagedBean(new Iq(e));this.spanningColumns.set(e,i),i.buildCache("top"),i.buildCache("bottom"),i.buildCache("center"),this.debouncePinnedEvent(),this.debounceModelEvent()}dispatchCellsUpdatedEvent(e){this.dispatchLocalEvent({type:"spannedCellsUpdated",pinned:e})}deregister(e){this.spanningColumns.delete(e)}onRowDataUpdated({node:e}){const{spannedRowRenderer:t}=this.beans;if(e.rowPinned){if(this.pinnedTimeout!=null)return;this.pinnedTimeout=window.setTimeout(()=>{this.pinnedTimeout=null,this.buildPinnedCaches(),t==null||t.createCtrls("top"),t==null||t.createCtrls("bottom")},0);return}this.modelTimeout==null&&(this.modelTimeout=window.setTimeout(()=>{this.modelTimeout=null,this.buildModelCaches(),t==null||t.createCtrls("center")},0))}buildModelCaches(){this.modelTimeout!=null&&clearTimeout(this.modelTimeout),this.spanningColumns.forEach(e=>e.buildCache("center")),this.debounceModelEvent()}buildPinnedCaches(){this.pinnedTimeout!=null&&clearTimeout(this.pinnedTimeout),this.spanningColumns.forEach(e=>{e.buildCache("top"),e.buildCache("bottom")}),this.debouncePinnedEvent()}isCellSpanning(e,t){const i=this.spanningColumns.get(e);return i?i.isCellSpanning(t):!1}getCellSpanByPosition(e){const{pinnedRowModel:t,rowModel:i}=this.beans,s=e.column,n=e.rowIndex,o=this.spanningColumns.get(s);if(!o)return;let r;switch(e.rowPinned){case"top":r=t==null?void 0:t.getPinnedTopRow(n);break;case"bottom":r=t==null?void 0:t.getPinnedBottomRow(n);break;default:r=i.getRow(n)}if(r)return o.getCellSpan(r)}getCellStart(e){const t=this.getCellSpanByPosition(e);return t?{...e,rowIndex:t.firstNode.rowIndex}:e}getCellEnd(e){const t=this.getCellSpanByPosition(e);return t?{...e,rowIndex:t.getLastNode().rowIndex}:e}getCellSpan(e,t){const i=this.spanningColumns.get(e);if(i)return i.getCellSpan(t)}forEachSpannedColumn(e,t){for(const[i,s]of this.spanningColumns)if(s.isCellSpanning(e)){const n=s.getCellSpan(e);t(i,n)}}destroy(){super.destroy(),this.spanningColumns.clear()}},_q=class extends Md{constructor(e,t,i){super(e.col,e.firstNode,i,t),this.cellSpan=e,this.SPANNED_CELL_CSS_CLASS="ag-spanned-cell"}setComp(e,t,i,s,n,o,r){this.eWrapper=i,super.setComp(e,t,i,s,n,o,r),this.setAriaRowSpan(),this.refreshAriaRowIndex()}isCellSpanning(){return!0}getCellSpan(){return this.cellSpan}refreshAriaRowIndex(){const{eGui:e,rowNode:t}=this;!e||t.rowIndex==null||Dm(e,t.rowIndex)}setAriaRowSpan(){lH(this.eGui,this.cellSpan.spannedNodes.size)}setFocusedCellPosition(e){this.focusedCellPosition=e}getFocusedCellPosition(){return this.focusedCellPosition??this.cellPosition}checkCellFocused(){const e=this.beans.focusSvc.getFocusedCell();return!!e&&this.cellSpan.doesSpanContain(e)}applyStaticCssClasses(){super.applyStaticCssClasses(),this.comp.toggleCss(this.SPANNED_CELL_CSS_CLASS,!0)}onCellFocused(e){const{beans:t}=this;if($v(t)){this.focusedCellPosition=void 0;return}const i=this.isCellFocused();i||(this.focusedCellPosition=void 0),e&&i&&(this.focusedCellPosition={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column}),super.onCellFocused(e)}getRootElement(){return this.eWrapper}},Lq=class extends Xm{onRowIndexChanged(){super.onRowIndexChanged();for(const e of this.getAllCellCtrls())e.refreshAriaRowIndex()}getInitialRowClasses(e){return["ag-spanned-row"]}getNewCellCtrl(e){var s;const t=(s=this.beans.rowSpanSvc)==null?void 0:s.getCellSpan(e,this.rowNode);if(!(!t||t.firstNode!==this.rowNode))return new _q(t,this,this.beans)}isCorrectCtrlForSpan(e){var s;const t=(s=this.beans.rowSpanSvc)==null?void 0:s.getCellSpan(e.column,this.rowNode);return!t||t.firstNode!==this.rowNode?!1:e.getCellSpan()===t}onRowHeightChanged(){}refreshFirstAndLastRowStyles(){}addHoverFunctionality(){}resetHoveredStatus(){}},Oq=class extends V{constructor(){super(...arguments),this.beanName="spannedRowRenderer",this.topCtrls=new Map,this.bottomCtrls=new Map,this.centerCtrls=new Map}postConstruct(){this.addManagedEventListeners({displayedRowsChanged:this.createAllCtrls.bind(this)})}createAllCtrls(){this.createCtrls("top"),this.createCtrls("bottom"),this.createCtrls("center")}createCtrls(e){const{rowSpanSvc:t}=this.beans,i=this.getCtrlsMap(e),s=i.size,n=this.getAllRelevantRowControls(e),o=new Map;let r=!1;for(const l of n)l.isAlive()&&(t==null||t.forEachSpannedColumn(l.rowNode,(c,d)=>{if(o.has(d.firstNode))return;const h=i.get(d.firstNode);if(h){o.set(d.firstNode,h),i.delete(d.firstNode);return}r=!0;const u=new Lq(d.firstNode,this.beans,!1,!1,!1);o.set(d.firstNode,u)}));this.setCtrlsMap(e,o);const a=o.size===s;if(!(!r&&a)){for(const l of i.values())l.destroyFirstPass(!0),l.destroySecondPass();this.dispatchLocalEvent({type:"spannedRowsUpdated",ctrlsKey:e})}}getAllRelevantRowControls(e){const{rowRenderer:t}=this.beans;switch(e){case"top":return t.topRowCtrls;case"bottom":return t.bottomRowCtrls;case"center":return t.allRowCtrls}}getCellByPosition(e){const{rowSpanSvc:t}=this.beans,i=t==null?void 0:t.getCellSpanByPosition(e);if(!i)return;const s=this.getCtrlsMap(e.rowPinned).get(i.firstNode);if(s)return s.getAllCellCtrls().find(n=>n.column===e.column)}getCtrls(e){return[...this.getCtrlsMap(e).values()]}destroyRowCtrls(e){for(const t of this.getCtrlsMap(e).values())t.destroyFirstPass(!0),t.destroySecondPass();this.setCtrlsMap(e,new Map)}getCtrlsMap(e){switch(e){case"top":return this.topCtrls;case"bottom":return this.bottomCtrls;default:return this.centerCtrls}}setCtrlsMap(e,t){switch(e){case"top":this.topCtrls=t;break;case"bottom":this.bottomCtrls=t;break;default:this.centerCtrls=t;break}}destroy(){super.destroy(),this.destroyRowCtrls("top"),this.destroyRowCtrls("bottom"),this.destroyRowCtrls("center")}},Nq={moduleName:"CellSpan",version:ne,beans:[kq,Oq]},Hq=class extends V{constructor(e,t){super(),this.cellCtrl=e,this.staticClasses=[],this.beans=t,this.column=e.column}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const{column:e,cellComp:t}=this,i=e.colDef,s=i.cellClassRules,n=this.getCellClassParams(e,i);BS(this.beans.expressionSvc,s===this.cellClassRules?void 0:this.cellClassRules,s,n,o=>t.toggleCss(o,!0),o=>t.toggleCss(o,!1)),this.cellClassRules=s}applyUserStyles(){const e=this.column,t=e.colDef,i=t.cellStyle;if(!i)return;let s;if(typeof i=="function"){const n=this.getCellClassParams(e,t);s=i(n)}else s=i;s&&this.cellComp.setUserStyles(s)}applyClassesFromColDef(){const{column:e,cellComp:t}=this,i=e.colDef,s=this.getCellClassParams(e,i);for(const o of this.staticClasses)t.toggleCss(o,!1);const n=this.beans.cellStyles.getStaticCellClasses(i,s);this.staticClasses=n;for(const o of n)t.toggleCss(o,!0)}getCellClassParams(e,t){const{value:i,rowNode:s}=this.cellCtrl;return Fe(this.beans.gos,{value:i,data:s.data,node:s,colDef:t,column:e,rowIndex:s.rowIndex})}},Gq=class extends V{constructor(){super(...arguments),this.beanName="cellStyles"}processAllCellClasses(e,t,i,s){BS(this.beans.expressionSvc,void 0,e.cellClassRules,t,i,s),this.processStaticCellClasses(e,t,i)}getStaticCellClasses(e,t){const{cellClass:i}=e;if(!i)return[];let s;return typeof i=="function"?s=i(t):s=i,typeof s=="string"&&(s=[s]),s||[]}createCellCustomStyleFeature(e,t){return new Hq(e,t)}processStaticCellClasses(e,t,i){this.getStaticCellClasses(e,t).forEach(n=>{i(n)})}},Bq={moduleName:"CellStyle",version:ne,beans:[Gq]},Vq={moduleName:"RowStyle",version:ne,beans:[A5]};function zq(e,t){var i;return!!((i=e.colHover)!=null&&i.isHovered(t))}var Wq=class extends V{constructor(e,t){super(),this.columns=e,this.element=t,this.destroyManagedListeners=[],this.enableFeature=i=>{const{beans:s,gos:n,element:o,columns:r}=this,a=s.colHover;if(i??!!n.get("columnHoverHighlight"))this.destroyManagedListeners=this.addManagedElementListeners(o,{mouseover:a.setMouseOver.bind(a,r),mouseout:a.clearMouseOver.bind(a)});else{for(const c of this.destroyManagedListeners)c();this.destroyManagedListeners=[]}}}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{this.enableFeature(e)}),this.enableFeature()}destroy(){super.destroy(),this.destroyManagedListeners=null}},$q="ag-column-hover",Uq=class extends V{constructor(){super(...arguments),this.beanName="colHover"}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{e||this.clearMouseOver()})}setMouseOver(e){this.updateState(e)}clearMouseOver(){this.updateState(null)}isHovered(e){if(!this.gos.get("columnHoverHighlight"))return!1;const t=this.selectedColumns;return!!t&&t.indexOf(e)>=0}addHeaderColumnHoverListener(e,t,i){const s=()=>{const n=this.isHovered(i);t.toggleCss("ag-column-hover",n)};e.addManagedEventListeners({columnHoverChanged:s}),s()}onCellColumnHover(e,t){if(!t)return;const i=this.isHovered(e);t.toggleCss($q,i)}addHeaderFilterColumnHoverListener(e,t,i,s){this.createHoverFeature(e,[i],s);const n=()=>{const o=this.isHovered(i);t.toggleCss("ag-column-hover",o)};e.addManagedEventListeners({columnHoverChanged:n}),n()}createHoverFeature(e,t,i){e.createManagedBean(new Wq(t,i))}updateState(e){this.selectedColumns=e,this.eventSvc.dispatchEvent({type:"columnHoverChanged"})}},jq={moduleName:"ColumnHover",version:ne,beans:[Uq],apiFunctions:{isColumnHovered:zq}},Kq=class extends V{constructor(){super(...arguments),this.beanName="apiEventSvc",this.syncListeners=new Map,this.asyncListeners=new Map,this.syncGlobalListeners=new Set,this.globalListenerPairs=new Map}postConstruct(){var e,t;this.wrapSvc=(t=(e=this.beans.frameworkOverrides).createGlobalEventListenerWrapper)==null?void 0:t.call(e)}addListener(e,t){var o;const i=((o=this.wrapSvc)==null?void 0:o.wrap(e,t))??t,s=!vm.has(e),n=s?this.asyncListeners:this.syncListeners;n.has(e)||n.set(e,new Set),n.get(e).add(i),this.eventSvc.addListener(e,i,s)}removeListener(e,t){var o,r;const i=((o=this.wrapSvc)==null?void 0:o.unwrap(e,t))??t,s=this.asyncListeners.get(e),n=!!(s!=null&&s.delete(i));n||(r=this.syncListeners.get(e))==null||r.delete(i),this.eventSvc.removeListener(e,i,n)}addGlobalListener(e){var o;const t=((o=this.wrapSvc)==null?void 0:o.wrapGlobal(e))??e,i=(r,a)=>{vm.has(r)&&t(r,a)},s=(r,a)=>{vm.has(r)||t(r,a)};this.globalListenerPairs.set(e,{syncListener:i,asyncListener:s});const n=this.eventSvc;n.addGlobalListener(i,!1),n.addGlobalListener(s,!0)}removeGlobalListener(e){const{eventSvc:t,wrapSvc:i,globalListenerPairs:s}=this,n=(i==null?void 0:i.unwrapGlobal(e))??e;if(s.has(n)){const{syncListener:r,asyncListener:a}=s.get(n);t.removeGlobalListener(r,!1),t.removeGlobalListener(a,!0),s.delete(e)}else this.syncGlobalListeners.delete(n),t.removeGlobalListener(n,!1)}destroyEventListeners(e,t){e.forEach((i,s)=>{i.forEach(n=>this.eventSvc.removeListener(s,n,t)),i.clear()}),e.clear()}destroyGlobalListeners(e,t){for(const i of e)this.eventSvc.removeGlobalListener(i,t);e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncListeners,!1),this.destroyEventListeners(this.asyncListeners,!0),this.destroyGlobalListeners(this.syncGlobalListeners,!1);const{globalListenerPairs:e,eventSvc:t}=this;e.forEach(({syncListener:i,asyncListener:s})=>{t.removeGlobalListener(i,!1),t.removeGlobalListener(s,!0)}),e.clear()}};function qq(e,t,i){var s;(s=e.apiEventSvc)==null||s.addListener(t,i)}function Yq(e,t,i){var s;(s=e.apiEventSvc)==null||s.removeListener(t,i)}function Xq(e,t){var i;(i=e.apiEventSvc)==null||i.addGlobalListener(t)}function Qq(e,t){var i;(i=e.apiEventSvc)==null||i.removeGlobalListener(t)}var Jq={moduleName:"EventApi",version:ne,apiFunctions:{addEventListener:qq,addGlobalListener:Xq,removeEventListener:Yq,removeGlobalListener:Qq},beans:[Kq]},Zq={moduleName:"Locale",version:ne,beans:[F4]},e7=class extends V{constructor(){super(...arguments),this.beanName="rowAutoHeight",this.wasEverActive=!1,this._debouncedCalculateRowHeights=Pi(this,this.calculateRowHeights.bind(this),1)}requestCheckAutoHeight(){this.wasEverActive&&this._debouncedCalculateRowHeights()}calculateRowHeights(){var a,l,c,d;const{visibleCols:e,rowModel:t,rowSpanSvc:i,pinnedRowModel:s}=this.beans,n=e.autoHeightCols;let o=!1;const r=h=>{var p;const u=h.__autoHeights;let f=Ba(this.beans,h).height;for(const m of n){let v=u==null?void 0:u[m.getColId()];const C=i==null?void 0:i.getCellSpan(m,h);if(C){if(C.getLastNode()!==h)continue;if(v=(p=i==null?void 0:i.getCellSpan(m,h))==null?void 0:p.getLastNodeAutoHeight(),!v)return}if(v==null){if(this.colSpanSkipCell(m,h))continue;return}f=Math.max(v,f)}f!==h.rowHeight&&(h.setRowHeight(f),o=!0)};(a=s==null?void 0:s.forEachPinnedRow)==null||a.call(s,"top",r),(l=s==null?void 0:s.forEachPinnedRow)==null||l.call(s,"bottom",r),(c=t.forEachDisplayedNode)==null||c.call(t,r),o&&((d=t.onRowHeightChanged)==null||d.call(t))}setRowAutoHeight(e,t,i){if(e.__autoHeights??(e.__autoHeights={}),t==null){delete e.__autoHeights[i.getId()];return}const s=e.__autoHeights[i.getId()];e.__autoHeights[i.getId()]=t,s!==t&&this.requestCheckAutoHeight()}colSpanSkipCell(e,t){const{colModel:i,colViewport:s,visibleCols:n}=this.beans;if(!i.colSpanActive)return!1;let o=[];switch(e.getPinned()){case"left":o=n.getLeftColsForRow(t);break;case"right":o=n.getRightColsForRow(t);break;case null:o=s.getColsWithinViewport(t);break}return!o.includes(e)}setupCellAutoHeight(e,t,i){if(!e.column.isAutoHeight()||!t)return!1;this.wasEverActive=!0;const s=t.parentElement,{rowNode:n,column:o}=e,r=this.beans,a=d=>{var w;if((w=this.beans.editSvc)!=null&&w.isEditing(e)||!e.isAlive()||!i.isAlive())return;const{paddingTop:h,paddingBottom:u,borderBottomWidth:f,borderTopWidth:p}=Uc(s),m=h+u+f+p,C=t.offsetHeight+m;if(d<5){const S=pi(r),b=!(S!=null&&S.contains(t)),E=C==0;if(b||E){window.setTimeout(()=>a(d+1),0);return}}this.setRowAutoHeight(n,C,o)},l=()=>a(0);l();const c=qa(r,t,l);return i.addDestroyFunc(()=>{c(),this.setRowAutoHeight(n,void 0,o)}),!0}setAutoHeightActive(e){this.active=e.list.some(t=>t.isVisible()&&t.isAutoHeight())}areRowsMeasured(){if(!this.active)return!0;const e=this.beans.rowRenderer.getAllRowCtrls();let t=null;for(const{rowNode:i}of e)if((!t||this.beans.colModel.colSpanActive)&&(t=this.beans.colViewport.getColsWithinViewport(i).filter(n=>n.isAutoHeight())),t.length!==0){if(!i.__autoHeights)return!1;for(const s of t){const n=i.__autoHeights[s.getColId()];if(!n||i.rowHeight<n)return!1}}return!0}},t7={moduleName:"RowAutoHeight",version:ne,beans:[e7]},i7={moduleName:"AllCommunity",version:ne,dependsOn:[eK,lK,CK,U4,t8,i8,s8,n8,o8,r8,a8,e8,K6,q6,Y6,j6,Q6,J6,_K,I8,ZK,aD,cq,dq,Cq,Rq,GW,Dq,S8,l4,Bq,jq,Vq,Jq,h4,PK,WD,Zq,t7,HW,tK,Nq]},s7=J("<option> </option>"),n7=J('<div class="toolbar svelte-33y0l8"><div class="toolbar-group svelte-33y0l8"><span class="label svelte-33y0l8">Theme:</span> <select class="svelte-33y0l8"></select></div> <div class="toolbar-group svelte-33y0l8"><button class="refresh-btn svelte-33y0l8">LÃ m má»i Grid</button></div></div> <div class="grid-wrapper svelte-33y0l8"><div class="ag-theme-alpine" style="height: 100%; width: 100%;"></div></div>',1);function o7(e,t){ot(t,!1),jH.registerModules([i7]);let i=re(),s,n=re("ag-theme-alpine");const o=[{name:"Alpine",class:"ag-theme-alpine"},{name:"Quartz",class:"ag-theme-quartz"},{name:"Balham",class:"ag-theme-balham"},{name:"Material",class:"ag-theme-material"}];let r=[{field:"athlete",headerName:"VÄV",sortable:!0,filter:!0,flex:2},{field:"age",headerName:"Tuá»i",width:100},{field:"country",headerName:"Quá»c gia",sortable:!0,filter:!0,flex:2},{field:"year",headerName:"NÄm",width:100},{field:"date",headerName:"NgÃ y",width:130},{field:"sport",headerName:"MÃ´n thi",sortable:!0,filter:!0,flex:2},{field:"gold",headerName:"VÃ ng",width:100,cellStyle:{color:"#d4a017"}},{field:"silver",headerName:"Báº¡c",width:100,cellStyle:{color:"#a8a8a8"}},{field:"bronze",headerName:"Äá»ng",width:100,cellStyle:{color:"#cd7f32"}},{field:"total",headerName:"Tá»ng",width:110,cellStyle:{fontWeight:"bold"}}],a=[];Ci(async()=>{try{const w=await fetch("https://www.ag-grid.com/example-assets/olympic-winners.json");if(!w.ok)throw new Error("KhÃ´ng táº£i ÄÆ°á»£c dá»¯ liá»u");a=await w.json(),console.log(`ÄÃ£ táº£i ${a.length} dÃ²ng dá»¯ liá»u thÃ nh cÃ´ng!`);const S={columnDefs:r,rowData:a,pagination:!0,paginationPageSize:20,paginationPageSizeSelector:[10,20,50,100],animateRows:!0,defaultColDef:{flex:1,minWidth:100,resizable:!0,sortable:!0,filter:!0},overlayLoadingTemplate:'<span class="ag-overlay-loading-center">Äang táº£i dá»¯ liá»u...</span>',overlayNoRowsTemplate:'<span class="ag-overlay-loading-center">KhÃ´ng cÃ³ dá»¯ liá»u</span>',onGridReady:b=>{s=b.api},onFirstDataRendered:()=>{R(i)&&R(i).offsetWidth>0&&s.sizeColumnsToFit()},onGridSizeChanged:()=>{R(i)&&R(i).offsetWidth>0&&s.sizeColumnsToFit()}};R4(R(i),S)}catch(w){console.error("Lá»i khi táº£i dá»¯ liá»u:",w),a=[{athlete:"Lá»i",country:"Kiá»m tra máº¡ng"}]}});function l(w){R(i)&&(o.forEach(S=>R(i).classList.remove(S.class)),R(i).classList.add(w),G(n,w),s&&R(i).offsetWidth>0&&setTimeout(()=>s.sizeColumnsToFit(),0))}function c(){s&&s.refreshCells({force:!0})}lt();var d=n7(),h=ce(d),u=I(h),f=L(I(u),2);Me(()=>{R(n),vI(()=>{})}),Ai(f,5,()=>o,gs,(w,S)=>{var b=s7(),E=I(b),A={};Me(()=>{Be(E,R(S).name),A!==(A=R(S).class)&&(b.value=(b.__value=R(S).class)??"")}),O(w,b)});var p=L(u,2),m=I(p),v=L(h,2),C=I(v);ji(C,w=>G(i,w),()=>R(i)),VI(f,()=>R(n),w=>G(n,w)),Y("change",f,w=>l(w.target.value)),Y("click",m,c),O(e,d),rt()}function wy(e,t){const i=typeof t=="object"&&t!==null;let s=t;if(typeof window<"u")try{const o=localStorage.getItem(e);o!==null&&(i?s={...t,...JSON.parse(o)}:s=o)}catch{}const n=ri(s);return n.subscribe(o=>{try{localStorage.setItem(e,i?JSON.stringify(o):o)}catch{}}),n}function r7(){const e=wy("$selectedFace","info"),t=ri(!0);function i(r){e.set(r),r==="cam"?t.set(!1):t.set(!0)}function s(){t.set(!0)}function n(){t.set(!1)}function o(){t.update(r=>!r)}return{face:e,menuVisible:t,changeFace:i,showMenu:s,hideMenu:n,toggleMenu:o}}const qS=r7(),rM=ri(!1);function yx(){const e=window.matchMedia("(max-width: 768px)").matches;rM.set(e)}typeof window<"u"&&(yx(),window.addEventListener("resize",yx));function a7(e,t){const i=()=>mt(rM,"$isMobile",s),[s,n]=Ln();var o=xe(),r=ce(o);{var a=c=>{var d=xe(),h=ce(d);We(h,t,"mobile",{}),O(c,d)},l=c=>{var d=xe(),h=ce(d);We(h,t,"desktop",{}),O(c,d)};ye(r,c=>{i()?c(a):c(l,!1)})}O(e,o),n()}var l7=J("<!> <!> <!>",1),c7=J("<!> <!> <!>",1),d7=J("<!> <!> <!>",1);function h7(e,t){ot(t,!1);let i=ge(t,"option",24,()=>({}));const s=i().mainKey||"layout-main-default",n=i().bodyKey||"layout-body-default",o=i().contentKey||"layout-content-default",r=i().noDivider??!0;i().noSnap;const a=i().mainSizes||[{size:5,snapSize123:2},{size:90,snapSize123:10},{size:5,snapSize123:10}],l=i().bodySizes||[{size:23,snapSize123:10},{size:50,snapSize123:10},{size:30,snapSize123:10}],c=i().contentSizes||[{size:10,snapSize123:5},{size:80,snapSize123:10},{size:10,snapSize123:10}];Ti(()=>{},()=>{console.log("sole:",c)}),Po(),lt();{let d=Aa(()=>`${r?"no-splitter-divider":""}`);lC(e,{get class(){return R(d)},get key(){return s},horizontal:!0,get defaultSizes(){return a},children:Jv,$$slots:{default:(h,u)=>{const f=Aa(()=>u.paneSizes);var p=d7(),m=ce(p);Io(m,{index:0,get paneSizes(){return R(f)},children:(w,S)=>{var b=xe(),E=ce(b);We(E,t,"header",{}),O(w,b)},$$slots:{default:!0}});var v=L(m,2);Io(v,{index:1,get paneSizes(){return R(f)},children:(w,S)=>{lC(w,{get key(){return n},horizontal:!1,get defaultSizes(){return l},children:Jv,$$slots:{default:(b,E)=>{const A=Aa(()=>E.paneSizes);var P=c7(),T=ce(P);Io(T,{index:0,get paneSizes(){return R(A)},children:(_,W)=>{var $=xe(),B=ce($);We(B,t,"left",{}),O(_,$)},$$slots:{default:!0}});var D=L(T,2);Io(D,{index:1,get paneSizes(){return R(A)},children:(_,W)=>{lC(_,{get key(){return o},horizontal:!0,get defaultSizes(){return c},children:Jv,$$slots:{default:($,B)=>{const q=Aa(()=>B.paneSizes);var X=l7(),U=ce(X);Io(U,{index:0,get paneSizes(){return R(q)},children:(Ce,le)=>{var ee=xe(),ve=ce(ee);We(ve,t,"head",{}),O(Ce,ee)},$$slots:{default:!0}});var pe=L(U,2);Io(pe,{index:1,get paneSizes(){return R(q)},children:(Ce,le)=>{var ee=xe(),ve=ce(ee);We(ve,t,"content",{}),O(Ce,ee)},$$slots:{default:!0}});var Ee=L(pe,2);Io(Ee,{index:2,get paneSizes(){return R(q)},children:(Ce,le)=>{var ee=xe(),ve=ce(ee);We(ve,t,"comment",{}),O(Ce,ee)},$$slots:{default:!0}}),O($,X)}}})},$$slots:{default:!0}});var N=L(D,2);{var M=_=>{Io(_,{index:2,get paneSizes(){return R(A)},children:(W,$)=>{var B=xe(),q=ce(B);We(q,t,"right",{}),O(W,B)},$$slots:{default:!0}})};ye(N,_=>{Re(i()),ie(()=>i().showBodyRight!==!1)&&_(M)})}O(b,P)}}})},$$slots:{default:!0}});var C=L(v,2);Io(C,{index:2,get paneSizes(){return R(f)},children:(w,S)=>{var b=xe(),E=ce(b);We(E,t,"footer",{}),O(w,b)},$$slots:{default:!0}}),O(h,p)}}})}rt()}const bi={avatar:"https://i.pravatar.cc/120?img=12",name:"Nguyá»n VÄn A",isGroup:!0,membersCount:5,description:"NhÃ³m trao Äá»i cÃ´ng viá»c",members:[{id:1,name:"Nguyá»n VÄn A",avatar:"https://i.pravatar.cc/40?img=12"},{id:2,name:"Tráº§n Thá» B",avatar:"https://i.pravatar.cc/40?img=32"},{id:3,name:"LÃª VÄn C",avatar:"https://i.pravatar.cc/40?img=45"}],media:["https://picsum.photos/200/140?1","https://picsum.photos/200/140?2","https://picsum.photos/200/140?3"],files:[{name:"BÃ¡o_cÃ¡o_T8.pdf",size:"1.2 MB"},{name:"Káº¿_hoáº¡ch.xlsx",size:"340 KB"}]};var u7=J(`<div class="flex items-center justify-between
               px-3 py-2
               rounded-lg
               bg-gray-100
               border-l-4 border-blue-500
               text-sm shadow-sm"><div class="truncate"><span class="font-semibold"> </span> </div> <button class="ml-3 text-gray-500 hover:text-gray-800">â</button></div>`),g7=J('<div class="text-xs text-gray-500 px-2">Äang táº£i file...</div>'),f7=J(`<div class="h-full flex flex-col bg-white border-t border-gray-200"><div class="flex items-center gap-3 px-3 py-2 shrink-0"><button type="button"><!></button> <button type="button"><!></button> <button type="button"><!></button> <!></div> <div class="px-3 pb-2 flex flex-col gap-2"><!> <div class="flex items-end gap-2"><textarea rows="1" class="flex-1 resize-none rounded-2xl
               border border-gray-200
               px-4 py-2 text-sm
               focus:outline-none focus:border-blue-400
               overflow-y-auto">
      </textarea> <button type="button" class="text-blue-500 shrink-0 disabled:opacity-40"><!></button></div> <!></div> <input type="file" accept="image/*" multiple class="hidden"/> <input type="file" multiple class="hidden"/></div>`);function aM(e,t){ot(t,!1);const i=()=>mt(dn,"$replyingTo",n),s=()=>mt(gr,"$myId",n),[n,o]=Ln();let r=ge(t,"placeholder",8,"Nháº­p tin nháº¯n..."),a=ge(t,"disabled",8,!1),l=ge(t,"autoFocus",8,!1),c=re(""),d=re(),h=re(),u=!1,f=re(!1);function p(){var Z;console.log("commitSend sending || uploading || !text.trim() || disabled:",u,R(f),R(c).trim(),a()),u=!0,ul({type:"chat",conversationId:si(Tn),from:si(gr),message:R(c).trim(),replyTo:((Z=si(dn))==null?void 0:Z.id)||null}),G(c,""),dn.set(null),requestAnimationFrame(()=>{u=!1})}function m(Z){Z.key==="Enter"&&!Z.shiftKey&&!Z.repeat&&!Z.isComposing&&(Z.preventDefault(),p())}function v(){var Z;(Z=R(d))==null||Z.click()}function C(){var Z;(Z=R(h))==null||Z.click()}async function w(Z){var we;if(!(!Z.length||R(f))){G(f,!0);for(const Ne of Z)try{console.log("uploaded0:",Ne);const Se=await Ok(Ne);console.log("uploaded:",Se),ul({type:"chat",conversationId:si(Tn),from:gr,message:Se.url,msgType:"media",meta:{mediaType:Se.type,name:Se.name,size:Se.size,mime:Se.mime},replyTo:((we=si(dn))==null?void 0:we.id)||null})}catch(Se){console.error("â Upload failed:",Se)}dn.set(null),G(f,!1)}}function S(Z){const we=Array.from(Z.target.files||[]);w(we),Z.target.value=""}function b(){ul({type:"chat",payload:{conversationId:si(Tn),from:si(gr),type:"sticker",stickerId:"sticker_like"}})}async function E(Z){var Ne;const we=Array.from(Z.target.files||[]);if(we.length){if(we.length===1){await w(we),Z.target.value="";return}G(f,!0);try{const Se=await Nk(we);console.log("results:",Se);const tt=Se.images.map(St=>St.url),Mt=Se.images.map(St=>St.url);ul({type:"chat",conversationId:si(Tn),from:si(gr),msgType:"album",message:JSON.stringify({urls:tt,fullUrls:Mt}),replyTo:((Ne=si(dn))==null?void 0:Ne.id)||null}),dn.set(null)}catch(Se){console.error("â Upload gallery failed",Se)}finally{G(f,!1),Z.target.value=""}}}lt();var A=f7(),P=I(A),T=I(P),D=I(T);Rk(D,{size:"22"});var N=L(T,2),M=I(N);Ck(M,{size:"22"});var _=L(N,2),W=I(_);uk(W,{size:"22"});var $=L(_,2);dk($,{size:"22"});var B=L(P,2),q=I(B);{var X=Z=>{var we=u7(),Ne=I(we),Se=I(Ne),tt=I(Se),Mt=L(Se),St=L(Ne,2);Me(()=>{Be(tt,(i(),s(),ie(()=>i().senderId===s()?"Báº¡n":"NgÆ°á»i khÃ¡c"))),Be(Mt,` : ${i(),ie(()=>i().content)??""}`)}),Y("click",St,()=>dn.set(null)),O(Z,we)};ye(q,Z=>{i()&&Z(X)})}var U=L(q,2),pe=I(U);Ey(pe,l());var Ee=L(pe,2),Ce=I(Ee);bk(Ce,{size:"22"});var le=L(U,2);{var ee=Z=>{var we=g7();O(Z,we)};ye(le,Z=>{R(f)&&Z(ee)})}var ve=L(B,2);ji(ve,Z=>G(d,Z),()=>R(d));var Oe=L(ve,2);ji(Oe,Z=>G(h,Z),()=>R(h)),Me(Z=>{T.disabled=R(f),N.disabled=R(f),_.disabled=R(f),fi(pe,"placeholder",r()),pe.disabled=a(),Ee.disabled=Z},[()=>(R(c),R(f),ie(()=>!R(c).trim()||R(f)))]),Y("click",T,b),Y("click",N,C),Y("click",_,v),eg(pe,()=>R(c),Z=>G(c,Z)),Y("keydown",pe,m),Y("click",Ee,p),Y("change",ve,E),Y("change",Oe,S),O(e,A),rt(),o()}var p7=J('<button class="text-gray-400 hover:text-gray-600"><!></button>'),m7=J(`<div class="flex items-center gap-2
         px-3 py-2
         rounded-full
         bg-gray-100
         border border-transparent
         focus-within:bg-white
         focus-within:border-blue-400
         transition"><!> <input type="text" class="flex-1 bg-transparent outline-none text-sm"/> <!></div>`);function v7(e,t){ot(t,!1);let i=ge(t,"placeholder",8,"TÃ¬m kiáº¿m"),s=ge(t,"autoFocus",8,!1),n=ge(t,"debounce",8,300),o=ge(t,"onSearch",8,()=>{}),r=ge(t,"onClear",8,()=>{}),a=re(""),l;function c(C){G(a,C.target.value),clearTimeout(l),l=setTimeout(()=>{o()(R(a).trim())},n())}function d(){G(a,""),clearTimeout(l),r()(),o()("")}function h(C){C.key==="Escape"&&R(a)&&d()}_r(()=>{clearTimeout(l)}),lt();var u=m7(),f=I(u);Oy(f,{size:"18",class:"text-gray-500 shrink-0"});var p=L(f,2);Ey(p,s());var m=L(p,2);{var v=C=>{var w=p7(),S=I(w);BE(S,{size:"16"}),Y("click",w,d),O(C,w)};ye(m,C=>{R(a)&&C(v)})}Me(()=>fi(p,"placeholder",i())),eg(p,()=>R(a),C=>G(a,C)),Y("input",p,c),Y("keydown",p,h),O(e,u),rt()}var C7=J('<div class="flex justify-between flex-row items-center w-full"><div><span class="font-semibold text-blue-600 truncate"> </span> <span> </span></div> <div><label for="quantity">Quantity (0-100):</label> <input type="number" id="quantity" name="quantity" min="0" max="100" step="5" value="1"/></div> <div><button><!></button></div></div>'),w7=J('<div class="min-w-[330px] w-full h-full flex flex-col"><div class="min-h-[50px] bg-gray-200"><!></div> <div class="flex-1 bg-gray-100 overflow-auto"><div class="w-full h-full overflow-auto"><h1 class="text-1xl font-bold mb-2 text-center hidden">Chat List</h1> <div class="bg-white shadow-md rounded-lg overflow-hidden"><ul id="chat-list" class="divide-y divide-gray-200"></ul></div></div></div></div>'),b7=J('<div class="font-semibold">Nguyá»n VÄn A</div>'),y7=J('<p class="text-center text-gray-400 mt-10">Chá»n má»t cuá»c trÃ² chuyá»n Äá» báº¯t Äáº§u</p>'),S7=J('<p class="text-center text-xs text-gray-500 py-2">Äang táº£i tin nháº¯n cÅ©...</p>'),R7=J("<!> <!>",1),x7=J('<!> <!> <div class="h-2"></div>',1),E7=J('<div class="h-full w-full flex flex-col"><div class="flex-1 overflow-y-auto p-3 bg-gray-50"><!></div></div>'),A7=J('<div class="h-full w-full flex flex-col"><!></div>'),F7=J('<img class="w-full h-20 object-cover rounded cursor-pointer" alt=""/>'),P7=J('<li class="flex justify-between items-center text-xs bg-gray-50 p-2 rounded"><span class="truncate"> </span> <span class="text-gray-400"> </span></li>'),T7=J('<li class="flex items-center gap-2"><img class="w-8 h-8 rounded-full"/> <span class="text-sm"> </span></li>'),D7=J('<section><h4 class="text-sm font-semibold mb-2">ThÃ nh viÃªn</h4> <ul class="space-y-2"></ul></section>'),M7=J('<div class="h-full w-full flex flex-col bg-white"><div class="p-4 border-b border-gray-200 flex flex-col items-center"><img class="w-20 h-20 rounded-full mb-2" alt=""/> <div class="font-semibold"> </div> <div class="text-xs text-gray-500"> </div></div> <div class="flex-1 overflow-y-auto px-4 py-3 space-y-5 chat-scroll"><section><h4 class="text-sm font-semibold mb-2">ThÃ´ng tin</h4> <p class="text-xs text-gray-600"> </p></section> <section><h4 class="text-sm font-semibold mb-2">áº¢nh / Video</h4> <div class="grid grid-cols-3 gap-2"></div></section> <section><h4 class="text-sm font-semibold mb-2">File</h4> <ul class="space-y-2"></ul></section> <!> <section class="pt-3 border-t border-gray-200"><button class="w-full text-sm text-red-600 hover:underline">Rá»i khá»i cuá»c trÃ² chuyá»n</button></section></div></div>'),I7=J('<div slot="footer" class="h-full flex items-center justify-center text-xs text-gray-400">Desktop Clone</div>');function k7(e,t){ot(t,!1);const i=()=>mt(ka,"$messages",c),s=()=>mt(Tn,"$conversationId",c),n=()=>mt(gr,"$myId",c),o=()=>mt(h,"$menuVisible",c),r=()=>mt(hw,"$myName",c),a=()=>mt(Tp,"$status",c),l=()=>mt(Hy,"$conversations",c),[c,d]=Ln(),{menuVisible:h,toggleMenu:u}=qS,f={};let p=re(null),m=re(),v=re(),C=re(!1),w=!1,S=0,b=null;async function E(D=!1){R(v)&&(await Fc(),R(v).scrollTo({top:R(v).scrollHeight,behavior:D?"smooth":"auto"}))}async function A(){if(!R(v)||R(C)||R(v).scrollTop>120||i().length===0)return;R(v).scrollTop<=1&&Ji(v,R(v).scrollTop=1);const D=i()[0];if(b!==D.id){G(C,!0),w=!0,S=R(v).scrollHeight,b=D.id;try{await tg(s(),{firstMsg:D})}catch(N){console.error("Load older failed:",N),b=null}finally{G(C,!1)}}}My(async()=>{if(R(v)){if(w){await Fc();const D=R(v).scrollHeight-S;D>0&&Ji(v,R(v).scrollTop+=D),w=!1;return}i().length>0&&(R(v).scrollHeight-R(v).scrollTop-R(v).clientHeight<300||b===null)&&E()}});async function P(D){!(D!=null&&D.conversationId)||R(p)===D.conversationId||(G(p,D.conversationId),Tn.set(R(p)),ka.set([]),b=null,w=!1,await tg(s()),E())}function T(D=""){const N=D.trim();if(!N||!R(p))return;const M=si(dn);ul({type:"chat",conversationId:R(p),from:n(),message:N,replyTo:(M==null?void 0:M.id)??null}),dn.set(null)}Ci(()=>{o()&&u(!1);const D=()=>A();return R(v).addEventListener("scroll",D,{passive:!0}),()=>{R(v).removeEventListener("scroll",D)}}),Ti(()=>(i(),R(v)),()=>{i().length>0&&R(v)&&R(v).scrollHeight-R(v).scrollTop-R(v).clientHeight<100&&E("smooth")}),Po(),lt(),h7(e,{get option(){return f},$$slots:{header:(D,N)=>{var M=C7(),_=I(M),W=I(_),$=I(W),B=L(W,2),q=I(B),X=L(_,4),U=I(X);U.__click=u;var pe=I(U);{var Ee=le=>{HE(le,{size:26})},Ce=le=>{GE(le,{size:26})};ye(pe,le=>{o()?le(Ee):le(Ce,!1)})}Me((le,ee)=>{Be($,r()),$i(B,1,`text-[10px] px-2 rounded-full ${le??""}`),Be(q,ee)},[()=>(a(),ie(()=>a().includes("Connected")?"bg-green-100 text-green-600":"bg-red-100 text-red-600")),()=>(a(),ie(()=>a().replace(/\s.*$/,"")))]),O(D,M)},left:(D,N)=>{var M=w7(),_=I(M),W=I(_);v7(W,{placeholder:"TÃ¬m kiáº¿m cuá»c trÃ² chuyá»n",onSearch:U=>{G(m,l().filter(pe=>(pe.name||"").toLowerCase().includes((U||"").toLowerCase())))}});var $=L(_,2),B=I($),q=L(I(B),2),X=I(q);Ai(X,5,l,gs,(U,pe)=>{aP(U,{get conversation(){return R(pe)},get selectedId(){return R(p)},onSelect:P})}),O(D,M)},head:(D,N)=>{var M=b7();O(D,M)},content:(D,N)=>{var M=E7(),_=I(M),W=I(_);{var $=q=>{var X=y7();O(q,X)},B=q=>{var X=x7(),U=ce(X);{var pe=Ce=>{var le=S7();O(Ce,le)};ye(U,Ce=>{R(C)&&Ce(pe)})}var Ee=L(U,2);Ai(Ee,3,i,Ce=>Ce.id,(Ce,le,ee)=>{var ve=R7(),Oe=ce(ve);{var Z=Ne=>{eA(Ne,{get time(){return R(le),ie(()=>R(le).created_at)},locale:"vi"})};ye(Oe,Ne=>{Re(R(ee)),Re(xm),R(le),i(),ie(()=>{var Se;return R(ee)===0||xm(R(le).created_at,(Se=i()[R(ee)-1])==null?void 0:Se.created_at)})&&Ne(Z)})}var we=L(Oe,2);rP(we,{get msg(){return R(le)},get myId(){return n()}}),O(Ce,ve)}),O(q,X)};ye(W,q=>{R(p)?q(B,!1):q($)})}ji(_,q=>G(v,q),()=>R(v)),O(D,M)},comment:(D,N)=>{var M=A7(),_=I(M);{let W=Aa(()=>!R(p));aM(_,{placeholder:"Nháº­p tin nháº¯n...",get disabled(){return R(W)},onSendText:$=>{T($==null?void 0:$.text),console.log("payload:",$)},onSendImages:$=>{console.log("onSendImages:",$)},onSendFiles:$=>{console.log("onSendFiles:",$)},onSendSticker:$=>{console.log("onSendSticker:",$)}})}O(D,M)},right:(D,N)=>{var M=M7(),_=I(M),W=I(_),$=L(W,2),B=I($),q=L($,2),X=I(q),U=L(_,2),pe=I(U),Ee=L(I(pe),2),Ce=I(Ee),le=L(pe,2),ee=L(I(le),2);Ai(ee,5,()=>(Re(bi),ie(()=>bi.media)),gs,(Ne,Se)=>{var tt=F7();Me(()=>fi(tt,"src",R(Se))),O(Ne,tt)});var ve=L(le,2),Oe=L(I(ve),2);Ai(Oe,5,()=>(Re(bi),ie(()=>bi.files)),gs,(Ne,Se)=>{var tt=P7(),Mt=I(tt),St=I(Mt),qt=L(Mt,2),Ht=I(qt);Me(()=>{Be(St,(R(Se),ie(()=>R(Se).name))),Be(Ht,(R(Se),ie(()=>R(Se).size)))}),O(Ne,tt)});var Z=L(ve,2);{var we=Ne=>{var Se=D7(),tt=L(I(Se),2);Ai(tt,5,()=>(Re(bi),ie(()=>bi.members)),gs,(Mt,St)=>{var qt=T7(),Ht=I(qt),wi=L(Ht,2),Ie=I(wi);Me(()=>{fi(Ht,"src",(R(St),ie(()=>R(St).avatar))),Be(Ie,(R(St),ie(()=>R(St).name)))}),O(Mt,qt)}),O(Ne,Se)};ye(Z,Ne=>{Re(bi),ie(()=>bi.isGroup)&&Ne(we)})}Me(()=>{fi(W,"src",(Re(bi),ie(()=>bi.avatar))),Be(B,(Re(bi),ie(()=>bi.name))),Be(X,(Re(bi),ie(()=>bi.isGroup?`${bi.membersCount} thÃ nh viÃªn`:"Äang hoáº¡t Äá»ng"))),Be(Ce,(Re(bi),ie(()=>bi.description)))}),O(D,M)},footer:(D,N)=>{var M=I7();O(D,M)}}}),rt(),d()}Fv(["click"]);var _7=J(`<div class="absolute bottom-0 left-0 right-0
               bg-white rounded-t-2xl
               p-4 pb-6
               animate-slide-up svelte-198oxpw"><!></div>`),L7=J(`<div class="absolute bg-white rounded-xl shadow-lg
               p-3 animate-scale-in svelte-198oxpw"><!></div>`),O7=J(`<div class="popup-center bg-white rounded-2xl shadow-xl
               animate-scale-in-center svelte-198oxpw"><!></div>`),N7=J('<div class="fixed inset-0 z-50"><div class="absolute inset-0 bg-black/40"></div> <!></div>');function H7(e,t){ot(t,!1);let i=ge(t,"open",12,!1),s=ge(t,"mode",8,"bottom"),n=ge(t,"anchorRect",8,null);const o=200,r=180,a=8,l=8;let c=re({top:0,left:0});function d(){i(!1)}function h(){if(!n())return{top:0,left:0};const m=window.innerWidth,v=window.innerHeight;let C=n().left+n().width/2-o/2;C=Math.max(l,C),C=Math.min(C,m-o-l);const w=v-n().bottom,S=n().top;let b;return w>=r+a?b=n().bottom+a:S>=r+a?b=n().top-r-a:b=Math.max(l,v-r-l),{top:b,left:C}}Ti(()=>(Re(i()),Re(s()),Re(n())),()=>{i()&&s()==="anchor"&&n()&&G(c,h())}),Po(),lt();var u=xe(),f=ce(u);{var p=m=>{var v=N7(),C=I(v),w=L(C,2);{var S=E=>{var A=_7(),P=I(A);We(P,t,"default",{}),O(E,A)},b=E=>{var A=xe(),P=ce(A);{var T=N=>{var M=L7(),_=I(M);We(_,t,"default",{}),Me(()=>ja(M,`
          top: ${R(c),ie(()=>R(c).top)??""}px;
          left: ${R(c),ie(()=>R(c).left)??""}px;
          width: 200px;
        `)),O(N,M)},D=N=>{var M=xe(),_=ce(M);{var W=$=>{var B=O7(),q=I(B);We(q,t,"default",{}),O($,B)};ye(_,$=>{s()==="center"&&$(W)},!0)}O(N,M)};ye(P,N=>{s()==="anchor"&&n()?N(T):N(D,!1)},!0)}O(E,A)};ye(w,E=>{s()==="bottom"?E(S):E(b,!1)})}Y("click",C,d),O(m,v)};ye(f,m=>{i()&&m(p)})}O(e,u),rt()}var G7=J('<h3 class="text-lg font-semibold mb-4">ThÃªm ngÆ°á»i dÃ¹ng</h3> <input placeholder="Nháº­p sá» Äiá»n thoáº¡i" class="w-full px-4 py-2 rounded-lg bg-gray-100 focus:outline-none"/> <button class="w-full mt-4 py-2 bg-blue-600 text-white rounded-lg">ThÃªm</button>',1);function B7(e,t){let i=ge(t,"onClose",8);var s=G7(),n=L(ce(s),4);Y("click",n,function(...o){var r;(r=i())==null||r.apply(this,o)}),O(e,s)}var V7=J('<h3 class="text-lg font-semibold mb-4">Táº¡o nhÃ³m</h3> <input placeholder="TÃªn nhÃ³m" class="w-full px-4 py-2 rounded-lg bg-gray-100 focus:outline-none"/> <button class="w-full mt-4 py-2 bg-blue-600 text-white rounded-lg">Táº¡o nhÃ³m</button>',1);function z7(e,t){let i=ge(t,"onClose",8);var s=V7(),n=L(ce(s),4);Y("click",n,function(...o){var r;(r=i())==null||r.apply(this,o)}),O(e,s)}var W7=J('<h3 class="text-lg font-semibold mb-4">CÃ i Äáº·t</h3> <div class="space-y-3 text-sm"><div class="flex justify-between"><span>ThÃ´ng bÃ¡o</span> <input type="checkbox" checked/></div> <div class="flex justify-between"><span>Cháº¿ Äá» tá»i</span> <input type="checkbox"/></div></div> <button class="w-full mt-6 py-2 bg-gray-200 rounded-lg">ÄÃ³ng</button>',1);function $7(e,t){let i=ge(t,"onClose",8);var s=W7(),n=L(ce(s),4);Y("click",n,function(...o){var r;(r=i())==null||r.apply(this,o)}),O(e,s)}var U7=J(`<div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold text-gray-900">CÃ i Äáº·t</h3> <button class="text-gray-400 hover:text-gray-600 text-xl">â</button></div> <div class="space-y-6 text-sm text-gray-700"><section><h4 class="text-xs font-semibold text-gray-400 uppercase mb-2">Chung</h4> <div class="space-y-3"><label class="flex items-center justify-between"><span>ThÃ´ng bÃ¡o</span> <input type="checkbox" class="accent-blue-500"/></label> <label class="flex items-center justify-between"><span>Cháº¿ Äá» tá»i</span> <input type="checkbox" class="accent-blue-500"/></label></div></section> <section><h4 class="text-xs font-semibold text-gray-400 uppercase mb-2">TrÃ² chuyá»n</h4> <div class="space-y-3"><label class="flex items-center justify-between"><span>Enter Äá» gá»­i</span> <input type="checkbox" class="accent-blue-500"/></label> <label class="flex items-center justify-between"><span>Tá»± cuá»n khi cÃ³ tin má»i</span> <input type="checkbox" class="accent-blue-500"/></label></div></section> <section><h4 class="text-xs font-semibold text-gray-400 uppercase mb-2">TÃ i khoáº£n</h4> <button class="w-full py-2 text-red-600
             bg-red-50 rounded-lg
             hover:bg-red-100 transition">ÄÄng xuáº¥t</button></section></div> <div class="mt-6 flex gap-3"><button class="flex-1 py-2 rounded-lg
           bg-gray-100 hover:bg-gray-200">Huá»·</button> <button class="flex-1 py-2 rounded-lg
           bg-blue-600 text-white
           hover:bg-blue-700">LÆ°u</button></div>`,1);function j7(e,t){ot(t,!1);let i=ge(t,"onClose",8),s=re(!0),n=re(!1),o=re(!0),r=re(!0);function a(){var M;(M=i())==null||M()}lt();var l=U7(),c=ce(l),d=L(I(c),2),h=L(c,2),u=I(h),f=L(I(u),2),p=I(f),m=L(I(p),2),v=L(p,2),C=L(I(v),2),w=L(u,2),S=L(I(w),2),b=I(S),E=L(I(b),2),A=L(b,2),P=L(I(A),2),T=L(h,2),D=I(T),N=L(D,2);Y("click",d,function(...M){var _;(_=i())==null||_.apply(this,M)}),op(m,()=>R(s),M=>G(s,M)),op(C,()=>R(n),M=>G(n,M)),op(E,()=>R(o),M=>G(o,M)),op(P,()=>R(r),M=>G(r,M)),Y("click",D,function(...M){var _;(_=i())==null||_.apply(this,M)}),Y("click",N,a),O(e,l),rt()}var K7=J(`<div class="flex items-center px-4 py-3
               border-b border-gray-100
               active:bg-gray-100 transition"><!></div>`),q7=J(`<div class="w-full h-dvh flex flex-col bg-white"><div class="sticky top-0 z-10 bg-white border-b border-gray-200"><div class="px-4 pt-4 pb-3"><div class="flex items-center justify-between mb-2"><h2 class="text-lg font-semibold text-gray-900">Tin nháº¯n</h2> <div class="flex items-center gap-4 text-gray-600"><button><!></button> <button><!></button> <button><!></button></div></div> <div><div class="relative"><!> <input type="text" placeholder="TÃ¬m kiáº¿m" class="w-full pl-10 pr-4 py-2 text-sm
                   rounded-full bg-gray-100
                   focus:outline-none"/></div></div></div></div> <div class="flex-1 overflow-y-auto"></div> <div class="shrink-0 border-t border-gray-200 bg-white"><div class="flex justify-around py-2"><div class="flex flex-col items-center text-blue-600 text-xs"><!> <span class="mt-0.5">Tin nháº¯n</span></div> <div class="flex flex-col items-center text-gray-500 text-xs"><button><!></button> <span class="mt-0.5">Danh báº¡</span></div> <div class="flex flex-col items-center text-gray-500 text-xs"><button><!></button> <span class="mt-0.5">CÃ i Äáº·t</span></div></div></div></div> <!>`,1);function Y7(e,t){ot(t,!1);const i=()=>mt(a,"$menuVisible",o),s=()=>mt(Tn,"$conversationId",o),n=()=>mt(Hy,"$conversations",o),[o,r]=Ln(),{menuVisible:a,toggleMenu:l}=qS;let c=ge(t,"openChat",8),d=re(null),h=re(!0),u=0;function f(Ie){var Rt;(Rt=c())==null||Rt(Ie)}function p(Ie){const Rt=Ie.target.scrollTop;Rt>u&&Rt>20&&G(h,!1),Rt<u&&G(h,!0),u=Rt}let m=re(!1),v=re(null),C=re("bottom"),w=re(null);function S({type:Ie,mode:Rt="bottom",event:Le=null}){G(v,Ie),G(C,Rt),Rt==="anchor"&&(Le!=null&&Le.currentTarget)?G(w,Le.currentTarget.getBoundingClientRect()):G(w,null),G(m,!0)}function b(){G(m,!1),G(v,null),G(w,null)}Ci(()=>{i()&&l(!1),document.addEventListener("touchmove",Ie=>{Ie.scale!==1&&Ie.preventDefault()},{passive:!1})});async function E(Ie){!(Ie!=null&&Ie.conversationId)||R(d)===Ie.conversationId||(G(d,Ie.conversationId),Tn.set(R(d)),ka.set([]),await tg(s()))}lt();var A=q7(),P=ce(A),T=I(P),D=I(T),N=I(D),M=L(I(N),2),_=I(M),W=I(_);xk(W,{size:20});var $=L(_,2),B=I($);Ek(B,{size:20});var q=L($,2),X=I(q);{var U=Ie=>{HE(Ie,{size:20})},pe=Ie=>{GE(Ie,{size:20})};ye(X,Ie=>{i()?Ie(U):Ie(pe,!1)})}var Ee=L(N,2);let Ce;var le=I(Ee),ee=I(le);Oy(ee,{size:18,class:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"});var ve=L(T,2);Ai(ve,5,n,gs,(Ie,Rt)=>{var Le=K7(),it=I(Le);aP(it,{get conversation(){return R(Rt)},get selectedId(){return R(d)},onSelect:E}),Y("click",Le,()=>f(R(Rt))),O(Ie,Le)});var Oe=L(ve,2),Z=I(Oe),we=I(Z),Ne=I(we);pk(Ne,{size:22});var Se=L(we,2),tt=I(Se),Mt=I(tt);lk(Mt,{size:22});var St=L(Se,2),qt=I(St),Ht=I(qt);yk(Ht,{size:22});var wi=L(P,2);H7(wi,{get mode(){return R(C)},get anchorRect(){return R(w)},get open(){return R(m)},set open(Ie){G(m,Ie)},children:(Ie,Rt)=>{var Le=xe(),it=ce(Le);{var Cs=oe=>{B7(oe,{onClose:b})},Nn=oe=>{var _e=xe(),st=ce(_e);{var Bt=Gn=>{z7(Gn,{onClose:b})},Hn=Gn=>{var Q=xe(),k=ce(Q);{var z=me=>{$7(me,{onClose:b})},K=me=>{var he=xe(),te=ce(he);{var ue=De=>{j7(De,{onClose:b})};ye(te,De=>{R(v)==="contacts"&&De(ue)},!0)}O(me,he)};ye(k,me=>{R(v)==="settings"?me(z):me(K,!1)},!0)}O(Gn,Q)};ye(st,Gn=>{R(v)==="group"?Gn(Bt):Gn(Hn,!1)},!0)}O(oe,_e)};ye(it,oe=>{R(v)==="user"?oe(Cs):oe(Nn,!1)})}O(Ie,Le)},$$slots:{default:!0},$$legacy:!0}),Me(()=>Ce=$i(Ee,1,"transition-all duration-200 ease-out overflow-hidden",null,Ce,{"h-0":!R(h),"opacity-0":!R(h),"mt-0":!R(h),"h-10":R(h),"opacity-100":R(h),"mt-2":R(h)})),Y("click",_,Ie=>S({type:"user",mode:"anchor",event:Ie})),Y("click",$,Ie=>S({type:"group",mode:"anchor",event:Ie})),Y("click",q,l),Y("scroll",ve,p),Y("click",tt,Ie=>S({type:"contacts",mode:"center",event:Ie})),Y("click",qt,Ie=>S({type:"settings",mode:"bottom",event:Ie})),O(e,A),rt(),r()}var X7=J("<!> <!>",1),Q7=J(`<div class="h-screen w-full flex flex-col bg-white"><header class="h-14 px-3
           flex items-center justify-between
           border-b border-gray-200 bg-white shrink-0"><div class="flex items-center gap-2"><button><!></button> <span class="font-semibold truncate max-w-[160px]"> </span></div> <div class="flex items-center gap-4"><!> <!></div></header> <main class="flex-1 overflow-y-auto bg-gray-100 px-3 py-2 space-y-2"></main> <footer class="w-full shrink-0
           px-2 py-0
           bg-white border-t border-gray-200"><!></footer></div>`);function J7(e,t){ot(t,!1);const i=()=>mt(Tn,"$conversationId",o),s=()=>mt(gr,"$myId",o),n=()=>mt(ka,"$messages",o),[o,r]=Ln(),a=re();let l=ge(t,"activeChat",8),c=ge(t,"back",8),d=re(),h=!1,u=!1,f=0,p=null;function m(B=""){const q=B.trim();!q||!R(a)||(console.log("text, selected, $myId:=-->",q,R(a),s()),ul({type:"chat",conversationId:R(a),from:s(),message:q}))}My(async()=>{if(R(d)){if(u){await Fc();const B=R(d).scrollHeight-f;B>0&&Ji(d,R(d).scrollTop+=B),u=!1;return}n().length>0&&(R(d).scrollHeight-R(d).scrollTop-R(d).clientHeight<300||p===null)&&C()}});async function v(){if(!R(d)||h||R(d).scrollTop>120||n().length===0)return;const B=n()[0];if(p!==B.id){h=!0,u=!0,f=R(d).scrollHeight,p=B.id;try{await tg(i(),{firstMsg:B})}catch(q){console.error("Load older failed:",q),p=null}finally{h=!1}}}async function C(B=!1){R(d)&&(await Fc(),R(d).scrollTo({top:R(d).scrollHeight,behavior:B?"smooth":"auto"}))}Ti(()=>i(),()=>{G(a,i())}),Ti(()=>(n(),R(d)),()=>{n().length>0&&R(d)&&R(d).scrollHeight-R(d).scrollTop-R(d).clientHeight<100&&C("smooth")}),Po(),lt();var w=Q7(),S=I(w),b=I(S),E=I(b);E.__click=function(...B){var q;(q=c())==null||q.apply(this,B)};var A=I(E);NE(A,{size:"22"});var P=L(E,2),T=I(P),D=L(b,2),N=I(D);Oy(N,{size:"20"});var M=L(N,2);ck(M,{size:"20"});var _=L(S,2);Ai(_,7,n,B=>B.id,(B,q,X)=>{var U=X7(),pe=ce(U);{var Ee=le=>{eA(le,{get time(){return R(q),ie(()=>R(q).created_at)},locale:"vi"})};ye(pe,le=>{Re(R(X)),Re(xm),R(q),n(),ie(()=>{var ee;return R(X)===0||xm(R(q).created_at,(ee=n()[R(X)-1])==null?void 0:ee.created_at)})&&le(Ee)})}var Ce=L(pe,2);rP(Ce,{get msg(){return R(q)},get myId(){return s()}}),O(B,U)}),ji(_,B=>G(d,B),()=>R(d));var W=L(_,2),$=I(W);aM($,{placeholder:"Nháº­p tin nháº¯n...",onSendText:B=>{m(B==null?void 0:B.text),console.log("payload:",B)},onSendImages:B=>{console.log("onSendImages:",B)},onSendFiles:B=>{console.log("onSendFiles:",B)},onSendSticker:B=>{console.log("onSendSticker:",B)}}),Me(()=>Be(T,(Re(l()),ie(()=>{var B;return(B=l())==null?void 0:B.name})))),Y("scroll",_,v),O(e,w),rt(),r()}Fv(["click"]);function Z7(e,t){ot(t,!1);const i=()=>mt(r,"$chatScreen",n),s=()=>mt(a,"$activeChat",n),[n,o]=Ln(),r=wy("chatScreen","list"),a=wy("activeChat",null);function l(v){a.set(v),r.set("detail")}function c(){r.set("list")}var d={back:c};lt();var h=xe(),u=ce(h);{var f=v=>{Y7(v,{openChat:l})},p=v=>{var C=xe(),w=ce(C);{var S=b=>{J7(b,{get activeChat(){return s()},back:c})};ye(w,b=>{i()==="detail"&&b(S)},!0)}O(v,C)};ye(u,v=>{i()==="list"?v(f):v(p,!1)})}O(e,h),Vr(t,"back",c);var m=rt(d);return o(),m}function e9(e){let t={mainKey:"chat-main",bodyKey:"chat-body",contentKey:"chat-content"};a7(e,{get option(){return t},$$slots:{mobile:(i,s)=>{Z7(i,{})},desktop:(i,s)=>{k7(i,{})}}})}var t9=J('<div class="p-4"> </div>'),i9=J('<div class="h-screen flex overflow-hidden"><div><div class="menu-left h-full w-full bg-blue-100 border-r-[2px] border-r-gray-300 flex flex-col items-center justify-between py-4 overflow-hidden"><div class="flex flex-col border-b gap-y-5"><button class="p-2 rounded-full hover:bg-green-600 text-white shadow-md transition"><!></button> <button class="p-2 rounded-full hover:bg-blue-600 text-white shadow-md transition"><!></button> <button class="p-2 rounded-full hover:bg-red-600 text-white shadow-md transition"><!></button> <button class="p-2 rounded-full bg-gray-500 hover:bg-gray-600 text-white shadow-md"><!></button> <button class="p-2 rounded-full bg-gray-500 hover:bg-gray-600 text-white shadow-md"><!></button></div> <div class="flex flex-col items-center"><button class="p-2 rounded-full hover:bg-gray-100 text-white shadow-md transition"><!></button></div></div></div> <div class="flex-1 overflow-auto bg-white"><!></div></div> <!> <!> <!> <!> <!>',1);function s9(e,t){ot(t,!1);const i=()=>mt(c,"$menuVisible",n),s=()=>mt(l,"$selectedFace",n),[n,o]=Ln();let r=re(!1),a=re({width:"80%",height:"80%",title:""});const{face:l,menuVisible:c,changeFace:d}=qS;function h(ve){let Oe="";ve.ctrlKey&&(Oe+="Ctrl+"),ve.altKey&&(Oe+="Alt+"),ve.shiftKey&&(Oe+="Shift+"),Oe+=ve.key,pw.subscribe(Z=>{Z[Oe]&&Z[Oe](ve)})}Ci(()=>{window.addEventListener("keydown",h)}),_r(()=>{window.removeEventListener("keydown",h)}),lt();var u=i9(),f=ce(u),p=I(f);let m;var v=I(p),C=I(v),w=I(C),S=I(w);ap(S,{name:"info-circle"});var b=L(w,2),E=I(b);ap(E,{name:"video"});var A=L(b,2),P=I(A);ap(P,{name:"list-ul"});var T=L(A,2),D=I(T);mk(D,{size:32});var N=L(T,2),M=I(N);fk(M,{size:32});var _=L(C,2),W=I(_),$=I(W);ap($,{name:"settings"});var B=L(p,2),q=I(B);{var X=ve=>{Dk(ve,{get user(){return Fa}})},U=ve=>{var Oe=xe(),Z=ce(Oe);{var we=Se=>{jk(Se,{onClose:()=>d("info")})},Ne=Se=>{var tt=xe(),Mt=ce(tt);{var St=Ht=>{c_(Ht,{})},qt=Ht=>{var wi=xe(),Ie=ce(wi);{var Rt=it=>{o7(it,{})},Le=it=>{var Cs=xe(),Nn=ce(Cs);{var oe=st=>{e9(st)},_e=st=>{var Bt=t9(),Hn=I(Bt);Me(()=>Be(Hn,`Coming soon... ${s()??""}`)),O(st,Bt)};ye(Nn,st=>{s()==="messenger"?st(oe):st(_e,!1)},!0)}O(it,Cs)};ye(Ie,it=>{s()==="chat"?it(Rt):it(Le,!1)},!0)}O(Ht,wi)};ye(Mt,Ht=>{s()==="list"?Ht(St):Ht(qt,!1)},!0)}O(Se,tt)};ye(Z,Se=>{s()==="cam"?Se(we):Se(Ne,!1)},!0)}O(ve,Oe)};ye(q,ve=>{s()==="info"?ve(X):ve(U,!1)})}var pe=L(f,2);Yk(pe,bt(()=>R(a),{closeOnOutsideClick:!1,get open(){return R(r)},set open(ve){G(r,ve)},children:(ve,Oe)=>{i_(ve)},$$slots:{default:!0},$$legacy:!0}));var Ee=L(pe,2);rC(Ee,{combo:"Escape",$$events:{pressed:()=>$r(l,"info")}});var Ce=L(Ee,2);rC(Ce,{combo:"Ctrl+q",$$events:{pressed:()=>$r(l,"info")}});var le=L(Ce,2);rC(le,{combo:"Ctrl+s",$$events:{pressed:ve=>{ve.preventDefault(),console.log("Save!")}}});var ee=L(le,2);f1(ee,{}),Me(()=>m=$i(p,1,"bg-gray-200 transition-all duration-300",null,m,{"w-[50px]":i(),"w-0":!i()})),Y("click",w,()=>d("info")),Y("click",b,()=>d("cam")),Y("click",A,()=>d("list")),Y("click",T,()=>d("chat")),Y("click",N,()=>d("messenger")),Y("click",W,()=>{G(r,!0),G(a,{width:"80%",height:"80%",title:"Thiáº¿t láº­p tÃ i khoáº£n"})}),O(e,u),rt(),o()}var n9=J('<div class="bg-red-100 text-red-700 px-3 py-2 rounded mb-4 text-sm"> </div>'),o9=bE('<svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4l3-3-3-3v4a12 12 0 00-12 12h4z"></path></svg>'),r9=J('<div class="min-h-screen bg-gray-100 flex items-center justify-center px-4"><div class="bg-white shadow-xl rounded-xl p-8 w-full max-w-md"><h2 class="text-2xl font-bold text-gray-800 text-center mb-6">ÄÄNG NHáº¬P</h2> <!> <form class="space-y-5"><div><label class="block text-sm font-medium text-gray-700">Email</label> <input type="email" class="mt-1 w-full px-4 py-2 border rounded-lg focus:ring focus:ring-blue-300 outline-none" required/></div> <div><label class="block text-sm font-medium text-gray-700">Máº­t kháº©u</label> <input type="password" class="mt-1 w-full px-4 py-2 border rounded-lg focus:ring focus:ring-blue-300 outline-none" required/></div> <button type="submit" class="w-full py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 transition flex justify-center"><!></button></form> <div class="flex items-center my-6"><div class="flex-1 h-px bg-gray-300"></div> <span class="px-3 text-gray-500 text-sm">hoáº·c</span> <div class="flex-1 h-px bg-gray-300"></div></div> <button class="w-full py-2 border border-gray-300 rounded-lg flex items-center justify-center gap-2 hover:bg-gray-100 transition"><img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" class="h-5 w-5"/> <span>ÄÄng nháº­p vá»i Google</span></button></div></div>');function a9(e,t){ot(t,!1);const i=new Tv;let s=re(""),n=re(""),o=re(""),r=re(!1);async function a(){G(o,""),G(r,!0);try{const P=await i.post("/auth/login",{email:R(s),password:R(n)},{withCredentials:!0});if(!P.user||!P.accessToken)throw new Error("Response missing user or accessToken");Fa.set(P.user),Pn.set(P.accessToken),console.log("setdata login:",P),P.refreshToken&&await _y(P.refreshToken)}catch(P){console.error("ð¨ LOGIN ERROR:",P),G(o,"Email hoáº·c máº­t kháº©u khÃ´ng ÄÃºng hoáº·c server khÃ´ng pháº£n há»i.")}finally{G(r,!1)}}function l(){window.location.href="http://localhost:3000/auth/google"}lt();var c=r9(),d=I(c),h=L(I(d),2);{var u=P=>{var T=n9(),D=I(T);Me(()=>Be(D,R(o))),O(P,T)};ye(h,P=>{R(o)&&P(u)})}var f=L(h,2),p=I(f),m=L(I(p),2),v=L(p,2),C=L(I(v),2),w=L(v,2),S=I(w);{var b=P=>{var T=o9();O(P,T)},E=P=>{var T=yE("ÄÄng nháº­p");O(P,T)};ye(S,P=>{R(r)?P(b):P(E,!1)})}var A=L(f,4);Me(()=>w.disabled=R(r)),eg(m,()=>R(s),P=>G(s,P)),eg(C,()=>R(n),P=>G(n,P)),Y("submit",f,YI(a)),Y("click",A,l),O(e,c),rt()}const l9=ri("light");function c9(){const e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches,i=e||(t?"dark":"light");d9(i),l9.set(i)}function d9(e){const t=document.documentElement;e==="dark"?t.classList.add("dark"):t.classList.remove("dark"),localStorage.setItem("theme",e)}function h9(e,t){ot(t,!1);const i=()=>mt(Pn,"$accessToken",o),s=()=>mt(Fa,"$user",o),n=()=>mt(nC,"$loading",o),[o,r]=Ln(),a=new Tv;let l=!1,c;const d=async()=>{try{let C=i();if(!C){const w=await OE();if(w){const S=await a.post("/auth/refresh",{refreshToken:w},{withCredentials:!0});C=S.accessToken,await Pn.set(C),S.refreshToken&&await _y(S.refreshToken)}}if(C){const w=await a.get("/auth/me",{headers:{Authorization:`Bearer ${C}`}});Fa.set(w.user)}else Fa.set(null)}catch(C){console.warn("Auto refresh failed:",C),Pn.set(""),Fa.set(null),await Ly()}};Ci(async()=>{nC.set(!0),await d(),c9(),window.addEventListener("beforeunload",h),window.addEventListener("popstate",u),c=Pn.subscribe(C=>{C?(console.log("ð accessToken ready â connect WS"),WE()):(console.log("ðª accessToken cleared â close WS"),fw())}),nC.set(!1)}),_r(()=>{c==null||c(),fw(),window.removeEventListener("beforeunload",h),window.removeEventListener("popstate",u)});function h(C){s()&&(C.preventDefault(),C.returnValue="")}function u(){s()&&!l&&(confirm("Báº¡n cÃ³ cháº¯c muá»n rá»i khá»i á»©ng dá»¥ng khÃ´ng?")?(l=!0,history.back()):history.pushState(null,"",location.href))}lt();var f=xe(),p=ce(f);{var m=C=>{VE(C,{})},v=C=>{var w=xe(),S=ce(w);{var b=A=>{s9(A,{})},E=A=>{a9(A,{})};ye(S,A=>{s()?A(b):A(E,!1)},!0)}O(C,w)};ye(p,C=>{n()?C(m):C(v,!1)})}O(e,f),rt(),r()}TI(h9,{target:document.getElementById("app")});export{Ji as $,ge as A,Jv as B,Io as C,Aa as D,kE as E,fi as F,Be as G,Tv as H,Nt as I,Ai as J,lC as K,gs as L,Pv as M,Ci as N,$i as O,Ti as P,Po as Q,Ek as R,Oy as S,eg as T,xk as U,yE as V,Gh as W,Fc as X,_r as Y,ap as Z,hl as _,ye as a,Yk as a0,mt as a1,_I as a2,Ln as a3,Fa as a4,Pn as a5,fw as a6,Ly as a7,f1 as a8,vI as a9,VI as aa,BE as ab,f9 as ac,Vr as ad,ji as b,I as c,ja as d,Y as e,J as f,R as g,O as h,lt as i,rt as j,YI as k,G as l,re as m,Wf as n,Re as o,ot as p,Nx as q,Jh as r,L as s,Me as t,ie as u,et as v,bt as w,xe as x,ce as y,We as z};
//# sourceMappingURL=index-CQo_ssL9.js.map
